(function(){const V=document.createElement("link").relList;if(V&&V.supports&&V.supports("modulepreload"))return;for(const G of document.querySelectorAll('link[rel="modulepreload"]'))T(G);new MutationObserver(G=>{for(const q of G)if(q.type==="childList")for(const j of q.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&T(j)}).observe(document,{childList:!0,subtree:!0});function F(G){const q={};return G.integrity&&(q.integrity=G.integrity),G.referrerPolicy&&(q.referrerPolicy=G.referrerPolicy),G.crossOrigin==="use-credentials"?q.credentials="include":G.crossOrigin==="anonymous"?q.credentials="omit":q.credentials="same-origin",q}function T(G){if(G.ep)return;G.ep=!0;const q=F(G);fetch(G.href,q)}})();var Tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rp(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}var Ey={exports:{}},mg={};var Lv;function _1(){if(Lv)return mg;Lv=1;var B=Symbol.for("react.transitional.element"),V=Symbol.for("react.fragment");function F(T,G,q){var j=null;if(q!==void 0&&(j=""+q),G.key!==void 0&&(j=""+G.key),"key"in G){q={};for(var J in G)J!=="key"&&(q[J]=G[J])}else q=G;return G=q.ref,{$$typeof:B,type:T,key:j,ref:G!==void 0?G:null,props:q}}return mg.Fragment=V,mg.jsx=F,mg.jsxs=F,mg}var Rv;function v1(){return Rv||(Rv=1,Ey.exports=_1()),Ey.exports}var Ui=v1(),Sy={exports:{}},yg={},Ty={exports:{}},Cy={};var Dv;function x1(){return Dv||(Dv=1,(function(B){function V(ct,kt){var ut=ct.length;ct.push(kt);t:for(;0<ut;){var ye=ut-1>>>1,te=ct[ye];if(0<G(te,kt))ct[ye]=kt,ct[ut]=te,ut=ye;else break t}}function F(ct){return ct.length===0?null:ct[0]}function T(ct){if(ct.length===0)return null;var kt=ct[0],ut=ct.pop();if(ut!==kt){ct[0]=ut;t:for(var ye=0,te=ct.length,mt=te>>>1;ye<mt;){var Zt=2*(ye+1)-1,ve=ct[Zt],Be=Zt+1,de=ct[Be];if(0>G(ve,ut))Be<te&&0>G(de,ve)?(ct[ye]=de,ct[Be]=ut,ye=Be):(ct[ye]=ve,ct[Zt]=ut,ye=Zt);else if(Be<te&&0>G(de,ut))ct[ye]=de,ct[Be]=ut,ye=Be;else break t}}return kt}function G(ct,kt){var ut=ct.sortIndex-kt.sortIndex;return ut!==0?ut:ct.id-kt.id}if(B.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var q=performance;B.unstable_now=function(){return q.now()}}else{var j=Date,J=j.now();B.unstable_now=function(){return j.now()-J}}var h=[],X=[],tt=1,ht=null,st=3,At=!1,yt=!1,it=!1,ae=!1,le=typeof setTimeout=="function"?setTimeout:null,Ft=typeof clearTimeout=="function"?clearTimeout:null,lt=typeof setImmediate<"u"?setImmediate:null;function pt(ct){for(var kt=F(X);kt!==null;){if(kt.callback===null)T(X);else if(kt.startTime<=ct)T(X),kt.sortIndex=kt.expirationTime,V(h,kt);else break;kt=F(X)}}function It(ct){if(it=!1,pt(ct),!yt)if(F(h)!==null)yt=!0,Dt||(Dt=!0,rt());else{var kt=F(X);kt!==null&&Xn(It,kt.startTime-ct)}}var Dt=!1,_t=-1,Jt=5,Xt=-1;function ie(){return ae?!0:!(B.unstable_now()-Xt<Jt)}function Yt(){if(ae=!1,Dt){var ct=B.unstable_now();Xt=ct;var kt=!0;try{t:{yt=!1,it&&(it=!1,Ft(_t),_t=-1),At=!0;var ut=st;try{e:{for(pt(ct),ht=F(h);ht!==null&&!(ht.expirationTime>ct&&ie());){var ye=ht.callback;if(typeof ye=="function"){ht.callback=null,st=ht.priorityLevel;var te=ye(ht.expirationTime<=ct);if(ct=B.unstable_now(),typeof te=="function"){ht.callback=te,pt(ct),kt=!0;break e}ht===F(h)&&T(h),pt(ct)}else T(h);ht=F(h)}if(ht!==null)kt=!0;else{var mt=F(X);mt!==null&&Xn(It,mt.startTime-ct),kt=!1}}break t}finally{ht=null,st=ut,At=!1}kt=void 0}}finally{kt?rt():Dt=!1}}}var rt;if(typeof lt=="function")rt=function(){lt(Yt)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,Sn=qe.port2;qe.port1.onmessage=Yt,rt=function(){Sn.postMessage(null)}}else rt=function(){le(Yt,0)};function Xn(ct,kt){_t=le(function(){ct(B.unstable_now())},kt)}B.unstable_IdlePriority=5,B.unstable_ImmediatePriority=1,B.unstable_LowPriority=4,B.unstable_NormalPriority=3,B.unstable_Profiling=null,B.unstable_UserBlockingPriority=2,B.unstable_cancelCallback=function(ct){ct.callback=null},B.unstable_forceFrameRate=function(ct){0>ct||125<ct?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Jt=0<ct?Math.floor(1e3/ct):5},B.unstable_getCurrentPriorityLevel=function(){return st},B.unstable_next=function(ct){switch(st){case 1:case 2:case 3:var kt=3;break;default:kt=st}var ut=st;st=kt;try{return ct()}finally{st=ut}},B.unstable_requestPaint=function(){ae=!0},B.unstable_runWithPriority=function(ct,kt){switch(ct){case 1:case 2:case 3:case 4:case 5:break;default:ct=3}var ut=st;st=ct;try{return kt()}finally{st=ut}},B.unstable_scheduleCallback=function(ct,kt,ut){var ye=B.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?ye+ut:ye):ut=ye,ct){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=ut+te,ct={id:tt++,callback:kt,priorityLevel:ct,startTime:ut,expirationTime:te,sortIndex:-1},ut>ye?(ct.sortIndex=ut,V(X,ct),F(h)===null&&ct===F(X)&&(it?(Ft(_t),_t=-1):it=!0,Xn(It,ut-ye))):(ct.sortIndex=te,V(h,ct),yt||At||(yt=!0,Dt||(Dt=!0,rt()))),ct},B.unstable_shouldYield=ie,B.unstable_wrapCallback=function(ct){var kt=st;return function(){var ut=st;st=kt;try{return ct.apply(this,arguments)}finally{st=ut}}}})(Cy)),Cy}var Nv;function b1(){return Nv||(Nv=1,Ty.exports=x1()),Ty.exports}var Iy={exports:{}},Ji={};var Ov;function w1(){if(Ov)return Ji;Ov=1;var B=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),j=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),X=Symbol.for("react.memo"),tt=Symbol.for("react.lazy"),ht=Symbol.for("react.activity"),st=Symbol.iterator;function At(mt){return mt===null||typeof mt!="object"?null:(mt=st&&mt[st]||mt["@@iterator"],typeof mt=="function"?mt:null)}var yt={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},it=Object.assign,ae={};function le(mt,Zt,ve){this.props=mt,this.context=Zt,this.refs=ae,this.updater=ve||yt}le.prototype.isReactComponent={},le.prototype.setState=function(mt,Zt){if(typeof mt!="object"&&typeof mt!="function"&&mt!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,mt,Zt,"setState")},le.prototype.forceUpdate=function(mt){this.updater.enqueueForceUpdate(this,mt,"forceUpdate")};function Ft(){}Ft.prototype=le.prototype;function lt(mt,Zt,ve){this.props=mt,this.context=Zt,this.refs=ae,this.updater=ve||yt}var pt=lt.prototype=new Ft;pt.constructor=lt,it(pt,le.prototype),pt.isPureReactComponent=!0;var It=Array.isArray;function Dt(){}var _t={H:null,A:null,T:null,S:null},Jt=Object.prototype.hasOwnProperty;function Xt(mt,Zt,ve){var Be=ve.ref;return{$$typeof:B,type:mt,key:Zt,ref:Be!==void 0?Be:null,props:ve}}function ie(mt,Zt){return Xt(mt.type,Zt,mt.props)}function Yt(mt){return typeof mt=="object"&&mt!==null&&mt.$$typeof===B}function rt(mt){var Zt={"=":"=0",":":"=2"};return"$"+mt.replace(/[=:]/g,function(ve){return Zt[ve]})}var qe=/\/+/g;function Sn(mt,Zt){return typeof mt=="object"&&mt!==null&&mt.key!=null?rt(""+mt.key):Zt.toString(36)}function Xn(mt){switch(mt.status){case"fulfilled":return mt.value;case"rejected":throw mt.reason;default:switch(typeof mt.status=="string"?mt.then(Dt,Dt):(mt.status="pending",mt.then(function(Zt){mt.status==="pending"&&(mt.status="fulfilled",mt.value=Zt)},function(Zt){mt.status==="pending"&&(mt.status="rejected",mt.reason=Zt)})),mt.status){case"fulfilled":return mt.value;case"rejected":throw mt.reason}}throw mt}function ct(mt,Zt,ve,Be,de){var On=typeof mt;(On==="undefined"||On==="boolean")&&(mt=null);var An=!1;if(mt===null)An=!0;else switch(On){case"bigint":case"string":case"number":An=!0;break;case"object":switch(mt.$$typeof){case B:case V:An=!0;break;case tt:return An=mt._init,ct(An(mt._payload),Zt,ve,Be,de)}}if(An)return de=de(mt),An=Be===""?"."+Sn(mt,0):Be,It(de)?(ve="",An!=null&&(ve=An.replace(qe,"$&/")+"/"),ct(de,Zt,ve,"",function(Gi){return Gi})):de!=null&&(Yt(de)&&(de=ie(de,ve+(de.key==null||mt&&mt.key===de.key?"":(""+de.key).replace(qe,"$&/")+"/")+An)),Zt.push(de)),1;An=0;var $n=Be===""?".":Be+":";if(It(mt))for(var yi=0;yi<mt.length;yi++)Be=mt[yi],On=$n+Sn(Be,yi),An+=ct(Be,Zt,ve,On,de);else if(yi=At(mt),typeof yi=="function")for(mt=yi.call(mt),yi=0;!(Be=mt.next()).done;)Be=Be.value,On=$n+Sn(Be,yi++),An+=ct(Be,Zt,ve,On,de);else if(On==="object"){if(typeof mt.then=="function")return ct(Xn(mt),Zt,ve,Be,de);throw Zt=String(mt),Error("Objects are not valid as a React child (found: "+(Zt==="[object Object]"?"object with keys {"+Object.keys(mt).join(", ")+"}":Zt)+"). If you meant to render a collection of children, use an array instead.")}return An}function kt(mt,Zt,ve){if(mt==null)return mt;var Be=[],de=0;return ct(mt,Be,"","",function(On){return Zt.call(ve,On,de++)}),Be}function ut(mt){if(mt._status===-1){var Zt=mt._result;Zt=Zt(),Zt.then(function(ve){(mt._status===0||mt._status===-1)&&(mt._status=1,mt._result=ve)},function(ve){(mt._status===0||mt._status===-1)&&(mt._status=2,mt._result=ve)}),mt._status===-1&&(mt._status=0,mt._result=Zt)}if(mt._status===1)return mt._result.default;throw mt._result}var ye=typeof reportError=="function"?reportError:function(mt){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Zt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof mt=="object"&&mt!==null&&typeof mt.message=="string"?String(mt.message):String(mt),error:mt});if(!window.dispatchEvent(Zt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",mt);return}console.error(mt)},te={map:kt,forEach:function(mt,Zt,ve){kt(mt,function(){Zt.apply(this,arguments)},ve)},count:function(mt){var Zt=0;return kt(mt,function(){Zt++}),Zt},toArray:function(mt){return kt(mt,function(Zt){return Zt})||[]},only:function(mt){if(!Yt(mt))throw Error("React.Children.only expected to receive a single React element child.");return mt}};return Ji.Activity=ht,Ji.Children=te,Ji.Component=le,Ji.Fragment=F,Ji.Profiler=G,Ji.PureComponent=lt,Ji.StrictMode=T,Ji.Suspense=h,Ji.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_t,Ji.__COMPILER_RUNTIME={__proto__:null,c:function(mt){return _t.H.useMemoCache(mt)}},Ji.cache=function(mt){return function(){return mt.apply(null,arguments)}},Ji.cacheSignal=function(){return null},Ji.cloneElement=function(mt,Zt,ve){if(mt==null)throw Error("The argument must be a React element, but you passed "+mt+".");var Be=it({},mt.props),de=mt.key;if(Zt!=null)for(On in Zt.key!==void 0&&(de=""+Zt.key),Zt)!Jt.call(Zt,On)||On==="key"||On==="__self"||On==="__source"||On==="ref"&&Zt.ref===void 0||(Be[On]=Zt[On]);var On=arguments.length-2;if(On===1)Be.children=ve;else if(1<On){for(var An=Array(On),$n=0;$n<On;$n++)An[$n]=arguments[$n+2];Be.children=An}return Xt(mt.type,de,Be)},Ji.createContext=function(mt){return mt={$$typeof:j,_currentValue:mt,_currentValue2:mt,_threadCount:0,Provider:null,Consumer:null},mt.Provider=mt,mt.Consumer={$$typeof:q,_context:mt},mt},Ji.createElement=function(mt,Zt,ve){var Be,de={},On=null;if(Zt!=null)for(Be in Zt.key!==void 0&&(On=""+Zt.key),Zt)Jt.call(Zt,Be)&&Be!=="key"&&Be!=="__self"&&Be!=="__source"&&(de[Be]=Zt[Be]);var An=arguments.length-2;if(An===1)de.children=ve;else if(1<An){for(var $n=Array(An),yi=0;yi<An;yi++)$n[yi]=arguments[yi+2];de.children=$n}if(mt&&mt.defaultProps)for(Be in An=mt.defaultProps,An)de[Be]===void 0&&(de[Be]=An[Be]);return Xt(mt,On,de)},Ji.createRef=function(){return{current:null}},Ji.forwardRef=function(mt){return{$$typeof:J,render:mt}},Ji.isValidElement=Yt,Ji.lazy=function(mt){return{$$typeof:tt,_payload:{_status:-1,_result:mt},_init:ut}},Ji.memo=function(mt,Zt){return{$$typeof:X,type:mt,compare:Zt===void 0?null:Zt}},Ji.startTransition=function(mt){var Zt=_t.T,ve={};_t.T=ve;try{var Be=mt(),de=_t.S;de!==null&&de(ve,Be),typeof Be=="object"&&Be!==null&&typeof Be.then=="function"&&Be.then(Dt,ye)}catch(On){ye(On)}finally{Zt!==null&&ve.types!==null&&(Zt.types=ve.types),_t.T=Zt}},Ji.unstable_useCacheRefresh=function(){return _t.H.useCacheRefresh()},Ji.use=function(mt){return _t.H.use(mt)},Ji.useActionState=function(mt,Zt,ve){return _t.H.useActionState(mt,Zt,ve)},Ji.useCallback=function(mt,Zt){return _t.H.useCallback(mt,Zt)},Ji.useContext=function(mt){return _t.H.useContext(mt)},Ji.useDebugValue=function(){},Ji.useDeferredValue=function(mt,Zt){return _t.H.useDeferredValue(mt,Zt)},Ji.useEffect=function(mt,Zt){return _t.H.useEffect(mt,Zt)},Ji.useEffectEvent=function(mt){return _t.H.useEffectEvent(mt)},Ji.useId=function(){return _t.H.useId()},Ji.useImperativeHandle=function(mt,Zt,ve){return _t.H.useImperativeHandle(mt,Zt,ve)},Ji.useInsertionEffect=function(mt,Zt){return _t.H.useInsertionEffect(mt,Zt)},Ji.useLayoutEffect=function(mt,Zt){return _t.H.useLayoutEffect(mt,Zt)},Ji.useMemo=function(mt,Zt){return _t.H.useMemo(mt,Zt)},Ji.useOptimistic=function(mt,Zt){return _t.H.useOptimistic(mt,Zt)},Ji.useReducer=function(mt,Zt,ve){return _t.H.useReducer(mt,Zt,ve)},Ji.useRef=function(mt){return _t.H.useRef(mt)},Ji.useState=function(mt){return _t.H.useState(mt)},Ji.useSyncExternalStore=function(mt,Zt,ve){return _t.H.useSyncExternalStore(mt,Zt,ve)},Ji.useTransition=function(){return _t.H.useTransition()},Ji.version="19.2.0",Ji}var zv;function Y_(){return zv||(zv=1,Iy.exports=w1()),Iy.exports}var My={exports:{}},hu={};var Pv;function E1(){if(Pv)return hu;Pv=1;var B=Y_();function V(h){var X="https://react.dev/errors/"+h;if(1<arguments.length){X+="?args[]="+encodeURIComponent(arguments[1]);for(var tt=2;tt<arguments.length;tt++)X+="&args[]="+encodeURIComponent(arguments[tt])}return"Minified React error #"+h+"; visit "+X+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function F(){}var T={d:{f:F,r:function(){throw Error(V(522))},D:F,C:F,L:F,m:F,X:F,S:F,M:F},p:0,findDOMNode:null},G=Symbol.for("react.portal");function q(h,X,tt){var ht=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:ht==null?null:""+ht,children:h,containerInfo:X,implementation:tt}}var j=B.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function J(h,X){if(h==="font")return"";if(typeof X=="string")return X==="use-credentials"?X:""}return hu.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,hu.createPortal=function(h,X){var tt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!X||X.nodeType!==1&&X.nodeType!==9&&X.nodeType!==11)throw Error(V(299));return q(h,X,null,tt)},hu.flushSync=function(h){var X=j.T,tt=T.p;try{if(j.T=null,T.p=2,h)return h()}finally{j.T=X,T.p=tt,T.d.f()}},hu.preconnect=function(h,X){typeof h=="string"&&(X?(X=X.crossOrigin,X=typeof X=="string"?X==="use-credentials"?X:"":void 0):X=null,T.d.C(h,X))},hu.prefetchDNS=function(h){typeof h=="string"&&T.d.D(h)},hu.preinit=function(h,X){if(typeof h=="string"&&X&&typeof X.as=="string"){var tt=X.as,ht=J(tt,X.crossOrigin),st=typeof X.integrity=="string"?X.integrity:void 0,At=typeof X.fetchPriority=="string"?X.fetchPriority:void 0;tt==="style"?T.d.S(h,typeof X.precedence=="string"?X.precedence:void 0,{crossOrigin:ht,integrity:st,fetchPriority:At}):tt==="script"&&T.d.X(h,{crossOrigin:ht,integrity:st,fetchPriority:At,nonce:typeof X.nonce=="string"?X.nonce:void 0})}},hu.preinitModule=function(h,X){if(typeof h=="string")if(typeof X=="object"&&X!==null){if(X.as==null||X.as==="script"){var tt=J(X.as,X.crossOrigin);T.d.M(h,{crossOrigin:tt,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0})}}else X==null&&T.d.M(h)},hu.preload=function(h,X){if(typeof h=="string"&&typeof X=="object"&&X!==null&&typeof X.as=="string"){var tt=X.as,ht=J(tt,X.crossOrigin);T.d.L(h,tt,{crossOrigin:ht,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0,type:typeof X.type=="string"?X.type:void 0,fetchPriority:typeof X.fetchPriority=="string"?X.fetchPriority:void 0,referrerPolicy:typeof X.referrerPolicy=="string"?X.referrerPolicy:void 0,imageSrcSet:typeof X.imageSrcSet=="string"?X.imageSrcSet:void 0,imageSizes:typeof X.imageSizes=="string"?X.imageSizes:void 0,media:typeof X.media=="string"?X.media:void 0})}},hu.preloadModule=function(h,X){if(typeof h=="string")if(X){var tt=J(X.as,X.crossOrigin);T.d.m(h,{as:typeof X.as=="string"&&X.as!=="script"?X.as:void 0,crossOrigin:tt,integrity:typeof X.integrity=="string"?X.integrity:void 0})}else T.d.m(h)},hu.requestFormReset=function(h){T.d.r(h)},hu.unstable_batchedUpdates=function(h,X){return h(X)},hu.useFormState=function(h,X,tt){return j.H.useFormState(h,X,tt)},hu.useFormStatus=function(){return j.H.useHostTransitionStatus()},hu.version="19.2.0",hu}var Bv;function S1(){if(Bv)return My.exports;Bv=1;function B(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(B)}catch(V){console.error(V)}}return B(),My.exports=E1(),My.exports}var Fv;function T1(){if(Fv)return yg;Fv=1;var B=b1(),V=Y_(),F=S1();function T(a){var u="https://react.dev/errors/"+a;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function G(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function q(a){var u=a,g=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,(u.flags&4098)!==0&&(g=u.return),a=u.return;while(a)}return u.tag===3?g:null}function j(a){if(a.tag===13){var u=a.memoizedState;if(u===null&&(a=a.alternate,a!==null&&(u=a.memoizedState)),u!==null)return u.dehydrated}return null}function J(a){if(a.tag===31){var u=a.memoizedState;if(u===null&&(a=a.alternate,a!==null&&(u=a.memoizedState)),u!==null)return u.dehydrated}return null}function h(a){if(q(a)!==a)throw Error(T(188))}function X(a){var u=a.alternate;if(!u){if(u=q(a),u===null)throw Error(T(188));return u!==a?null:a}for(var g=a,b=u;;){var A=g.return;if(A===null)break;var D=A.alternate;if(D===null){if(b=A.return,b!==null){g=b;continue}break}if(A.child===D.child){for(D=A.child;D;){if(D===g)return h(A),a;if(D===b)return h(A),u;D=D.sibling}throw Error(T(188))}if(g.return!==b.return)g=A,b=D;else{for(var K=!1,bt=A.child;bt;){if(bt===g){K=!0,g=A,b=D;break}if(bt===b){K=!0,b=A,g=D;break}bt=bt.sibling}if(!K){for(bt=D.child;bt;){if(bt===g){K=!0,g=D,b=A;break}if(bt===b){K=!0,b=D,g=A;break}bt=bt.sibling}if(!K)throw Error(T(189))}}if(g.alternate!==b)throw Error(T(190))}if(g.tag!==3)throw Error(T(188));return g.stateNode.current===g?a:u}function tt(a){var u=a.tag;if(u===5||u===26||u===27||u===6)return a;for(a=a.child;a!==null;){if(u=tt(a),u!==null)return u;a=a.sibling}return null}var ht=Object.assign,st=Symbol.for("react.element"),At=Symbol.for("react.transitional.element"),yt=Symbol.for("react.portal"),it=Symbol.for("react.fragment"),ae=Symbol.for("react.strict_mode"),le=Symbol.for("react.profiler"),Ft=Symbol.for("react.consumer"),lt=Symbol.for("react.context"),pt=Symbol.for("react.forward_ref"),It=Symbol.for("react.suspense"),Dt=Symbol.for("react.suspense_list"),_t=Symbol.for("react.memo"),Jt=Symbol.for("react.lazy"),Xt=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),Yt=Symbol.iterator;function rt(a){return a===null||typeof a!="object"?null:(a=Yt&&a[Yt]||a["@@iterator"],typeof a=="function"?a:null)}var qe=Symbol.for("react.client.reference");function Sn(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===qe?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case it:return"Fragment";case le:return"Profiler";case ae:return"StrictMode";case It:return"Suspense";case Dt:return"SuspenseList";case Xt:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case yt:return"Portal";case lt:return a.displayName||"Context";case Ft:return(a._context.displayName||"Context")+".Consumer";case pt:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case _t:return u=a.displayName||null,u!==null?u:Sn(a.type)||"Memo";case Jt:u=a._payload,a=a._init;try{return Sn(a(u))}catch{}}return null}var Xn=Array.isArray,ct=V.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,kt=F.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ut={pending:!1,data:null,method:null,action:null},ye=[],te=-1;function mt(a){return{current:a}}function Zt(a){0>te||(a.current=ye[te],ye[te]=null,te--)}function ve(a,u){te++,ye[te]=a.current,a.current=u}var Be=mt(null),de=mt(null),On=mt(null),An=mt(null);function $n(a,u){switch(ve(On,u),ve(de,a),ve(Be,null),u.nodeType){case 9:case 11:a=(a=u.documentElement)&&(a=a.namespaceURI)?nm(a):0;break;default:if(a=u.tagName,u=u.namespaceURI)u=nm(u),a=im(u,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}Zt(Be),ve(Be,a)}function yi(){Zt(Be),Zt(de),Zt(On)}function Gi(a){a.memoizedState!==null&&ve(An,a);var u=Be.current,g=im(u,a.type);u!==g&&(ve(de,a),ve(Be,g))}function jr(a){de.current===a&&(Zt(Be),Zt(de)),An.current===a&&(Zt(An),bf._currentValue=ut)}var Bn,lr;function Fr(a){if(Bn===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);Bn=u&&u[1]||"",lr=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Bn+a+lr}var Mn=!1;function ui(a,u){if(!a||Mn)return"";Mn=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(u){var ln=function(){throw Error()};if(Object.defineProperty(ln.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ln,[])}catch(Ue){var ze=Ue}Reflect.construct(a,[],ln)}else{try{ln.call()}catch(Ue){ze=Ue}a.call(ln.prototype)}}else{try{throw Error()}catch(Ue){ze=Ue}(ln=a())&&typeof ln.catch=="function"&&ln.catch(function(){})}}catch(Ue){if(Ue&&ze&&typeof Ue.stack=="string")return[Ue.stack,ze.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=b.DetermineComponentFrameRoot(),K=D[0],bt=D[1];if(K&&bt){var ee=K.split(`
`),Le=bt.split(`
`);for(A=b=0;b<ee.length&&!ee[b].includes("DetermineComponentFrameRoot");)b++;for(;A<Le.length&&!Le[A].includes("DetermineComponentFrameRoot");)A++;if(b===ee.length||A===Le.length)for(b=ee.length-1,A=Le.length-1;1<=b&&0<=A&&ee[b]!==Le[A];)A--;for(;1<=b&&0<=A;b--,A--)if(ee[b]!==Le[A]){if(b!==1||A!==1)do if(b--,A--,0>A||ee[b]!==Le[A]){var He=`
`+ee[b].replace(" at new "," at ");return a.displayName&&He.includes("<anonymous>")&&(He=He.replace("<anonymous>",a.displayName)),He}while(1<=b&&0<=A);break}}}finally{Mn=!1,Error.prepareStackTrace=g}return(g=a?a.displayName||a.name:"")?Fr(g):""}function Vl(a,u){switch(a.tag){case 26:case 27:case 5:return Fr(a.type);case 16:return Fr("Lazy");case 13:return a.child!==u&&u!==null?Fr("Suspense Fallback"):Fr("Suspense");case 19:return Fr("SuspenseList");case 0:case 15:return ui(a.type,!1);case 11:return ui(a.type.render,!1);case 1:return ui(a.type,!0);case 31:return Fr("Activity");default:return""}}function mr(a){try{var u="",g=null;do u+=Vl(a,g),g=a,a=a.return;while(a);return u}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var _l=Object.prototype.hasOwnProperty,vi=B.unstable_scheduleCallback,Us=B.unstable_cancelCallback,Wa=B.unstable_shouldYield,eo=B.unstable_requestPaint,Ri=B.unstable_now,$a=B.unstable_getCurrentPriorityLevel,ql=B.unstable_ImmediatePriority,Qr=B.unstable_UserBlockingPriority,hs=B.unstable_NormalPriority,$e=B.unstable_LowPriority,yr=B.unstable_IdlePriority,Xr=B.log,ri=B.unstable_setDisableYieldValue,Ki=null,Tr=null;function Rs(a){if(typeof Xr=="function"&&ri(a),Tr&&typeof Tr.setStrictMode=="function")try{Tr.setStrictMode(Ki,a)}catch{}}var _r=Math.clz32?Math.clz32:jl,Di=Math.log,fu=Math.LN2;function jl(a){return a>>>=0,a===0?32:31-(Di(a)/fu|0)|0}var vl=256,ya=262144,Dr=4194304;function Kn(a){var u=a&42;if(u!==0)return u;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function oi(a,u,g){var b=a.pendingLanes;if(b===0)return 0;var A=0,D=a.suspendedLanes,K=a.pingedLanes;a=a.warmLanes;var bt=b&134217727;return bt!==0?(b=bt&~D,b!==0?A=Kn(b):(K&=bt,K!==0?A=Kn(K):g||(g=bt&~a,g!==0&&(A=Kn(g))))):(bt=b&~D,bt!==0?A=Kn(bt):K!==0?A=Kn(K):g||(g=b&~a,g!==0&&(A=Kn(g)))),A===0?0:u!==0&&u!==A&&(u&D)===0&&(D=A&-A,g=u&-u,D>=g||D===32&&(g&4194048)!==0)?u:A}function Ds(a,u){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&u)===0}function rr(a,u){switch(a){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ts(){var a=Dr;return Dr<<=1,(Dr&62914560)===0&&(Dr=4194304),a}function Pi(a){for(var u=[],g=0;31>g;g++)u.push(a);return u}function Zr(a,u){a.pendingLanes|=u,u!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Yi(a,u,g,b,A,D){var K=a.pendingLanes;a.pendingLanes=g,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=g,a.entangledLanes&=g,a.errorRecoveryDisabledLanes&=g,a.shellSuspendCounter=0;var bt=a.entanglements,ee=a.expirationTimes,Le=a.hiddenUpdates;for(g=K&~g;0<g;){var He=31-_r(g),ln=1<<He;bt[He]=0,ee[He]=-1;var ze=Le[He];if(ze!==null)for(Le[He]=null,He=0;He<ze.length;He++){var Ue=ze[He];Ue!==null&&(Ue.lane&=-536870913)}g&=~ln}b!==0&&Ct(a,b,0),D!==0&&A===0&&a.tag!==0&&(a.suspendedLanes|=D&~(K&~u))}function Ct(a,u,g){a.pendingLanes|=u,a.suspendedLanes&=~u;var b=31-_r(u);a.entangledLanes|=u,a.entanglements[b]=a.entanglements[b]|1073741824|g&261930}function et(a,u){var g=a.entangledLanes|=u;for(a=a.entanglements;g;){var b=31-_r(g),A=1<<b;A&u|a[b]&u&&(a[b]|=u),g&=~A}}function ot(a,u){var g=u&-u;return g=(g&42)!==0?1:Lt(g),(g&(a.suspendedLanes|u))!==0?0:g}function Lt(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Pt(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Kt(){var a=kt.p;return a!==0?a:(a=window.event,a===void 0?32:sg(a.type))}function ue(a,u){var g=kt.p;try{return kt.p=a,u()}finally{kt.p=g}}var se=Math.random().toString(36).slice(2),$t="__reactFiber$"+se,me="__reactProps$"+se,je="__reactContainer$"+se,yn="__reactEvents$"+se,Je="__reactListeners$"+se,Zn="__reactHandles$"+se,jn="__reactResources$"+se,Fn="__reactMarker$"+se;function Qn(a){delete a[$t],delete a[me],delete a[yn],delete a[Je],delete a[Zn]}function fi(a){var u=a[$t];if(u)return u;for(var g=a.parentNode;g;){if(u=g[je]||g[$t]){if(g=u.alternate,u.child!==null||g!==null&&g.child!==null)for(a=Yp(a);a!==null;){if(g=a[$t])return g;a=Yp(a)}return u}a=g,g=a.parentNode}return null}function ki(a){if(a=a[$t]||a[je]){var u=a.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return a}return null}function Dn(a){var u=a.tag;if(u===5||u===26||u===27||u===6)return a.stateNode;throw Error(T(33))}function Vi(a){var u=a[jn];return u||(u=a[jn]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function _i(a){a[Fn]=!0}var Ra=new Set,Ss={};function _e(a,u){Hr(a,u),Hr(a+"Capture",u)}function Hr(a,u){for(Ss[a]=u,a=0;a<u.length;a++)Ra.add(u[a])}var Rn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_a={},Ns={};function gi(a){return _l.call(Ns,a)?!0:_l.call(_a,a)?!1:Rn.test(a)?Ns[a]=!0:(_a[a]=!0,!1)}function ji(a,u,g){if(gi(u))if(g===null)a.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":a.removeAttribute(u);return;case"boolean":var b=u.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){a.removeAttribute(u);return}}a.setAttribute(u,""+g)}}function ea(a,u,g){if(g===null)a.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(u);return}a.setAttribute(u,""+g)}}function kr(a,u,g,b){if(b===null)a.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(g);return}a.setAttributeNS(u,g,""+b)}}function re(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function gn(a){var u=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function zn(a,u,g){var b=Object.getOwnPropertyDescriptor(a.constructor.prototype,u);if(!a.hasOwnProperty(u)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var A=b.get,D=b.set;return Object.defineProperty(a,u,{configurable:!0,get:function(){return A.call(this)},set:function(K){g=""+K,D.call(this,K)}}),Object.defineProperty(a,u,{enumerable:b.enumerable}),{getValue:function(){return g},setValue:function(K){g=""+K},stopTracking:function(){a._valueTracker=null,delete a[u]}}}}function Ts(a){if(!a._valueTracker){var u=gn(a)?"checked":"value";a._valueTracker=zn(a,u,""+a[u])}}function Ja(a){if(!a)return!1;var u=a._valueTracker;if(!u)return!0;var g=u.getValue(),b="";return a&&(b=gn(a)?a.checked?"true":"false":a.value),a=b,a!==g?(u.setValue(a),!0):!1}function Hn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Ka=/[\n"\\]/g;function Ur(a){return a.replace(Ka,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function na(a,u,g,b,A,D,K,bt){a.name="",K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?a.type=K:a.removeAttribute("type"),u!=null?K==="number"?(u===0&&a.value===""||a.value!=u)&&(a.value=""+re(u)):a.value!==""+re(u)&&(a.value=""+re(u)):K!=="submit"&&K!=="reset"||a.removeAttribute("value"),u!=null?Qi(a,K,re(u)):g!=null?Qi(a,K,re(g)):b!=null&&a.removeAttribute("value"),A==null&&D!=null&&(a.defaultChecked=!!D),A!=null&&(a.checked=A&&typeof A!="function"&&typeof A!="symbol"),bt!=null&&typeof bt!="function"&&typeof bt!="symbol"&&typeof bt!="boolean"?a.name=""+re(bt):a.removeAttribute("name")}function br(a,u,g,b,A,D,K,bt){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(a.type=D),u!=null||g!=null){if(!(D!=="submit"&&D!=="reset"||u!=null)){Ts(a);return}g=g!=null?""+re(g):"",u=u!=null?""+re(u):g,bt||u===a.value||(a.value=u),a.defaultValue=u}b=b??A,b=typeof b!="function"&&typeof b!="symbol"&&!!b,a.checked=bt?a.checked:!!b,a.defaultChecked=!!b,K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"&&(a.name=K),Ts(a)}function Qi(a,u,g){u==="number"&&Hn(a.ownerDocument)===a||a.defaultValue===""+g||(a.defaultValue=""+g)}function R(a,u,g,b){if(a=a.options,u){u={};for(var A=0;A<g.length;A++)u["$"+g[A]]=!0;for(g=0;g<a.length;g++)A=u.hasOwnProperty("$"+a[g].value),a[g].selected!==A&&(a[g].selected=A),A&&b&&(a[g].defaultSelected=!0)}else{for(g=""+re(g),u=null,A=0;A<a.length;A++){if(a[A].value===g){a[A].selected=!0,b&&(a[A].defaultSelected=!0);return}u!==null||a[A].disabled||(u=a[A])}u!==null&&(u.selected=!0)}}function H(a,u,g){if(u!=null&&(u=""+re(u),u!==a.value&&(a.value=u),g==null)){a.defaultValue!==u&&(a.defaultValue=u);return}a.defaultValue=g!=null?""+re(g):""}function ft(a,u,g,b){if(u==null){if(b!=null){if(g!=null)throw Error(T(92));if(Xn(b)){if(1<b.length)throw Error(T(93));b=b[0]}g=b}g==null&&(g=""),u=g}g=re(u),a.defaultValue=g,b=a.textContent,b===g&&b!==""&&b!==null&&(a.value=b),Ts(a)}function Ht(a,u){if(u){var g=a.firstChild;if(g&&g===a.lastChild&&g.nodeType===3){g.nodeValue=u;return}}a.textContent=u}var Ce=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function pe(a,u,g){var b=u.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?b?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="":b?a.setProperty(u,g):typeof g!="number"||g===0||Ce.has(u)?u==="float"?a.cssFloat=g:a[u]=(""+g).trim():a[u]=g+"px"}function be(a,u,g){if(u!=null&&typeof u!="object")throw Error(T(62));if(a=a.style,g!=null){for(var b in g)!g.hasOwnProperty(b)||u!=null&&u.hasOwnProperty(b)||(b.indexOf("--")===0?a.setProperty(b,""):b==="float"?a.cssFloat="":a[b]="");for(var A in u)b=u[A],u.hasOwnProperty(A)&&g[A]!==b&&pe(a,A,b)}else for(var D in u)u.hasOwnProperty(D)&&pe(a,D,u[D])}function en(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function we(a){return wn.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Qe(){}var Tn=null;function Yn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Pn=null,Ni=null;function ke(a){var u=ki(a);if(u&&(a=u.stateNode)){var g=a[me]||null;t:switch(a=u.stateNode,u.type){case"input":if(na(a,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),u=g.name,g.type==="radio"&&u!=null){for(g=a;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Ur(""+u)+'"][type="radio"]'),u=0;u<g.length;u++){var b=g[u];if(b!==a&&b.form===a.form){var A=b[me]||null;if(!A)throw Error(T(90));na(b,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(u=0;u<g.length;u++)b=g[u],b.form===a.form&&Ja(b)}break t;case"textarea":H(a,g.value,g.defaultValue);break t;case"select":u=g.value,u!=null&&R(a,!!g.multiple,u,!1)}}}var _n=!1;function kn(a,u,g){if(_n)return a(u,g);_n=!0;try{var b=a(u);return b}finally{if(_n=!1,(Pn!==null||Ni!==null)&&(Ld(),Pn&&(u=Pn,a=Ni,Ni=Pn=null,ke(u),a)))for(u=0;u<a.length;u++)ke(a[u])}}function Xi(a,u){var g=a.stateNode;if(g===null)return null;var b=g[me]||null;if(b===null)return null;g=b[u];t:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(a=a.type,b=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!b;break t;default:a=!1}if(a)return null;if(g&&typeof g!="function")throw Error(T(231,u,typeof g));return g}var Wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xn=!1;if(Wi)try{var gr={};Object.defineProperty(gr,"passive",{get:function(){xn=!0}}),window.addEventListener("test",gr,gr),window.removeEventListener("test",gr,gr)}catch{xn=!1}var ur=null,qi=null,Yr=null;function ss(){if(Yr)return Yr;var a,u=qi,g=u.length,b,A="value"in ur?ur.value:ur.textContent,D=A.length;for(a=0;a<g&&u[a]===A[a];a++);var K=g-a;for(b=1;b<=K&&u[g-b]===A[D-b];b++);return Yr=A.slice(a,1<b?1-b:void 0)}function Da(a){var u=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&u===13&&(a=13)):a=u,a===10&&(a=13),32<=a||a===13?a:0}function Co(){return!0}function no(){return!1}function fs(a){function u(g,b,A,D,K){this._reactName=g,this._targetInst=A,this.type=b,this.nativeEvent=D,this.target=K,this.currentTarget=null;for(var bt in a)a.hasOwnProperty(bt)&&(g=a[bt],this[bt]=g?g(D):D[bt]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Co:no,this.isPropagationStopped=no,this}return ht(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Co)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Co)},persist:function(){},isPersistent:Co}),u}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ho=fs(Ci),fo=ht({},Ci,{view:0,detail:0}),io=fs(fo),jo,Io,Cs,ro=ht({},fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Cs&&(Cs&&a.type==="mousemove"?(jo=a.screenX-Cs.screenX,Io=a.screenY-Cs.screenY):Io=jo=0,Cs=a),jo)},movementY:function(a){return"movementY"in a?a.movementY:Io}}),Os=fs(ro),Pu=ht({},ro,{dataTransfer:0}),Qa=fs(Pu),xl=ht({},fo,{relatedTarget:0}),Ke=fs(xl),Hs=ht({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),wr=fs(Hs),tl=ht({},Ci,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Xo=fs(tl),du=ht({},Ci,{data:0}),Na=fs(du),ia={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oi(a){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(a):(a=zs[a])?!!u[a]:!1}function Mo(){return Oi}var Ps=ht({},fo,{key:function(a){if(a.key){var u=ia[a.key]||a.key;if(u!=="Unidentified")return u}return a.type==="keypress"?(a=Da(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Xl[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mo,charCode:function(a){return a.type==="keypress"?Da(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Da(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Ao=fs(Ps),va=ht({},ro,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zl=fs(va),Zo=ht({},fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mo}),po=fs(Zo),ra=ht({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),xa=fs(ra),Ho=ht({},ro,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),bl=fs(Ho),Ii=ht({},Ci,{newState:0,oldState:0}),wl=fs(Ii),Oa=[9,13,27,32],Hl=Wi&&"CompositionEvent"in window,Lo=null;Wi&&"documentMode"in document&&(Lo=document.documentMode);var za=Wi&&"TextEvent"in window&&!Lo,Bu=Wi&&(!Hl||Lo&&8<Lo&&11>=Lo),sa=" ",Ju=!1;function Nr(a,u){switch(a){case"keyup":return Oa.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function El(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ba=!1;function el(a,u){switch(a){case"compositionend":return El(u);case"keypress":return u.which!==32?null:(Ju=!0,sa);case"textInput":return a=u.data,a===sa&&Ju?null:a;default:return null}}function Yl(a,u){if(ba)return a==="compositionend"||!Hl&&Nr(a,u)?(a=ss(),Yr=qi=ur=null,ba=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Bu&&u.locale!=="ko"?null:u.data;default:return null}}var Ku={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qu(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u==="input"?!!Ku[a.type]:u==="textarea"}function Pa(a,u,g,b){Pn?Ni?Ni.push(b):Ni=[b]:Pn=b,u=kd(u,"onChange"),0<u.length&&(g=new ho("onChange","change",null,g,b),a.push({event:g,listeners:u}))}var Ro=null,Ys=null;function go(a){tm(a,0)}function oe(a){var u=Dn(a);if(Ja(u))return a}function De(a,u){if(a==="change")return u}var vn=!1;if(Wi){var Wn;if(Wi){var mn="oninput"in document;if(!mn){var hi=document.createElement("div");hi.setAttribute("oninput","return;"),mn=typeof hi.oninput=="function"}Wn=mn}else Wn=!1;vn=Wn&&(!document.documentMode||9<document.documentMode)}function wi(){Ro&&(Ro.detachEvent("onpropertychange",sr),Ys=Ro=null)}function sr(a){if(a.propertyName==="value"&&oe(Ys)){var u=[];Pa(u,Ys,a,Yn(a)),kn(go,u)}}function Ws(a,u,g){a==="focusin"?(wi(),Ro=u,Ys=g,Ro.attachEvent("onpropertychange",sr)):a==="focusout"&&wi()}function ds(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return oe(Ys)}function Gr(a,u){if(a==="click")return oe(u)}function Jn(a,u){if(a==="input"||a==="change")return oe(u)}function zi(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var tr=typeof Object.is=="function"?Object.is:zi;function cr(a,u){if(tr(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var g=Object.keys(a),b=Object.keys(u);if(g.length!==b.length)return!1;for(b=0;b<g.length;b++){var A=g[b];if(!_l.call(u,A)||!tr(a[A],u[A]))return!1}return!0}function Yo(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function wa(a,u){var g=Yo(a);a=0;for(var b;g;){if(g.nodeType===3){if(b=a+g.textContent.length,a<=u&&b>=u)return{node:g,offset:u-a};a=b}t:{for(;g;){if(g.nextSibling){g=g.nextSibling;break t}g=g.parentNode}g=void 0}g=Yo(g)}}function Gs(a,u){return a&&u?a===u?!0:a&&a.nodeType===3?!1:u&&u.nodeType===3?Gs(a,u.parentNode):"contains"in a?a.contains(u):a.compareDocumentPosition?!!(a.compareDocumentPosition(u)&16):!1:!1}function ps(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var u=Hn(a.document);u instanceof a.HTMLIFrameElement;){try{var g=typeof u.contentWindow.location.href=="string"}catch{g=!1}if(g)a=u.contentWindow;else break;u=Hn(a.document)}return u}function Ba(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u&&(u==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||u==="textarea"||a.contentEditable==="true")}var Sl=Wi&&"documentMode"in document&&11>=document.documentMode,Tl=null,or=null,Ai=null,oa=!1;function nl(a,u,g){var b=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;oa||Tl==null||Tl!==Hn(b)||(b=Tl,"selectionStart"in b&&Ba(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Ai&&cr(Ai,b)||(Ai=b,b=kd(or,"onSelect"),0<b.length&&(u=new ho("onSelect","select",null,u,g),a.push({event:u,listeners:b}),u.target=Tl)))}function Do(a,u){var g={};return g[a.toLowerCase()]=u.toLowerCase(),g["Webkit"+a]="webkit"+u,g["Moz"+a]="moz"+u,g}var Or={animationend:Do("Animation","AnimationEnd"),animationiteration:Do("Animation","AnimationIteration"),animationstart:Do("Animation","AnimationStart"),transitionrun:Do("Transition","TransitionRun"),transitionstart:Do("Transition","TransitionStart"),transitioncancel:Do("Transition","TransitionCancel"),transitionend:Do("Transition","TransitionEnd")},Bs={},mo={};Wi&&(mo=document.createElement("div").style,"AnimationEvent"in window||(delete Or.animationend.animation,delete Or.animationiteration.animation,delete Or.animationstart.animation),"TransitionEvent"in window||delete Or.transitionend.transition);function Vs(a){if(Bs[a])return Bs[a];if(!Or[a])return a;var u=Or[a],g;for(g in u)if(u.hasOwnProperty(g)&&g in mo)return Bs[a]=u[g];return a}var Wl=Vs("animationend"),il=Vs("animationiteration"),yo=Vs("animationstart"),$l=Vs("transitionrun"),rl=Vs("transitionstart"),Ea=Vs("transitioncancel"),Wo=Vs("transitionend"),sl=new Map,_o="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_o.push("scrollEnd");function In(a,u){sl.set(a,u),_e(u,[a])}var so=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},aa=[],pu=0,es=0;function Fu(){for(var a=pu,u=es=pu=0;u<a;){var g=aa[u];aa[u++]=null;var b=aa[u];aa[u++]=null;var A=aa[u];aa[u++]=null;var D=aa[u];if(aa[u++]=null,b!==null&&A!==null){var K=b.pending;K===null?A.next=A:(A.next=K.next,K.next=A),b.pending=A}D!==0&&mu(g,A,D)}}function $o(a,u,g,b){aa[pu++]=a,aa[pu++]=u,aa[pu++]=g,aa[pu++]=b,es|=b,a.lanes|=b,a=a.alternate,a!==null&&(a.lanes|=b)}function gu(a,u,g,b){return $o(a,u,g,b),Jl(a)}function al(a,u){return $o(a,null,null,u),Jl(a)}function mu(a,u,g){a.lanes|=g;var b=a.alternate;b!==null&&(b.lanes|=g);for(var A=!1,D=a.return;D!==null;)D.childLanes|=g,b=D.alternate,b!==null&&(b.childLanes|=g),D.tag===22&&(a=D.stateNode,a===null||a._visibility&1||(A=!0)),a=D,D=D.return;return a.tag===3?(D=a.stateNode,A&&u!==null&&(A=31-_r(g),a=D.hiddenUpdates,b=a[A],b===null?a[A]=[u]:b.push(u),u.lane=g|536870912),D):null}function Jl(a){if(50<Qf)throw Qf=0,td=null,Error(T(185));for(var u=a.return;u!==null;)a=u,u=a.return;return a.tag===3?a.stateNode:null}var Jo={};function Cl(a,u,g,b){this.tag=a,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(a,u,g,b){return new Cl(a,u,g,b)}function ll(a){return a=a.prototype,!(!a||!a.isReactComponent)}function gs(a,u){var g=a.alternate;return g===null?(g=$s(a.tag,u,a.key,a.mode),g.elementType=a.elementType,g.type=a.type,g.stateNode=a.stateNode,g.alternate=a,a.alternate=g):(g.pendingProps=u,g.type=a.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=a.flags&65011712,g.childLanes=a.childLanes,g.lanes=a.lanes,g.child=a.child,g.memoizedProps=a.memoizedProps,g.memoizedState=a.memoizedState,g.updateQueue=a.updateQueue,u=a.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=a.sibling,g.index=a.index,g.ref=a.ref,g.refCleanup=a.refCleanup,g}function yu(a,u){a.flags&=65011714;var g=a.alternate;return g===null?(a.childLanes=0,a.lanes=u,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=g.childLanes,a.lanes=g.lanes,a.child=g.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=g.memoizedProps,a.memoizedState=g.memoizedState,a.updateQueue=g.updateQueue,a.type=g.type,u=g.dependencies,a.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),a}function bn(a,u,g,b,A,D){var K=0;if(b=a,typeof a=="function")ll(a)&&(K=1);else if(typeof a=="string")K=ly(a,g,Be.current)?26:a==="html"||a==="head"||a==="body"?27:5;else t:switch(a){case Xt:return a=$s(31,g,u,A),a.elementType=Xt,a.lanes=D,a;case it:return qs(g.children,A,D,u);case ae:K=8,A|=24;break;case le:return a=$s(12,g,u,A|2),a.elementType=le,a.lanes=D,a;case It:return a=$s(13,g,u,A),a.elementType=It,a.lanes=D,a;case Dt:return a=$s(19,g,u,A),a.elementType=Dt,a.lanes=D,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case lt:K=10;break t;case Ft:K=9;break t;case pt:K=11;break t;case _t:K=14;break t;case Jt:K=16,b=null;break t}K=29,g=Error(T(130,a===null?"null":typeof a,"")),b=null}return u=$s(K,g,u,A),u.elementType=a,u.type=b,u.lanes=D,u}function qs(a,u,g,b){return a=$s(7,a,b,u),a.lanes=g,a}function tc(a,u,g){return a=$s(6,a,null,u),a.lanes=g,a}function js(a){var u=$s(18,null,null,0);return u.stateNode=a,u}function Il(a,u,g){return u=$s(4,a.children!==null?a.children:[],a.key,u),u.lanes=g,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}var ms=new WeakMap;function oo(a,u){if(typeof a=="object"&&a!==null){var g=ms.get(a);return g!==void 0?g:(u={value:a,source:u,stack:mr(u)},ms.set(a,u),u)}return{value:a,source:u,stack:mr(u)}}var Fa=[],ao=0,_u=null,vo=0,zr=[],ys=0,Cr=null,la=1,Js="";function ua(a,u){Fa[ao++]=vo,Fa[ao++]=_u,_u=a,vo=u}function hc(a,u,g){zr[ys++]=la,zr[ys++]=Js,zr[ys++]=Cr,Cr=a;var b=la;a=Js;var A=32-_r(b)-1;b&=~(1<<A),g+=1;var D=32-_r(u)+A;if(30<D){var K=A-A%5;D=(b&(1<<K)-1).toString(32),b>>=K,A-=K,la=1<<32-_r(u)+A|g<<A|b,Js=D+a}else la=1<<D|g<<A|b,Js=a}function vu(a){a.return!==null&&(ua(a,1),hc(a,1,0))}function xu(a){for(;a===_u;)_u=Fa[--ao],Fa[ao]=null,vo=Fa[--ao],Fa[ao]=null;for(;a===Cr;)Cr=zr[--ys],zr[ys]=null,Js=zr[--ys],zr[ys]=null,la=zr[--ys],zr[ys]=null}function ec(a,u){zr[ys++]=la,zr[ys++]=Js,zr[ys++]=Cr,la=u.id,Js=u.overflow,Cr=a}var os=null,Pr=null,Mi=!1,ka=null,hr=!1,lo=Error(T(519));function No(a){var u=Error(T(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kl(oo(u,a)),lo}function fc(a){var u=a.stateNode,g=a.type,b=a.memoizedProps;switch(u[$t]=a,u[me]=b,g){case"dialog":dr("cancel",u),dr("close",u);break;case"iframe":case"object":case"embed":dr("load",u);break;case"video":case"audio":for(g=0;g<sd.length;g++)dr(sd[g],u);break;case"source":dr("error",u);break;case"img":case"image":case"link":dr("error",u),dr("load",u);break;case"details":dr("toggle",u);break;case"input":dr("invalid",u),br(u,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":dr("invalid",u);break;case"textarea":dr("invalid",u),ft(u,b.value,b.defaultValue,b.children)}g=b.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||u.textContent===""+g||b.suppressHydrationWarning===!0||Up(u.textContent,g)?(b.popover!=null&&(dr("beforetoggle",u),dr("toggle",u)),b.onScroll!=null&&dr("scroll",u),b.onScrollEnd!=null&&dr("scrollend",u),b.onClick!=null&&(u.onclick=Qe),u=!0):u=!1,u||No(a,!0)}function bu(a){for(os=a.return;os;)switch(os.tag){case 5:case 31:case 13:hr=!1;return;case 27:case 3:hr=!0;return;default:os=os.return}}function Ua(a){if(a!==os)return!1;if(!Mi)return bu(a),Mi=!0,!1;var u=a.tag,g;if((g=u!==3&&u!==27)&&((g=u===5)&&(g=a.type,g=!(g!=="form"&&g!=="button")||Vp(a.type,a.memoizedProps)),g=!g),g&&Pr&&No(a),bu(a),u===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(T(317));Pr=lm(a)}else if(u===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(T(317));Pr=lm(a)}else u===27?(u=Pr,Hc(a.type)?(a=pf,pf=null,Pr=a):Pr=u):Pr=os?ou(a.stateNode.nextSibling):null;return!0}function ul(){Pr=os=null,Mi=!1}function ku(){var a=ka;return a!==null&&(Fl===null?Fl=a:Fl.push.apply(Fl,a),ka=null),a}function Kl(a){ka===null?ka=[a]:ka.push(a)}var Fs=mt(null),Ml=null,Oo=null;function Ga(a,u,g){ve(Fs,u._currentValue),u._currentValue=g}function cl(a){a._currentValue=Fs.current,Zt(Fs)}function Sa(a,u,g){for(;a!==null;){var b=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,b!==null&&(b.childLanes|=u)):b!==null&&(b.childLanes&u)!==u&&(b.childLanes|=u),a===g)break;a=a.return}}function Uu(a,u,g,b){var A=a.child;for(A!==null&&(A.return=a);A!==null;){var D=A.dependencies;if(D!==null){var K=A.child;D=D.firstContext;t:for(;D!==null;){var bt=D;D=A;for(var ee=0;ee<u.length;ee++)if(bt.context===u[ee]){D.lanes|=g,bt=D.alternate,bt!==null&&(bt.lanes|=g),Sa(D.return,g,a),b||(K=null);break t}D=bt.next}}else if(A.tag===18){if(K=A.return,K===null)throw Error(T(341));K.lanes|=g,D=K.alternate,D!==null&&(D.lanes|=g),Sa(K,g,a),K=null}else K=A.child;if(K!==null)K.return=A;else for(K=A;K!==null;){if(K===a){K=null;break}if(A=K.sibling,A!==null){A.return=K.return,K=A;break}K=K.return}A=K}}function Ei(a,u,g,b){a=null;for(var A=u,D=!1;A!==null;){if(!D){if((A.flags&524288)!==0)D=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var K=A.alternate;if(K===null)throw Error(T(387));if(K=K.memoizedProps,K!==null){var bt=A.type;tr(A.pendingProps.value,K.value)||(a!==null?a.push(bt):a=[bt])}}else if(A===An.current){if(K=A.alternate,K===null)throw Error(T(387));K.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(a!==null?a.push(bf):a=[bf])}A=A.return}a!==null&&Uu(u,a,g,b),u.flags|=262144}function ns(a){for(a=a.firstContext;a!==null;){if(!tr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Ta(a){Ml=a,Oo=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function dn(a){return Ql(Ml,a)}function zo(a,u){return Ml===null&&Ta(a),Ql(a,u)}function Ql(a,u){var g=u._currentValue;if(u={context:u,memoizedValue:g,next:null},Oo===null){if(a===null)throw Error(T(308));Oo=u,a.dependencies={lanes:0,firstContext:u},a.flags|=524288}else Oo=Oo.next=u;return g}var wu=typeof AbortController<"u"?AbortController:function(){var a=[],u=this.signal={aborted:!1,addEventListener:function(g,b){a.push(b)}};this.abort=function(){u.aborted=!0,a.forEach(function(g){return g()})}},xo=B.unstable_scheduleCallback,Al=B.unstable_NormalPriority,as={$$typeof:lt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ca(){return{controller:new wu,data:new Map,refCount:0}}function Ll(a){a.refCount--,a.refCount===0&&xo(Al,function(){a.controller.abort()})}var hl=null,dc=0,Rl=0,Ca=null;function pc(a,u){if(hl===null){var g=hl=[];dc=0,Rl=Fp(),Ca={status:"pending",value:void 0,then:function(b){g.push(b)}}}return dc++,u.then(Gu,Gu),u}function Gu(){if(--dc===0&&hl!==null){Ca!==null&&(Ca.status="fulfilled");var a=hl;hl=null,Rl=0,Ca=null;for(var u=0;u<a.length;u++)(0,a[u])()}}function gc(a,u){var g=[],b={status:"pending",value:null,reason:null,then:function(A){g.push(A)}};return a.then(function(){b.status="fulfilled",b.value=u;for(var A=0;A<g.length;A++)(0,g[A])(u)},function(A){for(b.status="rejected",b.reason=A,A=0;A<g.length;A++)(0,g[A])(void 0)}),b}var Bi=ct.S;ct.S=function(a,u){tf=Ri(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&pc(a,u),Bi!==null&&Bi(a,u)};var Ks=mt(null);function nc(){var a=Ks.current;return a!==null?a:vs.pooledCache}function fl(a,u){u===null?ve(Ks,Ks.current):ve(Ks,u.pool)}function ic(){var a=nc();return a===null?null:{parent:as._currentValue,pool:a}}var dl=Error(T(460)),Eu=Error(T(474)),Dl=Error(T(542)),Va={then:function(){}};function Vu(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Pc(a,u,g){switch(g=a[g],g===void 0?a.push(u):g!==u&&(u.then(Qe,Qe),u=g),u.status){case"fulfilled":return u.value;case"rejected":throw a=u.reason,eu(a),a;default:if(typeof u.status=="string")u.then(Qe,Qe);else{if(a=vs,a!==null&&100<a.shellSuspendCounter)throw Error(T(482));a=u,a.status="pending",a.then(function(b){if(u.status==="pending"){var A=u;A.status="fulfilled",A.value=b}},function(b){if(u.status==="pending"){var A=u;A.status="rejected",A.reason=b}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw a=u.reason,eu(a),a}throw tu=u,dl}}function qa(a){try{var u=a._init;return u(a._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(tu=g,dl):g}}var tu=null;function Nl(){if(tu===null)throw Error(T(459));var a=tu;return tu=null,a}function eu(a){if(a===dl||a===Dl)throw Error(T(483))}var m=null,o=0;function f(a){var u=o;return o+=1,m===null&&(m=[]),Pc(m,a,u)}function _(a,u){u=u.props.ref,a.ref=u!==void 0?u:null}function w(a,u){throw u.$$typeof===st?Error(T(525)):(a=Object.prototype.toString.call(u),Error(T(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a)))}function S(a){function u(Te,he){if(a){var Re=Te.deletions;Re===null?(Te.deletions=[he],Te.flags|=16):Re.push(he)}}function g(Te,he){if(!a)return null;for(;he!==null;)u(Te,he),he=he.sibling;return null}function b(Te){for(var he=new Map;Te!==null;)Te.key!==null?he.set(Te.key,Te):he.set(Te.index,Te),Te=Te.sibling;return he}function A(Te,he){return Te=gs(Te,he),Te.index=0,Te.sibling=null,Te}function D(Te,he,Re){return Te.index=Re,a?(Re=Te.alternate,Re!==null?(Re=Re.index,Re<he?(Te.flags|=67108866,he):Re):(Te.flags|=67108866,he)):(Te.flags|=1048576,he)}function K(Te){return a&&Te.alternate===null&&(Te.flags|=67108866),Te}function bt(Te,he,Re,sn){return he===null||he.tag!==6?(he=tc(Re,Te.mode,sn),he.return=Te,he):(he=A(he,Re),he.return=Te,he)}function ee(Te,he,Re,sn){var mi=Re.type;return mi===it?He(Te,he,Re.props.children,sn,Re.key):he!==null&&(he.elementType===mi||typeof mi=="object"&&mi!==null&&mi.$$typeof===Jt&&qa(mi)===he.type)?(he=A(he,Re.props),_(he,Re),he.return=Te,he):(he=bn(Re.type,Re.key,Re.props,null,Te.mode,sn),_(he,Re),he.return=Te,he)}function Le(Te,he,Re,sn){return he===null||he.tag!==4||he.stateNode.containerInfo!==Re.containerInfo||he.stateNode.implementation!==Re.implementation?(he=Il(Re,Te.mode,sn),he.return=Te,he):(he=A(he,Re.children||[]),he.return=Te,he)}function He(Te,he,Re,sn,mi){return he===null||he.tag!==7?(he=qs(Re,Te.mode,sn,mi),he.return=Te,he):(he=A(he,Re),he.return=Te,he)}function ln(Te,he,Re){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return he=tc(""+he,Te.mode,Re),he.return=Te,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case At:return Re=bn(he.type,he.key,he.props,null,Te.mode,Re),_(Re,he),Re.return=Te,Re;case yt:return he=Il(he,Te.mode,Re),he.return=Te,he;case Jt:return he=qa(he),ln(Te,he,Re)}if(Xn(he)||rt(he))return he=qs(he,Te.mode,Re,null),he.return=Te,he;if(typeof he.then=="function")return ln(Te,f(he),Re);if(he.$$typeof===lt)return ln(Te,zo(Te,he),Re);w(Te,he)}return null}function ze(Te,he,Re,sn){var mi=he!==null?he.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return mi!==null?null:bt(Te,he,""+Re,sn);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case At:return Re.key===mi?ee(Te,he,Re,sn):null;case yt:return Re.key===mi?Le(Te,he,Re,sn):null;case Jt:return Re=qa(Re),ze(Te,he,Re,sn)}if(Xn(Re)||rt(Re))return mi!==null?null:He(Te,he,Re,sn,null);if(typeof Re.then=="function")return ze(Te,he,f(Re),sn);if(Re.$$typeof===lt)return ze(Te,he,zo(Te,Re),sn);w(Te,Re)}return null}function Ue(Te,he,Re,sn,mi){if(typeof sn=="string"&&sn!==""||typeof sn=="number"||typeof sn=="bigint")return Te=Te.get(Re)||null,bt(he,Te,""+sn,mi);if(typeof sn=="object"&&sn!==null){switch(sn.$$typeof){case At:return Te=Te.get(sn.key===null?Re:sn.key)||null,ee(he,Te,sn,mi);case yt:return Te=Te.get(sn.key===null?Re:sn.key)||null,Le(he,Te,sn,mi);case Jt:return sn=qa(sn),Ue(Te,he,Re,sn,mi)}if(Xn(sn)||rt(sn))return Te=Te.get(Re)||null,He(he,Te,sn,mi,null);if(typeof sn.then=="function")return Ue(Te,he,Re,f(sn),mi);if(sn.$$typeof===lt)return Ue(Te,he,Re,zo(he,sn),mi);w(he,sn)}return null}function ti(Te,he,Re,sn){for(var mi=null,Sr=null,ni=he,Zi=he=0,vr=null;ni!==null&&Zi<Re.length;Zi++){ni.index>Zi?(vr=ni,ni=null):vr=ni.sibling;var Rr=ze(Te,ni,Re[Zi],sn);if(Rr===null){ni===null&&(ni=vr);break}a&&ni&&Rr.alternate===null&&u(Te,ni),he=D(Rr,he,Zi),Sr===null?mi=Rr:Sr.sibling=Rr,Sr=Rr,ni=vr}if(Zi===Re.length)return g(Te,ni),Mi&&ua(Te,Zi),mi;if(ni===null){for(;Zi<Re.length;Zi++)ni=ln(Te,Re[Zi],sn),ni!==null&&(he=D(ni,he,Zi),Sr===null?mi=ni:Sr.sibling=ni,Sr=ni);return Mi&&ua(Te,Zi),mi}for(ni=b(ni);Zi<Re.length;Zi++)vr=Ue(ni,Te,Zi,Re[Zi],sn),vr!==null&&(a&&vr.alternate!==null&&ni.delete(vr.key===null?Zi:vr.key),he=D(vr,he,Zi),Sr===null?mi=vr:Sr.sibling=vr,Sr=vr);return a&&ni.forEach(function(Dc){return u(Te,Dc)}),Mi&&ua(Te,Zi),mi}function Si(Te,he,Re,sn){if(Re==null)throw Error(T(151));for(var mi=null,Sr=null,ni=he,Zi=he=0,vr=null,Rr=Re.next();ni!==null&&!Rr.done;Zi++,Rr=Re.next()){ni.index>Zi?(vr=ni,ni=null):vr=ni.sibling;var Dc=ze(Te,ni,Rr.value,sn);if(Dc===null){ni===null&&(ni=vr);break}a&&ni&&Dc.alternate===null&&u(Te,ni),he=D(Dc,he,Zi),Sr===null?mi=Dc:Sr.sibling=Dc,Sr=Dc,ni=vr}if(Rr.done)return g(Te,ni),Mi&&ua(Te,Zi),mi;if(ni===null){for(;!Rr.done;Zi++,Rr=Re.next())Rr=ln(Te,Rr.value,sn),Rr!==null&&(he=D(Rr,he,Zi),Sr===null?mi=Rr:Sr.sibling=Rr,Sr=Rr);return Mi&&ua(Te,Zi),mi}for(ni=b(ni);!Rr.done;Zi++,Rr=Re.next())Rr=Ue(ni,Te,Zi,Rr.value,sn),Rr!==null&&(a&&Rr.alternate!==null&&ni.delete(Rr.key===null?Zi:Rr.key),he=D(Rr,he,Zi),Sr===null?mi=Rr:Sr.sibling=Rr,Sr=Rr);return a&&ni.forEach(function(hh){return u(Te,hh)}),Mi&&ua(Te,Zi),mi}function bs(Te,he,Re,sn){if(typeof Re=="object"&&Re!==null&&Re.type===it&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case At:t:{for(var mi=Re.key;he!==null;){if(he.key===mi){if(mi=Re.type,mi===it){if(he.tag===7){g(Te,he.sibling),sn=A(he,Re.props.children),sn.return=Te,Te=sn;break t}}else if(he.elementType===mi||typeof mi=="object"&&mi!==null&&mi.$$typeof===Jt&&qa(mi)===he.type){g(Te,he.sibling),sn=A(he,Re.props),_(sn,Re),sn.return=Te,Te=sn;break t}g(Te,he);break}else u(Te,he);he=he.sibling}Re.type===it?(sn=qs(Re.props.children,Te.mode,sn,Re.key),sn.return=Te,Te=sn):(sn=bn(Re.type,Re.key,Re.props,null,Te.mode,sn),_(sn,Re),sn.return=Te,Te=sn)}return K(Te);case yt:t:{for(mi=Re.key;he!==null;){if(he.key===mi)if(he.tag===4&&he.stateNode.containerInfo===Re.containerInfo&&he.stateNode.implementation===Re.implementation){g(Te,he.sibling),sn=A(he,Re.children||[]),sn.return=Te,Te=sn;break t}else{g(Te,he);break}else u(Te,he);he=he.sibling}sn=Il(Re,Te.mode,sn),sn.return=Te,Te=sn}return K(Te);case Jt:return Re=qa(Re),bs(Te,he,Re,sn)}if(Xn(Re))return ti(Te,he,Re,sn);if(rt(Re)){if(mi=rt(Re),typeof mi!="function")throw Error(T(150));return Re=mi.call(Re),Si(Te,he,Re,sn)}if(typeof Re.then=="function")return bs(Te,he,f(Re),sn);if(Re.$$typeof===lt)return bs(Te,he,zo(Te,Re),sn);w(Te,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint"?(Re=""+Re,he!==null&&he.tag===6?(g(Te,he.sibling),sn=A(he,Re),sn.return=Te,Te=sn):(g(Te,he),sn=tc(Re,Te.mode,sn),sn.return=Te,Te=sn),K(Te)):g(Te,he)}return function(Te,he,Re,sn){try{o=0;var mi=bs(Te,he,Re,sn);return m=null,mi}catch(ni){if(ni===dl||ni===Dl)throw ni;var Sr=$s(29,ni,null,Te.mode);return Sr.lanes=sn,Sr.return=Te,Sr}finally{}}}var L=S(!0),N=S(!1),P=!1;function Z(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Y(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function nt(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function dt(a,u,g){var b=a.updateQueue;if(b===null)return null;if(b=b.shared,(Lr&2)!==0){var A=b.pending;return A===null?u.next=u:(u.next=A.next,A.next=u),b.pending=u,u=Jl(a),mu(a,null,g),u}return $o(a,b,u,g),Jl(a)}function Et(a,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194048)!==0)){var b=u.lanes;b&=a.pendingLanes,g|=b,u.lanes=g,et(a,g)}}function xt(a,u){var g=a.updateQueue,b=a.alternate;if(b!==null&&(b=b.updateQueue,g===b)){var A=null,D=null;if(g=g.firstBaseUpdate,g!==null){do{var K={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};D===null?A=D=K:D=D.next=K,g=g.next}while(g!==null);D===null?A=D=u:D=D.next=u}else A=D=u;g={baseState:b.baseState,firstBaseUpdate:A,lastBaseUpdate:D,shared:b.shared,callbacks:b.callbacks},a.updateQueue=g;return}a=g.lastBaseUpdate,a===null?g.firstBaseUpdate=u:a.next=u,g.lastBaseUpdate=u}var Mt=!1;function St(){if(Mt){var a=Ca;if(a!==null)throw a}}function vt(a,u,g,b){Mt=!1;var A=a.updateQueue;P=!1;var D=A.firstBaseUpdate,K=A.lastBaseUpdate,bt=A.shared.pending;if(bt!==null){A.shared.pending=null;var ee=bt,Le=ee.next;ee.next=null,K===null?D=Le:K.next=Le,K=ee;var He=a.alternate;He!==null&&(He=He.updateQueue,bt=He.lastBaseUpdate,bt!==K&&(bt===null?He.firstBaseUpdate=Le:bt.next=Le,He.lastBaseUpdate=ee))}if(D!==null){var ln=A.baseState;K=0,He=Le=ee=null,bt=D;do{var ze=bt.lane&-536870913,Ue=ze!==bt.lane;if(Ue?(ir&ze)===ze:(b&ze)===ze){ze!==0&&ze===Rl&&(Mt=!0),He!==null&&(He=He.next={lane:0,tag:bt.tag,payload:bt.payload,callback:null,next:null});t:{var ti=a,Si=bt;ze=u;var bs=g;switch(Si.tag){case 1:if(ti=Si.payload,typeof ti=="function"){ln=ti.call(bs,ln,ze);break t}ln=ti;break t;case 3:ti.flags=ti.flags&-65537|128;case 0:if(ti=Si.payload,ze=typeof ti=="function"?ti.call(bs,ln,ze):ti,ze==null)break t;ln=ht({},ln,ze);break t;case 2:P=!0}}ze=bt.callback,ze!==null&&(a.flags|=64,Ue&&(a.flags|=8192),Ue=A.callbacks,Ue===null?A.callbacks=[ze]:Ue.push(ze))}else Ue={lane:ze,tag:bt.tag,payload:bt.payload,callback:bt.callback,next:null},He===null?(Le=He=Ue,ee=ln):He=He.next=Ue,K|=ze;if(bt=bt.next,bt===null){if(bt=A.shared.pending,bt===null)break;Ue=bt,bt=Ue.next,Ue.next=null,A.lastBaseUpdate=Ue,A.shared.pending=null}}while(!0);He===null&&(ee=ln),A.baseState=ee,A.firstBaseUpdate=Le,A.lastBaseUpdate=He,D===null&&(A.shared.lanes=0),Tc|=K,a.lanes=K,a.memoizedState=ln}}function Rt(a,u){if(typeof a!="function")throw Error(T(191,a));a.call(u)}function Tt(a,u){var g=a.callbacks;if(g!==null)for(a.callbacks=null,a=0;a<g.length;a++)Rt(g[a],u)}var Ut=mt(null),Gt=mt(0);function Nt(a,u){a=qc,ve(Gt,a),ve(Ut,u),qc=a|u.baseLanes}function jt(){ve(Gt,qc),ve(Ut,Ut.current)}function fe(){qc=Gt.current,Zt(Ut),Zt(Gt)}var Ee=mt(null),xe=null;function We(a){var u=a.alternate;ve(Qt,Qt.current&1),ve(Ee,a),xe===null&&(u===null||Ut.current!==null||u.memoizedState!==null)&&(xe=a)}function ce(a){ve(Qt,Qt.current),ve(Ee,a),xe===null&&(xe=a)}function Ve(a){a.tag===22?(ve(Qt,Qt.current),ve(Ee,a),xe===null&&(xe=a)):Pe()}function Pe(){ve(Qt,Qt.current),ve(Ee,Ee.current)}function ge(a){Zt(Ee),xe===a&&(xe=null),Zt(Qt)}var Qt=mt(0);function fn(a){for(var u=a;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||Ul(g)||Dh(g)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var an=0,Fe=null,Xe=null,pn=null,Vn=!1,Gn=!1,Un=!1,tn=0,ii=0,di=null,Er=0;function pi(){throw Error(T(321))}function ar(a,u){if(u===null)return!1;for(var g=0;g<u.length&&g<a.length;g++)if(!tr(a[g],u[g]))return!1;return!0}function Xs(a,u,g,b,A,D){return an=D,Fe=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ct.H=a===null||a.memoizedState===null?Ig:Qs,Un=!1,D=g(b,A),Un=!1,Gn&&(D=ks(u,g,b,A)),Ko(a),D}function Ko(a){ct.H=kf;var u=Xe!==null&&Xe.next!==null;if(an=0,pn=Xe=Fe=null,Vn=!1,ii=0,di=null,u)throw Error(T(300));a===null||Fo||(a=a.dependencies,a!==null&&ns(a)&&(Fo=!0))}function ks(a,u,g,b){Fe=a;var A=0;do{if(Gn&&(di=null),ii=0,Gn=!1,25<=A)throw Error(T(301));if(A+=1,pn=Xe=null,a.updateQueue!=null){var D=a.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}ct.H=ai,D=u(g,b)}while(Gn);return D}function er(){var a=ct.H,u=a.useState()[0];return u=typeof u.then=="function"?Ol(u):u,a=a.useState()[0],(Xe!==null?Xe.memoizedState:null)!==a&&(Fe.flags|=1024),u}function Wr(){var a=tn!==0;return tn=0,a}function nr(a,u,g){u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~g}function Is(a){if(Vn){for(a=a.memoizedState;a!==null;){var u=a.queue;u!==null&&(u.pending=null),a=a.next}Vn=!1}an=0,pn=Xe=Fe=null,Gn=!1,ii=tn=0,di=null}function Ir(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Fe.memoizedState=pn=a:pn=pn.next=a,pn}function xi(){if(Xe===null){var a=Fe.alternate;a=a!==null?a.memoizedState:null}else a=Xe.next;var u=pn===null?Fe.memoizedState:pn.next;if(u!==null)pn=u,Xe=a;else{if(a===null)throw Fe.alternate===null?Error(T(467)):Error(T(310));Xe=a,a={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},pn===null?Fe.memoizedState=pn=a:pn=pn.next=a}return pn}function Po(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ol(a){var u=ii;return ii+=1,di===null&&(di=[]),a=Pc(di,a,u),u=Fe,(pn===null?u.memoizedState:pn.next)===null&&(u=u.alternate,ct.H=u===null||u.memoizedState===null?Ig:Qs),a}function Ia(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ol(a);if(a.$$typeof===lt)return dn(a)}throw Error(T(438,String(a)))}function Bo(a){var u=null,g=Fe.updateQueue;if(g!==null&&(u=g.memoCache),u==null){var b=Fe.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(u={data:b.data.map(function(A){return A.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),g===null&&(g=Po(),Fe.updateQueue=g),g.memoCache=u,g=u.data[u.index],g===void 0)for(g=u.data[u.index]=Array(a),b=0;b<a;b++)g[b]=ie;return u.index++,g}function Ma(a,u){return typeof u=="function"?u(a):u}function zl(a){var u=xi();return uo(u,Xe,a)}function uo(a,u,g){var b=a.queue;if(b===null)throw Error(T(311));b.lastRenderedReducer=g;var A=a.baseQueue,D=b.pending;if(D!==null){if(A!==null){var K=A.next;A.next=D.next,D.next=K}u.baseQueue=A=D,b.pending=null}if(D=a.baseState,A===null)a.memoizedState=D;else{u=A.next;var bt=K=null,ee=null,Le=u,He=!1;do{var ln=Le.lane&-536870913;if(ln!==Le.lane?(ir&ln)===ln:(an&ln)===ln){var ze=Le.revertLane;if(ze===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,gesture:null,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),ln===Rl&&(He=!0);else if((an&ze)===ze){Le=Le.next,ze===Rl&&(He=!0);continue}else ln={lane:0,revertLane:Le.revertLane,gesture:null,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ee===null?(bt=ee=ln,K=D):ee=ee.next=ln,Fe.lanes|=ze,Tc|=ze;ln=Le.action,Un&&g(D,ln),D=Le.hasEagerState?Le.eagerState:g(D,ln)}else ze={lane:ln,revertLane:Le.revertLane,gesture:Le.gesture,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ee===null?(bt=ee=ze,K=D):ee=ee.next=ze,Fe.lanes|=ln,Tc|=ln;Le=Le.next}while(Le!==null&&Le!==u);if(ee===null?K=D:ee.next=bt,!tr(D,a.memoizedState)&&(Fo=!0,He&&(g=Ca,g!==null)))throw g;a.memoizedState=D,a.baseState=K,a.baseQueue=ee,b.lastRenderedState=D}return A===null&&(b.lanes=0),[a.memoizedState,b.dispatch]}function pl(a){var u=xi(),g=u.queue;if(g===null)throw Error(T(311));g.lastRenderedReducer=a;var b=g.dispatch,A=g.pending,D=u.memoizedState;if(A!==null){g.pending=null;var K=A=A.next;do D=a(D,K.action),K=K.next;while(K!==A);tr(D,u.memoizedState)||(Fo=!0),u.memoizedState=D,u.baseQueue===null&&(u.baseState=D),g.lastRenderedState=D}return[D,b]}function Su(a,u,g){var b=Fe,A=xi(),D=Mi;if(D){if(g===void 0)throw Error(T(407));g=g()}else g=u();var K=!tr((Xe||A).memoizedState,g);if(K&&(A.memoizedState=g,Fo=!0),A=A.queue,md(n.bind(null,b,A,a),[a]),A.getSnapshot!==u||K||pn!==null&&pn.memoizedState.tag&1){if(b.flags|=2048,ha(9,{destroy:void 0},t.bind(null,b,A,g,u),null),vs===null)throw Error(T(349));D||(an&127)!==0||gl(b,u,g)}return g}function gl(a,u,g){a.flags|=16384,a={getSnapshot:u,value:g},u=Fe.updateQueue,u===null?(u=Po(),Fe.updateQueue=u,u.stores=[a]):(g=u.stores,g===null?u.stores=[a]:g.push(a))}function t(a,u,g,b){u.value=g,u.getSnapshot=b,l(u)&&d(a)}function n(a,u,g){return g(function(){l(u)&&d(a)})}function l(a){var u=a.getSnapshot;a=a.value;try{var g=u();return!tr(a,g)}catch{return!0}}function d(a){var u=al(a,2);u!==null&&ru(u,a,2)}function v(a){var u=Ir();if(typeof a=="function"){var g=a;if(a=g(),Un){Rs(!0);try{g()}finally{Rs(!1)}}}return u.memoizedState=u.baseState=a,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:a},u}function C(a,u,g,b){return a.baseState=g,uo(a,Xe,typeof b=="function"?b:Ma)}function z(a,u,g,b,A){if(Bf(a))throw Error(T(485));if(a=u.action,a!==null){var D={payload:A,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(K){D.listeners.push(K)}};ct.T!==null?g(!0):D.isTransition=!1,b(D),g=u.pending,g===null?(D.next=u.pending=D,W(u,D)):(D.next=g.next,u.pending=g.next=D)}}function W(a,u){var g=u.action,b=u.payload,A=a.state;if(u.isTransition){var D=ct.T,K={};ct.T=K;try{var bt=g(A,b),ee=ct.S;ee!==null&&ee(K,bt),gt(a,u,bt)}catch(Le){Se(a,u,Le)}finally{D!==null&&K.types!==null&&(D.types=K.types),ct.T=D}}else try{D=g(A,b),gt(a,u,D)}catch(Le){Se(a,u,Le)}}function gt(a,u,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(b){Bt(a,u,b)},function(b){return Se(a,u,b)}):Bt(a,u,g)}function Bt(a,u,g){u.status="fulfilled",u.value=g,Ae(u),a.state=g,u=a.pending,u!==null&&(g=u.next,g===u?a.pending=null:(g=g.next,u.next=g,W(a,g)))}function Se(a,u,g){var b=a.pending;if(a.pending=null,b!==null){b=b.next;do u.status="rejected",u.reason=g,Ae(u),u=u.next;while(u!==b)}a.action=null}function Ae(a){a=a.listeners;for(var u=0;u<a.length;u++)(0,a[u])()}function rn(a,u){return u}function Nn(a,u){if(Mi){var g=vs.formState;if(g!==null){t:{var b=Fe;if(Mi){if(Pr){e:{for(var A=Pr,D=hr;A.nodeType!==8;){if(!D){A=null;break e}if(A=ou(A.nextSibling),A===null){A=null;break e}}D=A.data,A=D==="F!"||D==="F"?A:null}if(A){Pr=ou(A.nextSibling),b=A.data==="F!";break t}}No(b)}b=!1}b&&(u=g[0])}}return g=Ir(),g.memoizedState=g.baseState=u,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rn,lastRenderedState:u},g.queue=b,g=Cg.bind(null,Fe,b),b.dispatch=g,b=v(!1),D=pp.bind(null,Fe,!1,b.queue),b=Ir(),A={state:u,dispatch:null,action:a,pending:null},b.queue=A,g=z.bind(null,Fe,A,D,g),A.dispatch=g,b.memoizedState=a,[u,g,!1]}function ei(a){var u=xi();return ci(u,Xe,a)}function ci(a,u,g){if(u=uo(a,u,rn)[0],a=zl(Ma)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var b=Ol(u)}catch(K){throw K===dl?Dl:K}else b=u;u=xi();var A=u.queue,D=A.dispatch;return g!==u.memoizedState&&(Fe.flags|=2048,ha(9,{destroy:void 0},Mr.bind(null,A,g),null)),[b,D,a]}function Mr(a,u){a.action=u}function _s(a){var u=xi(),g=Xe;if(g!==null)return ci(u,g,a);xi(),u=u.memoizedState,g=xi();var b=g.queue.dispatch;return g.memoizedState=a,[u,b,!1]}function ha(a,u,g,b){return a={tag:a,create:g,deps:b,inst:u,next:null},u=Fe.updateQueue,u===null&&(u=Po(),Fe.updateQueue=u),g=u.lastEffect,g===null?u.lastEffect=a.next=a:(b=g.next,g.next=a,a.next=b,u.lastEffect=a),a}function mc(){return xi().memoizedState}function nu(a,u,g,b){var A=Ir();Fe.flags|=a,A.memoizedState=ha(1|u,{destroy:void 0},g,b===void 0?null:b)}function yc(a,u,g,b){var A=xi();b=b===void 0?null:b;var D=A.memoizedState.inst;Xe!==null&&b!==null&&ar(b,Xe.memoizedState.deps)?A.memoizedState=ha(u,D,g,b):(Fe.flags|=a,A.memoizedState=ha(1|u,D,g,b))}function Wc(a,u){nu(8390656,8,a,u)}function md(a,u){yc(2048,8,a,u)}function Gm(a){Fe.flags|=4;var u=Fe.updateQueue;if(u===null)u=Po(),Fe.updateQueue=u,u.events=[a];else{var g=u.events;g===null?u.events=[a]:g.push(a)}}function Of(a){var u=xi().memoizedState;return Gm({ref:u,nextImpl:a}),function(){if((Lr&2)!==0)throw Error(T(440));return u.impl.apply(void 0,arguments)}}function up(a,u){return yc(4,2,a,u)}function yd(a,u){return yc(4,4,a,u)}function zf(a,u){if(typeof u=="function"){a=a();var g=u(a);return function(){typeof g=="function"?g():u(null)}}if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function _c(a,u,g){g=g!=null?g.concat([a]):null,yc(4,4,zf.bind(null,u,a),g)}function qh(){}function cp(a,u){var g=xi();u=u===void 0?null:u;var b=g.memoizedState;return u!==null&&ar(u,b[1])?b[0]:(g.memoizedState=[a,u],a)}function hp(a,u){var g=xi();u=u===void 0?null:u;var b=g.memoizedState;if(u!==null&&ar(u,b[1]))return b[0];if(b=a(),Un){Rs(!0);try{a()}finally{Rs(!1)}}return g.memoizedState=[b,u],b}function fp(a,u,g){return g===void 0||(an&1073741824)!==0&&(ir&261930)===0?a.memoizedState=u:(a.memoizedState=g,a=ed(),Fe.lanes|=a,Tc|=a,g)}function Sg(a,u,g,b){return tr(g,u)?g:Ut.current!==null?(a=fp(a,g,b),tr(a,u)||(Fo=!0),a):(an&42)===0||(an&1073741824)!==0&&(ir&261930)===0?(Fo=!0,a.memoizedState=g):(a=ed(),Fe.lanes|=a,Tc|=a,u)}function Tg(a,u,g,b,A){var D=kt.p;kt.p=D!==0&&8>D?D:8;var K=ct.T,bt={};ct.T=bt,pp(a,!1,u,g);try{var ee=A(),Le=ct.S;if(Le!==null&&Le(bt,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var He=gc(ee,b);Pf(a,u,He,kl(a))}else Pf(a,u,b,kl(a))}catch(ln){Pf(a,u,{then:function(){},status:"rejected",reason:ln},kl())}finally{kt.p=D,K!==null&&bt.types!==null&&(K.types=bt.types),ct.T=K}}function dp(){}function yh(a,u,g,b){if(a.tag!==5)throw Error(T(476));var A=_h(a).queue;Tg(a,A,u,ut,g===null?dp:function(){return vc(a),g(b)})}function _h(a){var u=a.memoizedState;if(u!==null)return u;u={memoizedState:ut,baseState:ut,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:ut},next:null};var g={};return u.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:g},next:null},a.memoizedState=u,a=a.alternate,a!==null&&(a.memoizedState=u),u}function vc(a){var u=_h(a);u.next===null&&(u=a.alternate.memoizedState),Pf(a,u.next.queue,{},kl())}function Tu(){return dn(bf)}function Bc(){return xi().memoizedState}function Fc(){return xi().memoizedState}function vh(a){for(var u=a.return;u!==null;){switch(u.tag){case 24:case 3:var g=kl();a=nt(g);var b=dt(u,a,g);b!==null&&(ru(b,u,g),Et(b,u,g)),u={cache:ca()},a.payload=u;return}u=u.return}}function Vm(a,u,g){var b=kl();g={lane:b,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Bf(a)?Ff(u,g):(g=gu(a,u,g,b),g!==null&&(ru(g,a,b),qu(g,u,b)))}function Cg(a,u,g){var b=kl();Pf(a,u,g,b)}function Pf(a,u,g,b){var A={lane:b,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(Bf(a))Ff(u,A);else{var D=a.alternate;if(a.lanes===0&&(D===null||D.lanes===0)&&(D=u.lastRenderedReducer,D!==null))try{var K=u.lastRenderedState,bt=D(K,g);if(A.hasEagerState=!0,A.eagerState=bt,tr(bt,K))return $o(a,u,A,0),vs===null&&Fu(),!1}catch{}finally{}if(g=gu(a,u,A,b),g!==null)return ru(g,a,b),qu(g,u,b),!0}return!1}function pp(a,u,g,b){if(b={lane:2,revertLane:Fp(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Bf(a)){if(u)throw Error(T(479))}else u=gu(a,g,b,2),u!==null&&ru(u,a,2)}function Bf(a){var u=a.alternate;return a===Fe||u!==null&&u===Fe}function Ff(a,u){Gn=Vn=!0;var g=a.pending;g===null?u.next=u:(u.next=g.next,g.next=u),a.pending=u}function qu(a,u,g){if((g&4194048)!==0){var b=u.lanes;b&=a.pendingLanes,g|=b,u.lanes=g,et(a,g)}}var kf={readContext:dn,use:Ia,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useLayoutEffect:pi,useInsertionEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useSyncExternalStore:pi,useId:pi,useHostTransitionStatus:pi,useFormState:pi,useActionState:pi,useOptimistic:pi,useMemoCache:pi,useCacheRefresh:pi};kf.useEffectEvent=pi;var Ig={readContext:dn,use:Ia,useCallback:function(a,u){return Ir().memoizedState=[a,u===void 0?null:u],a},useContext:dn,useEffect:Wc,useImperativeHandle:function(a,u,g){g=g!=null?g.concat([a]):null,nu(4194308,4,zf.bind(null,u,a),g)},useLayoutEffect:function(a,u){return nu(4194308,4,a,u)},useInsertionEffect:function(a,u){nu(4,2,a,u)},useMemo:function(a,u){var g=Ir();u=u===void 0?null:u;var b=a();if(Un){Rs(!0);try{a()}finally{Rs(!1)}}return g.memoizedState=[b,u],b},useReducer:function(a,u,g){var b=Ir();if(g!==void 0){var A=g(u);if(Un){Rs(!0);try{g(u)}finally{Rs(!1)}}}else A=u;return b.memoizedState=b.baseState=A,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:A},b.queue=a,a=a.dispatch=Vm.bind(null,Fe,a),[b.memoizedState,a]},useRef:function(a){var u=Ir();return a={current:a},u.memoizedState=a},useState:function(a){a=v(a);var u=a.queue,g=Cg.bind(null,Fe,u);return u.dispatch=g,[a.memoizedState,g]},useDebugValue:qh,useDeferredValue:function(a,u){var g=Ir();return fp(g,a,u)},useTransition:function(){var a=v(!1);return a=Tg.bind(null,Fe,a.queue,!0,!1),Ir().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,u,g){var b=Fe,A=Ir();if(Mi){if(g===void 0)throw Error(T(407));g=g()}else{if(g=u(),vs===null)throw Error(T(349));(ir&127)!==0||gl(b,u,g)}A.memoizedState=g;var D={value:g,getSnapshot:u};return A.queue=D,Wc(n.bind(null,b,D,a),[a]),b.flags|=2048,ha(9,{destroy:void 0},t.bind(null,b,D,g,u),null),g},useId:function(){var a=Ir(),u=vs.identifierPrefix;if(Mi){var g=Js,b=la;g=(b&~(1<<32-_r(b)-1)).toString(32)+g,u="_"+u+"R_"+g,g=tn++,0<g&&(u+="H"+g.toString(32)),u+="_"}else g=Er++,u="_"+u+"r_"+g.toString(32)+"_";return a.memoizedState=u},useHostTransitionStatus:Tu,useFormState:Nn,useActionState:Nn,useOptimistic:function(a){var u=Ir();u.memoizedState=u.baseState=a;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=g,u=pp.bind(null,Fe,!0,g),g.dispatch=u,[a,u]},useMemoCache:Bo,useCacheRefresh:function(){return Ir().memoizedState=vh.bind(null,Fe)},useEffectEvent:function(a){var u=Ir(),g={impl:a};return u.memoizedState=g,function(){if((Lr&2)!==0)throw Error(T(440));return g.impl.apply(void 0,arguments)}}},Qs={readContext:dn,use:Ia,useCallback:cp,useContext:dn,useEffect:md,useImperativeHandle:_c,useInsertionEffect:up,useLayoutEffect:yd,useMemo:hp,useReducer:zl,useRef:mc,useState:function(){return zl(Ma)},useDebugValue:qh,useDeferredValue:function(a,u){var g=xi();return Sg(g,Xe.memoizedState,a,u)},useTransition:function(){var a=zl(Ma)[0],u=xi().memoizedState;return[typeof a=="boolean"?a:Ol(a),u]},useSyncExternalStore:Su,useId:Bc,useHostTransitionStatus:Tu,useFormState:ei,useActionState:ei,useOptimistic:function(a,u){var g=xi();return C(g,Xe,a,u)},useMemoCache:Bo,useCacheRefresh:Fc};Qs.useEffectEvent=Of;var ai={readContext:dn,use:Ia,useCallback:cp,useContext:dn,useEffect:md,useImperativeHandle:_c,useInsertionEffect:up,useLayoutEffect:yd,useMemo:hp,useReducer:pl,useRef:mc,useState:function(){return pl(Ma)},useDebugValue:qh,useDeferredValue:function(a,u){var g=xi();return Xe===null?fp(g,a,u):Sg(g,Xe.memoizedState,a,u)},useTransition:function(){var a=pl(Ma)[0],u=xi().memoizedState;return[typeof a=="boolean"?a:Ol(a),u]},useSyncExternalStore:Su,useId:Bc,useHostTransitionStatus:Tu,useFormState:_s,useActionState:_s,useOptimistic:function(a,u){var g=xi();return Xe!==null?C(g,Xe,a,u):(g.baseState=a,[a,g.queue.dispatch])},useMemoCache:Bo,useCacheRefresh:Fc};ai.useEffectEvent=Of;function xc(a,u,g,b){u=a.memoizedState,g=g(b,u),g=g==null?u:ht({},u,g),a.memoizedState=g,a.lanes===0&&(a.updateQueue.baseState=g)}var jh={enqueueSetState:function(a,u,g){a=a._reactInternals;var b=kl(),A=nt(b);A.payload=u,g!=null&&(A.callback=g),u=dt(a,A,b),u!==null&&(ru(u,a,b),Et(u,a,b))},enqueueReplaceState:function(a,u,g){a=a._reactInternals;var b=kl(),A=nt(b);A.tag=1,A.payload=u,g!=null&&(A.callback=g),u=dt(a,A,b),u!==null&&(ru(u,a,b),Et(u,a,b))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var g=kl(),b=nt(g);b.tag=2,u!=null&&(b.callback=u),u=dt(a,b,g),u!==null&&(ru(u,a,g),Et(u,a,g))}};function fr(a,u,g,b,A,D,K){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(b,D,K):u.prototype&&u.prototype.isPureReactComponent?!cr(g,b)||!cr(A,D):!0}function gp(a,u,g,b){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,b),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,b),u.state!==a&&jh.enqueueReplaceState(u,u.state,null)}function kc(a,u){var g=u;if("ref"in u){g={};for(var b in u)b!=="ref"&&(g[b]=u[b])}if(a=a.defaultProps){g===u&&(g=ht({},g));for(var A in a)g[A]===void 0&&(g[A]=a[A])}return g}function rc(a){so(a)}function sc(a){console.error(a)}function Cu(a){so(a)}function ml(a,u){try{var g=a.onUncaughtError;g(u.value,{componentStack:u.stack})}catch(b){setTimeout(function(){throw b})}}function fa(a,u,g){try{var b=a.onCaughtError;b(g.value,{componentStack:g.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function _d(a,u,g){return g=nt(g),g.tag=3,g.payload={element:null},g.callback=function(){ml(a,u)},g}function oc(a){return a=nt(a),a.tag=3,a}function mp(a,u,g,b){var A=g.type.getDerivedStateFromError;if(typeof A=="function"){var D=b.value;a.payload=function(){return A(D)},a.callback=function(){fa(u,g,b)}}var K=g.stateNode;K!==null&&typeof K.componentDidCatch=="function"&&(a.callback=function(){fa(u,g,b),typeof A!="function"&&(Xu===null?Xu=new Set([this]):Xu.add(this));var bt=b.stack;this.componentDidCatch(b.value,{componentStack:bt!==null?bt:""})})}function Xh(a,u,g,b,A){if(g.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(u=g.alternate,u!==null&&Ei(u,g,A,!0),g=Ee.current,g!==null){switch(g.tag){case 31:case 13:return xe===null?Rd():g.alternate===null&&So===0&&(So=3),g.flags&=-257,g.flags|=65536,g.lanes=A,b===Va?g.flags|=16384:(u=g.updateQueue,u===null?g.updateQueue=new Set([b]):u.add(b),Od(a,b,A)),!1;case 22:return g.flags|=65536,b===Va?g.flags|=16384:(u=g.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([b])},g.updateQueue=u):(g=u.retryQueue,g===null?u.retryQueue=new Set([b]):g.add(b)),Od(a,b,A)),!1}throw Error(T(435,g.tag))}return Od(a,b,A),Rd(),!1}if(Mi)return u=Ee.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=A,b!==lo&&(a=Error(T(422),{cause:b}),Kl(oo(a,g)))):(b!==lo&&(u=Error(T(423),{cause:b}),Kl(oo(u,g))),a=a.current.alternate,a.flags|=65536,A&=-A,a.lanes|=A,b=oo(b,g),A=_d(a.stateNode,b,A),xt(a,A),So!==4&&(So=2)),!1;var D=Error(T(520),{cause:b});if(D=oo(D,g),rh===null?rh=[D]:rh.push(D),So!==4&&(So=2),u===null)return!0;b=oo(b,g),g=u;do{switch(g.tag){case 3:return g.flags|=65536,a=A&-A,g.lanes|=a,a=_d(g.stateNode,b,a),xt(g,a),!1;case 1:if(u=g.type,D=g.stateNode,(g.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Xu===null||!Xu.has(D))))return g.flags|=65536,A&=-A,g.lanes|=A,A=oc(A),mp(A,a,g,b),xt(g,A),!1}g=g.return}while(g!==null);return!1}var Uf=Error(T(461)),Fo=!1;function da(a,u,g,b){u.child=a===null?N(u,null,g,b):L(u,a.child,g,b)}function Mg(a,u,g,b,A){g=g.render;var D=u.ref;if("ref"in b){var K={};for(var bt in b)bt!=="ref"&&(K[bt]=b[bt])}else K=b;return Ta(u),b=Xs(a,u,g,K,D,A),bt=Wr(),a!==null&&!Fo?(nr(a,u,A),bc(a,u,A)):(Mi&&bt&&vu(u),u.flags|=1,da(a,u,b,A),u.child)}function vd(a,u,g,b,A){if(a===null){var D=g.type;return typeof D=="function"&&!ll(D)&&D.defaultProps===void 0&&g.compare===null?(u.tag=15,u.type=D,yp(a,u,D,b,A)):(a=bn(g.type,null,b,u,u.mode,A),a.ref=u.ref,a.return=u,u.child=a)}if(D=a.child,!Tp(a,A)){var K=D.memoizedProps;if(g=g.compare,g=g!==null?g:cr,g(K,b)&&a.ref===u.ref)return bc(a,u,A)}return u.flags|=1,a=gs(D,b),a.ref=u.ref,a.return=u,u.child=a}function yp(a,u,g,b,A){if(a!==null){var D=a.memoizedProps;if(cr(D,b)&&a.ref===u.ref)if(Fo=!1,u.pendingProps=b=D,Tp(a,A))(a.flags&131072)!==0&&(Fo=!0);else return u.lanes=a.lanes,bc(a,u,A)}return vp(a,u,g,b,A)}function Ag(a,u,g,b){var A=b.children,D=a!==null?a.memoizedState:null;if(a===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((u.flags&128)!==0){if(D=D!==null?D.baseLanes|g:g,a!==null){for(b=u.child=a.child,A=0;b!==null;)A=A|b.lanes|b.childLanes,b=b.sibling;b=A&~D}else b=0,u.child=null;return $c(a,u,D,g,b)}if((g&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},a!==null&&fl(u,D!==null?D.cachePool:null),D!==null?Nt(u,D):jt(),Ve(u);else return b=u.lanes=536870912,$c(a,u,D!==null?D.baseLanes|g:g,g,b)}else D!==null?(fl(u,D.cachePool),Nt(u,D),Pe(),u.memoizedState=null):(a!==null&&fl(u,null),jt(),Pe());return da(a,u,A,g),u.child}function Iu(a,u){return a!==null&&a.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function $c(a,u,g,b,A){var D=nc();return D=D===null?null:{parent:as._currentValue,pool:D},u.memoizedState={baseLanes:g,cachePool:D},a!==null&&fl(u,null),jt(),Ve(u),a!==null&&Ei(a,u,b,!0),u.childLanes=A,null}function xh(a,u){return u=jf({mode:u.mode,children:u.children},a.mode),u.ref=a.ref,a.child=u,u.return=a,u}function Gf(a,u,g){return L(u,a.child,null,g),a=xh(u,u.pendingProps),a.flags|=2,ge(u),u.memoizedState=null,a}function _p(a,u,g){var b=u.pendingProps,A=(u.flags&128)!==0;if(u.flags&=-129,a===null){if(Mi){if(b.mode==="hidden")return a=xh(u,b),u.lanes=536870912,Iu(null,a);if(ce(u),(a=Pr)?(a=Hp(a,hr),a=a!==null&&a.data==="&"?a:null,a!==null&&(u.memoizedState={dehydrated:a,treeContext:Cr!==null?{id:la,overflow:Js}:null,retryLane:536870912,hydrationErrors:null},g=js(a),g.return=u,u.child=g,os=u,Pr=null)):a=null,a===null)throw No(u);return u.lanes=536870912,null}return xh(u,b)}var D=a.memoizedState;if(D!==null){var K=D.dehydrated;if(ce(u),A)if(u.flags&256)u.flags&=-257,u=Gf(a,u,g);else if(u.memoizedState!==null)u.child=a.child,u.flags|=128,u=null;else throw Error(T(558));else if(Fo||Ei(a,u,g,!1),A=(g&a.childLanes)!==0,Fo||A){if(b=vs,b!==null&&(K=ot(b,g),K!==0&&K!==D.retryLane))throw D.retryLane=K,al(a,K),ru(b,a,K),Uf;Rd(),u=Gf(a,u,g)}else a=D.treeContext,Pr=ou(K.nextSibling),os=u,Mi=!0,ka=null,hr=!1,a!==null&&ec(u,a),u=xh(u,b),u.flags|=4096;return u}return a=gs(a.child,{mode:b.mode,children:b.children}),a.ref=u.ref,u.child=a,a.return=u,a}function Vf(a,u){var g=u.ref;if(g===null)a!==null&&a.ref!==null&&(u.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(T(284));(a===null||a.ref!==g)&&(u.flags|=4194816)}}function vp(a,u,g,b,A){return Ta(u),g=Xs(a,u,g,b,void 0,A),b=Wr(),a!==null&&!Fo?(nr(a,u,A),bc(a,u,A)):(Mi&&b&&vu(u),u.flags|=1,da(a,u,g,A),u.child)}function xp(a,u,g,b,A,D){return Ta(u),u.updateQueue=null,g=ks(u,b,g,A),Ko(a),b=Wr(),a!==null&&!Fo?(nr(a,u,D),bc(a,u,D)):(Mi&&b&&vu(u),u.flags|=1,da(a,u,g,D),u.child)}function Lg(a,u,g,b,A){if(Ta(u),u.stateNode===null){var D=Jo,K=g.contextType;typeof K=="object"&&K!==null&&(D=dn(K)),D=new g(b,D),u.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=jh,u.stateNode=D,D._reactInternals=u,D=u.stateNode,D.props=b,D.state=u.memoizedState,D.refs={},Z(u),K=g.contextType,D.context=typeof K=="object"&&K!==null?dn(K):Jo,D.state=u.memoizedState,K=g.getDerivedStateFromProps,typeof K=="function"&&(xc(u,g,K,b),D.state=u.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(K=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),K!==D.state&&jh.enqueueReplaceState(D,D.state,null),vt(u,b,D,A),St(),D.state=u.memoizedState),typeof D.componentDidMount=="function"&&(u.flags|=4194308),b=!0}else if(a===null){D=u.stateNode;var bt=u.memoizedProps,ee=kc(g,bt);D.props=ee;var Le=D.context,He=g.contextType;K=Jo,typeof He=="object"&&He!==null&&(K=dn(He));var ln=g.getDerivedStateFromProps;He=typeof ln=="function"||typeof D.getSnapshotBeforeUpdate=="function",bt=u.pendingProps!==bt,He||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(bt||Le!==K)&&gp(u,D,b,K),P=!1;var ze=u.memoizedState;D.state=ze,vt(u,b,D,A),St(),Le=u.memoizedState,bt||ze!==Le||P?(typeof ln=="function"&&(xc(u,g,ln,b),Le=u.memoizedState),(ee=P||fr(u,g,ee,b,ze,Le,K))?(He||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(u.flags|=4194308)):(typeof D.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=b,u.memoizedState=Le),D.props=b,D.state=Le,D.context=K,b=ee):(typeof D.componentDidMount=="function"&&(u.flags|=4194308),b=!1)}else{D=u.stateNode,Y(a,u),K=u.memoizedProps,He=kc(g,K),D.props=He,ln=u.pendingProps,ze=D.context,Le=g.contextType,ee=Jo,typeof Le=="object"&&Le!==null&&(ee=dn(Le)),bt=g.getDerivedStateFromProps,(Le=typeof bt=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(K!==ln||ze!==ee)&&gp(u,D,b,ee),P=!1,ze=u.memoizedState,D.state=ze,vt(u,b,D,A),St();var Ue=u.memoizedState;K!==ln||ze!==Ue||P||a!==null&&a.dependencies!==null&&ns(a.dependencies)?(typeof bt=="function"&&(xc(u,g,bt,b),Ue=u.memoizedState),(He=P||fr(u,g,He,b,ze,Ue,ee)||a!==null&&a.dependencies!==null&&ns(a.dependencies))?(Le||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(b,Ue,ee),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(b,Ue,ee)),typeof D.componentDidUpdate=="function"&&(u.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof D.componentDidUpdate!="function"||K===a.memoizedProps&&ze===a.memoizedState||(u.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||K===a.memoizedProps&&ze===a.memoizedState||(u.flags|=1024),u.memoizedProps=b,u.memoizedState=Ue),D.props=b,D.state=Ue,D.context=ee,b=He):(typeof D.componentDidUpdate!="function"||K===a.memoizedProps&&ze===a.memoizedState||(u.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||K===a.memoizedProps&&ze===a.memoizedState||(u.flags|=1024),b=!1)}return D=b,Vf(a,u),b=(u.flags&128)!==0,D||b?(D=u.stateNode,g=b&&typeof g.getDerivedStateFromError!="function"?null:D.render(),u.flags|=1,a!==null&&b?(u.child=L(u,a.child,null,A),u.child=L(u,null,g,A)):da(a,u,g,A),u.memoizedState=D.state,a=u.child):a=bc(a,u,A),a}function xd(a,u,g,b){return ul(),u.flags|=256,da(a,u,g,b),u.child}var bp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qf(a){return{baseLanes:a,cachePool:ic()}}function bd(a,u,g){return a=a!==null?a.childLanes&~g:0,u&&(a|=Ru),a}function wp(a,u,g){var b=u.pendingProps,A=!1,D=(u.flags&128)!==0,K;if((K=D)||(K=a!==null&&a.memoizedState===null?!1:(Qt.current&2)!==0),K&&(A=!0,u.flags&=-129),K=(u.flags&32)!==0,u.flags&=-33,a===null){if(Mi){if(A?We(u):Pe(),(a=Pr)?(a=Hp(a,hr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(u.memoizedState={dehydrated:a,treeContext:Cr!==null?{id:la,overflow:Js}:null,retryLane:536870912,hydrationErrors:null},g=js(a),g.return=u,u.child=g,os=u,Pr=null)):a=null,a===null)throw No(u);return Dh(a)?u.lanes=32:u.lanes=536870912,null}var bt=b.children;return b=b.fallback,A?(Pe(),A=u.mode,bt=jf({mode:"hidden",children:bt},A),b=qs(b,A,g,null),bt.return=u,b.return=u,bt.sibling=b,u.child=bt,b=u.child,b.memoizedState=qf(g),b.childLanes=bd(a,K,g),u.memoizedState=bp,Iu(null,b)):(We(u),Uc(u,bt))}var ee=a.memoizedState;if(ee!==null&&(bt=ee.dehydrated,bt!==null)){if(D)u.flags&256?(We(u),u.flags&=-257,u=Ep(a,u,g)):u.memoizedState!==null?(Pe(),u.child=a.child,u.flags|=128,u=null):(Pe(),bt=b.fallback,A=u.mode,b=jf({mode:"visible",children:b.children},A),bt=qs(bt,A,g,null),bt.flags|=2,b.return=u,bt.return=u,b.sibling=bt,u.child=b,L(u,a.child,null,g),b=u.child,b.memoizedState=qf(g),b.childLanes=bd(a,K,g),u.memoizedState=bp,u=Iu(null,b));else if(We(u),Dh(bt)){if(K=bt.nextSibling&&bt.nextSibling.dataset,K)var Le=K.dgst;K=Le,b=Error(T(419)),b.stack="",b.digest=K,Kl({value:b,source:null,stack:null}),u=Ep(a,u,g)}else if(Fo||Ei(a,u,g,!1),K=(g&a.childLanes)!==0,Fo||K){if(K=vs,K!==null&&(b=ot(K,g),b!==0&&b!==ee.retryLane))throw ee.retryLane=b,al(a,b),ru(K,a,b),Uf;Ul(bt)||Rd(),u=Ep(a,u,g)}else Ul(bt)?(u.flags|=192,u.child=a.child,u=null):(a=ee.treeContext,Pr=ou(bt.nextSibling),os=u,Mi=!0,ka=null,hr=!1,a!==null&&ec(u,a),u=Uc(u,b.children),u.flags|=4096);return u}return A?(Pe(),bt=b.fallback,A=u.mode,ee=a.child,Le=ee.sibling,b=gs(ee,{mode:"hidden",children:b.children}),b.subtreeFlags=ee.subtreeFlags&65011712,Le!==null?bt=gs(Le,bt):(bt=qs(bt,A,g,null),bt.flags|=2),bt.return=u,b.return=u,b.sibling=bt,u.child=b,Iu(null,b),b=u.child,bt=a.child.memoizedState,bt===null?bt=qf(g):(A=bt.cachePool,A!==null?(ee=as._currentValue,A=A.parent!==ee?{parent:ee,pool:ee}:A):A=ic(),bt={baseLanes:bt.baseLanes|g,cachePool:A}),b.memoizedState=bt,b.childLanes=bd(a,K,g),u.memoizedState=bp,Iu(a.child,b)):(We(u),g=a.child,a=g.sibling,g=gs(g,{mode:"visible",children:b.children}),g.return=u,g.sibling=null,a!==null&&(K=u.deletions,K===null?(u.deletions=[a],u.flags|=16):K.push(a)),u.child=g,u.memoizedState=null,g)}function Uc(a,u){return u=jf({mode:"visible",children:u},a.mode),u.return=a,a.child=u}function jf(a,u){return a=$s(22,a,null,u),a.lanes=0,a}function Ep(a,u,g){return L(u,a.child,null,g),a=Uc(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function bh(a,u,g){a.lanes|=u;var b=a.alternate;b!==null&&(b.lanes|=u),Sa(a.return,u,g)}function Zh(a,u,g,b,A,D){var K=a.memoizedState;K===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:b,tail:g,tailMode:A,treeForkCount:D}:(K.isBackwards=u,K.rendering=null,K.renderingStartTime=0,K.last=b,K.tail=g,K.tailMode=A,K.treeForkCount=D)}function Sp(a,u,g){var b=u.pendingProps,A=b.revealOrder,D=b.tail;b=b.children;var K=Qt.current,bt=(K&2)!==0;if(bt?(K=K&1|2,u.flags|=128):K&=1,ve(Qt,K),da(a,u,b,g),b=Mi?vo:0,!bt&&a!==null&&(a.flags&128)!==0)t:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&bh(a,g,u);else if(a.tag===19)bh(a,g,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break t;for(;a.sibling===null;){if(a.return===null||a.return===u)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(A){case"forwards":for(g=u.child,A=null;g!==null;)a=g.alternate,a!==null&&fn(a)===null&&(A=g),g=g.sibling;g=A,g===null?(A=u.child,u.child=null):(A=g.sibling,g.sibling=null),Zh(u,!1,A,g,D,b);break;case"backwards":case"unstable_legacy-backwards":for(g=null,A=u.child,u.child=null;A!==null;){if(a=A.alternate,a!==null&&fn(a)===null){u.child=A;break}a=A.sibling,A.sibling=g,g=A,A=a}Zh(u,!0,g,null,D,b);break;case"together":Zh(u,!1,null,null,void 0,b);break;default:u.memoizedState=null}return u.child}function bc(a,u,g){if(a!==null&&(u.dependencies=a.dependencies),Tc|=u.lanes,(g&u.childLanes)===0)if(a!==null){if(Ei(a,u,g,!1),(g&u.childLanes)===0)return null}else return null;if(a!==null&&u.child!==a.child)throw Error(T(153));if(u.child!==null){for(a=u.child,g=gs(a,a.pendingProps),u.child=g,g.return=u;a.sibling!==null;)a=a.sibling,g=g.sibling=gs(a,a.pendingProps),g.return=u;g.sibling=null}return u.child}function Tp(a,u){return(a.lanes&u)!==0?!0:(a=a.dependencies,!!(a!==null&&ns(a)))}function qm(a,u,g){switch(u.tag){case 3:$n(u,u.stateNode.containerInfo),Ga(u,as,a.memoizedState.cache),ul();break;case 27:case 5:Gi(u);break;case 4:$n(u,u.stateNode.containerInfo);break;case 10:Ga(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,ce(u),null;break;case 13:var b=u.memoizedState;if(b!==null)return b.dehydrated!==null?(We(u),u.flags|=128,null):(g&u.child.childLanes)!==0?wp(a,u,g):(We(u),a=bc(a,u,g),a!==null?a.sibling:null);We(u);break;case 19:var A=(a.flags&128)!==0;if(b=(g&u.childLanes)!==0,b||(Ei(a,u,g,!1),b=(g&u.childLanes)!==0),A){if(b)return Sp(a,u,g);u.flags|=128}if(A=u.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),ve(Qt,Qt.current),b)break;return null;case 22:return u.lanes=0,Ag(a,u,g,u.pendingProps);case 24:Ga(u,as,a.memoizedState.cache)}return bc(a,u,g)}function Xf(a,u,g){if(a!==null)if(a.memoizedProps!==u.pendingProps)Fo=!0;else{if(!Tp(a,g)&&(u.flags&128)===0)return Fo=!1,qm(a,u,g);Fo=(a.flags&131072)!==0}else Fo=!1,Mi&&(u.flags&1048576)!==0&&hc(u,vo,u.index);switch(u.lanes=0,u.tag){case 16:t:{var b=u.pendingProps;if(a=qa(u.elementType),u.type=a,typeof a=="function")ll(a)?(b=kc(a,b),u.tag=1,u=Lg(null,u,a,b,g)):(u.tag=0,u=vp(null,u,a,b,g));else{if(a!=null){var A=a.$$typeof;if(A===pt){u.tag=11,u=Mg(null,u,a,b,g);break t}else if(A===_t){u.tag=14,u=vd(null,u,a,b,g);break t}}throw u=Sn(a)||a,Error(T(306,u,""))}}return u;case 0:return vp(a,u,u.type,u.pendingProps,g);case 1:return b=u.type,A=kc(b,u.pendingProps),Lg(a,u,b,A,g);case 3:t:{if($n(u,u.stateNode.containerInfo),a===null)throw Error(T(387));b=u.pendingProps;var D=u.memoizedState;A=D.element,Y(a,u),vt(u,b,null,g);var K=u.memoizedState;if(b=K.cache,Ga(u,as,b),b!==D.cache&&Uu(u,[as],g,!0),St(),b=K.element,D.isDehydrated)if(D={element:b,isDehydrated:!1,cache:K.cache},u.updateQueue.baseState=D,u.memoizedState=D,u.flags&256){u=xd(a,u,b,g);break t}else if(b!==A){A=oo(Error(T(424)),u),Kl(A),u=xd(a,u,b,g);break t}else{switch(a=u.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Pr=ou(a.firstChild),os=u,Mi=!0,ka=null,hr=!0,g=N(u,null,b,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(ul(),b===A){u=bc(a,u,g);break t}da(a,u,b,g)}u=u.child}return u;case 26:return Vf(a,u),a===null?(g=mf(u.type,null,u.pendingProps,null))?u.memoizedState=g:Mi||(g=u.type,a=u.pendingProps,b=Gd(On.current).createElement(g),b[$t]=u,b[me]=a,ga(b,g,a),_i(b),u.stateNode=b):u.memoizedState=mf(u.type,a.memoizedProps,u.pendingProps,a.memoizedState),null;case 27:return Gi(u),a===null&&Mi&&(b=u.stateNode=Wp(u.type,u.pendingProps,On.current),os=u,hr=!0,A=Pr,Hc(u.type)?(pf=A,Pr=ou(b.firstChild)):Pr=A),da(a,u,u.pendingProps.children,g),Vf(a,u),a===null&&(u.flags|=4194304),u.child;case 5:return a===null&&Mi&&((A=b=Pr)&&(b=Xp(b,u.type,u.pendingProps,hr),b!==null?(u.stateNode=b,os=u,Pr=ou(b.firstChild),hr=!1,A=!0):A=!1),A||No(u)),Gi(u),A=u.type,D=u.pendingProps,K=a!==null?a.memoizedProps:null,b=D.children,Vp(A,D)?b=null:K!==null&&Vp(A,K)&&(u.flags|=32),u.memoizedState!==null&&(A=Xs(a,u,er,null,null,g),bf._currentValue=A),Vf(a,u),da(a,u,b,g),u.child;case 6:return a===null&&Mi&&((a=g=Pr)&&(g=Zp(g,u.pendingProps,hr),g!==null?(u.stateNode=g,os=u,Pr=null,a=!0):a=!1),a||No(u)),null;case 13:return wp(a,u,g);case 4:return $n(u,u.stateNode.containerInfo),b=u.pendingProps,a===null?u.child=L(u,null,b,g):da(a,u,b,g),u.child;case 11:return Mg(a,u,u.type,u.pendingProps,g);case 7:return da(a,u,u.pendingProps,g),u.child;case 8:return da(a,u,u.pendingProps.children,g),u.child;case 12:return da(a,u,u.pendingProps.children,g),u.child;case 10:return b=u.pendingProps,Ga(u,u.type,b.value),da(a,u,b.children,g),u.child;case 9:return A=u.type._context,b=u.pendingProps.children,Ta(u),A=dn(A),b=b(A),u.flags|=1,da(a,u,b,g),u.child;case 14:return vd(a,u,u.type,u.pendingProps,g);case 15:return yp(a,u,u.type,u.pendingProps,g);case 19:return Sp(a,u,g);case 31:return _p(a,u,g);case 22:return Ag(a,u,g,u.pendingProps);case 24:return Ta(u),b=dn(as),a===null?(A=nc(),A===null&&(A=vs,D=ca(),A.pooledCache=D,D.refCount++,D!==null&&(A.pooledCacheLanes|=g),A=D),u.memoizedState={parent:b,cache:A},Z(u),Ga(u,as,A)):((a.lanes&g)!==0&&(Y(a,u),vt(u,null,null,g),St()),A=a.memoizedState,D=u.memoizedState,A.parent!==b?(A={parent:b,cache:b},u.memoizedState=A,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=A),Ga(u,as,b)):(b=D.cache,Ga(u,as,b),b!==A.cache&&Uu(u,[as],g,!0))),da(a,u,u.pendingProps.children,g),u.child;case 29:throw u.pendingProps}throw Error(T(156,u.tag))}function bo(a){a.flags|=4}function wd(a,u,g,b,A){if((u=(a.mode&32)!==0)&&(u=!1),u){if(a.flags|=16777216,(A&335544128)===A)if(a.stateNode.complete)a.flags|=8192;else if(Ah())a.flags|=8192;else throw tu=Va,Eu}else a.flags&=-16777217}function Cp(a,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Ph(u))if(Ah())a.flags|=8192;else throw tu=Va,Eu}function Mu(a,u){u!==null&&(a.flags|=4),a.flags&16384&&(u=a.tag!==22?ts():536870912,a.lanes|=u,xs|=u)}function wh(a,u){if(!Mi)switch(a.tailMode){case"hidden":u=a.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?a.tail=null:g.sibling=null;break;case"collapsed":g=a.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:b.sibling=null}}function is(a){var u=a.alternate!==null&&a.alternate.child===a.child,g=0,b=0;if(u)for(var A=a.child;A!==null;)g|=A.lanes|A.childLanes,b|=A.subtreeFlags&65011712,b|=A.flags&65011712,A.return=a,A=A.sibling;else for(A=a.child;A!==null;)g|=A.lanes|A.childLanes,b|=A.subtreeFlags,b|=A.flags,A.return=a,A=A.sibling;return a.subtreeFlags|=b,a.childLanes=g,u}function Zf(a,u,g){var b=u.pendingProps;switch(xu(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return is(u),null;case 1:return is(u),null;case 3:return g=u.stateNode,b=null,a!==null&&(b=a.memoizedState.cache),u.memoizedState.cache!==b&&(u.flags|=2048),cl(as),yi(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(Ua(u)?bo(u):a===null||a.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,ku())),is(u),null;case 26:var A=u.type,D=u.memoizedState;return a===null?(bo(u),D!==null?(is(u),Cp(u,D)):(is(u),wd(u,A,null,b,g))):D?D!==a.memoizedState?(bo(u),is(u),Cp(u,D)):(is(u),u.flags&=-16777217):(a=a.memoizedProps,a!==b&&bo(u),is(u),wd(u,A,a,b,g)),null;case 27:if(jr(u),g=On.current,A=u.type,a!==null&&u.stateNode!=null)a.memoizedProps!==b&&bo(u);else{if(!b){if(u.stateNode===null)throw Error(T(166));return is(u),null}a=Be.current,Ua(u)?fc(u):(a=Wp(A,b,g),u.stateNode=a,bo(u))}return is(u),null;case 5:if(jr(u),A=u.type,a!==null&&u.stateNode!=null)a.memoizedProps!==b&&bo(u);else{if(!b){if(u.stateNode===null)throw Error(T(166));return is(u),null}if(D=Be.current,Ua(u))fc(u);else{var K=Gd(On.current);switch(D){case 1:D=K.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:D=K.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":D=K.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":D=K.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":D=K.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof b.is=="string"?K.createElement("select",{is:b.is}):K.createElement("select"),b.multiple?D.multiple=!0:b.size&&(D.size=b.size);break;default:D=typeof b.is=="string"?K.createElement(A,{is:b.is}):K.createElement(A)}}D[$t]=u,D[me]=b;t:for(K=u.child;K!==null;){if(K.tag===5||K.tag===6)D.appendChild(K.stateNode);else if(K.tag!==4&&K.tag!==27&&K.child!==null){K.child.return=K,K=K.child;continue}if(K===u)break t;for(;K.sibling===null;){if(K.return===null||K.return===u)break t;K=K.return}K.sibling.return=K.return,K=K.sibling}u.stateNode=D;t:switch(ga(D,A,b),A){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break t;case"img":b=!0;break t;default:b=!1}b&&bo(u)}}return is(u),wd(u,u.type,a===null?null:a.memoizedProps,u.pendingProps,g),null;case 6:if(a&&u.stateNode!=null)a.memoizedProps!==b&&bo(u);else{if(typeof b!="string"&&u.stateNode===null)throw Error(T(166));if(a=On.current,Ua(u)){if(a=u.stateNode,g=u.memoizedProps,b=null,A=os,A!==null)switch(A.tag){case 27:case 5:b=A.memoizedProps}a[$t]=u,a=!!(a.nodeValue===g||b!==null&&b.suppressHydrationWarning===!0||Up(a.nodeValue,g)),a||No(u,!0)}else a=Gd(a).createTextNode(b),a[$t]=u,u.stateNode=a}return is(u),null;case 31:if(g=u.memoizedState,a===null||a.memoizedState!==null){if(b=Ua(u),g!==null){if(a===null){if(!b)throw Error(T(318));if(a=u.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(T(557));a[$t]=u}else ul(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;is(u),a=!1}else g=ku(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),a=!0;if(!a)return u.flags&256?(ge(u),u):(ge(u),null);if((u.flags&128)!==0)throw Error(T(558))}return is(u),null;case 13:if(b=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(A=Ua(u),b!==null&&b.dehydrated!==null){if(a===null){if(!A)throw Error(T(318));if(A=u.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(T(317));A[$t]=u}else ul(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;is(u),A=!1}else A=ku(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=A),A=!0;if(!A)return u.flags&256?(ge(u),u):(ge(u),null)}return ge(u),(u.flags&128)!==0?(u.lanes=g,u):(g=b!==null,a=a!==null&&a.memoizedState!==null,g&&(b=u.child,A=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(A=b.alternate.memoizedState.cachePool.pool),D=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(D=b.memoizedState.cachePool.pool),D!==A&&(b.flags|=2048)),g!==a&&g&&(u.child.flags|=8192),Mu(u,u.updateQueue),is(u),null);case 4:return yi(),a===null&&Zu(u.stateNode.containerInfo),is(u),null;case 10:return cl(u.type),is(u),null;case 19:if(Zt(Qt),b=u.memoizedState,b===null)return is(u),null;if(A=(u.flags&128)!==0,D=b.rendering,D===null)if(A)wh(b,!1);else{if(So!==0||a!==null&&(a.flags&128)!==0)for(a=u.child;a!==null;){if(D=fn(a),D!==null){for(u.flags|=128,wh(b,!1),a=D.updateQueue,u.updateQueue=a,Mu(u,a),u.subtreeFlags=0,a=g,g=u.child;g!==null;)yu(g,a),g=g.sibling;return ve(Qt,Qt.current&1|2),Mi&&ua(u,b.treeForkCount),u.child}a=a.sibling}b.tail!==null&&Ri()>Jf&&(u.flags|=128,A=!0,wh(b,!1),u.lanes=4194304)}else{if(!A)if(a=fn(D),a!==null){if(u.flags|=128,A=!0,a=a.updateQueue,u.updateQueue=a,Mu(u,a),wh(b,!0),b.tail===null&&b.tailMode==="hidden"&&!D.alternate&&!Mi)return is(u),null}else 2*Ri()-b.renderingStartTime>Jf&&g!==536870912&&(u.flags|=128,A=!0,wh(b,!1),u.lanes=4194304);b.isBackwards?(D.sibling=u.child,u.child=D):(a=b.last,a!==null?a.sibling=D:u.child=D,b.last=D)}return b.tail!==null?(a=b.tail,b.rendering=a,b.tail=a.sibling,b.renderingStartTime=Ri(),a.sibling=null,g=Qt.current,ve(Qt,A?g&1|2:g&1),Mi&&ua(u,b.treeForkCount),a):(is(u),null);case 22:case 23:return ge(u),fe(),b=u.memoizedState!==null,a!==null?a.memoizedState!==null!==b&&(u.flags|=8192):b&&(u.flags|=8192),b?(g&536870912)!==0&&(u.flags&128)===0&&(is(u),u.subtreeFlags&6&&(u.flags|=8192)):is(u),g=u.updateQueue,g!==null&&Mu(u,g.retryQueue),g=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==g&&(u.flags|=2048),a!==null&&Zt(Ks),null;case 24:return g=null,a!==null&&(g=a.memoizedState.cache),u.memoizedState.cache!==g&&(u.flags|=2048),cl(as),is(u),null;case 25:return null;case 30:return null}throw Error(T(156,u.tag))}function Eh(a,u){switch(xu(u),u.tag){case 1:return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return cl(as),yi(),a=u.flags,(a&65536)!==0&&(a&128)===0?(u.flags=a&-65537|128,u):null;case 26:case 27:case 5:return jr(u),null;case 31:if(u.memoizedState!==null){if(ge(u),u.alternate===null)throw Error(T(340));ul()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 13:if(ge(u),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(T(340));ul()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return Zt(Qt),null;case 4:return yi(),null;case 10:return cl(u.type),null;case 22:case 23:return ge(u),fe(),a!==null&&Zt(Ks),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 24:return cl(as),null;case 25:return null;default:return null}}function Ed(a,u){switch(xu(u),u.tag){case 3:cl(as),yi();break;case 26:case 27:case 5:jr(u);break;case 4:yi();break;case 31:u.memoizedState!==null&&ge(u);break;case 13:ge(u);break;case 19:Zt(Qt);break;case 10:cl(u.type);break;case 22:case 23:ge(u),fe(),a!==null&&Zt(Ks);break;case 24:cl(as)}}function Jc(a,u){try{var g=u.updateQueue,b=g!==null?g.lastEffect:null;if(b!==null){var A=b.next;g=A;do{if((g.tag&a)===a){b=void 0;var D=g.create,K=g.inst;b=D(),K.destroy=b}g=g.next}while(g!==A)}}catch(bt){rs(u,u.return,bt)}}function Gc(a,u,g){try{var b=u.updateQueue,A=b!==null?b.lastEffect:null;if(A!==null){var D=A.next;b=D;do{if((b.tag&a)===a){var K=b.inst,bt=K.destroy;if(bt!==void 0){K.destroy=void 0,A=u;var ee=g,Le=bt;try{Le()}catch(He){rs(A,ee,He)}}}b=b.next}while(b!==D)}}catch(He){rs(u,u.return,He)}}function Ip(a){var u=a.updateQueue;if(u!==null){var g=a.stateNode;try{Tt(u,g)}catch(b){rs(a,a.return,b)}}}function Rg(a,u,g){g.props=kc(a.type,a.memoizedProps),g.state=a.memoizedState;try{g.componentWillUnmount()}catch(b){rs(a,u,b)}}function Sh(a,u){try{var g=a.ref;if(g!==null){switch(a.tag){case 26:case 27:case 5:var b=a.stateNode;break;case 30:b=a.stateNode;break;default:b=a.stateNode}typeof g=="function"?a.refCleanup=g(b):g.current=b}}catch(A){rs(a,u,A)}}function ac(a,u){var g=a.ref,b=a.refCleanup;if(g!==null)if(typeof b=="function")try{b()}catch(A){rs(a,u,A)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(A){rs(a,u,A)}else g.current=null}function Hh(a){var u=a.type,g=a.memoizedProps,b=a.stateNode;try{t:switch(u){case"button":case"input":case"select":case"textarea":g.autoFocus&&b.focus();break t;case"img":g.src?b.src=g.src:g.srcSet&&(b.srcset=g.srcSet)}}catch(A){rs(a,a.return,A)}}function Kc(a,u,g){try{var b=a.stateNode;em(b,a.type,g,u),b[me]=u}catch(A){rs(a,a.return,A)}}function wc(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Hc(a.type)||a.tag===4}function Hf(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||wc(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Hc(a.type)||a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Sd(a,u,g){var b=a.tag;if(b===5||b===6)a=a.stateNode,u?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(a,u):(u=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,u.appendChild(a),g=g._reactRootContainer,g!=null||u.onclick!==null||(u.onclick=Qe));else if(b!==4&&(b===27&&Hc(a.type)&&(g=a.stateNode,u=null),a=a.child,a!==null))for(Sd(a,u,g),a=a.sibling;a!==null;)Sd(a,u,g),a=a.sibling}function Qc(a,u,g){var b=a.tag;if(b===5||b===6)a=a.stateNode,u?g.insertBefore(a,u):g.appendChild(a);else if(b!==4&&(b===27&&Hc(a.type)&&(g=a.stateNode),a=a.child,a!==null))for(Qc(a,u,g),a=a.sibling;a!==null;)Qc(a,u,g),a=a.sibling}function Yh(a){var u=a.stateNode,g=a.memoizedProps;try{for(var b=a.type,A=u.attributes;A.length;)u.removeAttributeNode(A[0]);ga(u,b,g),u[$t]=a,u[me]=g}catch(D){rs(a,a.return,D)}}var ko=!1,to=!1,Aa=!1,Au=typeof WeakSet=="function"?WeakSet:Set,Qo=null;function wo(a,u){if(a=a.containerInfo,oh=Hu,a=ps(a),Ba(a)){if("selectionStart"in a)var g={start:a.selectionStart,end:a.selectionEnd};else t:{g=(g=a.ownerDocument)&&g.defaultView||window;var b=g.getSelection&&g.getSelection();if(b&&b.rangeCount!==0){g=b.anchorNode;var A=b.anchorOffset,D=b.focusNode;b=b.focusOffset;try{g.nodeType,D.nodeType}catch{g=null;break t}var K=0,bt=-1,ee=-1,Le=0,He=0,ln=a,ze=null;e:for(;;){for(var Ue;ln!==g||A!==0&&ln.nodeType!==3||(bt=K+A),ln!==D||b!==0&&ln.nodeType!==3||(ee=K+b),ln.nodeType===3&&(K+=ln.nodeValue.length),(Ue=ln.firstChild)!==null;)ze=ln,ln=Ue;for(;;){if(ln===a)break e;if(ze===g&&++Le===A&&(bt=K),ze===D&&++He===b&&(ee=K),(Ue=ln.nextSibling)!==null)break;ln=ze,ze=ln.parentNode}ln=Ue}g=bt===-1||ee===-1?null:{start:bt,end:ee}}else g=null}g=g||{start:0,end:0}}else g=null;for(Ud={focusedElem:a,selectionRange:g},Hu=!1,Qo=u;Qo!==null;)if(u=Qo,a=u.child,(u.subtreeFlags&1028)!==0&&a!==null)a.return=u,Qo=a;else for(;Qo!==null;){switch(u=Qo,D=u.alternate,a=u.flags,u.tag){case 0:if((a&4)!==0&&(a=u.updateQueue,a=a!==null?a.events:null,a!==null))for(g=0;g<a.length;g++)A=a[g],A.ref.impl=A.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&D!==null){a=void 0,g=u,A=D.memoizedProps,D=D.memoizedState,b=g.stateNode;try{var ti=kc(g.type,A);a=b.getSnapshotBeforeUpdate(ti,D),b.__reactInternalSnapshotBeforeUpdate=a}catch(Si){rs(g,g.return,Si)}}break;case 3:if((a&1024)!==0){if(a=u.stateNode.containerInfo,g=a.nodeType,g===9)jp(a);else if(g===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":jp(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(T(163))}if(a=u.sibling,a!==null){a.return=u.return,Qo=a;break}Qo=u.return}}function Mp(a,u,g){var b=g.flags;switch(g.tag){case 0:case 11:case 15:lc(a,g),b&4&&Jc(5,g);break;case 1:if(lc(a,g),b&4)if(a=g.stateNode,u===null)try{a.componentDidMount()}catch(K){rs(g,g.return,K)}else{var A=kc(g.type,u.memoizedProps);u=u.memoizedState;try{a.componentDidUpdate(A,u,a.__reactInternalSnapshotBeforeUpdate)}catch(K){rs(g,g.return,K)}}b&64&&Ip(g),b&512&&Sh(g,g.return);break;case 3:if(lc(a,g),b&64&&(a=g.updateQueue,a!==null)){if(u=null,g.child!==null)switch(g.child.tag){case 27:case 5:u=g.child.stateNode;break;case 1:u=g.child.stateNode}try{Tt(a,u)}catch(K){rs(g,g.return,K)}}break;case 27:u===null&&b&4&&Yh(g);case 26:case 5:lc(a,g),u===null&&b&4&&Hh(g),b&512&&Sh(g,g.return);break;case 12:lc(a,g);break;case 31:lc(a,g),b&4&&Lp(a,g);break;case 13:lc(a,g),b&4&&th(a,g),b&64&&(a=g.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(g=Zg.bind(null,g),df(a,g))));break;case 22:if(b=g.memoizedState!==null||ko,!b){u=u!==null&&u.memoizedState!==null||to,A=ko;var D=to;ko=b,(to=u)&&!D?Ec(a,g,(g.subtreeFlags&8772)!==0):lc(a,g),ko=A,to=D}break;case 30:break;default:lc(a,g)}}function Wh(a){var u=a.alternate;u!==null&&(a.alternate=null,Wh(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&Qn(u)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Ar=null,iu=!1;function Vc(a,u,g){for(g=g.child;g!==null;)Ap(a,u,g),g=g.sibling}function Ap(a,u,g){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(Ki,g)}catch{}switch(g.tag){case 26:to||ac(g,u),Vc(a,u,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:to||ac(g,u);var b=Ar,A=iu;Hc(g.type)&&(Ar=g.stateNode,iu=!1),Vc(a,u,g),od(g.stateNode),Ar=b,iu=A;break;case 5:to||ac(g,u);case 6:if(b=Ar,A=iu,Ar=null,Vc(a,u,g),Ar=b,iu=A,Ar!==null)if(iu)try{(Ar.nodeType===9?Ar.body:Ar.nodeName==="HTML"?Ar.ownerDocument.body:Ar).removeChild(g.stateNode)}catch(D){rs(g,u,D)}else try{Ar.removeChild(g.stateNode)}catch(D){rs(g,u,D)}break;case 18:Ar!==null&&(iu?(a=Ar,om(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,g.stateNode),kh(a)):om(Ar,g.stateNode));break;case 4:b=Ar,A=iu,Ar=g.stateNode.containerInfo,iu=!0,Vc(a,u,g),Ar=b,iu=A;break;case 0:case 11:case 14:case 15:Gc(2,g,u),to||Gc(4,g,u),Vc(a,u,g);break;case 1:to||(ac(g,u),b=g.stateNode,typeof b.componentWillUnmount=="function"&&Rg(g,u,b)),Vc(a,u,g);break;case 21:Vc(a,u,g);break;case 22:to=(b=to)||g.memoizedState!==null,Vc(a,u,g),to=b;break;default:Vc(a,u,g)}}function Lp(a,u){if(u.memoizedState===null&&(a=u.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{kh(a)}catch(g){rs(u,u.return,g)}}}function th(a,u){if(u.memoizedState===null&&(a=u.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{kh(a)}catch(g){rs(u,u.return,g)}}function Dg(a){switch(a.tag){case 31:case 13:case 19:var u=a.stateNode;return u===null&&(u=a.stateNode=new Au),u;case 22:return a=a.stateNode,u=a._retryCache,u===null&&(u=a._retryCache=new Au),u;default:throw Error(T(435,a.tag))}}function Yf(a,u){var g=Dg(a);u.forEach(function(b){if(!g.has(b)){g.add(b);var A=Ym.bind(null,a,b);b.then(A,A)}})}function Pl(a,u){var g=u.deletions;if(g!==null)for(var b=0;b<g.length;b++){var A=g[b],D=a,K=u,bt=K;t:for(;bt!==null;){switch(bt.tag){case 27:if(Hc(bt.type)){Ar=bt.stateNode,iu=!1;break t}break;case 5:Ar=bt.stateNode,iu=!1;break t;case 3:case 4:Ar=bt.stateNode.containerInfo,iu=!0;break t}bt=bt.return}if(Ar===null)throw Error(T(160));Ap(D,K,A),Ar=null,iu=!1,D=A.alternate,D!==null&&(D.return=null),A.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)Ng(u,a),u=u.sibling}var ju=null;function Ng(a,u){var g=a.alternate,b=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Pl(u,a),yl(a),b&4&&(Gc(3,a,a.return),Jc(3,a),Gc(5,a,a.return));break;case 1:Pl(u,a),yl(a),b&512&&(to||g===null||ac(g,g.return)),b&64&&ko&&(a=a.updateQueue,a!==null&&(b=a.callbacks,b!==null&&(g=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=g===null?b:g.concat(b))));break;case 26:var A=ju;if(Pl(u,a),yl(a),b&512&&(to||g===null||ac(g,g.return)),b&4){var D=g!==null?g.memoizedState:null;if(b=a.memoizedState,g===null)if(b===null)if(a.stateNode===null){t:{b=a.type,g=a.memoizedProps,A=A.ownerDocument||A;e:switch(b){case"title":D=A.getElementsByTagName("title")[0],(!D||D[Fn]||D[$t]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=A.createElement(b),A.head.insertBefore(D,A.querySelector("head > title"))),ga(D,b,g),D[$t]=a,_i(D),b=D;break t;case"link":var K=gm("link","href",A).get(b+(g.href||""));if(K){for(var bt=0;bt<K.length;bt++)if(D=K[bt],D.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&D.getAttribute("rel")===(g.rel==null?null:g.rel)&&D.getAttribute("title")===(g.title==null?null:g.title)&&D.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){K.splice(bt,1);break e}}D=A.createElement(b),ga(D,b,g),A.head.appendChild(D);break;case"meta":if(K=gm("meta","content",A).get(b+(g.content||""))){for(bt=0;bt<K.length;bt++)if(D=K[bt],D.getAttribute("content")===(g.content==null?null:""+g.content)&&D.getAttribute("name")===(g.name==null?null:g.name)&&D.getAttribute("property")===(g.property==null?null:g.property)&&D.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&D.getAttribute("charset")===(g.charSet==null?null:g.charSet)){K.splice(bt,1);break e}}D=A.createElement(b),ga(D,b,g),A.head.appendChild(D);break;default:throw Error(T(468,b))}D[$t]=a,_i(D),b=D}a.stateNode=b}else mm(A,a.type,a.stateNode);else a.stateNode=Kp(A,b,a.memoizedProps);else D!==b?(D===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):D.count--,b===null?mm(A,a.type,a.stateNode):Kp(A,b,a.memoizedProps)):b===null&&a.stateNode!==null&&Kc(a,a.memoizedProps,g.memoizedProps)}break;case 27:Pl(u,a),yl(a),b&512&&(to||g===null||ac(g,g.return)),g!==null&&b&4&&Kc(a,a.memoizedProps,g.memoizedProps);break;case 5:if(Pl(u,a),yl(a),b&512&&(to||g===null||ac(g,g.return)),a.flags&32){A=a.stateNode;try{Ht(A,"")}catch(ti){rs(a,a.return,ti)}}b&4&&a.stateNode!=null&&(A=a.memoizedProps,Kc(a,A,g!==null?g.memoizedProps:A)),b&1024&&(Aa=!0);break;case 6:if(Pl(u,a),yl(a),b&4){if(a.stateNode===null)throw Error(T(162));b=a.memoizedProps,g=a.stateNode;try{g.nodeValue=b}catch(ti){rs(a,a.return,ti)}}break;case 3:if(jd=null,A=ju,ju=gf(u.containerInfo),Pl(u,a),ju=A,yl(a),b&4&&g!==null&&g.memoizedState.isDehydrated)try{kh(u.containerInfo)}catch(ti){rs(a,a.return,ti)}Aa&&(Aa=!1,Td(a));break;case 4:b=ju,ju=gf(a.stateNode.containerInfo),Pl(u,a),yl(a),ju=b;break;case 12:Pl(u,a),yl(a);break;case 31:Pl(u,a),yl(a),b&4&&(b=a.updateQueue,b!==null&&(a.updateQueue=null,Yf(a,b)));break;case 13:Pl(u,a),yl(a),a.child.flags&8192&&a.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Ih=Ri()),b&4&&(b=a.updateQueue,b!==null&&(a.updateQueue=null,Yf(a,b)));break;case 22:A=a.memoizedState!==null;var ee=g!==null&&g.memoizedState!==null,Le=ko,He=to;if(ko=Le||A,to=He||ee,Pl(u,a),to=He,ko=Le,yl(a),b&8192)t:for(u=a.stateNode,u._visibility=A?u._visibility&-2:u._visibility|1,A&&(g===null||ee||ko||to||Eo(a)),g=null,u=a;;){if(u.tag===5||u.tag===26){if(g===null){ee=g=u;try{if(D=ee.stateNode,A)K=D.style,typeof K.setProperty=="function"?K.setProperty("display","none","important"):K.display="none";else{bt=ee.stateNode;var ln=ee.memoizedProps.style,ze=ln!=null&&ln.hasOwnProperty("display")?ln.display:null;bt.style.display=ze==null||typeof ze=="boolean"?"":(""+ze).trim()}}catch(ti){rs(ee,ee.return,ti)}}}else if(u.tag===6){if(g===null){ee=u;try{ee.stateNode.nodeValue=A?"":ee.memoizedProps}catch(ti){rs(ee,ee.return,ti)}}}else if(u.tag===18){if(g===null){ee=u;try{var Ue=ee.stateNode;A?am(Ue,!0):am(ee.stateNode,!1)}catch(ti){rs(ee,ee.return,ti)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===a)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break t;for(;u.sibling===null;){if(u.return===null||u.return===a)break t;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}b&4&&(b=a.updateQueue,b!==null&&(g=b.retryQueue,g!==null&&(b.retryQueue=null,Yf(a,g))));break;case 19:Pl(u,a),yl(a),b&4&&(b=a.updateQueue,b!==null&&(a.updateQueue=null,Yf(a,b)));break;case 30:break;case 21:break;default:Pl(u,a),yl(a)}}function yl(a){var u=a.flags;if(u&2){try{for(var g,b=a.return;b!==null;){if(wc(b)){g=b;break}b=b.return}if(g==null)throw Error(T(160));switch(g.tag){case 27:var A=g.stateNode,D=Hf(a);Qc(a,D,A);break;case 5:var K=g.stateNode;g.flags&32&&(Ht(K,""),g.flags&=-33);var bt=Hf(a);Qc(a,bt,K);break;case 3:case 4:var ee=g.stateNode.containerInfo,Le=Hf(a);Sd(a,Le,ee);break;default:throw Error(T(161))}}catch(He){rs(a,a.return,He)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function Td(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var u=a;Td(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),a=a.sibling}}function lc(a,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Mp(a,u.alternate,u),u=u.sibling}function Eo(a){for(a=a.child;a!==null;){var u=a;switch(u.tag){case 0:case 11:case 14:case 15:Gc(4,u,u.return),Eo(u);break;case 1:ac(u,u.return);var g=u.stateNode;typeof g.componentWillUnmount=="function"&&Rg(u,u.return,g),Eo(u);break;case 27:od(u.stateNode);case 26:case 5:ac(u,u.return),Eo(u);break;case 22:u.memoizedState===null&&Eo(u);break;case 30:Eo(u);break;default:Eo(u)}a=a.sibling}}function Ec(a,u,g){for(g=g&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var b=u.alternate,A=a,D=u,K=D.flags;switch(D.tag){case 0:case 11:case 15:Ec(A,D,g),Jc(4,D);break;case 1:if(Ec(A,D,g),b=D,A=b.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Le){rs(b,b.return,Le)}if(b=D,A=b.updateQueue,A!==null){var bt=b.stateNode;try{var ee=A.shared.hiddenCallbacks;if(ee!==null)for(A.shared.hiddenCallbacks=null,A=0;A<ee.length;A++)Rt(ee[A],bt)}catch(Le){rs(b,b.return,Le)}}g&&K&64&&Ip(D),Sh(D,D.return);break;case 27:Yh(D);case 26:case 5:Ec(A,D,g),g&&b===null&&K&4&&Hh(D),Sh(D,D.return);break;case 12:Ec(A,D,g);break;case 31:Ec(A,D,g),g&&K&4&&Lp(A,D);break;case 13:Ec(A,D,g),g&&K&4&&th(A,D);break;case 22:D.memoizedState===null&&Ec(A,D,g),Sh(D,D.return);break;case 30:break;default:Ec(A,D,g)}u=u.sibling}}function Rp(a,u){var g=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),a=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(a=u.memoizedState.cachePool.pool),a!==g&&(a!=null&&a.refCount++,g!=null&&Ll(g))}function Cd(a,u){a=null,u.alternate!==null&&(a=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==a&&(u.refCount++,a!=null&&Ll(a))}function uc(a,u,g,b){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Og(a,u,g,b),u=u.sibling}function Og(a,u,g,b){var A=u.flags;switch(u.tag){case 0:case 11:case 15:uc(a,u,g,b),A&2048&&Jc(9,u);break;case 1:uc(a,u,g,b);break;case 3:uc(a,u,g,b),A&2048&&(a=null,u.alternate!==null&&(a=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==a&&(u.refCount++,a!=null&&Ll(a)));break;case 12:if(A&2048){uc(a,u,g,b),a=u.stateNode;try{var D=u.memoizedProps,K=D.id,bt=D.onPostCommit;typeof bt=="function"&&bt(K,u.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ee){rs(u,u.return,ee)}}else uc(a,u,g,b);break;case 31:uc(a,u,g,b);break;case 13:uc(a,u,g,b);break;case 23:break;case 22:D=u.stateNode,K=u.alternate,u.memoizedState!==null?D._visibility&2?uc(a,u,g,b):$h(a,u):D._visibility&2?uc(a,u,g,b):(D._visibility|=2,Th(a,u,g,b,(u.subtreeFlags&10256)!==0||!1)),A&2048&&Rp(K,u);break;case 24:uc(a,u,g,b),A&2048&&Cd(u.alternate,u);break;default:uc(a,u,g,b)}}function Th(a,u,g,b,A){for(A=A&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var D=a,K=u,bt=g,ee=b,Le=K.flags;switch(K.tag){case 0:case 11:case 15:Th(D,K,bt,ee,A),Jc(8,K);break;case 23:break;case 22:var He=K.stateNode;K.memoizedState!==null?He._visibility&2?Th(D,K,bt,ee,A):$h(D,K):(He._visibility|=2,Th(D,K,bt,ee,A)),A&&Le&2048&&Rp(K.alternate,K);break;case 24:Th(D,K,bt,ee,A),A&&Le&2048&&Cd(K.alternate,K);break;default:Th(D,K,bt,ee,A)}u=u.sibling}}function $h(a,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var g=a,b=u,A=b.flags;switch(b.tag){case 22:$h(g,b),A&2048&&Rp(b.alternate,b);break;case 24:$h(g,b),A&2048&&Cd(b.alternate,b);break;default:$h(g,b)}u=u.sibling}}var Jh=8192;function eh(a,u,g){if(a.subtreeFlags&Jh)for(a=a.child;a!==null;)Sc(a,u,g),a=a.sibling}function Sc(a,u,g){switch(a.tag){case 26:eh(a,u,g),a.flags&Jh&&a.memoizedState!==null&&tg(g,ju,a.memoizedState,a.memoizedProps);break;case 5:eh(a,u,g);break;case 3:case 4:var b=ju;ju=gf(a.stateNode.containerInfo),eh(a,u,g),ju=b;break;case 22:a.memoizedState===null&&(b=a.alternate,b!==null&&b.memoizedState!==null?(b=Jh,Jh=16777216,eh(a,u,g),Jh=b):eh(a,u,g));break;default:eh(a,u,g)}}function Bl(a){var u=a.alternate;if(u!==null&&(a=u.child,a!==null)){u.child=null;do u=a.sibling,a.sibling=null,a=u;while(a!==null)}}function Wf(a){var u=a.deletions;if((a.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var b=u[g];Qo=b,zg(b,a)}Bl(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Id(a),a=a.sibling}function Id(a){switch(a.tag){case 0:case 11:case 15:Wf(a),a.flags&2048&&Gc(9,a,a.return);break;case 3:Wf(a);break;case 12:Wf(a);break;case 22:var u=a.stateNode;a.memoizedState!==null&&u._visibility&2&&(a.return===null||a.return.tag!==13)?(u._visibility&=-3,Md(a)):Wf(a);break;default:Wf(a)}}function Md(a){var u=a.deletions;if((a.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var b=u[g];Qo=b,zg(b,a)}Bl(a)}for(a=a.child;a!==null;){switch(u=a,u.tag){case 0:case 11:case 15:Gc(8,u,u.return),Md(u);break;case 22:g=u.stateNode,g._visibility&2&&(g._visibility&=-3,Md(u));break;default:Md(u)}a=a.sibling}}function zg(a,u){for(;Qo!==null;){var g=Qo;switch(g.tag){case 0:case 11:case 15:Gc(8,g,u);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var b=g.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Ll(g.memoizedState.cache)}if(b=g.child,b!==null)b.return=g,Qo=b;else t:for(g=a;Qo!==null;){b=Qo;var A=b.sibling,D=b.return;if(Wh(b),b===g){Qo=null;break t}if(A!==null){A.return=D,Qo=A;break t}Qo=D}}}var jm={getCacheForType:function(a){var u=dn(as),g=u.data.get(a);return g===void 0&&(g=a(),u.data.set(a,g)),g},cacheSignal:function(){return dn(as).controller.signal}},$f=typeof WeakMap=="function"?WeakMap:Map,Lr=0,vs=null,Hi=null,ir=0,ls=0,Lu=null,nh=!1,Kh=!1,Dp=!1,qc=0,So=0,Tc=0,Ch=0,ih=0,Ru=0,xs=0,rh=null,Fl=null,Qh=!1,Ih=0,tf=0,Jf=1/0,Kf=null,Xu=null,Uo=0,Cc=null,ef=null,Ic=0,Mh=0,Np=null,Ad=null,Qf=0,td=null;function kl(){return(Lr&2)!==0&&ir!==0?ir&-ir:ct.T!==null?Fp():Kt()}function ed(){if(Ru===0)if((ir&536870912)===0||Mi){var a=ya;ya<<=1,(ya&3932160)===0&&(ya=262144),Ru=a}else Ru=536870912;return a=Ee.current,a!==null&&(a.flags|=32),Ru}function ru(a,u,g){(a===vs&&(ls===2||ls===9)||a.cancelPendingCommit!==null)&&(rf(a,0),sh(a,ir,Ru,!1)),Zr(a,g),((Lr&2)===0||a!==vs)&&(a===vs&&((Lr&2)===0&&(Ch|=g),So===4&&sh(a,ir,Ru,!1)),su(a))}function Pg(a,u,g){if((Lr&6)!==0)throw Error(T(327));var b=!g&&(u&127)===0&&(u&a.expiredLanes)===0||Ds(a,u),A=b?Zm(a,u):Dd(a,u,!0),D=b;do{if(A===0){Kh&&!b&&sh(a,u,0,!1);break}else{if(g=a.current.alternate,D&&!Xm(g)){A=Dd(a,u,!1),D=!1;continue}if(A===2){if(D=u,a.errorRecoveryDisabledLanes&D)var K=0;else K=a.pendingLanes&-536870913,K=K!==0?K:K&536870912?536870912:0;if(K!==0){u=K;t:{var bt=a;A=rh;var ee=bt.current.memoizedState.isDehydrated;if(ee&&(rf(bt,K).flags|=256),K=Dd(bt,K,!1),K!==2){if(Dp&&!ee){bt.errorRecoveryDisabledLanes|=D,Ch|=D,A=4;break t}D=Fl,Fl=A,D!==null&&(Fl===null?Fl=D:Fl.push.apply(Fl,D))}A=K}if(D=!1,A!==2)continue}}if(A===1){rf(a,0),sh(a,u,0,!0);break}t:{switch(b=a,D=A,D){case 0:case 1:throw Error(T(345));case 4:if((u&4194048)!==u)break;case 6:sh(b,u,Ru,!nh);break t;case 2:Fl=null;break;case 3:case 5:break;default:throw Error(T(329))}if((u&62914560)===u&&(A=Ih+300-Ri(),10<A)){if(sh(b,u,Ru,!nh),oi(b,0,!0)!==0)break t;Ic=u,b.timeoutHandle=rm(Bg.bind(null,b,g,Fl,Kf,Qh,u,Ru,Ch,xs,nh,D,"Throttled",-0,0),A);break t}Bg(b,g,Fl,Kf,Qh,u,Ru,Ch,xs,nh,D,null,-0,0)}}break}while(!0);su(a)}function Bg(a,u,g,b,A,D,K,bt,ee,Le,He,ln,ze,Ue){if(a.timeoutHandle=-1,ln=u.subtreeFlags,ln&8192||(ln&16785408)===16785408){ln={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Qe},Sc(u,D,ln);var ti=(D&62914560)===D?Ih-Ri():(D&4194048)===D?tf-Ri():0;if(ti=ym(ln,ti),ti!==null){Ic=D,a.cancelPendingCommit=ti(qg.bind(null,a,u,D,g,b,A,K,bt,ee,He,ln,null,ze,Ue)),sh(a,D,K,!Le);return}}qg(a,u,D,g,b,A,K,bt,ee)}function Xm(a){for(var u=a;;){var g=u.tag;if((g===0||g===11||g===15)&&u.flags&16384&&(g=u.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var b=0;b<g.length;b++){var A=g[b],D=A.getSnapshot;A=A.value;try{if(!tr(D(),A))return!1}catch{return!1}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function sh(a,u,g,b){u&=~ih,u&=~Ch,a.suspendedLanes|=u,a.pingedLanes&=~u,b&&(a.warmLanes|=u),b=a.expirationTimes;for(var A=u;0<A;){var D=31-_r(A),K=1<<D;b[D]=-1,A&=~K}g!==0&&Ct(a,g,u)}function Ld(){return(Lr&6)===0?(lf(0),!1):!0}function nf(){if(Hi!==null){if(ls===0)var a=Hi.return;else a=Hi,Oo=Ml=null,Is(a),m=null,o=0,a=Hi;for(;a!==null;)Ed(a.alternate,a),a=a.return;Hi=null}}function rf(a,u){var g=a.timeoutHandle;g!==-1&&(a.timeoutHandle=-1,ry(g)),g=a.cancelPendingCommit,g!==null&&(a.cancelPendingCommit=null,g()),Ic=0,nf(),vs=a,Hi=g=gs(a.current,null),ir=u,ls=0,Lu=null,nh=!1,Kh=Ds(a,u),Dp=!1,xs=Ru=ih=Ch=Tc=So=0,Fl=rh=null,Qh=!1,(u&8)!==0&&(u|=u&32);var b=a.entangledLanes;if(b!==0)for(a=a.entanglements,b&=u;0<b;){var A=31-_r(b),D=1<<A;u|=a[A],b&=~D}return qc=u,Fu(),g}function Op(a,u){Fe=null,ct.H=kf,u===dl||u===Dl?(u=Nl(),ls=3):u===Eu?(u=Nl(),ls=4):ls=u===Uf?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Lu=u,Hi===null&&(So=1,ml(a,oo(u,a.current)))}function Ah(){var a=Ee.current;return a===null?!0:(ir&4194048)===ir?xe===null:(ir&62914560)===ir||(ir&536870912)!==0?a===xe:!1}function Fg(){var a=ct.H;return ct.H=kf,a===null?kf:a}function kg(){var a=ct.A;return ct.A=jm,a}function Rd(){So=4,nh||(ir&4194048)!==ir&&Ee.current!==null||(Kh=!0),(Tc&134217727)===0&&(Ch&134217727)===0||vs===null||sh(vs,ir,Ru,!1)}function Dd(a,u,g){var b=Lr;Lr|=2;var A=Fg(),D=kg();(vs!==a||ir!==u)&&(Kf=null,rf(a,u)),u=!1;var K=So;t:do try{if(ls!==0&&Hi!==null){var bt=Hi,ee=Lu;switch(ls){case 8:nf(),K=6;break t;case 3:case 2:case 9:case 6:Ee.current===null&&(u=!0);var Le=ls;if(ls=0,Lu=null,jc(a,bt,ee,Le),g&&Kh){K=0;break t}break;default:Le=ls,ls=0,Lu=null,jc(a,bt,ee,Le)}}Ug(),K=So;break}catch(He){Op(a,He)}while(!0);return u&&a.shellSuspendCounter++,Oo=Ml=null,Lr=b,ct.H=A,ct.A=D,Hi===null&&(vs=null,ir=0,Fu()),K}function Ug(){for(;Hi!==null;)Gg(Hi)}function Zm(a,u){var g=Lr;Lr|=2;var b=Fg(),A=kg();vs!==a||ir!==u?(Kf=null,Jf=Ri()+500,rf(a,u)):Kh=Ds(a,u);t:do try{if(ls!==0&&Hi!==null){u=Hi;var D=Lu;e:switch(ls){case 1:ls=0,Lu=null,jc(a,u,D,1);break;case 2:case 9:if(Vu(D)){ls=0,Lu=null,Nd(u);break}u=function(){ls!==2&&ls!==9||vs!==a||(ls=7),su(a)},D.then(u,u);break t;case 3:ls=7;break t;case 4:ls=5;break t;case 7:Vu(D)?(ls=0,Lu=null,Nd(u)):(ls=0,Lu=null,jc(a,u,D,7));break;case 5:var K=null;switch(Hi.tag){case 26:K=Hi.memoizedState;case 5:case 27:var bt=Hi;if(K?Ph(K):bt.stateNode.complete){ls=0,Lu=null;var ee=bt.sibling;if(ee!==null)Hi=ee;else{var Le=bt.return;Le!==null?(Hi=Le,Lh(Le)):Hi=null}break e}}ls=0,Lu=null,jc(a,u,D,5);break;case 6:ls=0,Lu=null,jc(a,u,D,6);break;case 8:nf(),So=6;break t;default:throw Error(T(462))}}Hm();break}catch(He){Op(a,He)}while(!0);return Oo=Ml=null,ct.H=b,ct.A=A,Lr=g,Hi!==null?0:(vs=null,ir=0,Fu(),So)}function Hm(){for(;Hi!==null&&!Wa();)Gg(Hi)}function Gg(a){var u=Xf(a.alternate,a,qc);a.memoizedProps=a.pendingProps,u===null?Lh(a):Hi=u}function Nd(a){var u=a,g=u.alternate;switch(u.tag){case 15:case 0:u=xp(g,u,u.pendingProps,u.type,void 0,ir);break;case 11:u=xp(g,u,u.pendingProps,u.type.render,u.ref,ir);break;case 5:Is(u);default:Ed(g,u),u=Hi=yu(u,qc),u=Xf(g,u,qc)}a.memoizedProps=a.pendingProps,u===null?Lh(a):Hi=u}function jc(a,u,g,b){Oo=Ml=null,Is(u),m=null,o=0;var A=u.return;try{if(Xh(a,A,u,g,ir)){So=1,ml(a,oo(g,a.current)),Hi=null;return}}catch(D){if(A!==null)throw Hi=A,D;So=1,ml(a,oo(g,a.current)),Hi=null;return}u.flags&32768?(Mi||b===1?a=!0:Kh||(ir&536870912)!==0?a=!1:(nh=a=!0,(b===2||b===9||b===3||b===6)&&(b=Ee.current,b!==null&&b.tag===13&&(b.flags|=16384))),Vg(u,a)):Lh(u)}function Lh(a){var u=a;do{if((u.flags&32768)!==0){Vg(u,nh);return}a=u.return;var g=Zf(u.alternate,u,qc);if(g!==null){Hi=g;return}if(u=u.sibling,u!==null){Hi=u;return}Hi=u=a}while(u!==null);So===0&&(So=5)}function Vg(a,u){do{var g=Eh(a.alternate,a);if(g!==null){g.flags&=32767,Hi=g;return}if(g=a.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!u&&(a=a.sibling,a!==null)){Hi=a;return}Hi=a=g}while(a!==null);So=6,Hi=null}function qg(a,u,g,b,A,D,K,bt,ee){a.cancelPendingCommit=null;do nd();while(Uo!==0);if((Lr&6)!==0)throw Error(T(327));if(u!==null){if(u===a.current)throw Error(T(177));if(D=u.lanes|u.childLanes,D|=es,Yi(a,g,D,K,bt,ee),a===vs&&(Hi=vs=null,ir=0),ef=u,Cc=a,Ic=g,Mh=D,Np=A,Ad=b,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,Wm(hs,function(){return jg(),null})):(a.callbackNode=null,a.callbackPriority=0),b=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||b){b=ct.T,ct.T=null,A=kt.p,kt.p=2,K=Lr,Lr|=4;try{wo(a,u,g)}finally{Lr=K,kt.p=A,ct.T=b}}Uo=1,sf(),of(),zp()}}function sf(){if(Uo===1){Uo=0;var a=Cc,u=ef,g=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||g){g=ct.T,ct.T=null;var b=kt.p;kt.p=2;var A=Lr;Lr|=4;try{Ng(u,a);var D=Ud,K=ps(a.containerInfo),bt=D.focusedElem,ee=D.selectionRange;if(K!==bt&&bt&&bt.ownerDocument&&Gs(bt.ownerDocument.documentElement,bt)){if(ee!==null&&Ba(bt)){var Le=ee.start,He=ee.end;if(He===void 0&&(He=Le),"selectionStart"in bt)bt.selectionStart=Le,bt.selectionEnd=Math.min(He,bt.value.length);else{var ln=bt.ownerDocument||document,ze=ln&&ln.defaultView||window;if(ze.getSelection){var Ue=ze.getSelection(),ti=bt.textContent.length,Si=Math.min(ee.start,ti),bs=ee.end===void 0?Si:Math.min(ee.end,ti);!Ue.extend&&Si>bs&&(K=bs,bs=Si,Si=K);var Te=wa(bt,Si),he=wa(bt,bs);if(Te&&he&&(Ue.rangeCount!==1||Ue.anchorNode!==Te.node||Ue.anchorOffset!==Te.offset||Ue.focusNode!==he.node||Ue.focusOffset!==he.offset)){var Re=ln.createRange();Re.setStart(Te.node,Te.offset),Ue.removeAllRanges(),Si>bs?(Ue.addRange(Re),Ue.extend(he.node,he.offset)):(Re.setEnd(he.node,he.offset),Ue.addRange(Re))}}}}for(ln=[],Ue=bt;Ue=Ue.parentNode;)Ue.nodeType===1&&ln.push({element:Ue,left:Ue.scrollLeft,top:Ue.scrollTop});for(typeof bt.focus=="function"&&bt.focus(),bt=0;bt<ln.length;bt++){var sn=ln[bt];sn.element.scrollLeft=sn.left,sn.element.scrollTop=sn.top}}Hu=!!oh,Ud=oh=null}finally{Lr=A,kt.p=b,ct.T=g}}a.current=u,Uo=2}}function of(){if(Uo===2){Uo=0;var a=Cc,u=ef,g=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||g){g=ct.T,ct.T=null;var b=kt.p;kt.p=2;var A=Lr;Lr|=4;try{Mp(a,u.alternate,u)}finally{Lr=A,kt.p=b,ct.T=g}}Uo=3}}function zp(){if(Uo===4||Uo===3){Uo=0,eo();var a=Cc,u=ef,g=Ic,b=Ad;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Uo=5:(Uo=0,ef=Cc=null,af(a,a.pendingLanes));var A=a.pendingLanes;if(A===0&&(Xu=null),Pt(g),u=u.stateNode,Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(Ki,u,void 0,(u.current.flags&128)===128)}catch{}if(b!==null){u=ct.T,A=kt.p,kt.p=2,ct.T=null;try{for(var D=a.onRecoverableError,K=0;K<b.length;K++){var bt=b[K];D(bt.value,{componentStack:bt.stack})}}finally{ct.T=u,kt.p=A}}(Ic&3)!==0&&nd(),su(a),A=a.pendingLanes,(g&261930)!==0&&(A&42)!==0?a===td?Qf++:(Qf=0,td=a):Qf=0,lf(0)}}function af(a,u){(a.pooledCacheLanes&=u)===0&&(u=a.pooledCache,u!=null&&(a.pooledCache=null,Ll(u)))}function nd(){return sf(),of(),zp(),jg()}function jg(){if(Uo!==5)return!1;var a=Cc,u=Mh;Mh=0;var g=Pt(Ic),b=ct.T,A=kt.p;try{kt.p=32>g?32:g,ct.T=null,g=Np,Np=null;var D=Cc,K=Ic;if(Uo=0,ef=Cc=null,Ic=0,(Lr&6)!==0)throw Error(T(331));var bt=Lr;if(Lr|=4,Id(D.current),Og(D,D.current,K,g),Lr=bt,lf(0,!1),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(Ki,D)}catch{}return!0}finally{kt.p=A,ct.T=b,af(a,u)}}function Pp(a,u,g){u=oo(g,u),u=_d(a.stateNode,u,2),a=dt(a,u,2),a!==null&&(Zr(a,2),su(a))}function rs(a,u,g){if(a.tag===3)Pp(a,a,g);else for(;u!==null;){if(u.tag===3){Pp(u,a,g);break}else if(u.tag===1){var b=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(Xu===null||!Xu.has(b))){a=oo(g,a),g=oc(2),b=dt(u,g,2),b!==null&&(mp(g,b,u,a),Zr(b,2),su(b));break}}u=u.return}}function Od(a,u,g){var b=a.pingCache;if(b===null){b=a.pingCache=new $f;var A=new Set;b.set(u,A)}else A=b.get(u),A===void 0&&(A=new Set,b.set(u,A));A.has(g)||(Dp=!0,A.add(g),a=Xg.bind(null,a,u,g),u.then(a,a))}function Xg(a,u,g){var b=a.pingCache;b!==null&&b.delete(u),a.pingedLanes|=a.suspendedLanes&g,a.warmLanes&=~g,vs===a&&(ir&g)===g&&(So===4||So===3&&(ir&62914560)===ir&&300>Ri()-Ih?(Lr&2)===0&&rf(a,0):ih|=g,xs===ir&&(xs=0)),su(a)}function Bp(a,u){u===0&&(u=ts()),a=al(a,u),a!==null&&(Zr(a,u),su(a))}function Zg(a){var u=a.memoizedState,g=0;u!==null&&(g=u.retryLane),Bp(a,g)}function Ym(a,u){var g=0;switch(a.tag){case 31:case 13:var b=a.stateNode,A=a.memoizedState;A!==null&&(g=A.retryLane);break;case 19:b=a.stateNode;break;case 22:b=a.stateNode._retryCache;break;default:throw Error(T(314))}b!==null&&b.delete(u),Bp(a,g)}function Wm(a,u){return vi(a,u)}var id=null,Xc=null,zd=!1,pa=!1,Rh=!1,Du=0;function su(a){a!==Xc&&a.next===null&&(Xc===null?id=Xc=a:Xc=Xc.next=a),pa=!0,zd||(zd=!0,$m())}function lf(a,u){if(!Rh&&pa){Rh=!0;do for(var g=!1,b=id;b!==null;){if(a!==0){var A=b.pendingLanes;if(A===0)var D=0;else{var K=b.suspendedLanes,bt=b.pingedLanes;D=(1<<31-_r(42|a)+1)-1,D&=A&~(K&~bt),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(g=!0,Jg(b,D))}else D=ir,D=oi(b,b===vs?D:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(D&3)===0||Ds(b,D)||(g=!0,Jg(b,D));b=b.next}while(g);Rh=!1}}function Hg(){Yg()}function Yg(){pa=zd=!1;var a=0;Du!==0&&iy()&&(a=Du);for(var u=Ri(),g=null,b=id;b!==null;){var A=b.next,D=Wg(b,u);D===0?(b.next=null,g===null?id=A:g.next=A,A===null&&(Xc=g)):(g=b,(a!==0||(D&3)!==0)&&(pa=!0)),b=A}Uo!==0&&Uo!==5||lf(a),Du!==0&&(Du=0)}function Wg(a,u){for(var g=a.suspendedLanes,b=a.pingedLanes,A=a.expirationTimes,D=a.pendingLanes&-62914561;0<D;){var K=31-_r(D),bt=1<<K,ee=A[K];ee===-1?((bt&g)===0||(bt&b)!==0)&&(A[K]=rr(bt,u)):ee<=u&&(a.expiredLanes|=bt),D&=~bt}if(u=vs,g=ir,g=oi(a,a===u?g:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),b=a.callbackNode,g===0||a===u&&(ls===2||ls===9)||a.cancelPendingCommit!==null)return b!==null&&b!==null&&Us(b),a.callbackNode=null,a.callbackPriority=0;if((g&3)===0||Ds(a,g)){if(u=g&-g,u===a.callbackPriority)return u;switch(b!==null&&Us(b),Pt(g)){case 2:case 8:g=Qr;break;case 32:g=hs;break;case 268435456:g=yr;break;default:g=hs}return b=$g.bind(null,a),g=vi(g,b),a.callbackPriority=u,a.callbackNode=g,u}return b!==null&&b!==null&&Us(b),a.callbackPriority=2,a.callbackNode=null,2}function $g(a,u){if(Uo!==0&&Uo!==5)return a.callbackNode=null,a.callbackPriority=0,null;var g=a.callbackNode;if(nd()&&a.callbackNode!==g)return null;var b=ir;return b=oi(a,a===vs?b:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),b===0?null:(Pg(a,b,u),Wg(a,Ri()),a.callbackNode!=null&&a.callbackNode===g?$g.bind(null,a):null)}function Jg(a,u){if(nd())return null;Pg(a,u,!0)}function $m(){Vd(function(){(Lr&6)!==0?vi(ql,Hg):Yg()})}function Fp(){if(Du===0){var a=Rl;a===0&&(a=vl,vl<<=1,(vl&261888)===0&&(vl=256)),Du=a}return Du}function rd(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:we(""+a)}function Kg(a,u){var g=u.ownerDocument.createElement("input");return g.name=u.name,g.value=u.value,a.id&&g.setAttribute("form",a.id),u.parentNode.insertBefore(g,u),a=new FormData(a),g.parentNode.removeChild(g),a}function Qg(a,u,g,b,A){if(u==="submit"&&g&&g.stateNode===A){var D=rd((A[me]||null).action),K=b.submitter;K&&(u=(u=K[me]||null)?rd(u.formAction):K.getAttribute("formAction"),u!==null&&(D=u,K=null));var bt=new ho("action","action",null,b,A);a.push({event:bt,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(Du!==0){var ee=K?Kg(A,K):new FormData(A);yh(g,{pending:!0,data:ee,method:A.method,action:D},null,ee)}}else typeof D=="function"&&(bt.preventDefault(),ee=K?Kg(A,K):new FormData(A),yh(g,{pending:!0,data:ee,method:A.method,action:D},D,ee))},currentTarget:A}]})}}for(var Pd=0;Pd<_o.length;Pd++){var Bd=_o[Pd],Jm=Bd.toLowerCase(),Km=Bd[0].toUpperCase()+Bd.slice(1);In(Jm,"on"+Km)}In(Wl,"onAnimationEnd"),In(il,"onAnimationIteration"),In(yo,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In($l,"onTransitionRun"),In(rl,"onTransitionStart"),In(Ea,"onTransitionCancel"),In(Wo,"onTransitionEnd"),Hr("onMouseEnter",["mouseout","mouseover"]),Hr("onMouseLeave",["mouseout","mouseover"]),Hr("onPointerEnter",["pointerout","pointerover"]),Hr("onPointerLeave",["pointerout","pointerover"]),_e("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_e("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_e("onBeforeInput",["compositionend","keypress","textInput","paste"]),_e("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_e("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_e("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sd));function tm(a,u){u=(u&4)!==0;for(var g=0;g<a.length;g++){var b=a[g],A=b.event;b=b.listeners;t:{var D=void 0;if(u)for(var K=b.length-1;0<=K;K--){var bt=b[K],ee=bt.instance,Le=bt.currentTarget;if(bt=bt.listener,ee!==D&&A.isPropagationStopped())break t;D=bt,A.currentTarget=Le;try{D(A)}catch(He){so(He)}A.currentTarget=null,D=ee}else for(K=0;K<b.length;K++){if(bt=b[K],ee=bt.instance,Le=bt.currentTarget,bt=bt.listener,ee!==D&&A.isPropagationStopped())break t;D=bt,A.currentTarget=Le;try{D(A)}catch(He){so(He)}A.currentTarget=null,D=ee}}}}function dr(a,u){var g=u[yn];g===void 0&&(g=u[yn]=new Set);var b=a+"__bubble";g.has(b)||(Fd(u,a,2,!1),g.add(b))}function kp(a,u,g){var b=0;u&&(b|=4),Fd(g,a,b,u)}var Go="_reactListening"+Math.random().toString(36).slice(2);function Zu(a){if(!a[Go]){a[Go]=!0,Ra.forEach(function(g){g!=="selectionchange"&&(Qm.has(g)||kp(g,!1,a),kp(g,!0,a))});var u=a.nodeType===9?a:a.ownerDocument;u===null||u[Go]||(u[Go]=!0,kp("selectionchange",!1,u))}}function Fd(a,u,g,b){switch(sg(u)){case 2:var A=ig;break;case 8:A=Ef;break;default:A=uh}g=A.bind(null,u,g,a),A=void 0,!xn||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(A=!0),b?A!==void 0?a.addEventListener(u,g,{capture:!0,passive:A}):a.addEventListener(u,g,!0):A!==void 0?a.addEventListener(u,g,{passive:A}):a.addEventListener(u,g,!1)}function uf(a,u,g,b,A){var D=b;if((u&1)===0&&(u&2)===0&&b!==null)t:for(;;){if(b===null)return;var K=b.tag;if(K===3||K===4){var bt=b.stateNode.containerInfo;if(bt===A)break;if(K===4)for(K=b.return;K!==null;){var ee=K.tag;if((ee===3||ee===4)&&K.stateNode.containerInfo===A)return;K=K.return}for(;bt!==null;){if(K=fi(bt),K===null)return;if(ee=K.tag,ee===5||ee===6||ee===26||ee===27){b=D=K;continue t}bt=bt.parentNode}}b=b.return}kn(function(){var Le=D,He=Yn(g),ln=[];t:{var ze=sl.get(a);if(ze!==void 0){var Ue=ho,ti=a;switch(a){case"keypress":if(Da(g)===0)break t;case"keydown":case"keyup":Ue=Ao;break;case"focusin":ti="focus",Ue=Ke;break;case"focusout":ti="blur",Ue=Ke;break;case"beforeblur":case"afterblur":Ue=Ke;break;case"click":if(g.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=Os;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=Qa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=po;break;case Wl:case il:case yo:Ue=wr;break;case Wo:Ue=xa;break;case"scroll":case"scrollend":Ue=io;break;case"wheel":Ue=bl;break;case"copy":case"cut":case"paste":Ue=Xo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=Zl;break;case"toggle":case"beforetoggle":Ue=wl}var Si=(u&4)!==0,bs=!Si&&(a==="scroll"||a==="scrollend"),Te=Si?ze!==null?ze+"Capture":null:ze;Si=[];for(var he=Le,Re;he!==null;){var sn=he;if(Re=sn.stateNode,sn=sn.tag,sn!==5&&sn!==26&&sn!==27||Re===null||Te===null||(sn=Xi(he,Te),sn!=null&&Si.push(Mc(he,sn,Re))),bs)break;he=he.return}0<Si.length&&(ze=new Ue(ze,ti,null,g,He),ln.push({event:ze,listeners:Si}))}}if((u&7)===0){t:{if(ze=a==="mouseover"||a==="pointerover",Ue=a==="mouseout"||a==="pointerout",ze&&g!==Tn&&(ti=g.relatedTarget||g.fromElement)&&(fi(ti)||ti[je]))break t;if((Ue||ze)&&(ze=He.window===He?He:(ze=He.ownerDocument)?ze.defaultView||ze.parentWindow:window,Ue?(ti=g.relatedTarget||g.toElement,Ue=Le,ti=ti?fi(ti):null,ti!==null&&(bs=q(ti),Si=ti.tag,ti!==bs||Si!==5&&Si!==27&&Si!==6)&&(ti=null)):(Ue=null,ti=Le),Ue!==ti)){if(Si=Os,sn="onMouseLeave",Te="onMouseEnter",he="mouse",(a==="pointerout"||a==="pointerover")&&(Si=Zl,sn="onPointerLeave",Te="onPointerEnter",he="pointer"),bs=Ue==null?ze:Dn(Ue),Re=ti==null?ze:Dn(ti),ze=new Si(sn,he+"leave",Ue,g,He),ze.target=bs,ze.relatedTarget=Re,sn=null,fi(He)===Le&&(Si=new Si(Te,he+"enter",ti,g,He),Si.target=Re,Si.relatedTarget=bs,sn=Si),bs=sn,Ue&&ti)e:{for(Si=ty,Te=Ue,he=ti,Re=0,sn=Te;sn;sn=Si(sn))Re++;sn=0;for(var mi=he;mi;mi=Si(mi))sn++;for(;0<Re-sn;)Te=Si(Te),Re--;for(;0<sn-Re;)he=Si(he),sn--;for(;Re--;){if(Te===he||he!==null&&Te===he.alternate){Si=Te;break e}Te=Si(Te),he=Si(he)}Si=null}else Si=null;Ue!==null&&cf(ln,ze,Ue,Si,!1),ti!==null&&bs!==null&&cf(ln,bs,ti,Si,!0)}}t:{if(ze=Le?Dn(Le):window,Ue=ze.nodeName&&ze.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&ze.type==="file")var Sr=De;else if(Qu(ze))if(vn)Sr=Jn;else{Sr=ds;var ni=Ws}else Ue=ze.nodeName,!Ue||Ue.toLowerCase()!=="input"||ze.type!=="checkbox"&&ze.type!=="radio"?Le&&en(Le.elementType)&&(Sr=De):Sr=Gr;if(Sr&&(Sr=Sr(a,Le))){Pa(ln,Sr,g,He);break t}ni&&ni(a,ze,Le),a==="focusout"&&Le&&ze.type==="number"&&Le.memoizedProps.value!=null&&Qi(ze,"number",ze.value)}switch(ni=Le?Dn(Le):window,a){case"focusin":(Qu(ni)||ni.contentEditable==="true")&&(Tl=ni,or=Le,Ai=null);break;case"focusout":Ai=or=Tl=null;break;case"mousedown":oa=!0;break;case"contextmenu":case"mouseup":case"dragend":oa=!1,nl(ln,g,He);break;case"selectionchange":if(Sl)break;case"keydown":case"keyup":nl(ln,g,He)}var Zi;if(Hl)t:{switch(a){case"compositionstart":var vr="onCompositionStart";break t;case"compositionend":vr="onCompositionEnd";break t;case"compositionupdate":vr="onCompositionUpdate";break t}vr=void 0}else ba?Nr(a,g)&&(vr="onCompositionEnd"):a==="keydown"&&g.keyCode===229&&(vr="onCompositionStart");vr&&(Bu&&g.locale!=="ko"&&(ba||vr!=="onCompositionStart"?vr==="onCompositionEnd"&&ba&&(Zi=ss()):(ur=He,qi="value"in ur?ur.value:ur.textContent,ba=!0)),ni=kd(Le,vr),0<ni.length&&(vr=new Na(vr,a,null,g,He),ln.push({event:vr,listeners:ni}),Zi?vr.data=Zi:(Zi=El(g),Zi!==null&&(vr.data=Zi)))),(Zi=za?el(a,g):Yl(a,g))&&(vr=kd(Le,"onBeforeInput"),0<vr.length&&(ni=new Na("onBeforeInput","beforeinput",null,g,He),ln.push({event:ni,listeners:vr}),ni.data=Zi)),Qg(ln,a,Le,g,He)}tm(ln,u)})}function Mc(a,u,g){return{instance:a,listener:u,currentTarget:g}}function kd(a,u){for(var g=u+"Capture",b=[];a!==null;){var A=a,D=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||D===null||(A=Xi(a,g),A!=null&&b.unshift(Mc(a,A,D)),A=Xi(a,u),A!=null&&b.push(Mc(a,A,D))),a.tag===3)return b;a=a.return}return[]}function ty(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function cf(a,u,g,b,A){for(var D=u._reactName,K=[];g!==null&&g!==b;){var bt=g,ee=bt.alternate,Le=bt.stateNode;if(bt=bt.tag,ee!==null&&ee===b)break;bt!==5&&bt!==26&&bt!==27||Le===null||(ee=Le,A?(Le=Xi(g,D),Le!=null&&K.unshift(Mc(g,Le,ee))):A||(Le=Xi(g,D),Le!=null&&K.push(Mc(g,Le,ee)))),g=g.return}K.length!==0&&a.push({event:u,listeners:K})}var ey=/\r\n?/g,ny=/\u0000|\uFFFD/g;function hf(a){return(typeof a=="string"?a:""+a).replace(ey,`
`).replace(ny,"")}function Up(a,u){return u=hf(u),hf(a)===u}function us(a,u,g,b,A,D){switch(g){case"children":typeof b=="string"?u==="body"||u==="textarea"&&b===""||Ht(a,b):(typeof b=="number"||typeof b=="bigint")&&u!=="body"&&Ht(a,""+b);break;case"className":ea(a,"class",b);break;case"tabIndex":ea(a,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":ea(a,g,b);break;case"style":be(a,b,D);break;case"data":if(u!=="object"){ea(a,"data",b);break}case"src":case"href":if(b===""&&(u!=="a"||g!=="href")){a.removeAttribute(g);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){a.removeAttribute(g);break}b=we(""+b),a.setAttribute(g,b);break;case"action":case"formAction":if(typeof b=="function"){a.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(g==="formAction"?(u!=="input"&&us(a,u,"name",A.name,A,null),us(a,u,"formEncType",A.formEncType,A,null),us(a,u,"formMethod",A.formMethod,A,null),us(a,u,"formTarget",A.formTarget,A,null)):(us(a,u,"encType",A.encType,A,null),us(a,u,"method",A.method,A,null),us(a,u,"target",A.target,A,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){a.removeAttribute(g);break}b=we(""+b),a.setAttribute(g,b);break;case"onClick":b!=null&&(a.onclick=Qe);break;case"onScroll":b!=null&&dr("scroll",a);break;case"onScrollEnd":b!=null&&dr("scrollend",a);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(T(61));if(g=b.__html,g!=null){if(A.children!=null)throw Error(T(60));a.innerHTML=g}}break;case"multiple":a.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":a.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){a.removeAttribute("xlink:href");break}g=we(""+b),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?a.setAttribute(g,""+b):a.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?a.setAttribute(g,""):a.removeAttribute(g);break;case"capture":case"download":b===!0?a.setAttribute(g,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?a.setAttribute(g,b):a.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?a.setAttribute(g,b):a.removeAttribute(g);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?a.removeAttribute(g):a.setAttribute(g,b);break;case"popover":dr("beforetoggle",a),dr("toggle",a),ji(a,"popover",b);break;case"xlinkActuate":kr(a,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":kr(a,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":kr(a,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":kr(a,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":kr(a,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":kr(a,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":kr(a,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":kr(a,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":kr(a,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":ji(a,"is",b);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=nn.get(g)||g,ji(a,g,b))}}function Br(a,u,g,b,A,D){switch(g){case"style":be(a,b,D);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(T(61));if(g=b.__html,g!=null){if(A.children!=null)throw Error(T(60));a.innerHTML=g}}break;case"children":typeof b=="string"?Ht(a,b):(typeof b=="number"||typeof b=="bigint")&&Ht(a,""+b);break;case"onScroll":b!=null&&dr("scroll",a);break;case"onScrollEnd":b!=null&&dr("scrollend",a);break;case"onClick":b!=null&&(a.onclick=Qe);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ss.hasOwnProperty(g))t:{if(g[0]==="o"&&g[1]==="n"&&(A=g.endsWith("Capture"),u=g.slice(2,A?g.length-7:void 0),D=a[me]||null,D=D!=null?D[g]:null,typeof D=="function"&&a.removeEventListener(u,D,A),typeof b=="function")){typeof D!="function"&&D!==null&&(g in a?a[g]=null:a.hasAttribute(g)&&a.removeAttribute(g)),a.addEventListener(u,b,A);break t}g in a?a[g]=b:b===!0?a.setAttribute(g,""):ji(a,g,b)}}}function ga(a,u,g){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dr("error",a),dr("load",a);var b=!1,A=!1,D;for(D in g)if(g.hasOwnProperty(D)){var K=g[D];if(K!=null)switch(D){case"src":b=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(T(137,u));default:us(a,u,D,K,g,null)}}A&&us(a,u,"srcSet",g.srcSet,g,null),b&&us(a,u,"src",g.src,g,null);return;case"input":dr("invalid",a);var bt=D=K=A=null,ee=null,Le=null;for(b in g)if(g.hasOwnProperty(b)){var He=g[b];if(He!=null)switch(b){case"name":A=He;break;case"type":K=He;break;case"checked":ee=He;break;case"defaultChecked":Le=He;break;case"value":D=He;break;case"defaultValue":bt=He;break;case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(T(137,u));break;default:us(a,u,b,He,g,null)}}br(a,D,bt,ee,Le,K,A,!1);return;case"select":dr("invalid",a),b=K=D=null;for(A in g)if(g.hasOwnProperty(A)&&(bt=g[A],bt!=null))switch(A){case"value":D=bt;break;case"defaultValue":K=bt;break;case"multiple":b=bt;default:us(a,u,A,bt,g,null)}u=D,g=K,a.multiple=!!b,u!=null?R(a,!!b,u,!1):g!=null&&R(a,!!b,g,!0);return;case"textarea":dr("invalid",a),D=A=b=null;for(K in g)if(g.hasOwnProperty(K)&&(bt=g[K],bt!=null))switch(K){case"value":b=bt;break;case"defaultValue":A=bt;break;case"children":D=bt;break;case"dangerouslySetInnerHTML":if(bt!=null)throw Error(T(91));break;default:us(a,u,K,bt,g,null)}ft(a,b,A,D);return;case"option":for(ee in g)if(g.hasOwnProperty(ee)&&(b=g[ee],b!=null))switch(ee){case"selected":a.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:us(a,u,ee,b,g,null)}return;case"dialog":dr("beforetoggle",a),dr("toggle",a),dr("cancel",a),dr("close",a);break;case"iframe":case"object":dr("load",a);break;case"video":case"audio":for(b=0;b<sd.length;b++)dr(sd[b],a);break;case"image":dr("error",a),dr("load",a);break;case"details":dr("toggle",a);break;case"embed":case"source":case"link":dr("error",a),dr("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Le in g)if(g.hasOwnProperty(Le)&&(b=g[Le],b!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":throw Error(T(137,u));default:us(a,u,Le,b,g,null)}return;default:if(en(u)){for(He in g)g.hasOwnProperty(He)&&(b=g[He],b!==void 0&&Br(a,u,He,b,g,void 0));return}}for(bt in g)g.hasOwnProperty(bt)&&(b=g[bt],b!=null&&us(a,u,bt,b,g,null))}function em(a,u,g,b){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,D=null,K=null,bt=null,ee=null,Le=null,He=null;for(Ue in g){var ln=g[Ue];if(g.hasOwnProperty(Ue)&&ln!=null)switch(Ue){case"checked":break;case"value":break;case"defaultValue":ee=ln;default:b.hasOwnProperty(Ue)||us(a,u,Ue,null,b,ln)}}for(var ze in b){var Ue=b[ze];if(ln=g[ze],b.hasOwnProperty(ze)&&(Ue!=null||ln!=null))switch(ze){case"type":D=Ue;break;case"name":A=Ue;break;case"checked":Le=Ue;break;case"defaultChecked":He=Ue;break;case"value":K=Ue;break;case"defaultValue":bt=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(T(137,u));break;default:Ue!==ln&&us(a,u,ze,Ue,b,ln)}}na(a,K,bt,ee,Le,He,D,A);return;case"select":Ue=K=bt=ze=null;for(D in g)if(ee=g[D],g.hasOwnProperty(D)&&ee!=null)switch(D){case"value":break;case"multiple":Ue=ee;default:b.hasOwnProperty(D)||us(a,u,D,null,b,ee)}for(A in b)if(D=b[A],ee=g[A],b.hasOwnProperty(A)&&(D!=null||ee!=null))switch(A){case"value":ze=D;break;case"defaultValue":bt=D;break;case"multiple":K=D;default:D!==ee&&us(a,u,A,D,b,ee)}u=bt,g=K,b=Ue,ze!=null?R(a,!!g,ze,!1):!!b!=!!g&&(u!=null?R(a,!!g,u,!0):R(a,!!g,g?[]:"",!1));return;case"textarea":Ue=ze=null;for(bt in g)if(A=g[bt],g.hasOwnProperty(bt)&&A!=null&&!b.hasOwnProperty(bt))switch(bt){case"value":break;case"children":break;default:us(a,u,bt,null,b,A)}for(K in b)if(A=b[K],D=g[K],b.hasOwnProperty(K)&&(A!=null||D!=null))switch(K){case"value":ze=A;break;case"defaultValue":Ue=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(T(91));break;default:A!==D&&us(a,u,K,A,b,D)}H(a,ze,Ue);return;case"option":for(var ti in g)if(ze=g[ti],g.hasOwnProperty(ti)&&ze!=null&&!b.hasOwnProperty(ti))switch(ti){case"selected":a.selected=!1;break;default:us(a,u,ti,null,b,ze)}for(ee in b)if(ze=b[ee],Ue=g[ee],b.hasOwnProperty(ee)&&ze!==Ue&&(ze!=null||Ue!=null))switch(ee){case"selected":a.selected=ze&&typeof ze!="function"&&typeof ze!="symbol";break;default:us(a,u,ee,ze,b,Ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Si in g)ze=g[Si],g.hasOwnProperty(Si)&&ze!=null&&!b.hasOwnProperty(Si)&&us(a,u,Si,null,b,ze);for(Le in b)if(ze=b[Le],Ue=g[Le],b.hasOwnProperty(Le)&&ze!==Ue&&(ze!=null||Ue!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(T(137,u));break;default:us(a,u,Le,ze,b,Ue)}return;default:if(en(u)){for(var bs in g)ze=g[bs],g.hasOwnProperty(bs)&&ze!==void 0&&!b.hasOwnProperty(bs)&&Br(a,u,bs,void 0,b,ze);for(He in b)ze=b[He],Ue=g[He],!b.hasOwnProperty(He)||ze===Ue||ze===void 0&&Ue===void 0||Br(a,u,He,ze,b,Ue);return}}for(var Te in g)ze=g[Te],g.hasOwnProperty(Te)&&ze!=null&&!b.hasOwnProperty(Te)&&us(a,u,Te,null,b,ze);for(ln in b)ze=b[ln],Ue=g[ln],!b.hasOwnProperty(ln)||ze===Ue||ze==null&&Ue==null||us(a,u,ln,ze,b,Ue)}function Gp(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Zc(){if(typeof performance.getEntriesByType=="function"){for(var a=0,u=0,g=performance.getEntriesByType("resource"),b=0;b<g.length;b++){var A=g[b],D=A.transferSize,K=A.initiatorType,bt=A.duration;if(D&&bt&&Gp(K)){for(K=0,bt=A.responseEnd,b+=1;b<g.length;b++){var ee=g[b],Le=ee.startTime;if(Le>bt)break;var He=ee.transferSize,ln=ee.initiatorType;He&&Gp(ln)&&(ee=ee.responseEnd,K+=He*(ee<bt?1:(bt-Le)/(ee-Le)))}if(--b,u+=8*(D+K)/(A.duration/1e3),a++,10<a)break}}if(0<a)return u/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var oh=null,Ud=null;function Gd(a){return a.nodeType===9?a:a.ownerDocument}function nm(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function im(a,u){if(a===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&u==="foreignObject"?0:a}function Vp(a,u){return a==="textarea"||a==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var qp=null;function iy(){var a=window.event;return a&&a.type==="popstate"?a===qp?!1:(qp=a,!0):(qp=null,!1)}var rm=typeof setTimeout=="function"?setTimeout:void 0,ry=typeof clearTimeout=="function"?clearTimeout:void 0,sm=typeof Promise=="function"?Promise:void 0,Vd=typeof queueMicrotask=="function"?queueMicrotask:typeof sm<"u"?function(a){return sm.resolve(null).then(a).catch(ff)}:rm;function ff(a){setTimeout(function(){throw a})}function Hc(a){return a==="head"}function om(a,u){var g=u,b=0;do{var A=g.nextSibling;if(a.removeChild(g),A&&A.nodeType===8)if(g=A.data,g==="/$"||g==="/&"){if(b===0){a.removeChild(A),kh(u);return}b--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")b++;else if(g==="html")od(a.ownerDocument.documentElement);else if(g==="head"){g=a.ownerDocument.head,od(g);for(var D=g.firstChild;D;){var K=D.nextSibling,bt=D.nodeName;D[Fn]||bt==="SCRIPT"||bt==="STYLE"||bt==="LINK"&&D.rel.toLowerCase()==="stylesheet"||g.removeChild(D),D=K}}else g==="body"&&od(a.ownerDocument.body);g=A}while(g);kh(u)}function am(a,u){var g=a;a=0;do{var b=g.nextSibling;if(g.nodeType===1?u?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(u?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),b&&b.nodeType===8)if(g=b.data,g==="/$"){if(a===0)break;a--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||a++;g=b}while(g)}function jp(a){var u=a.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var g=u;switch(u=u.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":jp(g),Qn(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}a.removeChild(g)}}function Xp(a,u,g,b){for(;a.nodeType===1;){var A=g;if(a.nodeName.toLowerCase()!==u.toLowerCase()){if(!b&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(b){if(!a[Fn])switch(u){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(D=a.getAttribute("rel"),D==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(D!==A.rel||a.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||a.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||a.getAttribute("title")!==(A.title==null?null:A.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(D=a.getAttribute("src"),(D!==(A.src==null?null:A.src)||a.getAttribute("type")!==(A.type==null?null:A.type)||a.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&D&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(u==="input"&&a.type==="hidden"){var D=A.name==null?null:""+A.name;if(A.type==="hidden"&&a.getAttribute("name")===D)return a}else return a;if(a=ou(a.nextSibling),a===null)break}return null}function Zp(a,u,g){if(u==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!g||(a=ou(a.nextSibling),a===null))return null;return a}function Hp(a,u){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!u||(a=ou(a.nextSibling),a===null))return null;return a}function Ul(a){return a.data==="$?"||a.data==="$~"}function Dh(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function df(a,u){var g=a.ownerDocument;if(a.data==="$~")a._reactRetry=u;else if(a.data!=="$?"||g.readyState!=="loading")u();else{var b=function(){u(),g.removeEventListener("DOMContentLoaded",b)};g.addEventListener("DOMContentLoaded",b),a._reactRetry=b}}function ou(a){for(;a!=null;a=a.nextSibling){var u=a.nodeType;if(u===1||u===3)break;if(u===8){if(u=a.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return a}var pf=null;function lm(a){a=a.nextSibling;for(var u=0;a;){if(a.nodeType===8){var g=a.data;if(g==="/$"||g==="/&"){if(u===0)return ou(a.nextSibling);u--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||u++}a=a.nextSibling}return null}function Yp(a){a=a.previousSibling;for(var u=0;a;){if(a.nodeType===8){var g=a.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(u===0)return a;u--}else g!=="/$"&&g!=="/&"||u++}a=a.previousSibling}return null}function Wp(a,u,g){switch(u=Gd(g),a){case"html":if(a=u.documentElement,!a)throw Error(T(452));return a;case"head":if(a=u.head,!a)throw Error(T(453));return a;case"body":if(a=u.body,!a)throw Error(T(454));return a;default:throw Error(T(451))}}function od(a){for(var u=a.attributes;u.length;)a.removeAttributeNode(u[0]);Qn(a)}var Nu=new Map,$p=new Set;function gf(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Ac=kt.d;kt.d={f:sy,r:um,D:cm,C:hm,L:fm,m:oy,X:dm,S:ay,M:pm};function sy(){var a=Ac.f(),u=Ld();return a||u}function um(a){var u=ki(a);u!==null&&u.tag===5&&u.type==="form"?vc(u):Ac.r(a)}var au=typeof document>"u"?null:document;function Jp(a,u,g){var b=au;if(b&&typeof u=="string"&&u){var A=Ur(u);A='link[rel="'+a+'"][href="'+A+'"]',typeof g=="string"&&(A+='[crossorigin="'+g+'"]'),$p.has(A)||($p.add(A),a={rel:a,crossOrigin:g,href:u},b.querySelector(A)===null&&(u=b.createElement("link"),ga(u,"link",a),_i(u),b.head.appendChild(u)))}}function cm(a){Ac.D(a),Jp("dns-prefetch",a,null)}function hm(a,u){Ac.C(a,u),Jp("preconnect",a,u)}function fm(a,u,g){Ac.L(a,u,g);var b=au;if(b&&a&&u){var A='link[rel="preload"][as="'+Ur(u)+'"]';u==="image"&&g&&g.imageSrcSet?(A+='[imagesrcset="'+Ur(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(A+='[imagesizes="'+Ur(g.imageSizes)+'"]')):A+='[href="'+Ur(a)+'"]';var D=A;switch(u){case"style":D=Nh(a);break;case"script":D=Oh(a)}Nu.has(D)||(a=ht({rel:"preload",href:u==="image"&&g&&g.imageSrcSet?void 0:a,as:u},g),Nu.set(D,a),b.querySelector(A)!==null||u==="style"&&b.querySelector(yf(D))||u==="script"&&b.querySelector(ah(D))||(u=b.createElement("link"),ga(u,"link",a),_i(u),b.head.appendChild(u)))}}function oy(a,u){Ac.m(a,u);var g=au;if(g&&a){var b=u&&typeof u.as=="string"?u.as:"script",A='link[rel="modulepreload"][as="'+Ur(b)+'"][href="'+Ur(a)+'"]',D=A;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=Oh(a)}if(!Nu.has(D)&&(a=ht({rel:"modulepreload",href:a},u),Nu.set(D,a),g.querySelector(A)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(ah(D)))return}b=g.createElement("link"),ga(b,"link",a),_i(b),g.head.appendChild(b)}}}function ay(a,u,g){Ac.S(a,u,g);var b=au;if(b&&a){var A=Vi(b).hoistableStyles,D=Nh(a);u=u||"default";var K=A.get(D);if(!K){var bt={loading:0,preload:null};if(K=b.querySelector(yf(D)))bt.loading=5;else{a=ht({rel:"stylesheet",href:a,"data-precedence":u},g),(g=Nu.get(D))&&vf(a,g);var ee=K=b.createElement("link");_i(ee),ga(ee,"link",a),ee._p=new Promise(function(Le,He){ee.onload=Le,ee.onerror=He}),ee.addEventListener("load",function(){bt.loading|=1}),ee.addEventListener("error",function(){bt.loading|=2}),bt.loading|=4,zh(K,u,b)}K={type:"stylesheet",instance:K,count:1,state:bt},A.set(D,K)}}}function dm(a,u){Ac.X(a,u);var g=au;if(g&&a){var b=Vi(g).hoistableScripts,A=Oh(a),D=b.get(A);D||(D=g.querySelector(ah(A)),D||(a=ht({src:a,async:!0},u),(u=Nu.get(A))&&Qp(a,u),D=g.createElement("script"),_i(D),ga(D,"link",a),g.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},b.set(A,D))}}function pm(a,u){Ac.M(a,u);var g=au;if(g&&a){var b=Vi(g).hoistableScripts,A=Oh(a),D=b.get(A);D||(D=g.querySelector(ah(A)),D||(a=ht({src:a,async:!0,type:"module"},u),(u=Nu.get(A))&&Qp(a,u),D=g.createElement("script"),_i(D),ga(D,"link",a),g.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},b.set(A,D))}}function mf(a,u,g,b){var A=(A=On.current)?gf(A):null;if(!A)throw Error(T(446));switch(a){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(u=Nh(g.href),g=Vi(A).hoistableStyles,b=g.get(u),b||(b={type:"style",instance:null,count:0,state:null},g.set(u,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){a=Nh(g.href);var D=Vi(A).hoistableStyles,K=D.get(a);if(K||(A=A.ownerDocument||A,K={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(a,K),(D=A.querySelector(yf(a)))&&!D._p&&(K.instance=D,K.state.loading=5),Nu.has(a)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Nu.set(a,g),D||_f(A,a,g,K.state))),u&&b===null)throw Error(T(528,""));return K}if(u&&b!==null)throw Error(T(529,""));return null;case"script":return u=g.async,g=g.src,typeof g=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Oh(g),g=Vi(A).hoistableScripts,b=g.get(u),b||(b={type:"script",instance:null,count:0,state:null},g.set(u,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(T(444,a))}}function Nh(a){return'href="'+Ur(a)+'"'}function yf(a){return'link[rel="stylesheet"]['+a+"]"}function qd(a){return ht({},a,{"data-precedence":a.precedence,precedence:null})}function _f(a,u,g,b){a.querySelector('link[rel="preload"][as="style"]['+u+"]")?b.loading=1:(u=a.createElement("link"),b.preload=u,u.addEventListener("load",function(){return b.loading|=1}),u.addEventListener("error",function(){return b.loading|=2}),ga(u,"link",g),_i(u),a.head.appendChild(u))}function Oh(a){return'[src="'+Ur(a)+'"]'}function ah(a){return"script[async]"+a}function Kp(a,u,g){if(u.count++,u.instance===null)switch(u.type){case"style":var b=a.querySelector('style[data-href~="'+Ur(g.href)+'"]');if(b)return u.instance=b,_i(b),b;var A=ht({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return b=(a.ownerDocument||a).createElement("style"),_i(b),ga(b,"style",A),zh(b,g.precedence,a),u.instance=b;case"stylesheet":A=Nh(g.href);var D=a.querySelector(yf(A));if(D)return u.state.loading|=4,u.instance=D,_i(D),D;b=qd(g),(A=Nu.get(A))&&vf(b,A),D=(a.ownerDocument||a).createElement("link"),_i(D);var K=D;return K._p=new Promise(function(bt,ee){K.onload=bt,K.onerror=ee}),ga(D,"link",b),u.state.loading|=4,zh(D,g.precedence,a),u.instance=D;case"script":return D=Oh(g.src),(A=a.querySelector(ah(D)))?(u.instance=A,_i(A),A):(b=g,(A=Nu.get(D))&&(b=ht({},g),Qp(b,A)),a=a.ownerDocument||a,A=a.createElement("script"),_i(A),ga(A,"link",b),a.head.appendChild(A),u.instance=A);case"void":return null;default:throw Error(T(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(b=u.instance,u.state.loading|=4,zh(b,g.precedence,a));return u.instance}function zh(a,u,g){for(var b=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=b.length?b[b.length-1]:null,D=A,K=0;K<b.length;K++){var bt=b[K];if(bt.dataset.precedence===u)D=bt;else if(D!==A)break}D?D.parentNode.insertBefore(a,D.nextSibling):(u=g.nodeType===9?g.head:g,u.insertBefore(a,u.firstChild))}function vf(a,u){a.crossOrigin==null&&(a.crossOrigin=u.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=u.referrerPolicy),a.title==null&&(a.title=u.title)}function Qp(a,u){a.crossOrigin==null&&(a.crossOrigin=u.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=u.referrerPolicy),a.integrity==null&&(a.integrity=u.integrity)}var jd=null;function gm(a,u,g){if(jd===null){var b=new Map,A=jd=new Map;A.set(g,b)}else A=jd,b=A.get(g),b||(b=new Map,A.set(g,b));if(b.has(a))return b;for(b.set(a,null),g=g.getElementsByTagName(a),A=0;A<g.length;A++){var D=g[A];if(!(D[Fn]||D[$t]||a==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var K=D.getAttribute(u)||"";K=a+K;var bt=b.get(K);bt?bt.push(D):b.set(K,[D])}}return b}function mm(a,u,g){a=a.ownerDocument||a,a.head.insertBefore(g,u==="title"?a.querySelector("head > title"):null)}function ly(a,u,g){if(g===1||u.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return a=u.disabled,typeof u.precedence=="string"&&a==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function Ph(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function tg(a,u,g,b){if(g.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var A=Nh(b.href),D=u.querySelector(yf(A));if(D){u=D._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(a.count++,a=Xd.bind(a),u.then(a,a)),g.state.loading|=4,g.instance=D,_i(D);return}D=u.ownerDocument||u,b=qd(b),(A=Nu.get(A))&&vf(b,A),D=D.createElement("link"),_i(D);var K=D;K._p=new Promise(function(bt,ee){K.onload=bt,K.onerror=ee}),ga(D,"link",b),g.instance=D}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(g,u),(u=g.state.preload)&&(g.state.loading&3)===0&&(a.count++,g=Xd.bind(a),u.addEventListener("load",g),u.addEventListener("error",g))}}var eg=0;function ym(a,u){return a.stylesheets&&a.count===0&&Zd(a,a.stylesheets),0<a.count||0<a.imgCount?function(g){var b=setTimeout(function(){if(a.stylesheets&&Zd(a,a.stylesheets),a.unsuspend){var D=a.unsuspend;a.unsuspend=null,D()}},6e4+u);0<a.imgBytes&&eg===0&&(eg=62500*Zc());var A=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&Zd(a,a.stylesheets),a.unsuspend)){var D=a.unsuspend;a.unsuspend=null,D()}},(a.imgBytes>eg?50:800)+u);return a.unsuspend=g,function(){a.unsuspend=null,clearTimeout(b),clearTimeout(A)}}:null}function Xd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Zd(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var xf=null;function Zd(a,u){a.stylesheets=null,a.unsuspend!==null&&(a.count++,xf=new Map,u.forEach(lh,a),xf=null,Xd.call(a))}function lh(a,u){if(!(u.state.loading&4)){var g=xf.get(a);if(g)var b=g.get(null);else{g=new Map,xf.set(a,g);for(var A=a.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<A.length;D++){var K=A[D];(K.nodeName==="LINK"||K.getAttribute("media")!=="not all")&&(g.set(K.dataset.precedence,K),b=K)}b&&g.set(null,b)}A=u.instance,K=A.getAttribute("data-precedence"),D=g.get(K)||b,D===b&&g.set(null,A),g.set(K,A),this.count++,b=Xd.bind(this),A.addEventListener("load",b),A.addEventListener("error",b),D?D.parentNode.insertBefore(A,D.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(A,a.firstChild)),u.state.loading|=4}}var bf={$$typeof:lt,Provider:null,Consumer:null,_currentValue:ut,_currentValue2:ut,_threadCount:0};function _m(a,u,g,b,A,D,K,bt,ee){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pi(0),this.hiddenUpdates=Pi(null),this.identifierPrefix=b,this.onUncaughtError=A,this.onCaughtError=D,this.onRecoverableError=K,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function ad(a,u,g,b,A,D,K,bt,ee,Le,He,ln){return a=new _m(a,u,g,K,ee,Le,He,ln,bt),u=1,D===!0&&(u|=24),D=$s(3,null,null,u),a.current=D,D.stateNode=a,u=ca(),u.refCount++,a.pooledCache=u,u.refCount++,D.memoizedState={element:b,isDehydrated:g,cache:u},Z(D),a}function Hd(a){return a?(a=Jo,a):Jo}function vm(a,u,g,b,A,D){A=Hd(A),b.context===null?b.context=A:b.pendingContext=A,b=nt(u),b.payload={element:g},D=D===void 0?null:D,D!==null&&(b.callback=D),g=dt(a,b,u),g!==null&&(ru(g,a,u),Et(g,a,u))}function xm(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var g=a.retryLane;a.retryLane=g!==0&&g<u?g:u}}function Yd(a,u){xm(a,u),(a=a.alternate)&&xm(a,u)}function ng(a){if(a.tag===13||a.tag===31){var u=al(a,67108864);u!==null&&ru(u,a,67108864),Yd(a,67108864)}}function wf(a){if(a.tag===13||a.tag===31){var u=kl();u=Lt(u);var g=al(a,u);g!==null&&ru(g,a,u),Yd(a,u)}}var Hu=!0;function ig(a,u,g,b){var A=ct.T;ct.T=null;var D=kt.p;try{kt.p=2,uh(a,u,g,b)}finally{kt.p=D,ct.T=A}}function Ef(a,u,g,b){var A=ct.T;ct.T=null;var D=kt.p;try{kt.p=8,uh(a,u,g,b)}finally{kt.p=D,ct.T=A}}function uh(a,u,g,b){if(Hu){var A=Ou(b);if(A===null)uf(a,u,b,lu,g),$d(a,b);else if(ld(A,a,u,g,b))b.stopPropagation();else if($d(a,b),u&4&&-1<Wd.indexOf(a)){for(;A!==null;){var D=ki(A);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var K=Kn(D.pendingLanes);if(K!==0){var bt=D;for(bt.pendingLanes|=2,bt.entangledLanes|=2;K;){var ee=1<<31-_r(K);bt.entanglements[1]|=ee,K&=~ee}su(D),(Lr&6)===0&&(Jf=Ri()+500,lf(0))}}break;case 31:case 13:bt=al(D,2),bt!==null&&ru(bt,D,2),Ld(),Yd(D,2)}if(D=Ou(b),D===null&&uf(a,u,b,lu,g),D===A)break;A=D}A!==null&&b.stopPropagation()}else uf(a,u,b,null,g)}}function Ou(a){return a=Yn(a),rg(a)}var lu=null;function rg(a){if(lu=null,a=fi(a),a!==null){var u=q(a);if(u===null)a=null;else{var g=u.tag;if(g===13){if(a=j(u),a!==null)return a;a=null}else if(g===31){if(a=J(u),a!==null)return a;a=null}else if(g===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;a=null}else u!==a&&(a=null)}}return lu=a,null}function sg(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($a()){case ql:return 2;case Qr:return 8;case hs:case $e:return 32;case yr:return 268435456;default:return 32}default:return 32}}var og=!1,Lc=null,ja=null,uu=null,Sf=new Map,Tf=new Map,ch=[],Wd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $d(a,u){switch(a){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":ja=null;break;case"mouseover":case"mouseout":uu=null;break;case"pointerover":case"pointerout":Sf.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tf.delete(u.pointerId)}}function Rc(a,u,g,b,A,D){return a===null||a.nativeEvent!==D?(a={blockedOn:u,domEventName:g,eventSystemFlags:b,nativeEvent:D,targetContainers:[A]},u!==null&&(u=ki(u),u!==null&&ng(u)),a):(a.eventSystemFlags|=b,u=a.targetContainers,A!==null&&u.indexOf(A)===-1&&u.push(A),a)}function ld(a,u,g,b,A){switch(u){case"focusin":return Lc=Rc(Lc,a,u,g,b,A),!0;case"dragenter":return ja=Rc(ja,a,u,g,b,A),!0;case"mouseover":return uu=Rc(uu,a,u,g,b,A),!0;case"pointerover":var D=A.pointerId;return Sf.set(D,Rc(Sf.get(D)||null,a,u,g,b,A)),!0;case"gotpointercapture":return D=A.pointerId,Tf.set(D,Rc(Tf.get(D)||null,a,u,g,b,A)),!0}return!1}function Cf(a){var u=fi(a.target);if(u!==null){var g=q(u);if(g!==null){if(u=g.tag,u===13){if(u=j(g),u!==null){a.blockedOn=u,ue(a.priority,function(){wf(g)});return}}else if(u===31){if(u=J(g),u!==null){a.blockedOn=u,ue(a.priority,function(){wf(g)});return}}else if(u===3&&g.stateNode.current.memoizedState.isDehydrated){a.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Bh(a){if(a.blockedOn!==null)return!1;for(var u=a.targetContainers;0<u.length;){var g=Ou(a.nativeEvent);if(g===null){g=a.nativeEvent;var b=new g.constructor(g.type,g);Tn=b,g.target.dispatchEvent(b),Tn=null}else return u=ki(g),u!==null&&ng(u),a.blockedOn=g,!1;u.shift()}return!0}function ag(a,u,g){Bh(a)&&g.delete(u)}function ud(){og=!1,Lc!==null&&Bh(Lc)&&(Lc=null),ja!==null&&Bh(ja)&&(ja=null),uu!==null&&Bh(uu)&&(uu=null),Sf.forEach(ag),Tf.forEach(ag)}function If(a,u){a.blockedOn===u&&(a.blockedOn=null,og||(og=!0,B.unstable_scheduleCallback(B.unstable_NormalPriority,ud)))}var cd=null;function Fh(a){cd!==a&&(cd=a,B.unstable_scheduleCallback(B.unstable_NormalPriority,function(){cd===a&&(cd=null);for(var u=0;u<a.length;u+=3){var g=a[u],b=a[u+1],A=a[u+2];if(typeof b!="function"){if(rg(b||g)===null)continue;break}var D=ki(g);D!==null&&(a.splice(u,3),u-=3,yh(D,{pending:!0,data:A,method:g.method,action:b},b,A))}}))}function kh(a){function u(ee){return If(ee,a)}Lc!==null&&If(Lc,a),ja!==null&&If(ja,a),uu!==null&&If(uu,a),Sf.forEach(u),Tf.forEach(u);for(var g=0;g<ch.length;g++){var b=ch[g];b.blockedOn===a&&(b.blockedOn=null)}for(;0<ch.length&&(g=ch[0],g.blockedOn===null);)Cf(g),g.blockedOn===null&&ch.shift();if(g=(a.ownerDocument||a).$$reactFormReplay,g!=null)for(b=0;b<g.length;b+=3){var A=g[b],D=g[b+1],K=A[me]||null;if(typeof D=="function")K||Fh(g);else if(K){var bt=null;if(D&&D.hasAttribute("formAction")){if(A=D,K=D[me]||null)bt=K.formAction;else if(rg(A)!==null)continue}else bt=K.action;typeof bt=="function"?g[b+1]=bt:(g.splice(b,3),b-=3),Fh(g)}}}function lg(){function a(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(K){return A=K})},focusReset:"manual",scroll:"manual"})}function u(){A!==null&&(A(),A=null),b||setTimeout(g,20)}function g(){if(!b&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,A=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(g,100),function(){b=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),A!==null&&(A(),A=null)}}}function ug(a){this._internalRoot=a}Jd.prototype.render=ug.prototype.render=function(a){var u=this._internalRoot;if(u===null)throw Error(T(409));var g=u.current,b=kl();vm(g,b,a,u,null,null)},Jd.prototype.unmount=ug.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var u=a.containerInfo;vm(a.current,2,null,a,null,null),Ld(),u[je]=null}};function Jd(a){this._internalRoot=a}Jd.prototype.unstable_scheduleHydration=function(a){if(a){var u=Kt();a={blockedOn:null,target:a,priority:u};for(var g=0;g<ch.length&&u!==0&&u<ch[g].priority;g++);ch.splice(g,0,a),g===0&&Cf(a)}};var cg=V.version;if(cg!=="19.2.0")throw Error(T(527,cg,"19.2.0"));kt.findDOMNode=function(a){var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(T(188)):(a=Object.keys(a).join(","),Error(T(268,a)));return a=X(u),a=a!==null?tt(a):null,a=a===null?null:a.stateNode,a};var Uh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ct,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{Ki=Kd.inject(Uh),Tr=Kd}catch{}}return yg.createRoot=function(a,u){if(!G(a))throw Error(T(299));var g=!1,b="",A=rc,D=sc,K=Cu;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(A=u.onUncaughtError),u.onCaughtError!==void 0&&(D=u.onCaughtError),u.onRecoverableError!==void 0&&(K=u.onRecoverableError)),u=ad(a,1,!1,null,null,g,b,null,A,D,K,lg),a[je]=u.current,Zu(a),new ug(u)},yg.hydrateRoot=function(a,u,g){if(!G(a))throw Error(T(299));var b=!1,A="",D=rc,K=sc,bt=Cu,ee=null;return g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(A=g.identifierPrefix),g.onUncaughtError!==void 0&&(D=g.onUncaughtError),g.onCaughtError!==void 0&&(K=g.onCaughtError),g.onRecoverableError!==void 0&&(bt=g.onRecoverableError),g.formState!==void 0&&(ee=g.formState)),u=ad(a,1,!0,u,g??null,b,A,ee,D,K,bt,lg),u.context=Hd(null),g=u.current,b=kl(),b=Lt(b),A=nt(b),A.callback=null,dt(g,A,b),g=b,u.current.lanes=g,Zr(u,g),su(u),a[je]=u.current,Zu(a),new Jd(u)},yg.version="19.2.0",yg}var kv;function C1(){if(kv)return Sy.exports;kv=1;function B(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(B)}catch(V){console.error(V)}}return B(),Sy.exports=T1(),Sy.exports}var I1=C1();const M1=rp(I1);var Ls=Y_();const Cm=rp(Ls);var Am={exports:{}},A1=Am.exports,Uv;function L1(){return Uv||(Uv=1,(function(B,V){var F={};(function(T,G){B.exports=G()})(A1,(function(){var T,G,q;function j(h,X){if(!T)T=X;else if(!G)G=X;else{var tt="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+T+")(sharedChunk); ("+G+")(sharedChunk); self.onerror = null;",ht={};T(ht),q=X(ht),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(q.workerUrl=window.URL.createObjectURL(new Blob([tt],{type:"text/javascript"})))}}j(["exports"],(function(h){var X=typeof self<"u"?self:{},tt="2.11.1";let ht;const st={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(ht==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ht=F.API_URL_REGEX!=null?new RegExp(F.API_URL_REGEX):r}catch{ht=r}}return ht},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},At={supported:!1,testSupport:function(r){!ae&&it&&(le?Ft(r):yt=r)}};let yt,it,ae=!1,le=!1;function Ft(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,it),r.isContextLost())return;At.supported=!0}catch{}r.deleteTexture(e),ae=!0}X.document&&(it=X.document.createElement("img"),it.onload=function(){yt&&Ft(yt),yt=null,le=!0},it.onerror=function(){ae=!0,yt=null},it.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const lt="01";var pt=It;function It(r,e,s,c){this.cx=3*r,this.bx=3*(s-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(c-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=s,this.p2y=c}It.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var s=r,c=0;c<8;c++){var p=this.sampleCurveX(s)-r;if(Math.abs(p)<e)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=p/y}var x=0,E=1;for(s=r,c=0;c<20&&(p=this.sampleCurveX(s),!(Math.abs(p-r)<e));c++)r>p?x=s:E=s,s=.5*(E-x)+x;return s},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var Dt=_t;function _t(r,e){this.x=r,this.y=e}_t.prototype={clone:function(){return new _t(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,s=r.y-this.y;return e*e+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),s=Math.sin(r),c=s*this.x+e*this.y;return this.x=e*this.x-s*this.y,this.y=c,this},_rotateAround:function(r,e){var s=Math.cos(r),c=Math.sin(r),p=e.y+c*(this.x-e.x)+s*(this.y-e.y);return this.x=e.x+s*(this.x-e.x)-c*(this.y-e.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_t.convert=function(r){return r instanceof _t?r:Array.isArray(r)?new _t(r[0],r[1]):r};const Jt=Math.PI/180,Xt=180/Math.PI;function ie(r){return r*Jt}function Yt(r){return r*Xt}const rt=[[0,0],[1,0],[1,1],[0,1]];function qe(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,s=e*r;return 4*(r<.5?s:3*(r-e)+s-.75)}function Sn(r,e,s,c){const p=new pt(r,e,s,c);return function(y){return p.solve(y)}}const Xn=Sn(.25,.1,.25,1);function ct(r,e,s){return Math.min(s,Math.max(e,r))}function kt(r,e,s){return(s=ct((s-r)/(e-r),0,1))*s*(3-2*s)}function ut(r,e,s){const c=s-e,p=((r-e)%c+c)%c+e;return p===e?s:p}function ye(r,e,s){if(!r.length)return s(null,[]);let c=r.length;const p=new Array(r.length);let y=null;r.forEach(((x,E)=>{e(x,((I,M)=>{I&&(y=I),p[E]=M,--c==0&&s(y,p)}))}))}function te(r){const e=[];for(const s in r)e.push(r[s]);return e}function mt(r,...e){for(const s of e)for(const c in s)r[c]=s[c];return r}let Zt=1;function ve(){return Zt++}function Be(){return(function r(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)})()}function de(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function On(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function An(r,e){r.forEach((s=>{e[s]&&(e[s]=e[s].bind(e))}))}function $n(r,e){return r.indexOf(e,r.length-e.length)!==-1}function yi(r,e,s){const c={};for(const p in r)c[p]=e.call(this,r[p],p,r);return c}function Gi(r,e,s){const c={};for(const p in r)e.call(s||this,r[p],p,r)&&(c[p]=r[p]);return c}function jr(r){return Array.isArray(r)?r.map(jr):typeof r=="object"&&r?yi(r,jr):r}const Bn={};function lr(r){Bn[r]||(typeof console<"u"&&console.warn(r),Bn[r]=!0)}function Fr(r,e,s){return(s.y-r.y)*(e.x-r.x)>(e.y-r.y)*(s.x-r.x)}function Mn(r){let e=0;for(let s,c,p=0,y=r.length,x=y-1;p<y;x=p++)s=r[p],c=r[x],e+=(c.x-s.x)*(s.y+c.y);return e}function ui(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Vl(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((s,c,p,y)=>{const x=p||y;return e[c]=!x||x.toLowerCase(),""})),e["max-age"]){const s=parseInt(e["max-age"],10);isNaN(s)?delete e["max-age"]:e["max-age"]=s}return e}let mr=null;function _l(r){if(mr==null){const e=r.navigator?r.navigator.userAgent:null;mr=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return mr}function vi(r){try{const e=X[r];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Us(r,e){return[r[4*e],r[4*e+1],r[4*e+2],r[4*e+3]]}const Wa="mapbox-tiles";let eo,Ri,$a=500,ql=50;function Qr(){try{return X.caches}catch{}}function hs(){Qr()&&!eo&&(eo=X.caches.open(Wa))}function $e(r){const e=r.indexOf("?");if(e<0)return r;const s=(function(p){const y=p.indexOf("?");return y>0?p.slice(y+1).split("&"):[]})(r),c=s.filter((p=>{const y=p.split("=");return y[0]==="language"||y[0]==="worldview"}));return c.length?`${r.slice(0,e)}?${c.join("&")}`:r.slice(0,e)}let yr=1/0;const Xr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Xr);class ri extends Error{constructor(e,s,c){s===401&&Kn(c)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ki=ui()?()=>self.worker&&self.worker.referrer:()=>(X.location.protocol==="blob:"?X.parent:X).location.href,Tr=function(r,e){if(!(/^file:/.test(s=r.url)||/^file:/.test(Ki())&&!/^\w+:/.test(s))){if(X.fetch&&X.Request&&X.AbortController&&X.Request.prototype.hasOwnProperty("signal"))return(function(c,p){const y=new X.AbortController,x=new X.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Ki(),signal:y.signal});let E=!1,I=!1;const M=(O=x.url).indexOf("sku=")>0&&Kn(O);var O;c.type==="json"&&x.headers.set("Accept","application/json");const k=($,Q,at)=>{if(I)return;if($&&$.message!=="SecurityError"&&lr($),Q&&at)return U(Q);const wt=Date.now();X.fetch(x).then((zt=>{if(zt.ok){const Wt=M?zt.clone():null;return U(zt,Wt,wt)}return p(new ri(zt.statusText,zt.status,c.url))})).catch((zt=>{zt.code!==20&&p(new Error(zt.message))}))},U=($,Q,at)=>{(c.type==="arrayBuffer"?$.arrayBuffer():c.type==="json"?$.json():$.text()).then((wt=>{I||(Q&&at&&(function(zt,Wt,Ot){if(hs(),!eo)return;const Vt={status:Wt.status,statusText:Wt.statusText,headers:new X.Headers};Wt.headers.forEach(((Me,Ie)=>Vt.headers.set(Ie,Me)));const ne=Vl(Wt.headers.get("Cache-Control")||"");if(ne["no-store"])return;ne["max-age"]&&Vt.headers.set("Expires",new Date(Ot+1e3*ne["max-age"]).toUTCString());const qt=Vt.headers.get("Expires");qt&&(new Date(qt).getTime()-Ot<42e4||(function(Me,Ie){if(Ri===void 0)try{new Response(new ReadableStream),Ri=!0}catch{Ri=!1}Ri?Ie(Me.body):Me.blob().then(Ie)})(Wt,(Me=>{const Ie=new X.Response(Me,Vt);hs(),eo&&eo.then((Ge=>Ge.put($e(zt.url),Ie))).catch((Ge=>lr(Ge.message)))})))})(x,Q,at),E=!0,p(null,wt,$.headers.get("Cache-Control"),$.headers.get("Expires")))})).catch((wt=>{I||p(new Error(wt.message))}))};return M?(function($,Q){if(hs(),!eo)return Q(null);const at=$e($.url);eo.then((wt=>{wt.match(at).then((zt=>{const Wt=(function(Ot){if(!Ot)return!1;const Vt=new Date(Ot.headers.get("Expires")||0),ne=Vl(Ot.headers.get("Cache-Control")||"");return Vt>Date.now()&&!ne["no-cache"]})(zt);wt.delete(at),Wt&&wt.put(at,zt.clone()),Q(null,zt,Wt)})).catch(Q)})).catch(Q)})(x,k):k(null,null),{cancel:()=>{I=!0,E||y.abort()}}})(r,e);if(ui()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var s;return(function(c,p){const y=new X.XMLHttpRequest;y.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(y.responseType="arraybuffer");for(const x in c.headers)y.setRequestHeader(x,c.headers[x]);return c.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=c.credentials==="include",y.onerror=()=>{p(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let x=y.response;if(c.type==="json")try{x=JSON.parse(y.response)}catch(E){return p(E)}p(null,x,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else p(new ri(y.statusText,y.status,c.url))},y.send(c.body),{cancel:()=>y.abort()}})(r,e)},Rs=function(r,e){return Tr(mt(r,{type:"arrayBuffer"}),e)};function _r(r){const e=X.document.createElement("a");return e.href=r,e.protocol===X.document.location.protocol&&e.host===X.document.location.host}const Di="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fu,jl;fu=[],jl=0;const vl=function(r,e){if(At.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),jl>=st.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return fu.push(y),y}jl++;let s=!1;const c=()=>{if(!s)for(s=!0,jl--;fu.length&&jl<st.MAX_PARALLEL_IMAGE_REQUESTS;){const y=fu.shift(),{requestParameters:x,callback:E,cancelled:I}=y;I||(y.cancel=vl(x,E).cancel)}},p=Rs(r,((y,x,E,I)=>{c(),y?e(y):x&&(X.createImageBitmap?(function(M,O){const k=new X.Blob([new Uint8Array(M)],{type:"image/png"});X.createImageBitmap(k).then((U=>{O(null,U)})).catch((U=>{O(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(x,((M,O)=>e(M,O,E,I))):(function(M,O){const k=new X.Image,U=X.URL;k.onload=()=>{O(null,k),U.revokeObjectURL(k.src),k.onload=null,X.requestAnimationFrame((()=>{k.src=Di}))},k.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const $=new X.Blob([new Uint8Array(M)],{type:"image/png"});k.src=M.byteLength?U.createObjectURL($):Di})(x,((M,O)=>e(M,O,E,I))))}));return{cancel:()=>{p.cancel(),c()}}},ya="NO_ACCESS_TOKEN";function Dr(r){return r.indexOf("mapbox:")===0}function Kn(r){return st.API_URL_REGEX.test(r)}function oi(r){return st.API_STYLE_REGEX.test(r)&&!Ds(r)}function Ds(r){return st.API_SPRITE_REGEX.test(r)}const rr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ts(r){const e=r.match(rr);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Pi(r){const e=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${e}`}function Zr(r){if(!r)return null;const e=r.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(X.atob(e[1]).split("").map((s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch{return null}}class Yi{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const s=Zr(st.ACCESS_TOKEN);let c="";return c=s&&s.u?X.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,((p,y)=>String.fromCharCode(+("0x"+y))))):st.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${c}`:`mapbox.eventData:${c}`}fetchEventData(){const e=vi("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{const p=X.localStorage.getItem(s);p&&(this.eventData=JSON.parse(p));const y=X.localStorage.getItem(c);y&&(this.anonId=y)}catch{lr("Unable to read from LocalStorage")}}saveEventData(){const e=vi("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{X.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&X.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{lr("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,s,c,p){if(!st.EVENTS_URL)return;const y=ts(st.EVENTS_URL);y.params.push(`access_token=${p||st.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(e).toISOString()},E=s?mt(x,s):x,I={url:Pi(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=(function(M,O){return Tr(mt(M,{method:"POST"}),O)})(I,(M=>{this.pendingRequest=null,c(M),this.saveEventData(),this.processRequests(p)}))}queueRequest(e,s){this.queue.push(e),this.processRequests(s)}}const Ct=new class extends Yi{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,e){st.EVENTS_URL&&st.ACCESS_TOKEN&&Array.isArray(r)&&r.some((s=>Dr(s)||Kn(s)))&&this.queueRequest(Date.now(),e)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Zr(st.ACCESS_TOKEN),s=e?e.u:st.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;On(this.anonId)||(this.anonId=Be(),c=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),x=new Date(p),E=(p-this.eventData.lastSuccess)/864e5;c=c||E>=1||E<-1||y.getDate()!==x.getDate()}else c=!0;c?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:tt,skuId:lt,"enabled.telemetry":!1,userId:this.anonId},(y=>{y||(this.eventData.lastSuccess=p,this.eventData.tokenU=s)}),r):this.processRequests()}},et=Ct.postTurnstileEvent.bind(Ct),ot=new class extends Yi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,e,s,c){this.skuToken=e,this.errorCb=c,st.EVENTS_URL&&(s||st.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},s):this.errorCb(new Error(ya)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:s}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),On(this.anonId)||(this.anonId=Be()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:tt,skuId:lt,skuToken:this.skuToken,userId:this.anonId},(c=>{c?this.errorCb(c):e&&(this.success[e]=!0)}),r))}},Lt=ot.postMapLoadEvent.bind(ot),Pt=new class extends Yi{constructor(){super("gljs.performance")}postPerformanceEvent(r,e){st.EVENTS_URL&&(r||st.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:s}=this.queue.shift(),c=(function(p){const y=X.performance.getEntriesByType("resource"),x=X.performance.getEntriesByType("mark"),E=(function(U){const $={};if(U){for(const Q in U)if(Q!=="other")for(const at of U[Q]){const wt=`${Q}RequestCount`,zt=`${Q}ResolveRangeMin`,Wt=`${Q}ResolveRangeMax`;$[zt]=Math.min($[zt]||1/0,at.startTime),$[Wt]=Math.max($[Wt]||-1/0,at.responseEnd),$[wt]===void 0&&($[wt]=0),++$[wt]}}return $})((function(U,$){const Q={};if(U)for(const at of U){const wt=$(at);Q[wt]===void 0&&(Q[wt]=[]),Q[wt].push(at)}return Q})(y,yn)),I=X.devicePixelRatio,M=X.navigator.connection||X.navigator.mozConnection||X.navigator.webkitConnection,O={counters:[],metadata:[],attributes:[]},k=(U,$,Q)=>{Q!=null&&U.push({name:$,value:Q.toString()})};for(const U in E)k(O.counters,U,E[U]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(k(O.counters,"interactionRangeMin",p.interactionRange[0]),k(O.counters,"interactionRangeMax",p.interactionRange[1])),x)for(const U of Object.keys(me)){const $=me[U],Q=x.find((at=>at.name===$));Q&&k(O.counters,$,Q.startTime)}return k(O.counters,"visibilityHidden",p.visibilityHidden),k(O.attributes,"style",(function(U){if(U)for(const $ of U){const Q=$.name.split("?")[0];if(oi(Q)){const at=Q.split("/").slice(-2);if(at.length===2)return`mapbox://styles/${at[0]}/${at[1]}`}}})(y)),k(O.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),k(O.attributes,"fogEnabled",p.fogEnabled?"true":"false"),k(O.attributes,"projection",p.projection.name),k(O.attributes,"zoom",p.zoom),k(O.metadata,"devicePixelRatio",I),k(O.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),k(O.metadata,"navigatorUserAgent",X.navigator.userAgent),k(O.metadata,"screenWidth",X.screen.width),k(O.metadata,"screenHeight",X.screen.height),k(O.metadata,"windowWidth",X.innerWidth),k(O.metadata,"windowHeight",X.innerHeight),k(O.metadata,"mapWidth",p.width/I),k(O.metadata,"mapHeight",p.height/I),k(O.metadata,"webglRenderer",p.renderer),k(O.metadata,"webglVendor",p.vendor),k(O.metadata,"sdkVersion",tt),k(O.metadata,"sdkIdentifier","mapbox-gl-js"),O})(s);for(const p of c.metadata);for(const p of c.counters);for(const p of c.attributes);this.postEvent(e,c,(()=>{}),r)}},Kt=Pt.postPerformanceEvent.bind(Pt),ue=new class extends Yi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,e,s,c){if(!st.API_URL||!st.SESSION_PATH)return;const p=ts(st.API_URL+st.SESSION_PATH);p.params.push(`sku=${e||""}`),p.params.push(`access_token=${c||st.ACCESS_TOKEN||""}`);const y={url:Pi(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=(function(x,E){return Tr(mt(x,{method:"GET"}),E)})(y,(x=>{this.pendingRequest=null,s(x),this.saveEventData(),this.processRequests(c)}))}getSessionAPI(r,e,s,c){this.skuToken=e,this.errorCb=c,st.SESSION_PATH&&st.API_URL&&(s||st.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},s):this.errorCb(new Error(ya)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:s}=this.queue.shift();e&&this.success[e]||this.getSession(s,this.skuToken,(c=>{c?this.errorCb(c):e&&(this.success[e]=!0)}),r)}},se=ue.getSessionAPI.bind(ue),$t=new Set,me={create:"create",load:"load",fullLoad:"fullLoad"},je={mark(r){X.performance.mark(r)},measure(r,e,s){X.performance.measure(r,e,s)}};function yn(r){const e=r.name.split("?")[0];return e.includes("mapbox-gl.js")?"javascript":e.includes("mapbox-gl.css")?"css":(function(s){return st.API_FONTS_REGEX.test(s)})(e)?"fontRange":Ds(e)?"sprite":oi(e)?"style":(function(s){return st.API_TILEJSON_REGEX.test(s)})(e)?"tilejson":"other"}const Je=X.performance;function Zn(r){const e=r?r.url.toString():void 0;return Je.getEntriesByName(e)}let jn,Fn,Qn,fi;const ki={now:()=>Qn!==void 0?Qn:X.performance.now(),setNow(r){Qn=r},restoreNow(){Qn=void 0},frame(r){const e=X.requestAnimationFrame(r);return{cancel:()=>X.cancelAnimationFrame(e)}},getImageData(r,e=0){const{width:s,height:c}=r;fi||(fi=X.document.createElement("canvas"));const p=fi.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return(s>fi.width||c>fi.height)&&(fi.width=s,fi.height=c),p.clearRect(-e,-e,s+2*e,c+2*e),p.drawImage(r,0,0,s,c),p.getImageData(-e,-e,s+2*e,c+2*e)},resolveURL:r=>(jn||(jn=X.document.createElement("a")),jn.href=r,jn.href),get devicePixelRatio(){return X.devicePixelRatio},get prefersReducedMotion(){return!!X.matchMedia&&(Fn==null&&(Fn=X.matchMedia("(prefers-reduced-motion: reduce)")),Fn.matches)}};function Dn(r,e,s){s[r]&&s[r].indexOf(e)!==-1||(s[r]=s[r]||[],s[r].push(e))}function Vi(r,e,s){if(s&&s[r]){const c=s[r].indexOf(e);c!==-1&&s[r].splice(c,1)}}class _i{constructor(e,s={}){mt(this,s),this.type=e}}class Ra extends _i{constructor(e,s={}){super("error",mt({error:e},s))}}class Ss{on(e,s){return this._listeners=this._listeners||{},Dn(e,s,this._listeners),this}off(e,s){return Vi(e,s,this._listeners),Vi(e,s,this._oneTimeListeners),this}once(e,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Dn(e,s,this._oneTimeListeners),this):new Promise((c=>this.once(e,c)))}fire(e,s){typeof e=="string"&&(e=new _i(e,s||{}));const c=e.type;if(this.listens(c)){e.target=this;const p=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const E of p)E.call(this,e);const y=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const E of y)Vi(c,E,this._oneTimeListeners),E.call(this,e);const x=this._eventedParent;x&&(mt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(e))}else e instanceof Ra&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,s){return this._eventedParent=e,this._eventedParentData=s,this}}var _e=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Hr(r,...e){for(const s of e)for(const c in s)r[c]=s[c];return r}function Rn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function _a(r){if(Array.isArray(r))return r.map(_a);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const s in r)e[s]=_a(r[s]);return e}return Rn(r)}class Ns extends Error{constructor(e,s){super(s),this.message=s,this.key=e}}var gi=Ns;class ji{constructor(e,s=[]){this.parent=e,this.bindings={};for(const[c,p]of s)this.bindings[c]=p}concat(e){return new ji(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var ea=ji;const kr={kind:"null"},re={kind:"number"},gn={kind:"string"},zn={kind:"boolean"},Ts={kind:"color"},Ja={kind:"object"},Hn={kind:"value"},Ka={kind:"collator"},Ur={kind:"formatted"},na={kind:"resolvedImage"};function br(r,e){return{kind:"array",itemType:r,N:e}}function Qi(r){if(r.kind==="array"){const e=Qi(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const R=[kr,re,gn,zn,Ts,Ur,Ja,br(Hn),na];function H(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!H(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const s of R)if(!H(s,e))return null}}return`Expected ${Qi(r)} but found ${Qi(e)} instead.`}function ft(r,e){return e.some((s=>s.kind===r.kind))}function Ht(r,e){return e.some((s=>s==="null"?r===null:s==="array"?Array.isArray(r):s==="object"?r&&!Array.isArray(r)&&typeof r=="object":s===typeof r))}var Ce,pe={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function be(r){return(r=Math.round(r))<0?0:r>255?255:r}function en(r){return be(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function nn(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function wn(r,e,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?r+(e-r)*s*6:2*s<1?e:3*s<2?r+(e-r)*(2/3-s)*6:r}try{Ce={}.parseCSSColor=function(r){var e,s=r.replace(/ /g,"").toLowerCase();if(s in pe)return pe[s].slice();if(s[0]==="#")return s.length===4?(e=parseInt(s.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:s.length===7&&(e=parseInt(s.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var c=s.indexOf("("),p=s.indexOf(")");if(c!==-1&&p+1===s.length){var y=s.substr(0,c),x=s.substr(c+1,p-(c+1)).split(","),E=1;switch(y){case"rgba":if(x.length!==4)return null;E=nn(x.pop());case"rgb":return x.length!==3?null:[en(x[0]),en(x[1]),en(x[2]),E];case"hsla":if(x.length!==4)return null;E=nn(x.pop());case"hsl":if(x.length!==3)return null;var I=(parseFloat(x[0])%360+360)%360/360,M=nn(x[1]),O=nn(x[2]),k=O<=.5?O*(M+1):O+M-O*M,U=2*O-k;return[be(255*wn(U,k,I+1/3)),be(255*wn(U,k,I)),be(255*wn(U,k,I-1/3)),E];default:return null}}return null}}catch{}class we{constructor(e,s,c,p=1){this.r=e,this.g=s,this.b=c,this.a=p}static parse(e){if(!e)return;if(e instanceof we)return e;if(typeof e!="string")return;const s=Ce(e);return s?new we(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[e,s,c,p]=this.toArray();return`rgba(${Math.round(e)},${Math.round(s)},${Math.round(c)},${p})`}toArray(){const{r:e,g:s,b:c,a:p}=this;return p===0?[0,0,0,0]:[255*e/p,255*s/p,255*c/p,p]}toArray01(){const{r:e,g:s,b:c,a:p}=this;return p===0?[0,0,0,0]:[e/p,s/p,c/p,p]}toArray01PremultipliedAlpha(){const{r:e,g:s,b:c,a:p}=this;return[e,s,c,p]}}we.black=new we(0,0,0,1),we.white=new we(1,1,1,1),we.transparent=new we(0,0,0,0),we.red=new we(1,0,0,1),we.blue=new we(0,0,1,1);var Qe=we;class Tn{constructor(e,s,c){this.sensitivity=e?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,s){return this.collator.compare(e,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yn{constructor(e,s,c,p,y){this.text=e.normalize?e.normalize():e,this.image=s,this.scale=c,this.fontStack=p,this.textColor=y}}class Pn{constructor(e){this.sections=e}static fromString(e){return new Pn([new Yn(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof Pn?e:Pn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}serialize(){const e=["format"];for(const s of this.sections){if(s.image){e.push(["image",s.image.name]);continue}e.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),e.push(c)}return e}}class Ni{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ni({name:e,available:!1}):null}serialize(){return["image",this.name]}}function ke(r,e,s,c){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[r,e,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[r,e,s,c]:[r,e,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _n(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Qe||r instanceof Tn||r instanceof Pn||r instanceof Ni)return!0;if(Array.isArray(r)){for(const e of r)if(!_n(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!_n(r[e]))return!1;return!0}return!1}function kn(r){if(r===null)return kr;if(typeof r=="string")return gn;if(typeof r=="boolean")return zn;if(typeof r=="number")return re;if(r instanceof Qe)return Ts;if(r instanceof Tn)return Ka;if(r instanceof Pn)return Ur;if(r instanceof Ni)return na;if(Array.isArray(r)){const e=r.length;let s;for(const c of r){const p=kn(c);if(s){if(s===p)continue;s=Hn;break}s=p}return br(s||Hn,e)}return Ja}function Xi(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof Qe||r instanceof Pn||r instanceof Ni?r.toString():JSON.stringify(r)}class Wi{constructor(e,s){this.type=e,this.value=s}static parse(e,s){if(e.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!_n(e[1]))return s.error("invalid value");const c=e[1];let p=kn(c);const y=s.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new Wi(p,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Qe?["rgba"].concat(this.value.toArray()):this.value instanceof Pn?this.value.serialize():this.value}}var xn=Wi,gr=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const ur={string:gn,number:re,boolean:zn,object:Ja};class qi{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");let c,p=1;const y=e[0];if(y==="array"){let E,I;if(e.length>2){const M=e[1];if(typeof M!="string"||!(M in ur)||M==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);E=ur[M],p++}else E=Hn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return s.error('The length argument to "array" must be a positive integer literal',2);I=e[2],p++}c=br(E,I)}else c=ur[y];const x=[];for(;p<e.length;p++){const E=s.parse(e[p],p,Hn);if(!E)return null;x.push(E)}return new qi(c,x)}evaluate(e){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(e);if(!H(this.type,kn(c)))return c;if(s===this.args.length-1)throw new gr(`Expected value to be of type ${Qi(this.type)}, but found ${Qi(kn(c))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=this.type,s=[e.kind];if(e.kind==="array"){const c=e.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const p=e.N;(typeof p=="number"||this.args.length>1)&&s.push(p)}}return s.concat(this.args.map((c=>c.serialize())))}}var Yr=qi;class ss{constructor(e){this.type=Ur,this.sections=e}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const c=e[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const p=[];let y=!1;for(let x=1;x<=e.length-1;++x){const E=e[x];if(y&&typeof E=="object"&&!Array.isArray(E)){y=!1;let I=null;if(E["font-scale"]&&(I=s.parse(E["font-scale"],1,re),!I))return null;let M=null;if(E["text-font"]&&(M=s.parse(E["text-font"],1,br(gn)),!M))return null;let O=null;if(E["text-color"]&&(O=s.parse(E["text-color"],1,Ts),!O))return null;const k=p[p.length-1];k.scale=I,k.font=M,k.textColor=O}else{const I=s.parse(e[x],1,Hn);if(!I)return null;const M=I.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:I,scale:null,font:null,textColor:null})}}return new ss(p)}evaluate(e){return new Pn(this.sections.map((s=>{const c=s.content.evaluate(e);return kn(c)===na?new Yn("",c,null,null,null):new Yn(Xi(c),null,s.scale?s.scale.evaluate(e):null,s.font?s.font.evaluate(e).join(","):null,s.textColor?s.textColor.evaluate(e):null)})))}eachChild(e){for(const s of this.sections)e(s.content),s.scale&&e(s.scale),s.font&&e(s.font),s.textColor&&e(s.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const s of this.sections){e.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),e.push(c)}return e}}class Da{constructor(e){this.type=na,this.input=e}static parse(e,s){if(e.length!==2)return s.error("Expected two arguments.");const c=s.parse(e[1],1,gn);return c?new Da(c):s.error("No image name provided.")}evaluate(e){const s=this.input.evaluate(e),c=Ni.fromString(s);return c&&e.availableImages&&(c.available=e.availableImages.indexOf(s)>-1),c}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Co={"to-boolean":zn,"to-color":Ts,"to-number":re,"to-string":gn};class no{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const c=e[0];if((c==="to-boolean"||c==="to-string")&&e.length!==2)return s.error("Expected one argument.");const p=Co[c],y=[];for(let x=1;x<e.length;x++){const E=s.parse(e[x],x,Hn);if(!E)return null;y.push(E)}return new no(p,y)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let s,c;for(const p of this.args){if(s=p.evaluate(e),c=null,s instanceof Qe)return s;if(typeof s=="string"){const y=e.parseColor(s);if(y)return y}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:ke(s[0],s[1],s[2],s[3]),!c))return new Qe(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new gr(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(e),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new gr(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Pn.fromString(Xi(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ni.fromString(Xi(this.args[0].evaluate(e))):Xi(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new ss([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Da(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild((s=>{e.push(s.serialize())})),e}}var fs=no;const Ci=["Unknown","Point","LineString","Polygon"];var ho=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ci[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:s,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*e-r[0])+this.featureDistanceData.bearing[1]*(c*e-r[1])}return 0}parseColor(r){let e=this._parseColorCache[r];return e||(e=this._parseColorCache[r]=Qe.parse(r)),e}};class fo{constructor(e,s,c,p){this.name=e,this.type=s,this._evaluate=c,this.args=p}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((e=>e.serialize())))}static parse(e,s){const c=e[0],p=fo.definitions[c];if(!p)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=x.filter((([M])=>!Array.isArray(M)||M.length===e.length-1));let I=null;for(const[M,O]of E){I=new po(s.registry,s.path,null,s.scope);const k=[];let U=!1;for(let $=1;$<e.length;$++){const Q=e[$],at=Array.isArray(M)?M[$-1]:M.type,wt=I.parse(Q,1+k.length,at);if(!wt){U=!0;break}k.push(wt)}if(!U)if(Array.isArray(M)&&M.length!==k.length)I.error(`Expected ${M.length} arguments, but found ${k.length} instead.`);else{for(let $=0;$<k.length;$++){const Q=Array.isArray(M)?M[$]:M.type,at=k[$];I.concat($+1).checkSubtype(Q,at.type)}if(I.errors.length===0)return new fo(c,y,O,k)}}if(E.length===1)s.errors.push(...I.errors);else{const M=(E.length?E:x).map((([k])=>{return U=k,Array.isArray(U)?`(${U.map(Qi).join(", ")})`:`(${Qi(U.type)}...)`;var U})).join(" | "),O=[];for(let k=1;k<e.length;k++){const U=s.parse(e[k],1+O.length);if(!U)return null;O.push(Qi(U.type))}s.error(`Expected arguments of type ${M}, but found (${O.join(", ")}) instead.`)}return null}static register(e,s){fo.definitions=s;for(const c in s)e[c]=fo}}var io=fo;class jo{constructor(e,s,c){this.type=Ka,this.locale=c,this.caseSensitive=e,this.diacriticSensitive=s}static parse(e,s){if(e.length!==2)return s.error("Expected one argument.");const c=e[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const p=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,zn);if(!p)return null;const y=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,zn);if(!y)return null;let x=null;return c.locale&&(x=s.parse(c.locale,1,gn),!x)?null:new jo(p,y,x)}evaluate(e){return new Tn(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Io=8192;function Cs(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function ro(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Os(r,e){const s=(180+r[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,p=Math.pow(2,e.z);return[Math.round(s*p*Io),Math.round(c*p*Io)]}function Pu(r,e,s){const c=r[0]-e[0],p=r[1]-e[1],y=r[0]-s[0],x=r[1]-s[1];return c*x-y*p==0&&c*y<=0&&p*x<=0}function Qa(r,e){let s=!1;for(let x=0,E=e.length;x<E;x++){const I=e[x];for(let M=0,O=I.length;M<O-1;M++){if(Pu(r,I[M],I[M+1]))return!1;(p=I[M])[1]>(c=r)[1]!=(y=I[M+1])[1]>c[1]&&c[0]<(y[0]-p[0])*(c[1]-p[1])/(y[1]-p[1])+p[0]&&(s=!s)}}var c,p,y;return s}function xl(r,e){for(let s=0;s<e.length;s++)if(Qa(r,e[s]))return!0;return!1}function Ke(r,e,s,c){const p=c[0]-s[0],y=c[1]-s[1],x=(r[0]-s[0])*y-p*(r[1]-s[1]),E=(e[0]-s[0])*y-p*(e[1]-s[1]);return x>0&&E<0||x<0&&E>0}function Hs(r,e,s){for(const M of s)for(let O=0;O<M.length-1;++O)if((E=[(x=M[O+1])[0]-(y=M[O])[0],x[1]-y[1]])[0]*(I=[(p=e)[0]-(c=r)[0],p[1]-c[1]])[1]-E[1]*I[0]!=0&&Ke(c,p,y,x)&&Ke(y,x,c,p))return!0;var c,p,y,x,E,I;return!1}function wr(r,e){for(let s=0;s<r.length;++s)if(!Qa(r[s],e))return!1;for(let s=0;s<r.length-1;++s)if(Hs(r[s],r[s+1],e))return!1;return!0}function tl(r,e){for(let s=0;s<e.length;s++)if(wr(r,e[s]))return!0;return!1}function Xo(r,e,s){const c=[];for(let p=0;p<r.length;p++){const y=[];for(let x=0;x<r[p].length;x++){const E=Os(r[p][x],s);Cs(e,E),y.push(E)}c.push(y)}return c}function du(r,e,s){const c=[];for(let p=0;p<r.length;p++){const y=Xo(r[p],e,s);c.push(y)}return c}function Na(r,e,s,c){if(r[0]<s[0]||r[0]>s[2]){const p=.5*c;let y=r[0]-s[0]>p?-c:s[0]-r[0]>p?c:0;y===0&&(y=r[0]-s[2]>p?-c:s[2]-r[0]>p?c:0),r[0]+=y}Cs(e,r)}function ia(r,e,s,c){const p=Math.pow(2,c.z)*Io,y=[c.x*Io,c.y*Io],x=[];if(!r)return x;for(const E of r)for(const I of E){const M=[I.x+y[0],I.y+y[1]];Na(M,e,s,p),x.push(M)}return x}function Xl(r,e,s,c){const p=Math.pow(2,c.z)*Io,y=[c.x*Io,c.y*Io],x=[];if(!r)return x;for(const I of r){const M=[];for(const O of I){const k=[O.x+y[0],O.y+y[1]];Cs(e,k),M.push(k)}x.push(M)}if(e[2]-e[0]<=p/2){(E=e)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const I of x)for(const M of I)Na(M,e,s,p)}var E;return x}class zs{constructor(e,s){this.type=zn,this.geojson=e,this.geometries=s}static parse(e,s){if(e.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(_n(e[1])){const c=e[1];if(c.type==="FeatureCollection")for(let p=0;p<c.features.length;++p){const y=c.features[p].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new zs(c,c.features[p].geometry)}else if(c.type==="Feature"){const p=c.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new zs(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new zs(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(s,c){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(!x)return!1;if(c.type==="Polygon"){const E=Xo(c.coordinates,y,x),I=ia(s.geometry(),p,y,x);if(!ro(p,y))return!1;for(const M of I)if(!Qa(M,E))return!1}if(c.type==="MultiPolygon"){const E=du(c.coordinates,y,x),I=ia(s.geometry(),p,y,x);if(!ro(p,y))return!1;for(const M of I)if(!xl(M,E))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(s,c){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(!x)return!1;if(c.type==="Polygon"){const E=Xo(c.coordinates,y,x),I=Xl(s.geometry(),p,y,x);if(!ro(p,y))return!1;for(const M of I)if(!wr(M,E))return!1}if(c.type==="MultiPolygon"){const E=du(c.coordinates,y,x),I=Xl(s.geometry(),p,y,x);if(!ro(p,y))return!1;for(const M of I)if(!tl(M,E))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Oi=zs;function Mo(r){if(r instanceof io&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Oi)return!1;let e=!0;return r.eachChild((s=>{e&&!Mo(s)&&(e=!1)})),e}function Ps(r){if(r instanceof io&&r.name==="feature-state")return!1;let e=!0;return r.eachChild((s=>{e&&!Ps(s)&&(e=!1)})),e}function Ao(r,e){if(r instanceof io&&e.indexOf(r.name)>=0)return!1;let s=!0;return r.eachChild((c=>{s&&!Ao(c,e)&&(s=!1)})),s}class va{constructor(e,s){this.type=s.type,this.name=e,this.boundExpression=s}static parse(e,s){if(e.length!==2||typeof e[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=e[1];return s.scope.has(c)?new va(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Zl=va;class Zo{constructor(e,s=[],c,p=new ea,y=[]){this.registry=e,this.path=s,this.key=s.map((x=>`[${x}]`)).join(""),this.scope=p,this.errors=y,this.expectedType=c}parse(e,s,c,p,y={}){return s?this.concat(s,c,p)._parse(e,y):this._parse(e,y)}_parse(e,s){function c(p,y,x){return x==="assert"?new Yr(y,[p]):x==="coerce"?new fs(y,[p]):p}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=e[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[p];if(y){let x=y.parse(e,this);if(!x)return null;if(this.expectedType){const E=this.expectedType,I=x.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||I.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string"){if(this.checkSubtype(E,I))return null}else x=c(x,E,s.typeAnnotation||"coerce");else x=c(x,E,s.typeAnnotation||"assert")}if(!(x instanceof xn)&&x.type.kind!=="resolvedImage"&&ra(x)){const E=new ho;try{x=new xn(x.type,x.evaluate(E))}catch(I){return this.error(I.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,s,c){const p=typeof e=="number"?this.path.concat(e):this.path,y=c?this.scope.concat(c):this.scope;return new Zo(this.registry,p,s||null,y,this.errors)}error(e,...s){const c=`${this.key}${s.map((p=>`[${p}]`)).join("")}`;this.errors.push(new gi(c,e))}checkSubtype(e,s){const c=H(e,s);return c&&this.error(c),c}}var po=Zo;function ra(r){if(r instanceof Zl)return ra(r.boundExpression);if(r instanceof io&&r.name==="error"||r instanceof jo||r instanceof Oi)return!1;const e=r instanceof fs||r instanceof Yr;let s=!0;return r.eachChild((c=>{s=e?s&&ra(c):s&&c instanceof xn})),!!s&&Mo(r)&&Ao(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function xa(r,e){const s=r.length-1;let c,p,y=0,x=s,E=0;for(;y<=x;)if(E=Math.floor((y+x)/2),c=r[E],p=r[E+1],c<=e){if(E===s||e<p)return E;y=E+1}else{if(!(c>e))throw new gr("Input is not a number.");x=E-1}return 0}class Ho{constructor(e,s,c){this.type=e,this.input=s,this.labels=[],this.outputs=[];for(const[p,y]of c)this.labels.push(p),this.outputs.push(y)}static parse(e,s){if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(e[1],1,re);if(!c)return null;const p=[];let y=null;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);for(let x=1;x<e.length;x+=2){const E=x===1?-1/0:e[x],I=e[x+1],M=x,O=x+1;if(typeof E!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(p.length&&p[p.length-1][0]>=E)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const k=s.parse(I,O,y);if(!k)return null;y=y||k.type,p.push([E,k])}return new Ho(y,c,p)}evaluate(e){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(e);const p=this.input.evaluate(e);if(p<=s[0])return c[0].evaluate(e);const y=s.length;return p>=s[y-1]?c[y-1].evaluate(e):c[xa(s,p)].evaluate(e)}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){const e=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&e.push(this.labels[s]),e.push(this.outputs[s].serialize());return e}}var bl=Ho;function Ii(r,e,s){return r*(1-s)+e*s}var wl=Object.freeze({__proto__:null,number:Ii,color:function(r,e,s){return new Qe(Ii(r.r,e.r,s),Ii(r.g,e.g,s),Ii(r.b,e.b,s),Ii(r.a,e.a,s))},array:function(r,e,s){return r.map(((c,p)=>Ii(c,e[p],s)))}});const Oa=.95047,Hl=1.08883,Lo=4/29,za=6/29,Bu=3*za*za,sa=Math.PI/180,Ju=180/Math.PI;function Nr(r){return r>.008856451679035631?Math.pow(r,1/3):r/Bu+Lo}function El(r){return r>za?r*r*r:Bu*(r-Lo)}function ba(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function el(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Yl(r){const e=el(r.r),s=el(r.g),c=el(r.b),p=Nr((.4124564*e+.3575761*s+.1804375*c)/Oa),y=Nr((.2126729*e+.7151522*s+.072175*c)/1);return{l:116*y-16,a:500*(p-y),b:200*(y-Nr((.0193339*e+.119192*s+.9503041*c)/Hl)),alpha:r.a}}function Ku(r){let e=(r.l+16)/116,s=isNaN(r.a)?e:e+r.a/500,c=isNaN(r.b)?e:e-r.b/200;return e=1*El(e),s=Oa*El(s),c=Hl*El(c),new Qe(ba(3.2404542*s-1.5371385*e-.4985314*c),ba(-.969266*s+1.8760108*e+.041556*c),ba(.0556434*s-.2040259*e+1.0572252*c),r.alpha)}function Qu(r,e,s){const c=e-r;return r+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const Pa={forward:Yl,reverse:Ku,interpolate:function(r,e,s){return{l:Ii(r.l,e.l,s),a:Ii(r.a,e.a,s),b:Ii(r.b,e.b,s),alpha:Ii(r.alpha,e.alpha,s)}}},Ro={forward:function(r){const{l:e,a:s,b:c}=Yl(r),p=Math.atan2(c,s)*Ju;return{h:p<0?p+360:p,c:Math.sqrt(s*s+c*c),l:e,alpha:r.a}},reverse:function(r){const e=r.h*sa,s=r.c;return Ku({l:r.l,a:Math.cos(e)*s,b:Math.sin(e)*s,alpha:r.alpha})},interpolate:function(r,e,s){return{h:Qu(r.h,e.h,s),c:Ii(r.c,e.c,s),l:Ii(r.l,e.l,s),alpha:Ii(r.alpha,e.alpha,s)}}};var Ys=Object.freeze({__proto__:null,lab:Pa,hcl:Ro});class go{constructor(e,s,c,p,y){this.type=e,this.operator=s,this.interpolation=c,this.input=p,this.labels=[],this.outputs=[];for(const[x,E]of y)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(e,s,c,p){let y=0;if(e.name==="exponential")y=oe(s,e.base,c,p);else if(e.name==="linear")y=oe(s,1,c,p);else if(e.name==="cubic-bezier"){const x=e.controlPoints;y=new pt(x[0],x[1],x[2],x[3]).solve(oe(s,1,c,p))}return y}static parse(e,s){let[c,p,y,...x]=e;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const M=p[1];if(typeof M!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:M}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const M=p.slice(1);if(M.length!==4||M.some((O=>typeof O!="number"||O<0||O>1)))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:M}}}if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(y=s.parse(y,2,re),!y)return null;const E=[];let I=null;c==="interpolate-hcl"||c==="interpolate-lab"?I=Ts:s.expectedType&&s.expectedType.kind!=="value"&&(I=s.expectedType);for(let M=0;M<x.length;M+=2){const O=x[M],k=x[M+1],U=M+3,$=M+4;if(typeof O!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(E.length&&E[E.length-1][0]>=O)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const Q=s.parse(k,$,I);if(!Q)return null;I=I||Q.type,E.push([O,Q])}return I.kind==="number"||I.kind==="color"||I.kind==="array"&&I.itemType.kind==="number"&&typeof I.N=="number"?new go(I,c,p,y,E):s.error(`Type ${Qi(I)} is not interpolatable.`)}evaluate(e){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(e);const p=this.input.evaluate(e);if(p<=s[0])return c[0].evaluate(e);const y=s.length;if(p>=s[y-1])return c[y-1].evaluate(e);const x=xa(s,p),E=go.interpolationFactor(this.interpolation,p,s[x],s[x+1]),I=c[x].evaluate(e),M=c[x+1].evaluate(e);return this.operator==="interpolate"?wl[this.type.kind.toLowerCase()](I,M,E):this.operator==="interpolate-hcl"?Ro.reverse(Ro.interpolate(Ro.forward(I),Ro.forward(M),E)):Pa.reverse(Pa.interpolate(Pa.forward(I),Pa.forward(M),E))}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,e,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function oe(r,e,s,c){const p=c-s,y=r-s;return p===0?0:e===1?y/p:(Math.pow(e,y)-1)/(Math.pow(e,p)-1)}var De=go;class vn{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expectected at least one argument.");let c=null;const p=s.expectedType;p&&p.kind!=="value"&&(c=p);const y=[];for(const E of e.slice(1)){const I=s.parse(E,1+y.length,c,void 0,{typeAnnotation:"omit"});if(!I)return null;c=c||I.type,y.push(I)}const x=p&&y.some((E=>H(p,E.type)));return new vn(x?Hn:c,y)}evaluate(e){let s,c=null,p=0;for(const y of this.args){if(p++,c=y.evaluate(e),c&&c instanceof Ni&&!c.available&&(s||(s=c),c=null,p===this.args.length))return s;if(c!==null)break}return c}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=["coalesce"];return this.eachChild((s=>{e.push(s.serialize())})),e}}var Wn=vn;class mn{constructor(e,s){this.type=s.type,this.bindings=[].concat(e),this.result=s}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const s of this.bindings)e(s[1]);e(this.result)}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const c=[];for(let y=1;y<e.length-1;y+=2){const x=e[y];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=s.parse(e[y+1],y+1);if(!E)return null;c.push([x,E])}const p=s.parse(e[e.length-1],e.length-1,s.expectedType,c);return p?new mn(c,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[s,c]of this.bindings)e.push(s,c.serialize());return e.push(this.result.serialize()),e}}var hi=mn;class wi{constructor(e,s,c){this.type=e,this.index=s,this.input=c}static parse(e,s){if(e.length!==3)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,re),p=s.parse(e[2],2,br(s.expectedType||Hn));return c&&p?new wi(p.type.itemType,c,p):null}evaluate(e){const s=this.index.evaluate(e),c=this.input.evaluate(e);if(s<0)throw new gr(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new gr(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new gr(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var sr=wi;class Ws{constructor(e,s){this.type=zn,this.needle=e,this.haystack=s}static parse(e,s){if(e.length!==3)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,Hn),p=s.parse(e[2],2,Hn);return c&&p?ft(c.type,[zn,gn,re,kr,Hn])?new Ws(c,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(c.type)} instead`):null}evaluate(e){const s=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(c==null)return!1;if(!Ht(s,["boolean","string","number","null"]))throw new gr(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(kn(s))} instead.`);if(!Ht(c,["string","array"]))throw new gr(`Expected second argument to be of type array or string, but found ${Qi(kn(c))} instead.`);return c.indexOf(s)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var ds=Ws;class Gr{constructor(e,s,c){this.type=re,this.needle=e,this.haystack=s,this.fromIndex=c}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,Hn),p=s.parse(e[2],2,Hn);if(!c||!p)return null;if(!ft(c.type,[zn,gn,re,kr,Hn]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(c.type)} instead`);if(e.length===4){const y=s.parse(e[3],3,re);return y?new Gr(c,p,y):null}return new Gr(c,p)}evaluate(e){const s=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!Ht(s,["boolean","string","number","null"]))throw new gr(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(kn(s))} instead.`);if(!Ht(c,["string","array"]))throw new gr(`Expected second argument to be of type array or string, but found ${Qi(kn(c))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(e);return c.indexOf(s,p)}return c.indexOf(s)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Jn=Gr;class zi{constructor(e,s,c,p,y,x){this.inputType=e,this.type=s,this.input=c,this.cases=p,this.outputs=y,this.otherwise=x}static parse(e,s){if(e.length<5)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return s.error("Expected an even number of arguments.");let c,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const y={},x=[];for(let M=2;M<e.length-1;M+=2){let O=e[M];const k=e[M+1];Array.isArray(O)||(O=[O]);const U=s.concat(M);if(O.length===0)return U.error("Expected at least one branch label.");for(const Q of O){if(typeof Q!="number"&&typeof Q!="string")return U.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return U.error("Numeric branch labels must be integer values.");if(c){if(U.checkSubtype(c,kn(Q)))return null}else c=kn(Q);if(y[String(Q)]!==void 0)return U.error("Branch labels must be unique.");y[String(Q)]=x.length}const $=s.parse(k,M,p);if(!$)return null;p=p||$.type,x.push($)}const E=s.parse(e[1],1,Hn);if(!E)return null;const I=s.parse(e[e.length-1],e.length-1,p);return I?E.type.kind!=="value"&&s.concat(1).checkSubtype(c,E.type)?null:new zi(c,p,E,y,x,I):null}evaluate(e){const s=this.input.evaluate(e);return(kn(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],p={};for(const x of s){const E=p[this.cases[x]];E===void 0?(p[this.cases[x]]=c.length,c.push([this.cases[x],[x]])):c[E][1].push(x)}const y=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,E]of c)e.push(E.length===1?y(E[0]):E.map(y)),e.push(this.outputs[x].serialize());return e.push(this.otherwise.serialize()),e}}var tr=zi;class cr{constructor(e,s,c){this.type=e,this.branches=s,this.otherwise=c}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const p=[];for(let x=1;x<e.length-1;x+=2){const E=s.parse(e[x],x,zn);if(!E)return null;const I=s.parse(e[x+1],x+1,c);if(!I)return null;p.push([E,I]),c=c||I.type}const y=s.parse(e[e.length-1],e.length-1,c);return y?new cr(c,p,y):null}evaluate(e){for(const[s,c]of this.branches)if(s.evaluate(e))return c.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[s,c]of this.branches)e(s),e(c);e(this.otherwise)}outputDefined(){return this.branches.every((([e,s])=>s.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild((s=>{e.push(s.serialize())})),e}}var Yo=cr;class wa{constructor(e,s,c,p){this.type=e,this.input=s,this.beginIndex=c,this.endIndex=p}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,Hn),p=s.parse(e[2],2,re);if(!c||!p)return null;if(!ft(c.type,[br(Hn),gn,Hn]))return s.error(`Expected first argument to be of type array or string, but found ${Qi(c.type)} instead`);if(e.length===4){const y=s.parse(e[3],3,re);return y?new wa(c.type,c,p,y):null}return new wa(c.type,c,p)}evaluate(e){const s=this.input.evaluate(e),c=this.beginIndex.evaluate(e);if(!Ht(s,["string","array"]))throw new gr(`Expected first argument to be of type array or string, but found ${Qi(kn(s))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(e);return s.slice(c,p)}return s.slice(c)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Gs=wa;function ps(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Ba(r,e,s,c){return c.compare(e,s)===0}function Sl(r,e,s){const c=r!=="=="&&r!=="!=";return class Sx{constructor(y,x,E){this.type=zn,this.lhs=y,this.rhs=x,this.collator=E,this.hasUntypedArgument=y.type.kind==="value"||x.type.kind==="value"}static parse(y,x){if(y.length!==3&&y.length!==4)return x.error("Expected two or three arguments.");const E=y[0];let I=x.parse(y[1],1,Hn);if(!I)return null;if(!ps(E,I.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${Qi(I.type)}'.`);let M=x.parse(y[2],2,Hn);if(!M)return null;if(!ps(E,M.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${Qi(M.type)}'.`);if(I.type.kind!==M.type.kind&&I.type.kind!=="value"&&M.type.kind!=="value")return x.error(`Cannot compare types '${Qi(I.type)}' and '${Qi(M.type)}'.`);c&&(I.type.kind==="value"&&M.type.kind!=="value"?I=new Yr(M.type,[I]):I.type.kind!=="value"&&M.type.kind==="value"&&(M=new Yr(I.type,[M])));let O=null;if(y.length===4){if(I.type.kind!=="string"&&M.type.kind!=="string"&&I.type.kind!=="value"&&M.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(O=x.parse(y[3],3,Ka),!O)return null}return new Sx(I,M,O)}evaluate(y){const x=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(c&&this.hasUntypedArgument){const I=kn(x),M=kn(E);if(I.kind!==M.kind||I.kind!=="string"&&I.kind!=="number")throw new gr(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${I.kind}, ${M.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const I=kn(x),M=kn(E);if(I.kind!=="string"||M.kind!=="string")return e(y,x,E)}return this.collator?s(y,x,E,this.collator.evaluate(y)):e(y,x,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[r];return this.eachChild((x=>{y.push(x.serialize())})),y}}}const Tl=Sl("==",(function(r,e,s){return e===s}),Ba),or=Sl("!=",(function(r,e,s){return e!==s}),(function(r,e,s,c){return!Ba(0,e,s,c)})),Ai=Sl("<",(function(r,e,s){return e<s}),(function(r,e,s,c){return c.compare(e,s)<0})),oa=Sl(">",(function(r,e,s){return e>s}),(function(r,e,s,c){return c.compare(e,s)>0})),nl=Sl("<=",(function(r,e,s){return e<=s}),(function(r,e,s,c){return c.compare(e,s)<=0})),Do=Sl(">=",(function(r,e,s){return e>=s}),(function(r,e,s,c){return c.compare(e,s)>=0}));class Or{constructor(e,s,c,p,y,x){this.type=gn,this.number=e,this.locale=s,this.currency=c,this.unit=p,this.minFractionDigits=y,this.maxFractionDigits=x}static parse(e,s){if(e.length!==3)return s.error("Expected two arguments.");const c=s.parse(e[1],1,re);if(!c)return null;const p=e[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=s.parse(p.locale,1,gn),!y))return null;let x=null;if(p.currency&&(x=s.parse(p.currency,1,gn),!x))return null;let E=null;if(p.unit&&(E=s.parse(p.unit,1,gn),!E))return null;let I=null;if(p["min-fraction-digits"]&&(I=s.parse(p["min-fraction-digits"],1,re),!I))return null;let M=null;return p["max-fraction-digits"]&&(M=s.parse(p["max-fraction-digits"],1,re),!M)?null:new Or(c,y,x,E,I,M)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Bs{constructor(e){this.type=re,this.input=e}static parse(e,s){if(e.length!==2)return s.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=s.parse(e[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Qi(c.type)} instead.`):new Bs(c):null}evaluate(e){const s=this.input.evaluate(e);if(typeof s=="string"||Array.isArray(s))return s.length;throw new gr(`Expected value to be of type string or array, but found ${Qi(kn(s))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild((s=>{e.push(s.serialize())})),e}}const mo={"==":Tl,"!=":or,">":oa,"<":Ai,">=":Do,"<=":nl,array:Yr,at:sr,boolean:Yr,case:Yo,coalesce:Wn,collator:jo,format:ss,image:Da,in:ds,"index-of":Jn,interpolate:De,"interpolate-hcl":De,"interpolate-lab":De,length:Bs,let:hi,literal:xn,match:tr,number:Yr,"number-format":Or,object:Yr,slice:Gs,step:bl,string:Yr,"to-boolean":fs,"to-color":fs,"to-number":fs,"to-string":fs,var:Zl,within:Oi};function Vs(r,[e,s,c,p]){e=e.evaluate(r),s=s.evaluate(r),c=c.evaluate(r);const y=p?p.evaluate(r):1,x=ke(e,s,c,y);if(x)throw new gr(x);return new Qe(e/255*y,s/255*y,c/255*y,y)}function Wl(r,e){return r in e}function il(r,e){const s=e[r];return s===void 0?null:s}function yo(r){return{type:r}}io.register(mo,{error:[{kind:"error"},[gn],(r,[e])=>{throw new gr(e.evaluate(r))}],typeof:[gn,[Hn],(r,[e])=>Qi(kn(e.evaluate(r)))],"to-rgba":[br(re,4),[Ts],(r,[e])=>e.evaluate(r).toArray()],rgb:[Ts,[re,re,re],Vs],rgba:[Ts,[re,re,re,re],Vs],has:{type:zn,overloads:[[[gn],(r,[e])=>Wl(e.evaluate(r),r.properties())],[[gn,Ja],(r,[e,s])=>Wl(e.evaluate(r),s.evaluate(r))]]},get:{type:Hn,overloads:[[[gn],(r,[e])=>il(e.evaluate(r),r.properties())],[[gn,Ja],(r,[e,s])=>il(e.evaluate(r),s.evaluate(r))]]},"feature-state":[Hn,[gn],(r,[e])=>il(e.evaluate(r),r.featureState||{})],properties:[Ja,[],r=>r.properties()],"geometry-type":[gn,[],r=>r.geometryType()],id:[Hn,[],r=>r.id()],zoom:[re,[],r=>r.globals.zoom],pitch:[re,[],r=>r.globals.pitch||0],"distance-from-center":[re,[],r=>r.distanceFromCenter()],"heatmap-density":[re,[],r=>r.globals.heatmapDensity||0],"line-progress":[re,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[re,[],r=>r.globals.skyRadialProgress||0],accumulated:[Hn,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[re,yo(re),(r,e)=>{let s=0;for(const c of e)s+=c.evaluate(r);return s}],"*":[re,yo(re),(r,e)=>{let s=1;for(const c of e)s*=c.evaluate(r);return s}],"-":{type:re,overloads:[[[re,re],(r,[e,s])=>e.evaluate(r)-s.evaluate(r)],[[re],(r,[e])=>-e.evaluate(r)]]},"/":[re,[re,re],(r,[e,s])=>e.evaluate(r)/s.evaluate(r)],"%":[re,[re,re],(r,[e,s])=>e.evaluate(r)%s.evaluate(r)],ln2:[re,[],()=>Math.LN2],pi:[re,[],()=>Math.PI],e:[re,[],()=>Math.E],"^":[re,[re,re],(r,[e,s])=>Math.pow(e.evaluate(r),s.evaluate(r))],sqrt:[re,[re],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[re,[re],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[re,[re],(r,[e])=>Math.log(e.evaluate(r))],log2:[re,[re],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[re,[re],(r,[e])=>Math.sin(e.evaluate(r))],cos:[re,[re],(r,[e])=>Math.cos(e.evaluate(r))],tan:[re,[re],(r,[e])=>Math.tan(e.evaluate(r))],asin:[re,[re],(r,[e])=>Math.asin(e.evaluate(r))],acos:[re,[re],(r,[e])=>Math.acos(e.evaluate(r))],atan:[re,[re],(r,[e])=>Math.atan(e.evaluate(r))],min:[re,yo(re),(r,e)=>Math.min(...e.map((s=>s.evaluate(r))))],max:[re,yo(re),(r,e)=>Math.max(...e.map((s=>s.evaluate(r))))],abs:[re,[re],(r,[e])=>Math.abs(e.evaluate(r))],round:[re,[re],(r,[e])=>{const s=e.evaluate(r);return s<0?-Math.round(-s):Math.round(s)}],floor:[re,[re],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[re,[re],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[zn,[gn,Hn],(r,[e,s])=>r.properties()[e.value]===s.value],"filter-id-==":[zn,[Hn],(r,[e])=>r.id()===e.value],"filter-type-==":[zn,[gn],(r,[e])=>r.geometryType()===e.value],"filter-<":[zn,[gn,Hn],(r,[e,s])=>{const c=r.properties()[e.value],p=s.value;return typeof c==typeof p&&c<p}],"filter-id-<":[zn,[Hn],(r,[e])=>{const s=r.id(),c=e.value;return typeof s==typeof c&&s<c}],"filter->":[zn,[gn,Hn],(r,[e,s])=>{const c=r.properties()[e.value],p=s.value;return typeof c==typeof p&&c>p}],"filter-id->":[zn,[Hn],(r,[e])=>{const s=r.id(),c=e.value;return typeof s==typeof c&&s>c}],"filter-<=":[zn,[gn,Hn],(r,[e,s])=>{const c=r.properties()[e.value],p=s.value;return typeof c==typeof p&&c<=p}],"filter-id-<=":[zn,[Hn],(r,[e])=>{const s=r.id(),c=e.value;return typeof s==typeof c&&s<=c}],"filter->=":[zn,[gn,Hn],(r,[e,s])=>{const c=r.properties()[e.value],p=s.value;return typeof c==typeof p&&c>=p}],"filter-id->=":[zn,[Hn],(r,[e])=>{const s=r.id(),c=e.value;return typeof s==typeof c&&s>=c}],"filter-has":[zn,[Hn],(r,[e])=>e.value in r.properties()],"filter-has-id":[zn,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[zn,[br(gn)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[zn,[br(Hn)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[zn,[gn,br(Hn)],(r,[e,s])=>s.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[zn,[gn,br(Hn)],(r,[e,s])=>(function(c,p,y,x){for(;y<=x;){const E=y+x>>1;if(p[E]===c)return!0;p[E]>c?x=E-1:y=E+1}return!1})(r.properties()[e.value],s.value,0,s.value.length-1)],all:{type:zn,overloads:[[[zn,zn],(r,[e,s])=>e.evaluate(r)&&s.evaluate(r)],[yo(zn),(r,e)=>{for(const s of e)if(!s.evaluate(r))return!1;return!0}]]},any:{type:zn,overloads:[[[zn,zn],(r,[e,s])=>e.evaluate(r)||s.evaluate(r)],[yo(zn),(r,e)=>{for(const s of e)if(s.evaluate(r))return!0;return!1}]]},"!":[zn,[zn],(r,[e])=>!e.evaluate(r)],"is-supported-script":[zn,[gn],(r,[e])=>{const s=r.globals&&r.globals.isSupportedScript;return!s||s(e.evaluate(r))}],upcase:[gn,[gn],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[gn,[gn],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[gn,yo(Hn),(r,e)=>e.map((s=>Xi(s.evaluate(r)))).join("")],"resolved-locale":[gn,[Ka],(r,[e])=>e.evaluate(r).resolvedLocale()]});var $l=mo;function rl(r){return{result:"success",value:r}}function Ea(r){return{result:"error",value:r}}function Wo(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function sl(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function _o(r){return!!r.expression&&r.expression.interpolated}function In(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function so(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function aa(r){return r}function pu(r,e){const s=e.type==="color",c=r.stops&&typeof r.stops[0][0]=="object",p=c||!(c||r.property!==void 0),y=r.type||(_o(e)?"exponential":"interval");if(s&&((r=Hr({},r)).stops&&(r.stops=r.stops.map((M=>[M[0],Qe.parse(M[1])]))),r.default=Qe.parse(r.default?r.default:e.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!Ys[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let x,E,I;if(y==="exponential")x=gu;else if(y==="interval")x=$o;else if(y==="categorical"){x=Fu,E=Object.create(null);for(const M of r.stops)E[M[0]]=M[1];I=typeof r.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);x=al}if(c){const M={},O=[];for(let $=0;$<r.stops.length;$++){const Q=r.stops[$],at=Q[0].zoom;M[at]===void 0&&(M[at]={zoom:at,type:r.type,property:r.property,default:r.default,stops:[]},O.push(at)),M[at].stops.push([Q[0].value,Q[1]])}const k=[];for(const $ of O)k.push([M[$].zoom,pu(M[$],e)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:De.interpolationFactor.bind(void 0,U),zoomStops:k.map(($=>$[0])),evaluate:({zoom:$},Q)=>gu({stops:k,base:r.base},e,$).evaluate($,Q)}}if(p){const M=y==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:De.interpolationFactor.bind(void 0,M),zoomStops:r.stops.map((O=>O[0])),evaluate:({zoom:O})=>x(r,e,O,E,I)}}return{kind:"source",evaluate(M,O){const k=O&&O.properties?O.properties[r.property]:void 0;return k===void 0?es(r.default,e.default):x(r,e,k,E,I)}}}function es(r,e,s){return r!==void 0?r:e!==void 0?e:s!==void 0?s:void 0}function Fu(r,e,s,c,p){return es(typeof s===p?c[s]:void 0,r.default,e.default)}function $o(r,e,s){if(In(s)!=="number")return es(r.default,e.default);const c=r.stops.length;if(c===1||s<=r.stops[0][0])return r.stops[0][1];if(s>=r.stops[c-1][0])return r.stops[c-1][1];const p=xa(r.stops.map((y=>y[0])),s);return r.stops[p][1]}function gu(r,e,s){const c=r.base!==void 0?r.base:1;if(In(s)!=="number")return es(r.default,e.default);const p=r.stops.length;if(p===1||s<=r.stops[0][0])return r.stops[0][1];if(s>=r.stops[p-1][0])return r.stops[p-1][1];const y=xa(r.stops.map((O=>O[0])),s),x=(function(O,k,U,$){const Q=$-U,at=O-U;return Q===0?0:k===1?at/Q:(Math.pow(k,at)-1)/(Math.pow(k,Q)-1)})(s,c,r.stops[y][0],r.stops[y+1][0]),E=r.stops[y][1],I=r.stops[y+1][1];let M=wl[e.type]||aa;if(r.colorSpace&&r.colorSpace!=="rgb"){const O=Ys[r.colorSpace];M=(k,U)=>O.reverse(O.interpolate(O.forward(k),O.forward(U),x))}return typeof E.evaluate=="function"?{evaluate(...O){const k=E.evaluate.apply(void 0,O),U=I.evaluate.apply(void 0,O);if(k!==void 0&&U!==void 0)return M(k,U,x)}}:M(E,I,x)}function al(r,e,s){return e.type==="color"?s=Qe.parse(s):e.type==="formatted"?s=Pn.fromString(s.toString()):e.type==="resolvedImage"?s=Ni.fromString(s.toString()):In(s)===e.type||e.type==="enum"&&e.values[s]||(s=void 0),es(s,r.default,e.default)}class mu{constructor(e,s){this.expression=e,this._warningHistory={},this._evaluator=new ho,this._defaultValue=s?(function(c){return c.type==="color"&&(so(c.default)||Array.isArray(c.default))?new Qe(0,0,0,0):c.type==="color"?Qe.parse(c.default)||null:c.default===void 0?null:c.default})(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(e,s,c,p,y,x,E,I){return this._evaluator.globals=e,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=I||null,this.expression.evaluate(this._evaluator)}evaluate(e,s,c,p,y,x,E,I){this._evaluator.globals=e,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=I||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new gr(`Expected value to be one of ${Object.keys(this._enumValues).map((O=>JSON.stringify(O))).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function Jl(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in $l}function Jo(r,e){const s=new po($l,[],e?(function(p){const y={color:Ts,string:gn,number:re,enum:gn,boolean:zn,formatted:Ur,resolvedImage:na};return p.type==="array"?br(y[p.value]||Hn,p.length):y[p.type]})(e):void 0),c=s.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?rl(new mu(c,e)):Ea(s.errors)}class Cl{constructor(e,s){this.kind=e,this._styleExpression=s,this.isStateDependent=e!=="constant"&&!Ps(s.expression)}evaluateWithoutErrorHandling(e,s,c,p,y,x){return this._styleExpression.evaluateWithoutErrorHandling(e,s,c,p,y,x)}evaluate(e,s,c,p,y,x){return this._styleExpression.evaluate(e,s,c,p,y,x)}}class $s{constructor(e,s,c,p){this.kind=e,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=e!=="camera"&&!Ps(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(e,s,c,p,y,x){return this._styleExpression.evaluateWithoutErrorHandling(e,s,c,p,y,x)}evaluate(e,s,c,p,y,x){return this._styleExpression.evaluate(e,s,c,p,y,x)}interpolationFactor(e,s,c){return this.interpolationType?De.interpolationFactor(this.interpolationType,e,s,c):0}}function ll(r,e){if((r=Jo(r,e)).result==="error")return r;const s=r.value.expression,c=Mo(s);if(!c&&!Wo(e))return Ea([new gi("","data expressions not supported")]);const p=Ao(s,["zoom","pitch","distance-from-center"]);if(!p&&!sl(e))return Ea([new gi("","zoom expressions not supported")]);const y=yu(s);return y||p?y instanceof gi?Ea([y]):y instanceof De&&!_o(e)?Ea([new gi("",'"interpolate" expressions cannot be used with this property')]):rl(y?new $s(c?"camera":"composite",r.value,y.labels,y instanceof De?y.interpolation:void 0):new Cl(c?"constant":"source",r.value)):Ea([new gi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class gs{constructor(e,s){this._parameters=e,this._specification=s,Hr(this,pu(this._parameters,this._specification))}static deserialize(e){return new gs(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function yu(r){let e=null;if(r instanceof hi)e=yu(r.result);else if(r instanceof Wn){for(const s of r.args)if(e=yu(s),e)break}else(r instanceof bl||r instanceof De)&&r.input instanceof io&&r.input.name==="zoom"&&(e=r);return e instanceof gi||r.eachChild((s=>{const c=yu(s);c instanceof gi?e=c:!e&&c?e=new gi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&c&&e!==c&&(e=new gi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}class bn{constructor(e,s,c,p){this.message=(e?`${e}: `:"")+c,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function qs(r){const e=r.key,s=r.value,c=r.valueSpec||{},p=r.objectElementValidators||{},y=r.style,x=r.styleSpec;let E=[];const I=In(s);if(I!=="object")return[new bn(e,s,`object expected, ${I} found`)];for(const M in s){const O=M.split(".")[0],k=c[O]||c["*"];let U;p[O]?U=p[O]:c[O]?U=Fs:p["*"]?U=p["*"]:c["*"]&&(U=Fs),U?E=E.concat(U({key:(e&&`${e}.`)+M,value:s[M],valueSpec:k,style:y,styleSpec:x,object:s,objectKey:M},s)):E.push(new bn(e,s[M],`unknown property "${M}"`))}for(const M in c)p[M]||c[M].required&&c[M].default===void 0&&s[M]===void 0&&E.push(new bn(e,s,`missing required property "${M}"`));return E}function tc(r){const e=r.value,s=r.valueSpec,c=r.style,p=r.styleSpec,y=r.key,x=r.arrayElementValidator||Fs;if(In(e)!=="array")return[new bn(y,e,`array expected, ${In(e)} found`)];if(s.length&&e.length!==s.length)return[new bn(y,e,`array length ${s.length} expected, length ${e.length} found`)];if(s["min-length"]&&e.length<s["min-length"])return[new bn(y,e,`array length at least ${s["min-length"]} expected, length ${e.length} found`)];let E={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};p.$version<7&&(E.function=s.function),In(s.value)==="object"&&(E=s.value);let I=[];for(let M=0;M<e.length;M++)I=I.concat(x({array:e,arrayIndex:M,value:e[M],valueSpec:E,style:c,styleSpec:p,key:`${y}[${M}]`}));return I}function js(r){const e=r.key,s=r.value,c=r.valueSpec;let p=In(s);if(p==="number"&&s!=s&&(p="NaN"),p!=="number")return[new bn(e,s,`number expected, ${p} found`)];if("minimum"in c){let y=c.minimum;if(In(c.minimum)==="array"&&(y=c.minimum[r.arrayIndex]),s<y)return[new bn(e,s,`${s} is less than the minimum value ${y}`)]}if("maximum"in c){let y=c.maximum;if(In(c.maximum)==="array"&&(y=c.maximum[r.arrayIndex]),s>y)return[new bn(e,s,`${s} is greater than the maximum value ${y}`)]}return[]}function Il(r){const e=r.valueSpec,s=Rn(r.value.type);let c,p,y,x={};const E=s!=="categorical"&&r.value.property===void 0,I=!E,M=In(r.value.stops)==="array"&&In(r.value.stops[0])==="array"&&In(r.value.stops[0][0])==="object",O=qs({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function($){if(s==="identity")return[new bn($.key,$.value,'identity function may not have a "stops" property')];let Q=[];const at=$.value;return Q=Q.concat(tc({key:$.key,value:at,valueSpec:$.valueSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:k})),In(at)==="array"&&at.length===0&&Q.push(new bn($.key,at,"array must have at least one stop")),Q},default:function($){return Fs({key:$.key,value:$.value,valueSpec:e,style:$.style,styleSpec:$.styleSpec})}}});return s==="identity"&&E&&O.push(new bn(r.key,r.value,'missing required property "property"')),s==="identity"||r.value.stops||O.push(new bn(r.key,r.value,'missing required property "stops"')),s==="exponential"&&r.valueSpec.expression&&!_o(r.valueSpec)&&O.push(new bn(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(I&&!Wo(r.valueSpec)?O.push(new bn(r.key,r.value,"property functions not supported")):E&&!sl(r.valueSpec)&&O.push(new bn(r.key,r.value,"zoom functions not supported"))),s!=="categorical"&&!M||r.value.property!==void 0||O.push(new bn(r.key,r.value,'"property" property is required')),O;function k($){let Q=[];const at=$.value,wt=$.key;if(In(at)!=="array")return[new bn(wt,at,`array expected, ${In(at)} found`)];if(at.length!==2)return[new bn(wt,at,`array length 2 expected, length ${at.length} found`)];if(M){if(In(at[0])!=="object")return[new bn(wt,at,`object expected, ${In(at[0])} found`)];if(at[0].zoom===void 0)return[new bn(wt,at,"object stop key must have zoom")];if(at[0].value===void 0)return[new bn(wt,at,"object stop key must have value")];const zt=Rn(at[0].zoom);if(typeof zt!="number")return[new bn(wt,at[0].zoom,"stop zoom values must be numbers")];if(y&&y>zt)return[new bn(wt,at[0].zoom,"stop zoom values must appear in ascending order")];zt!==y&&(y=zt,p=void 0,x={}),Q=Q.concat(qs({key:`${wt}[0]`,value:at[0],valueSpec:{zoom:{}},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:js,value:U}}))}else Q=Q.concat(U({key:`${wt}[0]`,value:at[0],style:$.style,styleSpec:$.styleSpec},at));return Jl(_a(at[1]))?Q.concat([new bn(`${wt}[1]`,at[1],"expressions are not allowed in function stops.")]):Q.concat(Fs({key:`${wt}[1]`,value:at[1],valueSpec:e,style:$.style,styleSpec:$.styleSpec}))}function U($,Q){const at=In($.value),wt=Rn($.value),zt=$.value!==null?$.value:Q;if(c){if(at!==c)return[new bn($.key,zt,`${at} stop domain type must match previous stop domain type ${c}`)]}else c=at;if(at!=="number"&&at!=="string"&&at!=="boolean"&&typeof wt!="number"&&typeof wt!="string"&&typeof wt!="boolean")return[new bn($.key,zt,"stop domain value must be a number, string, or boolean")];if(at!=="number"&&s!=="categorical"){let Wt=`number expected, ${at} found`;return Wo(e)&&s===void 0&&(Wt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new bn($.key,zt,Wt)]}return s!=="categorical"||at!=="number"||typeof wt=="number"&&isFinite(wt)&&Math.floor(wt)===wt?s!=="categorical"&&at==="number"&&typeof wt=="number"&&typeof p=="number"&&p!==void 0&&wt<p?[new bn($.key,zt,"stop domain values must appear in ascending order")]:(p=wt,s==="categorical"&&wt in x?[new bn($.key,zt,"stop domain values must be unique")]:(x[wt]=!0,[])):[new bn($.key,zt,`integer expected, found ${String(wt)}`)]}}function ms(r){const e=(r.expressionContext==="property"?ll:Jo)(_a(r.value),r.valueSpec);if(e.result==="error")return e.value.map((c=>new bn(`${r.key}${c.key}`,r.value,c.message)));const s=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!s.outputDefined())return[new bn(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Ps(s))return[new bn(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return oo(s,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Ao(s,["zoom","feature-state"]))return[new bn(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Mo(s))return[new bn(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function oo(r,e){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const p of e.valueSpec.expression.parameters)s.delete(p);if(s.size===0)return[];const c=[];return r instanceof io&&s.has(r.name)?[new bn(e.key,e.value,`["${r.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(r.eachChild((p=>{c.push(...oo(p,e))})),c)}function Fa(r){const e=r.key,s=r.value,c=r.valueSpec,p=[];return Array.isArray(c.values)?c.values.indexOf(Rn(s))===-1&&p.push(new bn(e,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(c.values).indexOf(Rn(s))===-1&&p.push(new bn(e,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function ao(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!ao(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function _u(r,e="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ao(r)||(r=ua(r));const s=r;let c=!0;try{c=(function(M){if(!ys(M))return M;let O=_a(M);return zr(O),O=vo(O),O})(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const p=_e[`filter_${e}`],y=Jo(c,p);let x=null;if(y.result==="error")throw new Error(y.value.map((M=>`${M.key}: ${M.message}`)).join(", "));x=(M,O,k)=>y.value.evaluate(M,O,{},k);let E=null,I=null;if(c!==s){const M=Jo(s,p);if(M.result==="error")throw new Error(M.value.map((O=>`${O.key}: ${O.message}`)).join(", "));E=(O,k,U,$,Q)=>M.value.evaluate(O,k,{},U,void 0,void 0,$,Q),I=!Mo(M.value.expression)}return{filter:x,dynamicFilter:E||void 0,needGeometry:Js(c),needFeature:!!I}}function vo(r){if(!Array.isArray(r))return r;const e=(function(s){if(Cr.has(s[0])){for(let c=1;c<s.length;c++)if(ys(s[c]))return!0}return s})(r);return e===!0?e:e.map((s=>vo(s)))}function zr(r){let e=!1;const s=[];if(r[0]==="case"){for(let c=1;c<r.length-1;c+=2)e=e||ys(r[c]),s.push(r[c+1]);s.push(r[r.length-1])}else if(r[0]==="match"){e=e||ys(r[1]);for(let c=2;c<r.length-1;c+=2)s.push(r[c+1]);s.push(r[r.length-1])}else if(r[0]==="step"){e=e||ys(r[1]);for(let c=1;c<r.length-1;c+=2)s.push(r[c+1])}e&&(r.length=0,r.push("any",...s));for(let c=1;c<r.length;c++)zr(r[c])}function ys(r){if(!Array.isArray(r))return!1;if((e=r[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let s=1;s<r.length;s++)if(ys(r[s]))return!0;return!1}const Cr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function la(r,e){return r<e?-1:r>e?1:0}function Js(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(Js(r[e]))return!0;return!1}function ua(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?hc(r[1],r[2],"=="):e==="!="?ec(hc(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?hc(r[1],r[2],e):e==="any"?(s=r.slice(1),["any"].concat(s.map(ua))):e==="all"?["all"].concat(r.slice(1).map(ua)):e==="none"?["all"].concat(r.slice(1).map(ua).map(ec)):e==="in"?vu(r[1],r.slice(2)):e==="!in"?ec(vu(r[1],r.slice(2))):e==="has"?xu(r[1]):e==="!has"?ec(xu(r[1])):e!=="within"||r;var s}function hc(r,e,s){switch(r){case"$type":return[`filter-type-${s}`,e];case"$id":return[`filter-id-${s}`,e];default:return[`filter-${s}`,r,e]}}function vu(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((s=>typeof s!=typeof e[0]))?["filter-in-large",r,["literal",e.sort(la)]]:["filter-in-small",r,["literal",e]]}}function xu(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ec(r){return["!",r]}function os(r){return ao(_a(r.value))?ms(Hr({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):Pr(r)}function Pr(r){const e=r.value,s=r.key;if(In(e)!=="array")return[new bn(s,e,`array expected, ${In(e)} found`)];const c=r.styleSpec;let p,y=[];if(e.length<1)return[new bn(s,e,"filter array must have at least 1 element")];switch(y=y.concat(Fa({key:`${s}[0]`,value:e[0],valueSpec:c.filter_operator,style:r.style,styleSpec:r.styleSpec})),Rn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Rn(e[1])==="$type"&&y.push(new bn(s,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&y.push(new bn(s,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(p=In(e[1]),p!=="string"&&y.push(new bn(`${s}[1]`,e[1],`string expected, ${p} found`)));for(let x=2;x<e.length;x++)p=In(e[x]),Rn(e[1])==="$type"?y=y.concat(Fa({key:`${s}[${x}]`,value:e[x],valueSpec:c.geometry_type,style:r.style,styleSpec:r.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new bn(`${s}[${x}]`,e[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<e.length;x++)y=y.concat(Pr({key:`${s}[${x}]`,value:e[x],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":p=In(e[1]),e.length!==2?y.push(new bn(s,e,`filter array for "${e[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new bn(`${s}[1]`,e[1],`string expected, ${p} found`));break;case"within":p=In(e[1]),e.length!==2?y.push(new bn(s,e,`filter array for "${e[0]}" operator must have 2 elements`)):p!=="object"&&y.push(new bn(`${s}[1]`,e[1],`object expected, ${p} found`))}return y}function Mi(r,e){const s=r.key,c=r.style,p=r.styleSpec,y=r.value,x=r.objectKey,E=p[`${e}_${r.layerType}`];if(!E)return[];const I=x.match(/^(.*)-transition$/);if(e==="paint"&&I&&E[I[1]]&&E[I[1]].transition)return Fs({key:s,value:y,valueSpec:p.transition,style:c,styleSpec:p});const M=r.valueSpec||E[x];if(!M)return[new bn(s,y,`unknown property "${x}"`)];let O;if(In(y)==="string"&&Wo(M)&&!M.tokens&&(O=/^{([^}]+)}$/.exec(y)))return[new bn(s,y,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const k=[];return r.layerType==="symbol"&&(x==="text-field"&&c&&!c.glyphs&&k.push(new bn(s,y,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&so(_a(y))&&Rn(y.type)==="identity"&&k.push(new bn(s,y,'"text-font" does not support identity functions'))),k.concat(Fs({key:r.key,value:y,valueSpec:M,style:c,styleSpec:p,expressionContext:"property",propertyType:e,propertyKey:x}))}function ka(r){return Mi(r,"paint")}function hr(r){return Mi(r,"layout")}function lo(r){let e=[];const s=r.value,c=r.key,p=r.style,y=r.styleSpec;s.type||s.ref||e.push(new bn(c,s,'either "type" or "ref" is required'));let x=Rn(s.type);const E=Rn(s.ref);if(s.id){const I=Rn(s.id);for(let M=0;M<r.arrayIndex;M++){const O=p.layers[M];Rn(O.id)===I&&e.push(new bn(c,s.id,`duplicate layer id "${s.id}", previously used at line ${O.id.__line__}`))}}if("ref"in s){let I;["type","source","source-layer","filter","layout"].forEach((M=>{M in s&&e.push(new bn(c,s[M],`"${M}" is prohibited for ref layers`))})),p.layers.forEach((M=>{Rn(M.id)===E&&(I=M)})),I?I.ref?e.push(new bn(c,s.ref,"ref cannot reference another ref layer")):x=Rn(I.type):typeof E=="string"&&e.push(new bn(c,s.ref,`ref layer "${E}" not found`))}else if(x!=="background"&&x!=="sky")if(s.source){const I=p.sources&&p.sources[s.source],M=I&&Rn(I.type);I?M==="vector"&&x==="raster"?e.push(new bn(c,s.source,`layer "${s.id}" requires a raster source`)):M==="raster"&&x!=="raster"?e.push(new bn(c,s.source,`layer "${s.id}" requires a vector source`)):M!=="vector"||s["source-layer"]?M==="raster-dem"&&x!=="hillshade"?e.push(new bn(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||M==="geojson"&&I.lineMetrics||e.push(new bn(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new bn(c,s,`layer "${s.id}" must specify a "source-layer"`)):e.push(new bn(c,s.source,`source "${s.source}" not found`))}else e.push(new bn(c,s,'missing required property "source"'));return e=e.concat(qs({key:c,value:s,valueSpec:y.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Fs({key:`${c}.type`,value:s.type,valueSpec:y.layer.type,style:r.style,styleSpec:r.styleSpec,object:s,objectKey:"type"}),filter:I=>os(Hr({layerType:x},I)),layout:I=>qs({layer:s,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":M=>hr(Hr({layerType:x},M))}}),paint:I=>qs({layer:s,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":M=>ka(Hr({layerType:x},M))}})}})),e}function No(r){const e=r.value,s=r.key,c=In(e);return c!=="string"?[new bn(s,e,`string expected, ${c} found`)]:[]}const fc={promoteId:function({key:r,value:e}){if(In(e)==="string")return No({key:r,value:e});{const s=[];for(const c in e)s.push(...No({key:`${r}.${c}`,value:e[c]}));return s}}};function bu(r){const e=r.value,s=r.key,c=r.styleSpec,p=r.style;if(!e.type)return[new bn(s,e,'"type" is required')];const y=Rn(e.type);let x;switch(y){case"vector":case"raster":case"raster-dem":return x=qs({key:s,value:e,valueSpec:c[`source_${y.replace("-","_")}`],style:r.style,styleSpec:c,objectElementValidators:fc}),x;case"geojson":if(x=qs({key:s,value:e,valueSpec:c.source_geojson,style:p,styleSpec:c,objectElementValidators:fc}),e.cluster)for(const E in e.clusterProperties){const[I,M]=e.clusterProperties[E],O=typeof I=="string"?[I,["accumulated"],["get",E]]:I;x.push(...ms({key:`${s}.${E}.map`,value:M,expressionContext:"cluster-map"})),x.push(...ms({key:`${s}.${E}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return x;case"video":return qs({key:s,value:e,valueSpec:c.source_video,style:p,styleSpec:c});case"image":return qs({key:s,value:e,valueSpec:c.source_image,style:p,styleSpec:c});case"canvas":return[new bn(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fa({key:`${s}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ua(r){const e=r.value,s=r.styleSpec,c=s.light,p=r.style;let y=[];const x=In(e);if(e===void 0)return y;if(x!=="object")return y=y.concat([new bn("light",e,`object expected, ${x} found`)]),y;for(const E in e){const I=E.match(/^(.*)-transition$/);y=y.concat(I&&c[I[1]]&&c[I[1]].transition?Fs({key:E,value:e[E],valueSpec:s.transition,style:p,styleSpec:s}):c[E]?Fs({key:E,value:e[E],valueSpec:c[E],style:p,styleSpec:s}):[new bn(E,e[E],`unknown property "${E}"`)])}return y}function ul(r){const e=r.value,s=r.key,c=r.style,p=r.styleSpec,y=p.terrain;let x=[];const E=In(e);if(e===void 0)return x;if(E!=="object")return x=x.concat([new bn("terrain",e,`object expected, ${E} found`)]),x;for(const I in e){const M=I.match(/^(.*)-transition$/);x=x.concat(M&&y[M[1]]&&y[M[1]].transition?Fs({key:I,value:e[I],valueSpec:p.transition,style:c,styleSpec:p}):y[I]?Fs({key:I,value:e[I],valueSpec:y[I],style:c,styleSpec:p}):[new bn(I,e[I],`unknown property "${I}"`)])}if(e.source){const I=c.sources&&c.sources[e.source],M=I&&Rn(I.type);I?M!=="raster-dem"&&x.push(new bn(s,e.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):x.push(new bn(s,e.source,`source "${e.source}" not found`))}else x.push(new bn(s,e,'terrain is missing required property "source"'));return x}function ku(r){const e=r.value,s=r.style,c=r.styleSpec,p=c.fog;let y=[];const x=In(e);if(e===void 0)return y;if(x!=="object")return y=y.concat([new bn("fog",e,`object expected, ${x} found`)]),y;for(const E in e){const I=E.match(/^(.*)-transition$/);y=y.concat(I&&p[I[1]]&&p[I[1]].transition?Fs({key:E,value:e[E],valueSpec:c.transition,style:s,styleSpec:c}):p[E]?Fs({key:E,value:e[E],valueSpec:p[E],style:s,styleSpec:c}):[new bn(E,e[E],`unknown property "${E}"`)])}return y}const Kl={"*":()=>[],array:tc,boolean:function(r){const e=r.value,s=r.key,c=In(e);return c!=="boolean"?[new bn(s,e,`boolean expected, ${c} found`)]:[]},number:js,color:function(r){const e=r.key,s=r.value,c=In(s);return c!=="string"?[new bn(e,s,`color expected, ${c} found`)]:Ce(s)===null?[new bn(e,s,`color expected, "${s}" found`)]:[]},enum:Fa,filter:os,function:Il,layer:lo,object:qs,source:bu,light:Ua,terrain:ul,fog:ku,string:No,formatted:function(r){return No(r).length===0?[]:ms(r)},resolvedImage:function(r){return No(r).length===0?[]:ms(r)},projection:function(r){const e=r.value,s=r.styleSpec,c=s.projection,p=r.style;let y=[];const x=In(e);if(x==="object")for(const E in e)y=y.concat(Fs({key:E,value:e[E],valueSpec:c[E],style:p,styleSpec:s}));else x!=="string"&&(y=y.concat([new bn("projection",e,`object or string expected, ${x} found`)]));return y}};function Fs(r){const e=r.value,s=r.valueSpec,c=r.styleSpec;return s.expression&&so(Rn(e))?Il(r):s.expression&&Jl(_a(e))?ms(r):s.type&&Kl[s.type]?Kl[s.type](r):qs(Hr({},r,{valueSpec:s.type?c[s.type]:s}))}function Ml(r){const e=r.value,s=r.key,c=No(r);return c.length||(e.indexOf("{fontstack}")===-1&&c.push(new bn(s,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&c.push(new bn(s,e,'"glyphs" url must include a "{range}" token'))),c}function Oo(r,e=_e){return Sa(Fs({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:Ml,"*":()=>[]}}))}const Ga=r=>Sa(ka(r)),cl=r=>Sa(hr(r));function Sa(r){return r.slice().sort(((e,s)=>e.line&&s.line?e.line-s.line:0))}function Uu(r,e){let s=!1;if(e&&e.length)for(const c of e)r.fire(new Ra(new Error(c.message))),s=!0;return s}var Ei=ns;function ns(r,e,s){var c=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var p=new Int32Array(this.arrayBuffer);r=p[0],this.d=(e=p[1])+2*(s=p[2]);for(var y=0;y<this.d*this.d;y++){var x=p[3+y],E=p[3+y+1];c.push(x===E?null:p.subarray(x,E))}var I=p[3+c.length+1];this.keys=p.subarray(p[3+c.length],I),this.bboxes=p.subarray(I),this.insert=this._insertReadonly}else{this.d=e+2*s;for(var M=0;M<this.d*this.d;M++)c.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=r,this.padding=s,this.scale=e/r,this.uid=0;var O=s/e*r;this.min=-O,this.max=r+O}ns.prototype.insert=function(r,e,s,c,p){this._forEachCell(e,s,c,p,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(e),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(p)},ns.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ns.prototype._insertCell=function(r,e,s,c,p,y){this.cells[p].push(y)},ns.prototype.query=function(r,e,s,c,p){var y=this.min,x=this.max;if(r<=y&&e<=y&&x<=s&&x<=c&&!p)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(r,e,s,c,this._queryCell,E,{},p),E},ns.prototype._queryCell=function(r,e,s,c,p,y,x,E){var I=this.cells[p];if(I!==null)for(var M=this.keys,O=this.bboxes,k=0;k<I.length;k++){var U=I[k];if(x[U]===void 0){var $=4*U;(E?E(O[$+0],O[$+1],O[$+2],O[$+3]):r<=O[$+2]&&e<=O[$+3]&&s>=O[$+0]&&c>=O[$+1])?(x[U]=!0,y.push(M[U])):x[U]=!1}}},ns.prototype._forEachCell=function(r,e,s,c,p,y,x,E){for(var I=this._convertToCellCoord(r),M=this._convertToCellCoord(e),O=this._convertToCellCoord(s),k=this._convertToCellCoord(c),U=I;U<=O;U++)for(var $=M;$<=k;$++){var Q=this.d*$+U;if((!E||E(this._convertFromCellCoord(U),this._convertFromCellCoord($),this._convertFromCellCoord(U+1),this._convertFromCellCoord($+1)))&&p.call(this,r,e,s,c,Q,y,x,E))return}},ns.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},ns.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},ns.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,e=3+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var p=new Int32Array(e+s+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var y=e,x=0;x<r.length;x++){var E=r[x];p[3+x]=y,p.set(E,y),y+=E.length}return p[3+r.length]=y,p.set(this.keys,y),p[3+r.length+1]=y+=this.keys.length,p.set(this.bboxes,y),y+=this.bboxes.length,p.buffer};const Ta={};function dn(r,e,s={}){Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),Ta[e]={klass:r,omit:s.omit||[]}}dn(Object,"Object"),Ei.serialize=function(r,e){const s=r.toArrayBuffer();return e&&e.push(s),{buffer:s}},Ei.deserialize=function(r){return new Ei(r.buffer)},Object.defineProperty(Ei,"name",{value:"Grid"}),dn(Ei,"Grid"),dn(Qe,"Color"),dn(Error,"Error"),dn(ri,"AJAXError"),dn(Ni,"ResolvedImage"),dn(gs,"StylePropertyFunction"),dn(mu,"StyleExpression",{omit:["_evaluator"]}),dn($s,"ZoomDependentExpression"),dn(Cl,"ZoomConstantExpression"),dn(io,"CompoundExpression",{omit:["_evaluate"]});for(const r in $l)Ta[$l[r]._classRegistryKey]||dn($l[r],`Expression${r}`);function zo(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Ql(r){return X.ImageBitmap&&r instanceof X.ImageBitmap}function wu(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(zo(r)||Ql(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const s=r;return e&&e.push(s.buffer),s}if(r instanceof X.ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const s=[];for(const c of r)s.push(wu(c,e));return s}if(typeof r=="object"){const s=r.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const p=s.serialize?s.serialize(r,e):{};if(!s.serialize){for(const y in r)r.hasOwnProperty(y)&&(Ta[c].omit.indexOf(y)>=0||(p[y]=wu(r[y],e)));r instanceof Error&&(p.message=r.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(p.$name=c),p}throw new Error("can't serialize object of type "+typeof r)}function xo(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||zo(r)||Ql(r)||ArrayBuffer.isView(r)||r instanceof X.ImageData)return r;if(Array.isArray(r))return r.map(xo);if(typeof r=="object"){const e=r.$name||"Object",{klass:s}=Ta[e];if(!s)throw new Error(`can't deserialize unregistered class ${e}`);if(s.deserialize)return s.deserialize(r);const c=Object.create(s.prototype);for(const p of Object.keys(r))p!=="$name"&&(c[p]=xo(r[p]));return c}throw new Error("can't deserialize object of type "+typeof r)}class Al{constructor(){this.first=!0}update(e,s){const c=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=s),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=c,!0))}}const as=r=>r>=1536&&r<=1791,ca=r=>r>=1872&&r<=1919,Ll=r=>r>=2208&&r<=2303,hl=r=>r>=11904&&r<=12031,dc=r=>r>=12032&&r<=12255,Rl=r=>r>=12272&&r<=12287,Ca=r=>r>=12288&&r<=12351,pc=r=>r>=12352&&r<=12447,Gu=r=>r>=12448&&r<=12543,gc=r=>r>=12544&&r<=12591,Bi=r=>r>=12704&&r<=12735,Ks=r=>r>=12736&&r<=12783,nc=r=>r>=12784&&r<=12799,fl=r=>r>=12800&&r<=13055,ic=r=>r>=13056&&r<=13311,dl=r=>r>=13312&&r<=19903,Eu=r=>r>=19968&&r<=40959,Dl=r=>r>=40960&&r<=42127,Va=r=>r>=42128&&r<=42191,Vu=r=>r>=44032&&r<=55215,Pc=r=>r>=63744&&r<=64255,qa=r=>r>=64336&&r<=65023,tu=r=>r>=65040&&r<=65055,Nl=r=>r>=65072&&r<=65103,eu=r=>r>=65104&&r<=65135,m=r=>r>=65136&&r<=65279,o=r=>r>=65280&&r<=65519;function f(r){for(const e of r)if(S(e.charCodeAt(0)))return!0;return!1}function _(r){for(const e of r)if(!w(e.charCodeAt(0)))return!1;return!0}function w(r){return!(as(r)||ca(r)||Ll(r)||qa(r)||m(r))}function S(r){return!(r!==746&&r!==747&&(r<4352||!(Bi(r)||gc(r)||Nl(r)&&!(r>=65097&&r<=65103)||Pc(r)||ic(r)||hl(r)||Ks(r)||!(!Ca(r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||dl(r)||Eu(r)||fl(r)||(e=>e>=12592&&e<=12687)(r)||(e=>e>=43360&&e<=43391)(r)||(e=>e>=55216&&e<=55295)(r)||(e=>e>=4352&&e<=4607)(r)||Vu(r)||pc(r)||Rl(r)||(e=>e>=12688&&e<=12703)(r)||dc(r)||nc(r)||Gu(r)&&r!==12540||!(!o(r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!eu(r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||(e=>e>=5120&&e<=5759)(r)||(e=>e>=6320&&e<=6399)(r)||tu(r)||(e=>e>=19904&&e<=19967)(r)||Dl(r)||Va(r))))}function L(r){return!(S(r)||(function(e){return!!((s=>s>=128&&s<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(s=>s>=8192&&s<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(s=>s>=8448&&s<=8527)(e)||(s=>s>=8528&&s<=8591)(e)||(s=>s>=8960&&s<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(s=>s>=9216&&s<=9279)(e)&&e!==9251||(s=>s>=9280&&s<=9311)(e)||(s=>s>=9312&&s<=9471)(e)||(s=>s>=9632&&s<=9727)(e)||(s=>s>=9728&&s<=9983)(e)&&!(e>=9754&&e<=9759)||(s=>s>=11008&&s<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ca(e)||Gu(e)||(s=>s>=57344&&s<=63743)(e)||Nl(e)||eu(e)||o(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)})(r))}function N(r){return r>=1424&&r<=2303||qa(r)||m(r)}function P(r,e){return!(!e&&N(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||(s=>s>=6016&&s<=6143)(r))}function Z(r){for(const e of r)if(N(e.charCodeAt(0)))return!0;return!1}const Y="deferred",nt="loading",dt="loaded";let Et=null,xt="unavailable",Mt=null;const St=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(xt="error"),Et&&Et(r)};function vt(){Rt.fire(new _i("pluginStateChange",{pluginStatus:xt,pluginURL:Mt}))}const Rt=new Ss,Tt=function(){return xt},Ut=function(){if(xt!==Y||!Mt)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xt=nt,vt(),Mt&&Rs({url:Mt},(r=>{r?St(r):(xt=dt,vt())}))},Gt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>xt===dt||Gt.applyArabicShaping!=null,isLoading:()=>xt===nt,setState(r){xt=r.pluginStatus,Mt=r.pluginURL},isParsed:()=>Gt.applyArabicShaping!=null&&Gt.processBidirectionalText!=null&&Gt.processStyledBidirectionalText!=null,getPluginURL:()=>Mt};class Nt{constructor(e,s){this.zoom=e,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Al,this.transition={},this.pitch=0)}isSupportedScript(e){return(function(s,c){for(const p of s)if(!P(p.charCodeAt(0),c))return!1;return!0})(e,Gt.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,s=e-Math.floor(e),c=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*s}}}class jt{constructor(e,s){this.property=e,this.value=s,this.expression=(function(c,p){if(so(c))return new gs(c,p);if(Jl(c)){const y=ll(c,p);if(y.result==="error")throw new Error(y.value.map((x=>`${x.key}: ${x.message}`)).join(", "));return y.value}{let y=c;return typeof c=="string"&&p.type==="color"&&(y=Qe.parse(c)),{kind:"constant",evaluate:()=>y}}})(s===void 0?e.specification.default:s,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,s,c){return this.property.possiblyEvaluate(this,e,s,c)}}class fe{constructor(e){this.property=e,this.value=new jt(e,void 0)}transitioned(e,s){return new xe(this.property,this.value,s,mt({},e.transition,this.transition),e.now)}untransitioned(){return new xe(this.property,this.value,null,{},0)}}class Ee{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return jr(this._values[e].value.value)}setValue(e,s){this._values.hasOwnProperty(e)||(this._values[e]=new fe(this._values[e].property)),this._values[e].value=new jt(this._values[e].property,s===null?void 0:jr(s))}getTransition(e){return jr(this._values[e].transition)}setTransition(e,s){this._values.hasOwnProperty(e)||(this._values[e]=new fe(this._values[e].property)),this._values[e].transition=jr(s)||void 0}serialize(){const e={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(e[s]=c);const p=this.getTransition(s);p!==void 0&&(e[`${s}-transition`]=p)}return e}transitioned(e,s){const c=new We(this._properties);for(const p of Object.keys(this._values))c._values[p]=this._values[p].transitioned(e,s._values[p]);return c}untransitioned(){const e=new We(this._properties);for(const s of Object.keys(this._values))e._values[s]=this._values[s].untransitioned();return e}}class xe{constructor(e,s,c,p,y){const x=p.delay||0,E=p.duration||0;y=y||0,this.property=e,this.value=s,this.begin=y+x,this.end=this.begin+E,e.specification.transition&&(p.delay||p.duration)&&(this.prior=c)}possiblyEvaluate(e,s,c){const p=e.now||0,y=this.value.possiblyEvaluate(e,s,c),x=this.prior;if(x){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return x.possiblyEvaluate(e,s,c);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(e,s,c),y,qe(E))}}return y}}class We{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,s,c){const p=new Pe(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(e,s,c);return p}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ce{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return jr(this._values[e].value)}setValue(e,s){this._values[e]=new jt(this._values[e].property,s===null?void 0:jr(s))}serialize(){const e={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(e[s]=c)}return e}possiblyEvaluate(e,s,c){const p=new Pe(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(e,s,c);return p}}class Ve{constructor(e,s,c){this.property=e,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,s,c,p){return this.property.evaluate(this.value,this.parameters,e,s,c,p)}}class Pe{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ge{constructor(e){this.specification=e}possiblyEvaluate(e,s){return e.expression.evaluate(s)}interpolate(e,s,c){const p=wl[this.specification.type];return p?p(e,s,c):e}}class Qt{constructor(e,s){this.specification=e,this.overrides=s}possiblyEvaluate(e,s,c,p){return new Ve(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(s,null,{},c,p)}:e.expression,s)}interpolate(e,s,c){if(e.value.kind!=="constant"||s.value.kind!=="constant")return e;if(e.value.value===void 0||s.value.value===void 0)return new Ve(this,{kind:"constant",value:void 0},e.parameters);const p=wl[this.specification.type];return p?new Ve(this,{kind:"constant",value:p(e.value.value,s.value.value,c)},e.parameters):e}evaluate(e,s,c,p,y,x){return e.kind==="constant"?e.value:e.evaluate(s,c,p,y,x)}}class fn extends Qt{possiblyEvaluate(e,s,c,p){if(e.value===void 0)return new Ve(this,{kind:"constant",value:void 0},s);if(e.expression.kind==="constant"){const y=e.expression.evaluate(s,null,{},c,p),x=e.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,E=this._calculate(x,x,x,s);return new Ve(this,{kind:"constant",value:E},s)}if(e.expression.kind==="camera"){const y=this._calculate(e.expression.evaluate({zoom:s.zoom-1}),e.expression.evaluate({zoom:s.zoom}),e.expression.evaluate({zoom:s.zoom+1}),s);return new Ve(this,{kind:"constant",value:y},s)}return new Ve(this,e.expression,s)}evaluate(e,s,c,p,y,x){if(e.kind==="source"){const E=e.evaluate(s,c,p,y,x);return this._calculate(E,E,E,s)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(s.zoom)-1},c,p),e.evaluate({zoom:Math.floor(s.zoom)},c,p),e.evaluate({zoom:Math.floor(s.zoom)+1},c,p),s):e.value}_calculate(e,s,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:e,to:s,other:c}:{from:c,to:s,other:e}}interpolate(e){return e}}class an{constructor(e){this.specification=e}possiblyEvaluate(e,s,c,p){if(e.value!==void 0){if(e.expression.kind==="constant"){const y=e.expression.evaluate(s,null,{},c,p);return this._calculate(y,y,y,s)}return this._calculate(e.expression.evaluate(new Nt(Math.floor(s.zoom-1),s)),e.expression.evaluate(new Nt(Math.floor(s.zoom),s)),e.expression.evaluate(new Nt(Math.floor(s.zoom+1),s)),s)}}_calculate(e,s,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:e,to:s}:{from:c,to:s}}interpolate(e){return e}}class Fe{constructor(e){this.specification=e}possiblyEvaluate(e,s,c,p){return!!e.expression.evaluate(s,null,{},c,p)}interpolate(){return!1}}class Xe{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new Nt(0,{});for(const c in e){const p=e[c];p.specification.overridable&&this.overridableProperties.push(c);const y=this.defaultPropertyValues[c]=new jt(p,void 0),x=this.defaultTransitionablePropertyValues[c]=new fe(p);this.defaultTransitioningPropertyValues[c]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=y.possiblyEvaluate(s)}}}function pn(r,e){return 256*(r=ct(Math.floor(r),0,255))+ct(Math.floor(e),0,255)}dn(Qt,"DataDrivenProperty"),dn(ge,"DataConstantProperty"),dn(fn,"CrossFadedDataDrivenProperty"),dn(an,"CrossFadedProperty"),dn(Fe,"ColorRampProperty");const Vn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Gn{constructor(e,s){this._structArray=e,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Un{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,s){return e._trim(),s&&(e.isTransferred=!0,s.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const s=Object.create(this.prototype);return s.arrayBuffer=e.arrayBuffer,s.length=e.length,s.capacity=e.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function tn(r,e=1){let s=0,c=0;return{members:r.map((p=>{const y=Vn[p.type].BYTES_PER_ELEMENT,x=s=ii(s,Math.max(e,y)),E=p.components||1;return c=Math.max(c,y),s+=y*E,{name:p.name,type:p.type,components:E,offset:x}})),size:ii(s,Math.max(c,e)),alignment:e}}function ii(r,e){return Math.ceil(r/e)*e}class di extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,s)}emplace(e,s,c){const p=2*e;return this.int16[p+0]=s,this.int16[p+1]=c,e}}di.prototype.bytesPerElement=4,dn(di,"StructArrayLayout2i4");class Er extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c){const p=this.length;return this.resize(p+1),this.emplace(p,e,s,c)}emplace(e,s,c,p){const y=3*e;return this.int16[y+0]=s,this.int16[y+1]=c,this.int16[y+2]=p,e}}Er.prototype.bytesPerElement=6,dn(Er,"StructArrayLayout3i6");class pi extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,s,c,p)}emplace(e,s,c,p,y){const x=4*e;return this.int16[x+0]=s,this.int16[x+1]=c,this.int16[x+2]=p,this.int16[x+3]=y,e}}pi.prototype.bytesPerElement=8,dn(pi,"StructArrayLayout4i8");class ar extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E){const I=this.length;return this.resize(I+1),this.emplace(I,e,s,c,p,y,x,E)}emplace(e,s,c,p,y,x,E,I){const M=6*e,O=12*e,k=3*e;return this.int16[M+0]=s,this.int16[M+1]=c,this.uint8[O+4]=p,this.uint8[O+5]=y,this.uint8[O+6]=x,this.uint8[O+7]=E,this.float32[k+2]=I,e}}ar.prototype.bytesPerElement=12,dn(ar,"StructArrayLayout2i4ub1f12");class Xs extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,s,c,p)}emplace(e,s,c,p,y){const x=4*e;return this.float32[x+0]=s,this.float32[x+1]=c,this.float32[x+2]=p,this.float32[x+3]=y,e}}Xs.prototype.bytesPerElement=16,dn(Xs,"StructArrayLayout4f16");class Ko extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E,I,M,O){const k=this.length;return this.resize(k+1),this.emplace(k,e,s,c,p,y,x,E,I,M,O)}emplace(e,s,c,p,y,x,E,I,M,O,k){const U=10*e;return this.uint16[U+0]=s,this.uint16[U+1]=c,this.uint16[U+2]=p,this.uint16[U+3]=y,this.uint16[U+4]=x,this.uint16[U+5]=E,this.uint16[U+6]=I,this.uint16[U+7]=M,this.uint16[U+8]=O,this.uint16[U+9]=k,e}}Ko.prototype.bytesPerElement=20,dn(Ko,"StructArrayLayout10ui20");class ks extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E,I){const M=this.length;return this.resize(M+1),this.emplace(M,e,s,c,p,y,x,E,I)}emplace(e,s,c,p,y,x,E,I,M){const O=8*e;return this.uint16[O+0]=s,this.uint16[O+1]=c,this.uint16[O+2]=p,this.uint16[O+3]=y,this.uint16[O+4]=x,this.uint16[O+5]=E,this.uint16[O+6]=I,this.uint16[O+7]=M,e}}ks.prototype.bytesPerElement=16,dn(ks,"StructArrayLayout8ui16");class er extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,e,s,c,p,y,x)}emplace(e,s,c,p,y,x,E){const I=6*e;return this.int16[I+0]=s,this.int16[I+1]=c,this.int16[I+2]=p,this.int16[I+3]=y,this.int16[I+4]=x,this.int16[I+5]=E,e}}er.prototype.bytesPerElement=12,dn(er,"StructArrayLayout6i12");class Wr extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E,I,M,O,k,U){const $=this.length;return this.resize($+1),this.emplace($,e,s,c,p,y,x,E,I,M,O,k,U)}emplace(e,s,c,p,y,x,E,I,M,O,k,U,$){const Q=12*e;return this.int16[Q+0]=s,this.int16[Q+1]=c,this.int16[Q+2]=p,this.int16[Q+3]=y,this.uint16[Q+4]=x,this.uint16[Q+5]=E,this.uint16[Q+6]=I,this.uint16[Q+7]=M,this.int16[Q+8]=O,this.int16[Q+9]=k,this.int16[Q+10]=U,this.int16[Q+11]=$,e}}Wr.prototype.bytesPerElement=24,dn(Wr,"StructArrayLayout4i4ui4i24");class nr extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,e,s,c,p,y,x)}emplace(e,s,c,p,y,x,E){const I=10*e,M=5*e;return this.int16[I+0]=s,this.int16[I+1]=c,this.int16[I+2]=p,this.float32[M+2]=y,this.float32[M+3]=x,this.float32[M+4]=E,e}}nr.prototype.bytesPerElement=20,dn(nr,"StructArrayLayout3i3f20");class Is extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint32[1*e+0]=s,e}}Is.prototype.bytesPerElement=4,dn(Is,"StructArrayLayout1ul4");class Ir extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E,I,M,O,k,U,$){const Q=this.length;return this.resize(Q+1),this.emplace(Q,e,s,c,p,y,x,E,I,M,O,k,U,$)}emplace(e,s,c,p,y,x,E,I,M,O,k,U,$,Q){const at=20*e,wt=10*e;return this.int16[at+0]=s,this.int16[at+1]=c,this.int16[at+2]=p,this.int16[at+3]=y,this.int16[at+4]=x,this.float32[wt+3]=E,this.float32[wt+4]=I,this.float32[wt+5]=M,this.float32[wt+6]=O,this.int16[at+14]=k,this.uint32[wt+8]=U,this.uint16[at+18]=$,this.uint16[at+19]=Q,e}}Ir.prototype.bytesPerElement=40,dn(Ir,"StructArrayLayout5i4f1i1ul2ui40");class xi extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E){const I=this.length;return this.resize(I+1),this.emplace(I,e,s,c,p,y,x,E)}emplace(e,s,c,p,y,x,E,I){const M=8*e;return this.int16[M+0]=s,this.int16[M+1]=c,this.int16[M+2]=p,this.int16[M+4]=y,this.int16[M+5]=x,this.int16[M+6]=E,this.int16[M+7]=I,e}}xi.prototype.bytesPerElement=16,dn(xi,"StructArrayLayout3i2i2i16");class Po extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,s,c,p,y)}emplace(e,s,c,p,y,x){const E=4*e,I=8*e;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=p,this.int16[I+6]=y,this.int16[I+7]=x,e}}Po.prototype.bytesPerElement=16,dn(Po,"StructArrayLayout2f1f2i16");class Ol extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,s,c,p)}emplace(e,s,c,p,y){const x=12*e,E=3*e;return this.uint8[x+0]=s,this.uint8[x+1]=c,this.float32[E+1]=p,this.float32[E+2]=y,e}}Ol.prototype.bytesPerElement=12,dn(Ol,"StructArrayLayout2ub2f12");class Ia extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c){const p=this.length;return this.resize(p+1),this.emplace(p,e,s,c)}emplace(e,s,c,p){const y=3*e;return this.float32[y+0]=s,this.float32[y+1]=c,this.float32[y+2]=p,e}}Ia.prototype.bytesPerElement=12,dn(Ia,"StructArrayLayout3f12");class Bo extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c){const p=this.length;return this.resize(p+1),this.emplace(p,e,s,c)}emplace(e,s,c,p){const y=3*e;return this.uint16[y+0]=s,this.uint16[y+1]=c,this.uint16[y+2]=p,e}}Bo.prototype.bytesPerElement=6,dn(Bo,"StructArrayLayout3ui6");class Ma extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E,I,M,O,k,U,$,Q,at,wt,zt,Wt,Ot,Vt,ne){const qt=this.length;return this.resize(qt+1),this.emplace(qt,e,s,c,p,y,x,E,I,M,O,k,U,$,Q,at,wt,zt,Wt,Ot,Vt,ne)}emplace(e,s,c,p,y,x,E,I,M,O,k,U,$,Q,at,wt,zt,Wt,Ot,Vt,ne,qt){const Me=30*e,Ie=15*e,Ge=60*e;return this.int16[Me+0]=s,this.int16[Me+1]=c,this.int16[Me+2]=p,this.float32[Ie+2]=y,this.float32[Ie+3]=x,this.uint16[Me+8]=E,this.uint16[Me+9]=I,this.uint32[Ie+5]=M,this.uint32[Ie+6]=O,this.uint32[Ie+7]=k,this.uint16[Me+16]=U,this.uint16[Me+17]=$,this.uint16[Me+18]=Q,this.float32[Ie+10]=at,this.float32[Ie+11]=wt,this.uint8[Ge+48]=zt,this.uint8[Ge+49]=Wt,this.uint8[Ge+50]=Ot,this.uint32[Ie+13]=Vt,this.int16[Me+28]=ne,this.uint8[Ge+58]=qt,e}}Ma.prototype.bytesPerElement=60,dn(Ma,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class zl extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y,x,E,I,M,O,k,U,$,Q,at,wt,zt,Wt,Ot,Vt,ne,qt,Me,Ie,Ge,cn,Ne,Ze,Ye,on){const hn=this.length;return this.resize(hn+1),this.emplace(hn,e,s,c,p,y,x,E,I,M,O,k,U,$,Q,at,wt,zt,Wt,Ot,Vt,ne,qt,Me,Ie,Ge,cn,Ne,Ze,Ye,on)}emplace(e,s,c,p,y,x,E,I,M,O,k,U,$,Q,at,wt,zt,Wt,Ot,Vt,ne,qt,Me,Ie,Ge,cn,Ne,Ze,Ye,on,hn){const Oe=38*e,En=19*e;return this.int16[Oe+0]=s,this.int16[Oe+1]=c,this.int16[Oe+2]=p,this.float32[En+2]=y,this.float32[En+3]=x,this.int16[Oe+8]=E,this.int16[Oe+9]=I,this.int16[Oe+10]=M,this.int16[Oe+11]=O,this.int16[Oe+12]=k,this.int16[Oe+13]=U,this.uint16[Oe+14]=$,this.uint16[Oe+15]=Q,this.uint16[Oe+16]=at,this.uint16[Oe+17]=wt,this.uint16[Oe+18]=zt,this.uint16[Oe+19]=Wt,this.uint16[Oe+20]=Ot,this.uint16[Oe+21]=Vt,this.uint16[Oe+22]=ne,this.uint16[Oe+23]=qt,this.uint16[Oe+24]=Me,this.uint16[Oe+25]=Ie,this.uint16[Oe+26]=Ge,this.uint16[Oe+27]=cn,this.uint16[Oe+28]=Ne,this.uint32[En+15]=Ze,this.float32[En+16]=Ye,this.float32[En+17]=on,this.float32[En+18]=hn,e}}zl.prototype.bytesPerElement=76,dn(zl,"StructArrayLayout3i2f6i15ui1ul3f76");class uo extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.float32[1*e+0]=s,e}}uo.prototype.bytesPerElement=4,dn(uo,"StructArrayLayout1f4");class pl extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,s,c,p,y)}emplace(e,s,c,p,y,x){const E=5*e;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=p,this.float32[E+3]=y,this.float32[E+4]=x,e}}pl.prototype.bytesPerElement=20,dn(pl,"StructArrayLayout5f20");class Su extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,s,c,p)}emplace(e,s,c,p,y){const x=6*e;return this.uint32[3*e+0]=s,this.uint16[x+2]=c,this.uint16[x+3]=p,this.uint16[x+4]=y,e}}Su.prototype.bytesPerElement=12,dn(Su,"StructArrayLayout1ul3ui12");class gl extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,s)}emplace(e,s,c){const p=2*e;return this.uint16[p+0]=s,this.uint16[p+1]=c,e}}gl.prototype.bytesPerElement=4,dn(gl,"StructArrayLayout2ui4");class t extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint16[1*e+0]=s,e}}t.prototype.bytesPerElement=2,dn(t,"StructArrayLayout1ui2");class n extends Un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,s)}emplace(e,s,c){const p=2*e;return this.float32[p+0]=s,this.float32[p+1]=c,e}}n.prototype.bytesPerElement=8,dn(n,"StructArrayLayout2f8");class l extends Gn{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}l.prototype.size=12;class d extends er{get(e){return new l(this,e)}}dn(d,"FillExtrusionExtArray");class v extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}v.prototype.size=40;class C extends Ir{get(e){return new v(this,e)}}dn(C,"CollisionBoxArray");class z extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}z.prototype.size=60;class W extends Ma{get(e){return new z(this,e)}}dn(W,"PlacedSymbolArray");class gt extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}gt.prototype.size=76;class Bt extends zl{get(e){return new gt(this,e)}}dn(Bt,"SymbolInstanceArray");class Se extends uo{getoffsetX(e){return this.float32[1*e+0]}}dn(Se,"GlyphOffsetArray");class Ae extends Er{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}dn(Ae,"SymbolLineVertexArray");class rn extends Gn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}rn.prototype.size=12;class Nn extends Su{get(e){return new rn(this,e)}}dn(Nn,"FeatureIndexArray");class ei extends Gn{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}ei.prototype.size=4;class ci extends gl{get(e){return new ei(this,e)}}dn(ci,"FillExtrusionCentroidArray");class Mr extends Gn{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Mr.prototype.size=12;class _s extends er{get(e){return new Mr(this,e)}}dn(_s,"CircleGlobeExtArray");const ha=tn([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),mc=tn([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var nu={exports:{}},yc={exports:{}};yc.exports=function(r,e){var s,c,p,y,x,E,I,M;for(c=r.length-(s=3&r.length),p=e,x=3432918353,E=461845907,M=0;M<c;)I=255&r.charCodeAt(M)|(255&r.charCodeAt(++M))<<8|(255&r.charCodeAt(++M))<<16|(255&r.charCodeAt(++M))<<24,++M,p=27492+(65535&(y=5*(65535&(p=(p^=I=(65535&(I=(I=(65535&I)*x+(((I>>>16)*x&65535)<<16)&4294967295)<<15|I>>>17))*E+(((I>>>16)*E&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(I=0,s){case 3:I^=(255&r.charCodeAt(M+2))<<16;case 2:I^=(255&r.charCodeAt(M+1))<<8;case 1:p^=I=(65535&(I=(I=(65535&(I^=255&r.charCodeAt(M)))*x+(((I>>>16)*x&65535)<<16)&4294967295)<<15|I>>>17))*E+(((I>>>16)*E&65535)<<16)&4294967295}return p^=r.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Wc={exports:{}};Wc.exports=function(r,e){for(var s,c=r.length,p=e^c,y=0;c>=4;)s=1540483477*(65535&(s=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++y;switch(c){case 3:p^=(255&r.charCodeAt(y+2))<<16;case 2:p^=(255&r.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&r.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var md=yc.exports,Gm=Wc.exports;nu.exports=md,nu.exports.murmur3=md,nu.exports.murmur2=Gm;class Of{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,s,c,p){this.ids.push(up(e)),this.positions.push(s,c,p)}getPositions(e){const s=up(e);let c=0,p=this.ids.length-1;for(;c<p;){const x=c+p>>1;this.ids[x]>=s?p=x:c=x+1}const y=[];for(;this.ids[c]===s;)y.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return y}static serialize(e,s){const c=new Float64Array(e.ids),p=new Uint32Array(e.positions);return yd(c,p,0,c.length-1),s&&s.push(c.buffer,p.buffer),{ids:c,positions:p}}static deserialize(e){const s=new Of;return s.ids=e.ids,s.positions=e.positions,s.indexed=!0,s}}function up(r){const e=+r;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:nu.exports(String(r))}function yd(r,e,s,c){for(;s<c;){const p=r[s+c>>1];let y=s-1,x=c+1;for(;;){do y++;while(r[y]<p);do x--;while(r[x]>p);if(y>=x)break;zf(r,y,x),zf(e,3*y,3*x),zf(e,3*y+1,3*x+1),zf(e,3*y+2,3*x+2)}x-s<c-x?(yd(r,e,s,x),s=x+1):(yd(r,e,x+1,c),c=x)}}function zf(r,e,s){const c=r[e];r[e]=r[s],r[s]=c}dn(Of,"FeaturePositionMap");class _c{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,s),this.initialized=!0),!!this.location}}class qh extends _c{constructor(e){super(e),this.current=0}set(e,s,c){this.fetchUniformLocation(e,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class cp extends _c{constructor(e){super(e),this.current=[0,0,0,0]}set(e,s,c){this.fetchUniformLocation(e,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class hp extends _c{constructor(e){super(e),this.current=Qe.transparent}set(e,s,c){this.fetchUniformLocation(e,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const fp=new Float32Array(16),Sg=new Float32Array(9),Tg=new Float32Array(4);function dp(r){return[pn(255*r.r,255*r.g),pn(255*r.b,255*r.a)]}class yh{constructor(e,s,c){this.value=e,this.uniformNames=s.map((p=>`u_${p}`)),this.type=c}setUniform(e,s,c,p,y){s.set(e,y,p.constantOr(this.value))}getBinding(e,s){return this.type==="color"?new hp(e):new qh(e)}}class _h{constructor(e,s){this.uniformNames=s.map((c=>`u_${c}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,s){this.pixelRatioFrom=s.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=s.tl.concat(s.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,s,c,p,y){const x=y==="u_pattern_to"||y==="u_dash_to"?this.patternTo:y==="u_pattern_from"||y==="u_dash_from"?this.patternFrom:y==="u_pixel_ratio_to"?this.pixelRatioTo:y==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&s.set(e,y,x)}getBinding(e,s){return s==="u_pattern_from"||s==="u_pattern_to"||s==="u_dash_from"||s==="u_dash_to"?new cp(e):new qh(e)}}class vc{constructor(e,s,c,p){this.expression=e,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map((y=>({name:`a_${y}`,type:"Float32",components:c==="color"?2:1,offset:0}))),this.paintVertexArray=new p}populatePaintArray(e,s,c,p,y,x){const E=this.paintVertexArray.length,I=this.expression.evaluate(new Nt(0),s,{},y,p,x);this.paintVertexArray.resize(e),this._setPaintValue(E,e,I)}updatePaintArray(e,s,c,p,y){const x=this.expression.evaluate({zoom:0},c,p,void 0,y);this._setPaintValue(e,s,x)}_setPaintValue(e,s,c){if(this.type==="color"){const p=dp(c);for(let y=e;y<s;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=e;p<s;p++)this.paintVertexArray.emplace(p,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Tu{constructor(e,s,c,p,y,x){this.expression=e,this.uniformNames=s.map((E=>`u_${E}_t`)),this.type=c,this.useIntegerZoom=p,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=s.map((E=>({name:`a_${E}`,type:"Float32",components:c==="color"?4:2,offset:0}))),this.paintVertexArray=new x}populatePaintArray(e,s,c,p,y,x){const E=this.expression.evaluate(new Nt(this.zoom),s,{},y,p,x),I=this.expression.evaluate(new Nt(this.zoom+1),s,{},y,p,x),M=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(M,e,E,I)}updatePaintArray(e,s,c,p,y){const x=this.expression.evaluate({zoom:this.zoom},c,p,void 0,y),E=this.expression.evaluate({zoom:this.zoom+1},c,p,void 0,y);this._setPaintValue(e,s,x,E)}_setPaintValue(e,s,c,p){if(this.type==="color"){const y=dp(c),x=dp(p);for(let E=e;E<s;E++)this.paintVertexArray.emplace(E,y[0],y[1],x[0],x[1])}else{for(let y=e;y<s;y++)this.paintVertexArray.emplace(y,c,p);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(p))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,s,c,p,y){const x=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,E=ct(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);s.set(e,y,E)}getBinding(e,s){return new qh(e)}}class Bc{constructor(e,s,c,p,y,x,E){this.expression=e,this.type=c,this.useIntegerZoom=p,this.zoom=y,this.layerId=E,this.paintVertexAttributes=(c==="array"?mc:ha).members;for(let I=0;I<s.length;++I);this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(e,s,c){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(p,e,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(e,s,c,p,y,x){this._setPaintValues(e,s,c.patterns&&c.patterns[this.layerId],x)}_setPaintValues(e,s,c,p){if(!p||!c)return;const{min:y,mid:x,max:E}=c,I=p[y],M=p[x],O=p[E];if(I&&M&&O)for(let k=e;k<s;k++)this._setPaintValue(this.zoomInPaintVertexArray,k,M,I),this._setPaintValue(this.zoomOutPaintVertexArray,k,M,O)}_setPaintValue(e,s,c,p){e.emplace(s,c.tl[0],c.tl[1],c.br[0],c.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],c.pixelRatio,p.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Fc{constructor(e,s,c=(()=>!0)){this.binders={},this._buffers=[];const p=[];for(const y in e.paint._values){if(!c(y))continue;const x=e.paint.get(y);if(!(x instanceof Ve&&Wo(x.property.specification)))continue;const E=Cg(y,e.type),I=x.value,M=x.property.specification.type,O=x.property.useIntegerZoom,k=x.property.specification["property-type"],U=k==="cross-faded"||k==="cross-faded-data-driven",$=String(y)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(I.kind!=="constant"||$)if(I.kind==="source"||$||U){const Q=Bf(y,M,"source");this.binders[y]=U?new Bc(I,E,M,O,s,Q,e.id):new vc(I,E,M,Q),p.push(`/a_${y}`)}else{const Q=Bf(y,M,"composite");this.binders[y]=new Tu(I,E,M,O,s,Q),p.push(`/z_${y}`)}else this.binders[y]=U?new _h(I.value,E):new yh(I.value,E,M),p.push(`/u_${y}`)}this.cacheKey=p.sort().join("")}getMaxValue(e){const s=this.binders[e];return s instanceof vc||s instanceof Tu?s.maxValue:0}populatePaintArrays(e,s,c,p,y,x){for(const E in this.binders){const I=this.binders[E];(I instanceof vc||I instanceof Tu||I instanceof Bc)&&I.populatePaintArray(e,s,c,p,y,x)}}setConstantPatternPositions(e,s){for(const c in this.binders){const p=this.binders[c];p instanceof _h&&p.setConstantPatternPositions(e,s)}}updatePaintArrays(e,s,c,p,y,x){let E=!1;for(const I in e){const M=s.getPositions(I);for(const O of M){const k=c.feature(O.index);for(const U in this.binders){const $=this.binders[U];if(($ instanceof vc||$ instanceof Tu||$ instanceof Bc)&&$.expression.isStateDependent===!0){const Q=p.paint.get(U);$.expression=Q.value,$.updatePaintArray(O.start,O.end,k,e[I],y,x),E=!0}}}}return E}defines(){const e=[];for(const s in this.binders){const c=this.binders[s];(c instanceof yh||c instanceof _h)&&e.push(...c.uniformNames.map((p=>`#define HAS_UNIFORM_${p}`)))}return e}getBinderAttributes(){const e=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof vc||c instanceof Tu||c instanceof Bc)for(let p=0;p<c.paintVertexAttributes.length;p++)e.push(c.paintVertexAttributes[p].name)}return e}getBinderUniforms(){const e=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof yh||c instanceof _h||c instanceof Tu)for(const p of c.uniformNames)e.push(p)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const s=[];for(const c in this.binders){const p=this.binders[c];if(p instanceof yh||p instanceof _h||p instanceof Tu)for(const y of p.uniformNames)s.push({name:y,property:c,binding:p.getBinding(e,y)})}return s}setUniforms(e,s,c,p,y){for(const{name:x,property:E,binding:I}of c)this.binders[E].setUniform(e,I,y,p.get(E),x)}updatePaintBuffers(e){this._buffers=[];for(const s in this.binders){const c=this.binders[s];if(e&&c instanceof Bc){const p=e.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(c instanceof vc||c instanceof Tu)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(e){for(const s in this.binders){const c=this.binders[s];(c instanceof vc||c instanceof Tu||c instanceof Bc)&&c.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const s=this.binders[e];(s instanceof vc||s instanceof Tu||s instanceof Bc)&&s.destroy()}}}class vh{constructor(e,s,c=(()=>!0)){this.programConfigurations={};for(const p of e)this.programConfigurations[p.id]=new Fc(p,s,c);this.needsUpload=!1,this._featureMap=new Of,this._bufferOffset=0}populatePaintArrays(e,s,c,p,y,x,E){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(e,s,p,y,x,E);s.id!==void 0&&this._featureMap.add(s.id,c,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,s,c,p,y){for(const x of c)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,s,x,p,y)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Vm={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Cg(r,e){return Vm[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}const Pf={"line-pattern":{source:Ko,composite:Ko},"fill-pattern":{source:Ko,composite:Ko},"fill-extrusion-pattern":{source:Ko,composite:Ko},"line-dasharray":{source:ks,composite:ks}},pp={color:{source:n,composite:Xs},number:{source:uo,composite:n}};function Bf(r,e,s){const c=Pf[r];return c&&c[s]||pp[e][s]}dn(yh,"ConstantBinder"),dn(_h,"CrossFadedConstantBinder"),dn(vc,"SourceExpressionBinder"),dn(Bc,"CrossFadedCompositeBinder"),dn(Tu,"CompositeExpressionBinder"),dn(Fc,"ProgramConfiguration",{omit:["_buffers"]}),dn(vh,"ProgramConfigurationSet");const Ff="-transition";class qu extends Ss{constructor(e,s){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),s.layout&&(this._unevaluatedLayout=new ce(s.layout)),s.paint)){this._transitionablePaint=new Ee(s.paint);for(const c in e.paint)this.setPaintProperty(c,e.paint[c],{validate:!1});for(const c in e.layout)this.setLayoutProperty(c,e.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Pe(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,s,c={}){s!=null&&this._validate(cl,`layers.${this.id}.layout.${e}`,e,s,c)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,s):this.visibility=s)}getPaintProperty(e){return $n(e,Ff)?this._transitionablePaint.getTransition(e.slice(0,-Ff.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,s,c={}){if(s!=null&&this._validate(Ga,`layers.${this.id}.paint.${e}`,e,s,c))return!1;if($n(e,Ff))return this._transitionablePaint.setTransition(e.slice(0,-Ff.length),s||void 0),!1;{const p=this._transitionablePaint._values[e],y=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),E=p.value;this._transitionablePaint.setValue(e,s),this._handleSpecialPaintPropertyUpdate(e);const I=this._transitionablePaint._values[e].value;return I.isDataDriven()||x||y||this._handleOverridablePaintPropertyUpdate(e,E,I)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,s,c){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,s){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,s)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Gi(e,((s,c)=>!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length)))}_validate(e,s,c,p,y={}){return(!y||y.validate!==!1)&&Uu(this,e.call(Oo,{key:s,layerType:this.type,objectKey:c,value:p,styleSpec:_e,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const s=this.paint.get(e);if(s instanceof Ve&&Wo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=_u(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const kf=tn([{name:"a_pos",components:2,type:"Int16"}],4),Ig=tn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Qs{constructor(e=[]){this.segments=e}prepareSegment(e,s,c,p){let y=this.segments[this.segments.length-1];return e>Qs.MAX_VERTEX_ARRAY_LENGTH&&lr(`Max vertices per segment is ${Qs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!y||y.vertexLength+e>Qs.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const e of this.segments)for(const s in e.vaos)e.vaos[s].destroy()}static simpleSegment(e,s,c,p){return new Qs([{vertexOffset:e,primitiveOffset:s,vertexLength:c,primitiveLength:p,vaos:{},sortKey:0}])}}Qs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn(Qs,"SegmentVector");var ai=8192;class xc{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof fr?new fr(e.lng,e.lat):fr.convert(e),this}setSouthWest(e){return this._sw=e instanceof fr?new fr(e.lng,e.lat):fr.convert(e),this}extend(e){const s=this._sw,c=this._ne;let p,y;if(e instanceof fr)p=e,y=e;else{if(!(e instanceof xc))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(xc.convert(e)):this.extend(fr.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(fr.convert(e)):this;if(p=e._sw,y=e._ne,!p||!y)return this}return s||c?(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new fr(p.lng,p.lat),this._ne=new fr(y.lng,y.lat)),this}getCenter(){return new fr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new fr(this.getWest(),this.getNorth())}getSouthEast(){return new fr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:c}=fr.convert(e);let p=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&p}static convert(e){return!e||e instanceof xc?e:new xc(e)}}const jh=63710088e-1;class fr{constructor(e,s){if(isNaN(e)||isNaN(s))throw new Error(`Invalid LngLat object: (${e}, ${s})`);if(this.lng=+e,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fr(ut(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const s=Math.PI/180,c=this.lat*s,p=e.lat*s,y=Math.sin(c)*Math.sin(p)+Math.cos(c)*Math.cos(p)*Math.cos((e.lng-this.lng)*s);return jh*Math.acos(Math.min(y,1))}toBounds(e=0){const s=360*e/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new xc(new fr(this.lng-c,this.lat-s),new fr(this.lng+c,this.lat+s))}static convert(e){if(e instanceof fr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new fr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new fr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const gp=2*Math.PI*jh;function kc(r){return gp*Math.cos(r*Math.PI/180)}function rc(r){return(180+r)/360}function sc(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Cu(r,e){return r/kc(e)}function ml(r){return 360*r-180}function fa(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function _d(r,e){return r*kc(fa(e))}const oc=85.051129;function mp(r){return 1/Math.cos(r*Math.PI/180)}class Xh{constructor(e,s,c=0){this.x=+e,this.y=+s,this.z=+c}static fromLngLat(e,s=0){const c=fr.convert(e);return new Xh(rc(c.lng),sc(c.lat),Cu(s,c.lat))}toLngLat(){return new fr(ml(this.x),fa(this.y))}toAltitude(){return _d(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/gp*mp(fa(this.y))}}function Uf(r,e,s,c,p,y,x,E,I){const M=(e+c)/2,O=(s+p)/2,k=new Dt(M,O);E(k),(function(U,$,Q,at,wt,zt){const Wt=Q-wt,Ot=at-zt;return Math.abs((at-$)*Wt-(Q-U)*Ot)/Math.hypot(Wt,Ot)})(k.x,k.y,y.x,y.y,x.x,x.y)>=I?(Uf(r,e,s,M,O,y,k,E,I),Uf(r,M,O,c,p,k,x,E,I)):r.push(x)}function Fo(r,e,s){let c=r[0],p=c.x,y=c.y;e(c);const x=[c];for(let E=1;E<r.length;E++){const I=r[E],{x:M,y:O}=I;e(I),Uf(x,p,y,M,O,c,I,e,s),p=M,y=O,c=I}return x}function da(r,e,s,c){if(c(e,s)){const p=e.add(s)._mult(.5);da(r,e,p,c),da(r,p,s,c)}else r.push(s)}function Mg(r,e){let s=r[0];const c=[s];for(let p=1;p<r.length;p++){const y=r[p];da(c,s,y,e),s=y}return c}const vd=Math.pow(2,14)-1,yp=-vd-1;function Ag(r,e){const s=Math.round(r.x*e),c=Math.round(r.y*e);return r.x=ct(s,yp,vd),r.y=ct(c,yp,vd),(s<r.x||s>r.x+1||c<r.y||c>r.y+1)&&lr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function Iu(r,e,s){const c=r.loadGeometry(),p=r.extent,y=ai/p;if(e&&s&&s.projection.isReprojectedInTileSpace){const x=1<<e.z,{scale:E,x:I,y:M,projection:O}=s,k=U=>{const $=ml((e.x+U.x/p)/x),Q=fa((e.y+U.y/p)/x),at=O.project($,Q);U.x=(at.x*E-I)*p,U.y=(at.y*E-M)*p};for(let U=0;U<c.length;U++)if(r.type!==1)c[U]=Fo(c[U],k,1);else{const $=[];for(const Q of c[U])Q.x<0||Q.x>=p||Q.y<0||Q.y>=p||(k(Q),$.push(Q));c[U]=$}}for(const x of c)for(const E of x)Ag(E,y);return c}function $c(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?Iu(r):[]}}function xh(r,e,s,c,p){r.emplaceBack(2*e+(c+1)/2,2*s+(p+1)/2)}function Gf(r,e,s){r.emplaceBack(e.x,e.y,e.z,s[0]*16384,s[1]*16384,s[2]*16384)}class _p{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new di,this.indexArray=new Bo,this.segments=new Qs,this.programConfigurations=new vh(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(e,s,c,p){const y=this.layers[0],x=[];let E=null;y.type==="circle"&&(E=y.layout.get("circle-sort-key"));for(const{feature:M,id:O,index:k,sourceLayerIndex:U}of e){const $=this.layers[0]._featureFilter.needGeometry,Q=$c(M,$);if(!this.layers[0]._featureFilter.filter(new Nt(this.zoom),Q,c))continue;const at=E?E.evaluate(Q,{},c):void 0,wt={id:O,properties:M.properties,type:M.type,sourceLayerIndex:U,index:k,geometry:$?Q.geometry:Iu(M,c,p),patterns:{},sortKey:at};x.push(wt)}E&&x.sort(((M,O)=>M.sortKey-O.sortKey));let I=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new _s,I=p.projection);for(const M of x){const{geometry:O,index:k,sourceLayerIndex:U}=M,$=e[k].feature;this.addFeature(M,O,k,s.availableImages,c,I),s.featureIndex.insert($,O,k,U,this.index)}}update(e,s,c,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Ig.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,s,c,p,y,x){for(const E of s)for(const I of E){const M=I.x,O=I.y;if(M<0||M>=ai||O<0||O>=ai)continue;if(x){const $=x.projectTilePoint(M,O,y),Q=x.upVector(y,M,O),at=this.globeExtVertexArray;Gf(at,$,Q),Gf(at,$,Q),Gf(at,$,Q),Gf(at,$,Q)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=k.vertexLength;xh(this.layoutVertexArray,M,O,-1,-1),xh(this.layoutVertexArray,M,O,1,-1),xh(this.layoutVertexArray,M,O,1,1),xh(this.layoutVertexArray,M,O,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{},p,y)}}function Vf(r,e){for(let s=0;s<r.length;s++)if(Uc(e,r[s]))return!0;for(let s=0;s<e.length;s++)if(Uc(r,e[s]))return!0;return!!xd(r,e)}function vp(r,e,s){return!!Uc(r,e)||!!qf(e,r,s)}function xp(r,e){if(r.length===1)return wp(e,r[0]);for(let s=0;s<e.length;s++){const c=e[s];for(let p=0;p<c.length;p++)if(Uc(r,c[p]))return!0}for(let s=0;s<r.length;s++)if(wp(e,r[s]))return!0;for(let s=0;s<e.length;s++)if(xd(r,e[s]))return!0;return!1}function Lg(r,e,s){if(r.length>1){if(xd(r,e))return!0;for(let c=0;c<e.length;c++)if(qf(e[c],r,s))return!0}for(let c=0;c<r.length;c++)if(qf(r[c],e,s))return!0;return!1}function xd(r,e){if(r.length===0||e.length===0)return!1;for(let s=0;s<r.length-1;s++){const c=r[s],p=r[s+1];for(let y=0;y<e.length-1;y++)if(bp(c,p,e[y],e[y+1]))return!0}return!1}function bp(r,e,s,c){return Fr(r,s,c)!==Fr(e,s,c)&&Fr(r,e,s)!==Fr(r,e,c)}function qf(r,e,s){const c=s*s;if(e.length===1)return r.distSqr(e[0])<c;for(let p=1;p<e.length;p++)if(bd(r,e[p-1],e[p])<c)return!0;return!1}function bd(r,e,s){const c=e.distSqr(s);if(c===0)return r.distSqr(e);const p=((r.x-e.x)*(s.x-e.x)+(r.y-e.y)*(s.y-e.y))/c;return r.distSqr(p<0?e:p>1?s:s.sub(e)._mult(p)._add(e))}function wp(r,e){let s,c,p,y=!1;for(let x=0;x<r.length;x++){s=r[x];for(let E=0,I=s.length-1;E<s.length;I=E++)c=s[E],p=s[I],c.y>e.y!=p.y>e.y&&e.x<(p.x-c.x)*(e.y-c.y)/(p.y-c.y)+c.x&&(y=!y)}return y}function Uc(r,e){let s=!1;for(let c=0,p=r.length-1;c<r.length;p=c++){const y=r[c],x=r[p];y.y>e.y!=x.y>e.y&&e.x<(x.x-y.x)*(e.y-y.y)/(x.y-y.y)+y.x&&(s=!s)}return s}function jf(r,e,s,c,p){for(const x of r)if(e<=x.x&&s<=x.y&&c>=x.x&&p>=x.y)return!0;const y=[new Dt(e,s),new Dt(e,p),new Dt(c,p),new Dt(c,s)];if(r.length>2){for(const x of y)if(Uc(r,x))return!0}for(let x=0;x<r.length-1;x++)if(Ep(r[x],r[x+1],y))return!0;return!1}function Ep(r,e,s){const c=s[0],p=s[2];if(r.x<c.x&&e.x<c.x||r.x>p.x&&e.x>p.x||r.y<c.y&&e.y<c.y||r.y>p.y&&e.y>p.y)return!1;const y=Fr(r,e,s[0]);return y!==Fr(r,e,s[1])||y!==Fr(r,e,s[2])||y!==Fr(r,e,s[3])}function bh(r,e,s){const c=e.paint.get(r).value;return c.kind==="constant"?c.value:s.programConfigurations.get(e.id).getMaxValue(r)}function Zh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Sp(r,e,s,c,p){if(!e[0]&&!e[1])return r;const y=Dt.convert(e)._mult(p);s==="viewport"&&y._rotate(-c);const x=[];for(let E=0;E<r.length;E++)x.push(r[E].sub(y));return x}function bc(r,e,s,c){const p=Dt.convert(r)._mult(c);return e==="viewport"&&p._rotate(-s),p}dn(_p,"CircleBucket",{omit:["layers"]});const Tp=new Xe({"circle-sort-key":new Qt(_e.layout_circle["circle-sort-key"])});var qm={paint:new Xe({"circle-radius":new Qt(_e.paint_circle["circle-radius"]),"circle-color":new Qt(_e.paint_circle["circle-color"]),"circle-blur":new Qt(_e.paint_circle["circle-blur"]),"circle-opacity":new Qt(_e.paint_circle["circle-opacity"]),"circle-translate":new ge(_e.paint_circle["circle-translate"]),"circle-translate-anchor":new ge(_e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ge(_e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ge(_e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qt(_e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qt(_e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qt(_e.paint_circle["circle-stroke-opacity"])}),layout:Tp},Xf=1e-6,bo=typeof Float32Array<"u"?Float32Array:Array;function wd(){var r=new bo(9);return bo!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Cp(r,e,s){var c=e[0],p=e[1],y=e[2],x=e[3],E=e[4],I=e[5],M=e[6],O=e[7],k=e[8],U=s[0],$=s[1],Q=s[2],at=s[3],wt=s[4],zt=s[5],Wt=s[6],Ot=s[7],Vt=s[8];return r[0]=U*c+$*x+Q*M,r[1]=U*p+$*E+Q*O,r[2]=U*y+$*I+Q*k,r[3]=at*c+wt*x+zt*M,r[4]=at*p+wt*E+zt*O,r[5]=at*y+wt*I+zt*k,r[6]=Wt*c+Ot*x+Vt*M,r[7]=Wt*p+Ot*E+Vt*O,r[8]=Wt*y+Ot*I+Vt*k,r}function Mu(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function wh(r,e){var s=e[0],c=e[1],p=e[2],y=e[3],x=e[4],E=e[5],I=e[6],M=e[7],O=e[8],k=e[9],U=e[10],$=e[11],Q=e[12],at=e[13],wt=e[14],zt=e[15],Wt=s*E-c*x,Ot=s*I-p*x,Vt=s*M-y*x,ne=c*I-p*E,qt=c*M-y*E,Me=p*M-y*I,Ie=O*at-k*Q,Ge=O*wt-U*Q,cn=O*zt-$*Q,Ne=k*wt-U*at,Ze=k*zt-$*at,Ye=U*zt-$*wt,on=Wt*Ye-Ot*Ze+Vt*Ne+ne*cn-qt*Ge+Me*Ie;return on?(r[0]=(E*Ye-I*Ze+M*Ne)*(on=1/on),r[1]=(p*Ze-c*Ye-y*Ne)*on,r[2]=(at*Me-wt*qt+zt*ne)*on,r[3]=(U*qt-k*Me-$*ne)*on,r[4]=(I*cn-x*Ye-M*Ge)*on,r[5]=(s*Ye-p*cn+y*Ge)*on,r[6]=(wt*Vt-Q*Me-zt*Ot)*on,r[7]=(O*Me-U*Vt+$*Ot)*on,r[8]=(x*Ze-E*cn+M*Ie)*on,r[9]=(c*cn-s*Ze-y*Ie)*on,r[10]=(Q*qt-at*Vt+zt*Wt)*on,r[11]=(k*Vt-O*qt-$*Wt)*on,r[12]=(E*Ge-x*Ne-I*Ie)*on,r[13]=(s*Ne-c*Ge+p*Ie)*on,r[14]=(at*Ot-Q*ne-wt*Wt)*on,r[15]=(O*ne-k*Ot+U*Wt)*on,r):null}function is(r,e,s){var c=e[0],p=e[1],y=e[2],x=e[3],E=e[4],I=e[5],M=e[6],O=e[7],k=e[8],U=e[9],$=e[10],Q=e[11],at=e[12],wt=e[13],zt=e[14],Wt=e[15],Ot=s[0],Vt=s[1],ne=s[2],qt=s[3];return r[0]=Ot*c+Vt*E+ne*k+qt*at,r[1]=Ot*p+Vt*I+ne*U+qt*wt,r[2]=Ot*y+Vt*M+ne*$+qt*zt,r[3]=Ot*x+Vt*O+ne*Q+qt*Wt,r[4]=(Ot=s[4])*c+(Vt=s[5])*E+(ne=s[6])*k+(qt=s[7])*at,r[5]=Ot*p+Vt*I+ne*U+qt*wt,r[6]=Ot*y+Vt*M+ne*$+qt*zt,r[7]=Ot*x+Vt*O+ne*Q+qt*Wt,r[8]=(Ot=s[8])*c+(Vt=s[9])*E+(ne=s[10])*k+(qt=s[11])*at,r[9]=Ot*p+Vt*I+ne*U+qt*wt,r[10]=Ot*y+Vt*M+ne*$+qt*zt,r[11]=Ot*x+Vt*O+ne*Q+qt*Wt,r[12]=(Ot=s[12])*c+(Vt=s[13])*E+(ne=s[14])*k+(qt=s[15])*at,r[13]=Ot*p+Vt*I+ne*U+qt*wt,r[14]=Ot*y+Vt*M+ne*$+qt*zt,r[15]=Ot*x+Vt*O+ne*Q+qt*Wt,r}function Zf(r,e,s){var c,p,y,x,E,I,M,O,k,U,$,Q,at=s[0],wt=s[1],zt=s[2];return e===r?(r[12]=e[0]*at+e[4]*wt+e[8]*zt+e[12],r[13]=e[1]*at+e[5]*wt+e[9]*zt+e[13],r[14]=e[2]*at+e[6]*wt+e[10]*zt+e[14],r[15]=e[3]*at+e[7]*wt+e[11]*zt+e[15]):(p=e[1],y=e[2],x=e[3],E=e[4],I=e[5],M=e[6],O=e[7],k=e[8],U=e[9],$=e[10],Q=e[11],r[0]=c=e[0],r[1]=p,r[2]=y,r[3]=x,r[4]=E,r[5]=I,r[6]=M,r[7]=O,r[8]=k,r[9]=U,r[10]=$,r[11]=Q,r[12]=c*at+E*wt+k*zt+e[12],r[13]=p*at+I*wt+U*zt+e[13],r[14]=y*at+M*wt+$*zt+e[14],r[15]=x*at+O*wt+Q*zt+e[15]),r}function Eh(r,e,s){var c=s[0],p=s[1],y=s[2];return r[0]=e[0]*c,r[1]=e[1]*c,r[2]=e[2]*c,r[3]=e[3]*c,r[4]=e[4]*p,r[5]=e[5]*p,r[6]=e[6]*p,r[7]=e[7]*p,r[8]=e[8]*y,r[9]=e[9]*y,r[10]=e[10]*y,r[11]=e[11]*y,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Ed(r,e,s){var c=Math.sin(s),p=Math.cos(s),y=e[4],x=e[5],E=e[6],I=e[7],M=e[8],O=e[9],k=e[10],U=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=y*p+M*c,r[5]=x*p+O*c,r[6]=E*p+k*c,r[7]=I*p+U*c,r[8]=M*p-y*c,r[9]=O*p-x*c,r[10]=k*p-E*c,r[11]=U*p-I*c,r}function Jc(r,e,s){var c=Math.sin(s),p=Math.cos(s),y=e[0],x=e[1],E=e[2],I=e[3],M=e[8],O=e[9],k=e[10],U=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=y*p-M*c,r[1]=x*p-O*c,r[2]=E*p-k*c,r[3]=I*p-U*c,r[8]=y*c+M*p,r[9]=x*c+O*p,r[10]=E*c+k*p,r[11]=I*c+U*p,r}function Gc(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ip(r,e,s){var c,p,y,x=s[0],E=s[1],I=s[2],M=Math.hypot(x,E,I);return M<Xf?null:(x*=M=1/M,E*=M,I*=M,c=Math.sin(e),p=Math.cos(e),r[0]=x*x*(y=1-p)+p,r[1]=E*x*y+I*c,r[2]=I*x*y-E*c,r[3]=0,r[4]=x*E*y-I*c,r[5]=E*E*y+p,r[6]=I*E*y+x*c,r[7]=0,r[8]=x*I*y+E*c,r[9]=E*I*y-x*c,r[10]=I*I*y+p,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Rg=is;function Sh(){var r=new bo(3);return bo!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function ac(r){var e=new bo(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Hh(r){return Math.hypot(r[0],r[1],r[2])}function Kc(r,e,s){var c=new bo(3);return c[0]=r,c[1]=e,c[2]=s,c}function wc(r,e,s){return r[0]=e[0]+s[0],r[1]=e[1]+s[1],r[2]=e[2]+s[2],r}function Hf(r,e,s){return r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],r}function Sd(r,e,s){return r[0]=e[0]*s[0],r[1]=e[1]*s[1],r[2]=e[2]*s[2],r}function Qc(r,e,s){return r[0]=Math.min(e[0],s[0]),r[1]=Math.min(e[1],s[1]),r[2]=Math.min(e[2],s[2]),r}function Yh(r,e,s){return r[0]=Math.max(e[0],s[0]),r[1]=Math.max(e[1],s[1]),r[2]=Math.max(e[2],s[2]),r}function ko(r,e,s){return r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function to(r,e,s,c){return r[0]=e[0]+s[0]*c,r[1]=e[1]+s[1]*c,r[2]=e[2]+s[2]*c,r}function Aa(r,e){var s=e[0],c=e[1],p=e[2],y=s*s+c*c+p*p;return y>0&&(y=1/Math.sqrt(y)),r[0]=e[0]*y,r[1]=e[1]*y,r[2]=e[2]*y,r}function Au(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Qo(r,e,s){var c=e[0],p=e[1],y=e[2],x=s[0],E=s[1],I=s[2];return r[0]=p*I-y*E,r[1]=y*x-c*I,r[2]=c*E-p*x,r}function wo(r,e,s){var c=e[0],p=e[1],y=e[2],x=s[3]*c+s[7]*p+s[11]*y+s[15];return r[0]=(s[0]*c+s[4]*p+s[8]*y+s[12])/(x=x||1),r[1]=(s[1]*c+s[5]*p+s[9]*y+s[13])/x,r[2]=(s[2]*c+s[6]*p+s[10]*y+s[14])/x,r}function Mp(r,e,s){var c=s[0],p=s[1],y=s[2],x=e[0],E=e[1],I=e[2],M=p*I-y*E,O=y*x-c*I,k=c*E-p*x,U=p*k-y*O,$=y*M-c*k,Q=c*O-p*M,at=2*s[3];return O*=at,k*=at,$*=2,Q*=2,r[0]=x+(M*=at)+(U*=2),r[1]=E+O+$,r[2]=I+k+Q,r}var Wh,Ar=Hf,iu=Sd,Vc=Hh;function Ap(r,e,s){return r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r[3]=e[3]*s,r}function Lp(r,e){var s=e[0],c=e[1],p=e[2],y=e[3],x=s*s+c*c+p*p+y*y;return x>0&&(x=1/Math.sqrt(x)),r[0]=s*x,r[1]=c*x,r[2]=p*x,r[3]=y*x,r}function th(r,e,s){var c=e[0],p=e[1],y=e[2],x=e[3];return r[0]=s[0]*c+s[4]*p+s[8]*y+s[12]*x,r[1]=s[1]*c+s[5]*p+s[9]*y+s[13]*x,r[2]=s[2]*c+s[6]*p+s[10]*y+s[14]*x,r[3]=s[3]*c+s[7]*p+s[11]*y+s[15]*x,r}function Dg(){var r=new bo(4);return bo!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Yf(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function Pl(r,e,s){s*=.5;var c=e[0],p=e[1],y=e[2],x=e[3],E=Math.sin(s),I=Math.cos(s);return r[0]=c*I+x*E,r[1]=p*I+y*E,r[2]=y*I-p*E,r[3]=x*I-c*E,r}function ju(r,e,s){s*=.5;var c=e[0],p=e[1],y=e[2],x=e[3],E=Math.sin(s),I=Math.cos(s);return r[0]=c*I-y*E,r[1]=p*I+x*E,r[2]=y*I+c*E,r[3]=x*I-p*E,r}Sh(),Wh=new bo(4),bo!=Float32Array&&(Wh[0]=0,Wh[1]=0,Wh[2]=0,Wh[3]=0);var Ng=Lp;Sh(),Kc(1,0,0),Kc(0,1,0),Dg(),Dg(),wd();class yl{constructor(e,s){this.pos=e,this.dir=s}intersectsPlane(e,s,c){const p=Au(s,this.dir);if(Math.abs(p)<1e-6)return!1;const y=((e[0]-this.pos[0])*s[0]+(e[1]-this.pos[1])*s[1]+(e[2]-this.pos[2])*s[2])/p;return c[0]=this.pos[0]+this.dir[0]*y,c[1]=this.pos[1]+this.dir[1]*y,c[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(e,s,c){if((function($,Q){var at=$[0],wt=$[1],zt=$[2],Wt=Q[0],Ot=Q[1],Vt=Q[2];return Math.abs(at-Wt)<=Xf*Math.max(1,Math.abs(at),Math.abs(Wt))&&Math.abs(wt-Ot)<=Xf*Math.max(1,Math.abs(wt),Math.abs(Ot))&&Math.abs(zt-Vt)<=Xf*Math.max(1,Math.abs(zt),Math.abs(Vt))})(this.pos,e)||s===0)return c[0]=c[1]=c[2]=0,!1;const[p,y,x]=this.dir,E=this.pos[0]-e[0],I=this.pos[1]-e[1],M=this.pos[2]-e[2],O=p*p+y*y+x*x,k=2*(E*p+I*y+M*x),U=k*k-4*O*(E*E+I*I+M*M-s*s);if(U<0){const $=Math.max(-k/2,0),Q=E+p*$,at=I+y*$,wt=M+x*$,zt=Math.hypot(Q,at,wt);return c[0]=Q*s/zt,c[1]=at*s/zt,c[2]=wt*s/zt,!1}{const $=(-k-Math.sqrt(U))/(2*O);if($<0){const Q=Math.hypot(E,I,M);return c[0]=E*s/Q,c[1]=I*s/Q,c[2]=M*s/Q,!1}return c[0]=E+p*$,c[1]=I+y*$,c[2]=M+x*$,!0}}}class Td{constructor(e,s,c,p,y){this.TL=e,this.TR=s,this.BR=c,this.BL=p,this.horizon=y}static fromInvProjectionMatrix(e,s,c){const p=[-1,1,1],y=[1,1,1],x=[1,-1,1],E=[-1,-1,1],I=wo(p,p,e),M=wo(y,y,e),O=wo(x,x,e),k=wo(E,E,e);return new Td(I,M,O,k,s/c)}}class lc{constructor(e,s){this.points=e,this.planes=s}static fromInvProjectionMatrix(e,s,c,p){const y=Math.pow(2,c),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((I=>{const M=th([],I,e),O=1/M[3]/s*y;return(function(k,U,$){return k[0]=U[0]*$[0],k[1]=U[1]*$[1],k[2]=U[2]*$[2],k[3]=U[3]*$[3],k})(M,M,[O,O,p?1/M[3]:O,O])})),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((I=>{const M=Aa([],Qo([],Ar([],x[I[0]],x[I[1]]),Ar([],x[I[2]],x[I[1]]))),O=-Au(M,x[I[1]]);return M.concat(O)}));return new lc(x,E)}}class Eo{static fromPoints(e){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const p of e)Qc(s,s,p),Yh(c,c,p);return new Eo(s,c)}static applyTransform(e,s){const c=e.getCorners();for(let p=0;p<c.length;++p)wo(c[p],c[p],s);return Eo.fromPoints(c)}constructor(e,s){this.min=e,this.max=s,this.center=ko([],wc([],this.min,this.max),.5)}quadrant(e){const s=[e%2==0,e<2],c=ac(this.min),p=ac(this.max);for(let y=0;y<s.length;y++)c[y]=s[y]?this.min[y]:this.center[y],p[y]=s[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new Eo(c,p)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,s=this.max;return[[e[0],e[1],e[2]],[s[0],e[1],e[2]],[s[0],s[1],e[2]],[e[0],s[1],e[2]],[e[0],e[1],s[2]],[s[0],e[1],s[2]],[s[0],s[1],s[2]],[e[0],s[1],s[2]]]}intersects(e){const s=this.getCorners();let c=!0;for(let p=0;p<e.planes.length;p++){const y=e.planes[p];let x=0;for(let E=0;E<s.length;E++)x+=Au(y,s[E])+y[3]>=0;if(x===0)return 0;x!==s.length&&(c=!1)}if(c)return 2;for(let p=0;p<3;p++){let y=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let E=0;E<e.points.length;E++){const I=e.points[E][p]-this.min[p];y=Math.min(y,I),x=Math.max(x,I)}if(x<0||y>this.max[p]-this.min[p])return 0}return 1}}function Ec(r,e,s,c,p,y,x,E,I){if(y&&r.queryGeometry.isAboveHorizon)return!1;y&&(I*=r.pixelToTileUnitsFactor);const M=r.tileID.canonical,O=s.projection.upVectorScale(M,s.center.lat,s.worldSize).metersToTile;for(const k of e)for(const U of k){const $=U.add(E),Q=p&&s.elevation?s.elevation.exaggeration()*p.getElevationAt($.x,$.y,!0):0,at=s.projection.projectTilePoint($.x,$.y,M);if(Q>0){const Ot=s.projection.upVector(M,$.x,$.y);at.x+=Ot[0]*O*Q,at.y+=Ot[1]*O*Q,at.z+=Ot[2]*O*Q}const wt=y?$:Rp(at.x,at.y,at.z,c),zt=y?r.tilespaceRays.map((Ot=>Og(Ot,Q))):r.queryGeometry.screenGeometry,Wt=th([],[at.x,at.y,at.z,1],c);if(!x&&y?I*=Wt[3]/s.cameraToCenterDistance:x&&!y&&(I*=s.cameraToCenterDistance/Wt[3]),y){const Ot=fa((U.y/ai+M.y)/(1<<M.z));I/=s.projection.pixelsPerMeter(Ot,1)/Cu(1,Ot)}if(vp(zt,wt,I))return!0}return!1}function Rp(r,e,s,c){const p=th([],[r,e,s,1],c);return new Dt(p[0]/p[3],p[1]/p[3])}const Cd=Kc(0,0,0),uc=Kc(0,0,1);function Og(r,e){const s=Sh();return Cd[2]=e,r.intersectsPlane(Cd,uc,s),new Dt(s[0],s[1])}class Th extends _p{}function $h(r,{width:e,height:s},c,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==e*s*c)throw new RangeError("mismatched image size")}else p=new Uint8Array(e*s*c);return r.width=e,r.height=s,r.data=p,r}function Jh(r,e,s){const{width:c,height:p}=e;c===r.width&&p===r.height||(eh(r,e,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,c),height:Math.min(r.height,p)},s),r.width=c,r.height=p,r.data=e.data)}function eh(r,e,s,c,p,y){if(p.width===0||p.height===0)return e;if(p.width>r.width||p.height>r.height||s.x>r.width-p.width||s.y>r.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>e.width||p.height>e.height||c.x>e.width-p.width||c.y>e.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=r.data,E=e.data;for(let I=0;I<p.height;I++){const M=((s.y+I)*r.width+s.x)*y,O=((c.y+I)*e.width+c.x)*y;for(let k=0;k<p.width*y;k++)E[O+k]=x[M+k]}return e}dn(Th,"HeatmapBucket",{omit:["layers"]});class Sc{constructor(e,s){$h(this,e,1,s)}resize(e){Jh(this,new Sc(e),1)}clone(){return new Sc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,c,p,y){eh(e,s,c,p,y,1)}}class Bl{constructor(e,s){$h(this,e,4,s)}resize(e){Jh(this,new Bl(e),4)}replace(e,s){s?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Bl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,c,p,y){eh(e,s,c,p,y,4)}}dn(Sc,"AlphaImage"),dn(Bl,"RGBAImage");var Wf={paint:new Xe({"heatmap-radius":new Qt(_e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qt(_e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ge(_e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fe(_e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ge(_e.paint_heatmap["heatmap-opacity"])})};function Id(r){const e={},s=r.resolution||256,c=r.clips?r.clips.length:1,p=r.image||new Bl({width:s,height:c}),y=(x,E,I)=>{e[r.evaluationKey]=I;const M=r.expression.evaluate(e);p.data[x+E+0]=Math.floor(255*M.r/M.a),p.data[x+E+1]=Math.floor(255*M.g/M.a),p.data[x+E+2]=Math.floor(255*M.b/M.a),p.data[x+E+3]=Math.floor(255*M.a)};if(r.clips)for(let x=0,E=0;x<c;++x,E+=4*s)for(let I=0,M=0;I<s;I++,M+=4){const O=I/(s-1),{start:k,end:U}=r.clips[x];y(E,M,k*(1-O)+U*O)}else for(let x=0,E=0;x<s;x++,E+=4)y(0,E,x/(s-1));return p}var Md={paint:new Xe({"hillshade-illumination-direction":new ge(_e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ge(_e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ge(_e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ge(_e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ge(_e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ge(_e.paint_hillshade["hillshade-accent-color"])})};const zg=tn([{name:"a_pos",components:2,type:"Int16"}],4),{members:jm}=zg;var $f={exports:{}};function Lr(r,e,s){s=s||2;var c,p,y,x,E,I,M,O=e&&e.length,k=O?e[0]*s:r.length,U=vs(r,0,k,s,!0),$=[];if(!U||U.next===U.prev)return $;if(O&&(U=(function(at,wt,zt,Wt){var Ot,Vt,ne,qt=[];for(Ot=0,Vt=wt.length;Ot<Vt;Ot++)(ne=vs(at,wt[Ot]*Wt,Ot<Vt-1?wt[Ot+1]*Wt:at.length,Wt,!1))===ne.next&&(ne.steiner=!0),qt.push(Ch(ne));for(qt.sort(Dp),Ot=0;Ot<qt.length;Ot++)zt=qc(qt[Ot],zt);return zt})(r,e,U,s)),r.length>80*s){c=y=r[0],p=x=r[1];for(var Q=s;Q<k;Q+=s)(E=r[Q])<c&&(c=E),(I=r[Q+1])<p&&(p=I),E>y&&(y=E),I>x&&(x=I);M=(M=Math.max(y-c,x-p))!==0?32767/M:0}return ir(U,$,s,c,p,M,0),$}function vs(r,e,s,c,p){var y,x;if(p===Cc(r,e,s,c)>0)for(y=e;y<s;y+=c)x=Kf(y,r[y],r[y+1],x);else for(y=s-c;y>=e;y-=c)x=Kf(y,r[y],r[y+1],x);return x&&rh(x,x.next)&&(Xu(x),x=x.next),x}function Hi(r,e){if(!r)return r;e||(e=r);var s,c=r;do if(s=!1,c.steiner||!rh(c,c.next)&&xs(c.prev,c,c.next)!==0)c=c.next;else{if(Xu(c),(c=e=c.prev)===c.next)break;s=!0}while(s||c!==e);return e}function ir(r,e,s,c,p,y,x){if(r){!x&&y&&(function(O,k,U,$){var Q=O;do Q.z===0&&(Q.z=Tc(Q.x,Q.y,k,U,$)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==O);Q.prevZ.nextZ=null,Q.prevZ=null,(function(at){var wt,zt,Wt,Ot,Vt,ne,qt,Me,Ie=1;do{for(zt=at,at=null,Vt=null,ne=0;zt;){for(ne++,Wt=zt,qt=0,wt=0;wt<Ie&&(qt++,Wt=Wt.nextZ);wt++);for(Me=Ie;qt>0||Me>0&&Wt;)qt!==0&&(Me===0||!Wt||zt.z<=Wt.z)?(Ot=zt,zt=zt.nextZ,qt--):(Ot=Wt,Wt=Wt.nextZ,Me--),Vt?Vt.nextZ=Ot:at=Ot,Ot.prevZ=Vt,Vt=Ot;zt=Wt}Vt.nextZ=null,Ie*=2}while(ne>1)})(Q)})(r,c,p,y);for(var E,I,M=r;r.prev!==r.next;)if(E=r.prev,I=r.next,y?Lu(r,c,p,y):ls(r))e.push(E.i/s|0),e.push(r.i/s|0),e.push(I.i/s|0),Xu(r),r=I.next,M=I.next;else if((r=I)===M){x?x===1?ir(r=nh(Hi(r),e,s),e,s,c,p,y,2):x===2&&Kh(r,e,s,c,p,y):ir(Hi(r),e,s,c,p,y,1);break}}}function ls(r){var e=r.prev,s=r,c=r.next;if(xs(e,s,c)>=0)return!1;for(var p=e.x,y=s.x,x=c.x,E=e.y,I=s.y,M=c.y,O=p<y?p<x?p:x:y<x?y:x,k=E<I?E<M?E:M:I<M?I:M,U=p>y?p>x?p:x:y>x?y:x,$=E>I?E>M?E:M:I>M?I:M,Q=c.next;Q!==e;){if(Q.x>=O&&Q.x<=U&&Q.y>=k&&Q.y<=$&&ih(p,E,y,I,x,M,Q.x,Q.y)&&xs(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function Lu(r,e,s,c){var p=r.prev,y=r,x=r.next;if(xs(p,y,x)>=0)return!1;for(var E=p.x,I=y.x,M=x.x,O=p.y,k=y.y,U=x.y,$=E<I?E<M?E:M:I<M?I:M,Q=O<k?O<U?O:U:k<U?k:U,at=E>I?E>M?E:M:I>M?I:M,wt=O>k?O>U?O:U:k>U?k:U,zt=Tc($,Q,e,s,c),Wt=Tc(at,wt,e,s,c),Ot=r.prevZ,Vt=r.nextZ;Ot&&Ot.z>=zt&&Vt&&Vt.z<=Wt;){if(Ot.x>=$&&Ot.x<=at&&Ot.y>=Q&&Ot.y<=wt&&Ot!==p&&Ot!==x&&ih(E,O,I,k,M,U,Ot.x,Ot.y)&&xs(Ot.prev,Ot,Ot.next)>=0||(Ot=Ot.prevZ,Vt.x>=$&&Vt.x<=at&&Vt.y>=Q&&Vt.y<=wt&&Vt!==p&&Vt!==x&&ih(E,O,I,k,M,U,Vt.x,Vt.y)&&xs(Vt.prev,Vt,Vt.next)>=0))return!1;Vt=Vt.nextZ}for(;Ot&&Ot.z>=zt;){if(Ot.x>=$&&Ot.x<=at&&Ot.y>=Q&&Ot.y<=wt&&Ot!==p&&Ot!==x&&ih(E,O,I,k,M,U,Ot.x,Ot.y)&&xs(Ot.prev,Ot,Ot.next)>=0)return!1;Ot=Ot.prevZ}for(;Vt&&Vt.z<=Wt;){if(Vt.x>=$&&Vt.x<=at&&Vt.y>=Q&&Vt.y<=wt&&Vt!==p&&Vt!==x&&ih(E,O,I,k,M,U,Vt.x,Vt.y)&&xs(Vt.prev,Vt,Vt.next)>=0)return!1;Vt=Vt.nextZ}return!0}function nh(r,e,s){var c=r;do{var p=c.prev,y=c.next.next;!rh(p,y)&&Fl(p,c,c.next,y)&&tf(p,y)&&tf(y,p)&&(e.push(p.i/s|0),e.push(c.i/s|0),e.push(y.i/s|0),Xu(c),Xu(c.next),c=r=y),c=c.next}while(c!==r);return Hi(c)}function Kh(r,e,s,c,p,y){var x=r;do{for(var E=x.next.next;E!==x.prev;){if(x.i!==E.i&&Ru(x,E)){var I=Jf(x,E);return x=Hi(x,x.next),I=Hi(I,I.next),ir(x,e,s,c,p,y,0),void ir(I,e,s,c,p,y,0)}E=E.next}x=x.next}while(x!==r)}function Dp(r,e){return r.x-e.x}function qc(r,e){var s=(function(p,y){var x,E=y,I=p.x,M=p.y,O=-1/0;do{if(M<=E.y&&M>=E.next.y&&E.next.y!==E.y){var k=E.x+(M-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(k<=I&&k>O&&(O=k,x=E.x<E.next.x?E:E.next,k===I))return x}E=E.next}while(E!==y);if(!x)return null;var U,$=x,Q=x.x,at=x.y,wt=1/0;E=x;do I>=E.x&&E.x>=Q&&I!==E.x&&ih(M<at?I:O,M,Q,at,M<at?O:I,M,E.x,E.y)&&(U=Math.abs(M-E.y)/(I-E.x),tf(E,p)&&(U<wt||U===wt&&(E.x>x.x||E.x===x.x&&So(x,E)))&&(x=E,wt=U)),E=E.next;while(E!==$);return x})(r,e);if(!s)return e;var c=Jf(s,r);return Hi(c,c.next),Hi(s,s.next)}function So(r,e){return xs(r.prev,r,e.prev)<0&&xs(e.next,r,r.next)<0}function Tc(r,e,s,c,p){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-s)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-c)*p|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ch(r){var e=r,s=r;do(e.x<s.x||e.x===s.x&&e.y<s.y)&&(s=e),e=e.next;while(e!==r);return s}function ih(r,e,s,c,p,y,x,E){return(p-x)*(e-E)>=(r-x)*(y-E)&&(r-x)*(c-E)>=(s-x)*(e-E)&&(s-x)*(y-E)>=(p-x)*(c-E)}function Ru(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!(function(s,c){var p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==c.i&&p.next.i!==c.i&&Fl(p,p.next,s,c))return!0;p=p.next}while(p!==s);return!1})(r,e)&&(tf(r,e)&&tf(e,r)&&(function(s,c){var p=s,y=!1,x=(s.x+c.x)/2,E=(s.y+c.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&x<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==s);return y})(r,e)&&(xs(r.prev,r,e.prev)||xs(r,e.prev,e))||rh(r,e)&&xs(r.prev,r,r.next)>0&&xs(e.prev,e,e.next)>0)}function xs(r,e,s){return(e.y-r.y)*(s.x-e.x)-(e.x-r.x)*(s.y-e.y)}function rh(r,e){return r.x===e.x&&r.y===e.y}function Fl(r,e,s,c){var p=Ih(xs(r,e,s)),y=Ih(xs(r,e,c)),x=Ih(xs(s,c,r)),E=Ih(xs(s,c,e));return p!==y&&x!==E||!(p!==0||!Qh(r,s,e))||!(y!==0||!Qh(r,c,e))||!(x!==0||!Qh(s,r,c))||!(E!==0||!Qh(s,e,c))}function Qh(r,e,s){return e.x<=Math.max(r.x,s.x)&&e.x>=Math.min(r.x,s.x)&&e.y<=Math.max(r.y,s.y)&&e.y>=Math.min(r.y,s.y)}function Ih(r){return r>0?1:r<0?-1:0}function tf(r,e){return xs(r.prev,r,r.next)<0?xs(r,e,r.next)>=0&&xs(r,r.prev,e)>=0:xs(r,e,r.prev)<0||xs(r,r.next,e)<0}function Jf(r,e){var s=new Uo(r.i,r.x,r.y),c=new Uo(e.i,e.x,e.y),p=r.next,y=e.prev;return r.next=e,e.prev=r,s.next=p,p.prev=s,c.next=s,s.prev=c,y.next=c,c.prev=y,c}function Kf(r,e,s,c){var p=new Uo(r,e,s);return c?(p.next=c.next,p.prev=c,c.next.prev=p,c.next=p):(p.prev=p,p.next=p),p}function Xu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Uo(r,e,s){this.i=r,this.x=e,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cc(r,e,s,c){for(var p=0,y=e,x=s-c;y<s;y+=c)p+=(r[x]-r[y])*(r[y+1]+r[x+1]),x=y;return p}function ef(r,e,s,c,p){Ic(r,e,s,c||r.length-1,p||Np)}function Ic(r,e,s,c,p){for(;c>s;){if(c-s>600){var y=c-s+1,x=e-s+1,E=Math.log(y),I=.5*Math.exp(2*E/3),M=.5*Math.sqrt(E*I*(y-I)/y)*(x-y/2<0?-1:1);Ic(r,e,Math.max(s,Math.floor(e-x*I/y+M)),Math.min(c,Math.floor(e+(y-x)*I/y+M)),p)}var O=r[e],k=s,U=c;for(Mh(r,s,e),p(r[c],O)>0&&Mh(r,s,c);k<U;){for(Mh(r,k,U),k++,U--;p(r[k],O)<0;)k++;for(;p(r[U],O)>0;)U--}p(r[s],O)===0?Mh(r,s,U):Mh(r,++U,c),U<=e&&(s=U+1),e<=U&&(c=U-1)}}function Mh(r,e,s){var c=r[e];r[e]=r[s],r[s]=c}function Np(r,e){return r<e?-1:r>e?1:0}function Ad(r,e){const s=r.length;if(s<=1)return[r];const c=[];let p,y;for(let x=0;x<s;x++){const E=Mn(r[x]);E!==0&&(r[x].area=Math.abs(E),y===void 0&&(y=E<0),y===E<0?(p&&c.push(p),p=[r[x]]):p.push(r[x]))}if(p&&c.push(p),e>1)for(let x=0;x<c.length;x++)c[x].length<=e||(ef(c[x],e,1,c[x].length-1,Qf),c[x]=c[x].slice(0,e));return c}function Qf(r,e){return e.area-r.area}function td(r,e,s){const c=s.patternDependencies;let p=!1;for(const y of e){const x=y.paint.get(`${r}-pattern`);x.isConstant()||(p=!0);const E=x.constantOr(null);E&&(p=!0,c[E.to]=!0,c[E.from]=!0)}return p}function kl(r,e,s,c,p){const y=p.patternDependencies;for(const x of e){const E=x.paint.get(`${r}-pattern`).value;if(E.kind!=="constant"){let I=E.evaluate({zoom:c-1},s,{},p.availableImages),M=E.evaluate({zoom:c},s,{},p.availableImages),O=E.evaluate({zoom:c+1},s,{},p.availableImages);I=I&&I.name?I.name:I,M=M&&M.name?M.name:M,O=O&&O.name?O.name:O,y[I]=!0,y[M]=!0,y[O]=!0,s.patterns[x.id]={min:I,mid:M,max:O}}}return s}$f.exports=Lr,$f.exports.default=Lr,Lr.deviation=function(r,e,s,c){var p=e&&e.length,y=Math.abs(Cc(r,0,p?e[0]*s:r.length,s));if(p)for(var x=0,E=e.length;x<E;x++)y-=Math.abs(Cc(r,e[x]*s,x<E-1?e[x+1]*s:r.length,s));var I=0;for(x=0;x<c.length;x+=3){var M=c[x]*s,O=c[x+1]*s,k=c[x+2]*s;I+=Math.abs((r[M]-r[k])*(r[O+1]-r[M+1])-(r[M]-r[O])*(r[k+1]-r[M+1]))}return y===0&&I===0?0:Math.abs((I-y)/y)},Lr.flatten=function(r){for(var e=r[0][0].length,s={vertices:[],holes:[],dimensions:e},c=0,p=0;p<r.length;p++){for(var y=0;y<r[p].length;y++)for(var x=0;x<e;x++)s.vertices.push(r[p][y][x]);p>0&&s.holes.push(c+=r[p-1].length)}return s};class ed{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new di,this.indexArray=new Bo,this.indexArray2=new gl,this.programConfigurations=new vh(e.layers,e.zoom),this.segments=new Qs,this.segments2=new Qs,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.projection=e.projection}populate(e,s,c,p){this.hasPattern=td("fill",this.layers,s);const y=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:E,id:I,index:M,sourceLayerIndex:O}of e){const k=this.layers[0]._featureFilter.needGeometry,U=$c(E,k);if(!this.layers[0]._featureFilter.filter(new Nt(this.zoom),U,c))continue;const $=y?y.evaluate(U,{},c,s.availableImages):void 0,Q={id:I,properties:E.properties,type:E.type,sourceLayerIndex:O,index:M,geometry:k?U.geometry:Iu(E,c,p),patterns:{},sortKey:$};x.push(Q)}y&&x.sort(((E,I)=>E.sortKey-I.sortKey));for(const E of x){const{geometry:I,index:M,sourceLayerIndex:O}=E;if(this.hasPattern){const k=kl("fill",this.layers,E,this.zoom,s);this.patternFeatures.push(k)}else this.addFeature(E,I,M,c,{},s.availableImages);s.featureIndex.insert(e[M].feature,I,M,O,this.index)}}update(e,s,c,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c,p)}addFeatures(e,s,c,p,y){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,c,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,s,c,p,y,x=[]){for(const E of Ad(s,500)){let I=0;for(const Q of E)I+=Q.length;const M=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),O=M.vertexLength,k=[],U=[];for(const Q of E){if(Q.length===0)continue;Q!==E[0]&&U.push(k.length/2);const at=this.segments2.prepareSegment(Q.length,this.layoutVertexArray,this.indexArray2),wt=at.vertexLength;this.layoutVertexArray.emplaceBack(Q[0].x,Q[0].y),this.indexArray2.emplaceBack(wt+Q.length-1,wt),k.push(Q[0].x),k.push(Q[0].y);for(let zt=1;zt<Q.length;zt++)this.layoutVertexArray.emplaceBack(Q[zt].x,Q[zt].y),this.indexArray2.emplaceBack(wt+zt-1,wt+zt),k.push(Q[zt].x),k.push(Q[zt].y);at.vertexLength+=Q.length,at.primitiveLength+=Q.length}const $=$f.exports(k,U);for(let Q=0;Q<$.length;Q+=3)this.indexArray.emplaceBack(O+$[Q],O+$[Q+1],O+$[Q+2]);M.vertexLength+=I,M.primitiveLength+=$.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,y,x,p)}}dn(ed,"FillBucket",{omit:["layers","patternFeatures"]});const ru=new Xe({"fill-sort-key":new Qt(_e.layout_fill["fill-sort-key"])});var Pg={paint:new Xe({"fill-antialias":new ge(_e.paint_fill["fill-antialias"]),"fill-opacity":new Qt(_e.paint_fill["fill-opacity"]),"fill-color":new Qt(_e.paint_fill["fill-color"]),"fill-outline-color":new Qt(_e.paint_fill["fill-outline-color"]),"fill-translate":new ge(_e.paint_fill["fill-translate"]),"fill-translate-anchor":new ge(_e.paint_fill["fill-translate-anchor"]),"fill-pattern":new fn(_e.paint_fill["fill-pattern"])}),layout:ru};const Bg=tn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Xm=tn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),sh=tn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Ld}=Bg;var nf={},rf=Dt,Op=Ah;function Ah(r,e,s,c,p){this.properties={},this.extent=s,this.type=0,this._pbf=r,this._geometry=-1,this._keys=c,this._values=p,r.readFields(Fg,this,e)}function Fg(r,e,s){r==1?e.id=s.readVarint():r==2?(function(c,p){for(var y=c.readVarint()+c.pos;c.pos<y;){var x=p._keys[c.readVarint()],E=p._values[c.readVarint()];p.properties[x]=E}})(s,e):r==3?e.type=s.readVarint():r==4&&(e._geometry=s.pos)}function kg(r){for(var e,s,c=0,p=0,y=r.length,x=y-1;p<y;x=p++)c+=((s=r[x]).x-(e=r[p]).x)*(e.y+s.y);return c}Ah.types=["Unknown","Point","LineString","Polygon"],Ah.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,s=r.readVarint()+r.pos,c=1,p=0,y=0,x=0,E=[];r.pos<s;){if(p<=0){var I=r.readVarint();c=7&I,p=I>>3}if(p--,c===1||c===2)y+=r.readSVarint(),x+=r.readSVarint(),c===1&&(e&&E.push(e),e=[]),e.push(new rf(y,x));else{if(c!==7)throw new Error("unknown command "+c);e&&e.push(e[0].clone())}}return e&&E.push(e),E},Ah.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,s=1,c=0,p=0,y=0,x=1/0,E=-1/0,I=1/0,M=-1/0;r.pos<e;){if(c<=0){var O=r.readVarint();s=7&O,c=O>>3}if(c--,s===1||s===2)(p+=r.readSVarint())<x&&(x=p),p>E&&(E=p),(y+=r.readSVarint())<I&&(I=y),y>M&&(M=y);else if(s!==7)throw new Error("unknown command "+s)}return[x,I,E,M]},Ah.prototype.toGeoJSON=function(r,e,s){var c,p,y=this.extent*Math.pow(2,s),x=this.extent*r,E=this.extent*e,I=this.loadGeometry(),M=Ah.types[this.type];function O($){for(var Q=0;Q<$.length;Q++){var at=$[Q];$[Q]=[360*(at.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(at.y+E)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(c=0;c<I.length;c++)k[c]=I[c][0];O(I=k);break;case 2:for(c=0;c<I.length;c++)O(I[c]);break;case 3:for(I=(function($){var Q=$.length;if(Q<=1)return[$];for(var at,wt,zt=[],Wt=0;Wt<Q;Wt++){var Ot=kg($[Wt]);Ot!==0&&(wt===void 0&&(wt=Ot<0),wt===Ot<0?(at&&zt.push(at),at=[$[Wt]]):at.push($[Wt]))}return at&&zt.push(at),zt})(I),c=0;c<I.length;c++)for(p=0;p<I[c].length;p++)O(I[c][p])}I.length===1?I=I[0]:M="Multi"+M;var U={type:"Feature",geometry:{type:M,coordinates:I},properties:this.properties};return"id"in this&&(U.id=this.id),U};var Rd=Op,Dd=Ug;function Ug(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Zm,this,e),this.length=this._features.length}function Zm(r,e,s){r===15?e.version=s.readVarint():r===1?e.name=s.readString():r===5?e.extent=s.readVarint():r===2?e._features.push(s.pos):r===3?e._keys.push(s.readString()):r===4&&e._values.push((function(c){for(var p=null,y=c.readVarint()+c.pos;c.pos<y;){var x=c.readVarint()>>3;p=x===1?c.readString():x===2?c.readFloat():x===3?c.readDouble():x===4?c.readVarint64():x===5?c.readVarint():x===6?c.readSVarint():x===7?c.readBoolean():null}return p})(s))}Ug.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new Rd(this._pbf,e,this.extent,this._keys,this._values)};var Hm=Dd;function Gg(r,e,s){if(r===3){var c=new Hm(s,s.readVarint()+s.pos);c.length&&(e[c.name]=c)}}var Nd=nf.VectorTile=function(r,e){this.layers=r.readFields(Gg,{},e)},jc=nf.VectorTileFeature=Op;function Lh(r,e,s,c){const p=[],y=c===0?(x,E,I,M,O,k)=>{x.push(new Dt(k,I+(k-E)/(M-E)*(O-I)))}:(x,E,I,M,O,k)=>{x.push(new Dt(E+(k-I)/(O-I)*(M-E),k))};for(const x of r){const E=[];for(const I of x){if(I.length<=2)continue;const M=[];for(let U=0;U<I.length-1;U++){const $=I[U].x,Q=I[U].y,at=I[U+1].x,wt=I[U+1].y,zt=c===0?$:Q,Wt=c===0?at:wt;zt<e?Wt>e&&y(M,$,Q,at,wt,e):zt>s?Wt<s&&y(M,$,Q,at,wt,s):M.push(I[U]),Wt<e&&zt>=e&&y(M,$,Q,at,wt,e),Wt>s&&zt<=s&&y(M,$,Q,at,wt,s)}let O=I[I.length-1];const k=c===0?O.x:O.y;k>=e&&k<=s&&M.push(O),M.length&&(O=M[M.length-1],M[0].x===O.x&&M[0].y===O.y||M.push(M[0]),E.push(M))}E.length&&p.push(E)}return p}nf.VectorTileLayer=Dd;const Vg=jc.types,qg=Math.pow(2,13);function sf(r,e,s,c,p,y,x,E){r.emplaceBack((e<<1)+x,(s<<1)+y,(Math.floor(c*qg)<<1)+p,Math.round(E))}function of(r,e,s){r.emplaceBack(e.x,e.y,e.z,s[0]*16384,s[1]*16384,s[2]*16384)}class zp{constructor(){this.acc=new Dt(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Dt(e.x,e.y),this.max=new Dt(e.x,e.y))}append(e,s){this.currentPolyCount.edges++,this.acc._add(e);const c=this.min,p=this.max;e.x<c.x?c.x=e.x:e.x>p.x&&(p.x=e.x),e.y<c.y?c.y=e.y:e.y>p.y&&(p.y=e.y),((e.x===0||e.x===ai)&&e.x===s.x)!=((e.y===0||e.y===ai)&&e.y===s.y)&&this.processBorderOverlap(e,s),s.x<0!=e.x<0&&this.addBorderIntersection(0,Ii(s.y,e.y,(0-s.x)/(e.x-s.x))),s.x>ai!=e.x>ai&&this.addBorderIntersection(1,Ii(s.y,e.y,(ai-s.x)/(e.x-s.x))),s.y<0!=e.y<0&&this.addBorderIntersection(2,Ii(s.x,e.x,(0-s.y)/(e.y-s.y))),s.y>ai!=e.y>ai&&this.addBorderIntersection(3,Ii(s.x,e.x,(ai-s.y)/(e.y-s.y)))}addBorderIntersection(e,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[e];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(e,s){if(e.x===s.x){if(e.y===s.y)return;const c=e.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,e.y)}else{const c=e.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,e.x)}}centroid(){const e=this.polyCount.reduce(((s,c)=>s+c.edges),0);return e!==0?this.acc.div(e)._round():new Dt(0,0)}span(){return new Dt(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((e,s)=>e+ +(s[0]!==Number.MAX_VALUE)),0)}}class af{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new pi,this.centroidVertexArray=new ci,this.indexArray=new Bo,this.programConfigurations=new vh(e.layers,e.zoom),this.segments=new Qs,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.enableTerrain=e.enableTerrain}populate(e,s,c,p){this.features=[],this.hasPattern=td("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=(function(y){const x=Math.exp(Math.PI*(1-y.y/(1<<y.z)*2));return 80150034*x/(x*x+1)/ai/(1<<y.z)})(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:y,id:x,index:E,sourceLayerIndex:I}of e){const M=this.layers[0]._featureFilter.needGeometry,O=$c(y,M);if(!this.layers[0]._featureFilter.filter(new Nt(this.zoom),O,c))continue;const k={id:x,sourceLayerIndex:I,index:E,geometry:M?O.geometry:Iu(y,c,p),properties:y.properties,type:y.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(kl("fill-extrusion",this.layers,k,this.zoom,s)):this.addFeature(k,k.geometry,E,c,{},s.availableImages,p),s.featureIndex.insert(y,k.geometry,E,I,this.index,U)}this.sortBorders()}addFeatures(e,s,c,p,y){for(const x of this.features){const{geometry:E}=x;this.addFeature(x,E,x.index,s,c,p,y)}this.sortBorders()}update(e,s,c,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ld),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,sh.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Xm.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,s,c,p,y,x,E){const I=[new Dt(0,0),new Dt(ai,ai)],M=E.projection,O=M.name==="globe",k=this.enableTerrain&&!O?new zp:null,U=Vg[e.type]==="Polygon";O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new d);const $=Ad(s,500);for(let zt=$.length-1;zt>=0;zt--){const Wt=$[zt];(Wt.length===0||(Q=Wt[0]).every((Ot=>Ot.x<=0))||Q.every((Ot=>Ot.x>=ai))||Q.every((Ot=>Ot.y<=0))||Q.every((Ot=>Ot.y>=ai)))&&$.splice(zt,1)}var Q;let at;if(O)at=Zg($,I,p);else{at=[];for(const zt of $)at.push({polygon:zt,bounds:I})}const wt=U?this.edgeRadius:0;for(const{polygon:zt,bounds:Wt}of at){let Ot=0,Vt=0;for(const qt of zt)U&&!qt[0].equals(qt[qt.length-1])&&qt.push(qt[0]),Vt+=U?qt.length-1:qt.length;const ne=this.segments.prepareSegment((U?5:4)*Vt,this.layoutVertexArray,this.indexArray);if(U){const qt=[],Me=[];Ot=ne.vertexLength;for(const Ge of zt){let cn,Ne;Ge.length&&Ge!==zt[0]&&Me.push(qt.length/2),cn=Ge[1].sub(Ge[0])._perp()._unit();for(let Ze=1;Ze<Ge.length;Ze++){const Ye=Ge[Ze],on=Ge[Ze===Ge.length-1?1:Ze+1];let{x:hn,y:Oe}=Ye;if(wt){Ne=on.sub(Ye)._perp()._unit();const En=cn.add(Ne)._unit(),si=wt*Math.min(4,1/(cn.x*En.x+cn.y*En.y));hn+=si*En.x,Oe+=si*En.y,cn=Ne}sf(this.layoutVertexArray,hn,Oe,0,0,1,1,0),ne.vertexLength++,qt.push(Ye.x,Ye.y),O&&of(this.layoutVertexExtArray,M.projectTilePoint(hn,Oe,p),M.upVector(p,hn,Oe))}}const Ie=$f.exports(qt,Me);for(let Ge=0;Ge<Ie.length;Ge+=3)this.indexArray.emplaceBack(Ot+Ie[Ge],Ot+Ie[Ge+2],Ot+Ie[Ge+1]),ne.primitiveLength++}for(const qt of zt){k&&qt.length&&k.startRing(qt[0]);let Me,Ie,Ge,cn=qt.length>4&&Od(qt[qt.length-2],qt[0],qt[1]),Ne=wt?jg(qt[qt.length-2],qt[0],qt[1],wt):0;Ie=qt[1].sub(qt[0])._perp()._unit();let Ze=!0;for(let Ye=1,on=0;Ye<qt.length;Ye++){let hn=qt[Ye-1],Oe=qt[Ye];const En=qt[Ye===qt.length-1?1:Ye+1];if(k&&U&&k.currentPolyCount.top++,rs(Oe,hn,Wt)){wt&&(Ie=En.sub(Oe)._perp()._unit(),Ze=!Ze);continue}k&&k.append(Oe,hn);const si=Oe.sub(hn)._perp(),Ln=si.x/(Math.abs(si.x)+Math.abs(si.y)),qn=si.y>0?1:0,Cn=hn.dist(Oe);if(on+Cn>32768&&(on=0),wt){Ge=En.sub(Oe)._perp()._unit();let pr=Pp(hn,Oe,En,nd(Ie,Ge),wt);isNaN(pr)&&(pr=0);const bi=Oe.sub(hn)._unit();hn=hn.add(bi.mult(Ne))._round(),Oe=Oe.add(bi.mult(-pr))._round(),Ne=pr,Ie=Ge}const li=ne.vertexLength,Ti=qt.length>4&&Od(hn,Oe,En);let Li=Xg(on,cn,Ze);if(sf(this.layoutVertexArray,hn.x,hn.y,Ln,qn,0,0,Li),sf(this.layoutVertexArray,hn.x,hn.y,Ln,qn,0,1,Li),on+=Cn,Li=Xg(on,Ti,!Ze),cn=Ti,sf(this.layoutVertexArray,Oe.x,Oe.y,Ln,qn,0,0,Li),sf(this.layoutVertexArray,Oe.x,Oe.y,Ln,qn,0,1,Li),ne.vertexLength+=4,this.indexArray.emplaceBack(li+0,li+1,li+2),this.indexArray.emplaceBack(li+1,li+3,li+2),ne.primitiveLength+=2,wt){const pr=Ot+(Ye===1?qt.length-2:Ye-2),bi=Ye===1?Ot:pr+1;if(this.indexArray.emplaceBack(li+1,pr,li+3),this.indexArray.emplaceBack(pr,bi,li+3),ne.primitiveLength+=2,Me===void 0&&(Me=li),!rs(En,qt[Ye],Wt)){const Ms=Ye===qt.length-1?Me:ne.vertexLength;this.indexArray.emplaceBack(li+2,li+3,Ms),this.indexArray.emplaceBack(li+3,Ms+1,Ms),this.indexArray.emplaceBack(li+3,bi,Ms+1),ne.primitiveLength+=3}Ze=!Ze}if(O){const pr=this.layoutVertexExtArray,bi=M.projectTilePoint(hn.x,hn.y,p),Ms=M.projectTilePoint(Oe.x,Oe.y,p),Fi=M.upVector(p,hn.x,hn.y),$i=M.upVector(p,Oe.x,Oe.y);of(pr,bi,Fi),of(pr,bi,Fi),of(pr,Ms,$i),of(pr,Ms,$i)}}U&&(Ot+=qt.length-1)}}if(k&&k.polyCount.length>0){if(k.borders){k.vertexArrayOffset=this.centroidVertexArray.length;const zt=k.borders,Wt=this.featuresOnBorder.push(k)-1;for(let Ot=0;Ot<4;Ot++)zt[Ot][0]!==Number.MAX_VALUE&&this.borders[Ot].push(Wt)}this.encodeCentroid(k.borders?void 0:k.centroid(),k)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,y,x,p)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort(((s,c)=>this.featuresOnBorder[s].borders[e][0]-this.featuresOnBorder[c].borders[e][0]))}encodeCentroid(e,s,c=!0){let p,y;if(e)if(e.y!==0){const E=s.span()._mult(this.tileToMeter);p=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(E.x/10)),y=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else p=Math.ceil(7*(e.x+450)),y=0;else p=0,y=+c;let x=c?this.centroidVertexArray.length:s.vertexArrayOffset;for(const E of s.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let I=0;I<E.top;I++)this.centroidVertexArray.emplace(x++,p,y);for(let I=0;I<2*E.edges;I++)this.centroidVertexArray.emplace(x++,0,y),this.centroidVertexArray.emplace(x++,p,y)}}}function nd(r,e){const s=r.add(e)._unit();return r.x*s.x+r.y*s.y}function jg(r,e,s,c){const p=e.sub(r)._perp()._unit(),y=s.sub(e)._perp()._unit();return Pp(r,e,s,nd(p,y),c)}function Pp(r,e,s,c,p){const y=Math.sqrt(1-c*c);return Math.min(r.dist(e)/3,e.dist(s)/3,p*y/c)}function rs(r,e,s){return r.x<s[0].x&&e.x<s[0].x||r.x>s[1].x&&e.x>s[1].x||r.y<s[0].y&&e.y<s[0].y||r.y>s[1].y&&e.y>s[1].y}function Od(r,e,s){if(r.x<0||r.x>=ai||e.x<0||e.x>=ai||s.x<0||s.x>=ai)return!1;const c=s.sub(e),p=c.perp(),y=r.sub(e);return(c.x*y.x+c.y*y.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(y.x*y.x+y.y*y.y))>-.866&&p.x*y.x+p.y*y.y<0}function Xg(r,e,s){const c=e?2|r:-3&r;return s?1|c:-2&c}function Bp(){const r=Math.PI/32,e=Math.tan(r),s=jh;return s*Math.sqrt(1+2*e*e)-s}function Zg(r,e,s){const c=1<<s.z,p=ml(s.x/c),y=ml((s.x+1)/c),x=fa(s.y/c),E=fa((s.y+1)/c);return(function(I,M,O,k,U=0,$){const Q=[];if(!I.length||!O||!k)return Q;const at=(qt,Me)=>{for(const Ie of qt)Q.push({polygon:Ie,bounds:Me})},wt=Math.ceil(Math.log2(O)),zt=Math.ceil(Math.log2(k)),Wt=wt-zt,Ot=[];for(let qt=0;qt<Math.abs(Wt);qt++)Ot.push(Wt>0?0:1);for(let qt=0;qt<Math.min(wt,zt);qt++)Ot.push(0),Ot.push(1);let Vt=I;if(Vt=Lh(Vt,M[0].y-U,M[1].y+U,1),Vt=Lh(Vt,M[0].x-U,M[1].x+U,0),!Vt.length)return Q;const ne=[];for(Ot.length?ne.push({polygons:Vt,bounds:M,depth:0}):at(Vt,M);ne.length;){const qt=ne.pop(),Me=qt.depth,Ie=Ot[Me],Ge=qt.bounds[0],cn=qt.bounds[1],Ne=Ie===0?Ge.x:Ge.y,Ze=Ie===0?cn.x:cn.y,Ye=$?$(Ie,Ne,Ze):.5*(Ne+Ze),on=Lh(qt.polygons,Ne-U,Ye+U,Ie),hn=Lh(qt.polygons,Ye-U,Ze+U,Ie);if(on.length){const Oe=[Ge,new Dt(Ie===0?Ye:cn.x,Ie===1?Ye:cn.y)];Ot.length>Me+1?ne.push({polygons:on,bounds:Oe,depth:Me+1}):at(on,Oe)}if(hn.length){const Oe=[new Dt(Ie===0?Ye:Ge.x,Ie===1?Ye:Ge.y),cn];Ot.length>Me+1?ne.push({polygons:hn,bounds:Oe,depth:Me+1}):at(hn,Oe)}}return Q})(r,e,Math.ceil((y-p)/11.25),Math.ceil((x-E)/11.25),1,((I,M,O)=>{if(I===0)return .5*(M+O);{const k=fa((s.y+M/ai)/c);return(sc(.5*(fa((s.y+O/ai)/c)+k))*c-s.y)*ai}}))}dn(af,"FillExtrusionBucket",{omit:["layers","features"]}),dn(zp,"PartMetadata");const Ym=new Xe({"fill-extrusion-edge-radius":new ge(_e["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Wm={paint:new Xe({"fill-extrusion-opacity":new ge(_e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qt(_e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ge(_e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ge(_e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fn(_e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qt(_e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qt(_e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ge(_e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ge(_e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ge(_e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:Ym};function id(r,e,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[r*c-2*Math.PI*6378137/2,e*c-2*Math.PI*6378137/2]}class Xc{constructor(e,s,c){this.z=e,this.x=s,this.y=c,this.key=Rh(0,e,e,s,c)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,s){const c=(function(y,x,E){var I=id(256*y,256*(x=Math.pow(2,E)-x-1),E),M=id(256*(y+1),256*(x+1),E);return I[0]+","+I[1]+","+M[0]+","+M[1]})(this.x,this.y,this.z),p=(function(y,x,E){let I,M="";for(let O=y;O>0;O--)I=1<<O-1,M+=(x&I?1:0)+(E&I?2:0);return M})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zd{constructor(e,s){this.wrap=e,this.canonical=s,this.key=Rh(e,s.z,s.z,s.x,s.y)}}class pa{constructor(e,s,c,p,y){this.overscaledZ=e,this.wrap=s,this.canonical=new Xc(c,+p,+y),this.key=s===0&&e===c?this.canonical.key:Rh(s,e,c,p,y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const s=this.canonical.z-e;return e>this.canonical.z?new pa(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pa(e,this.wrap,e,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(e,s=!0){if(this.overscaledZ===e&&s)return this.key;if(e>this.canonical.z)return Rh(this.wrap*+s,e,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-e;return Rh(this.wrap*+s,e,e,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const s=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>s&&e.canonical.y===this.canonical.y>>s}children(e){if(this.overscaledZ>=e)return[new pa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,p=2*this.canonical.y;return[new pa(s,this.wrap,s,c,p),new pa(s,this.wrap,s,c+1,p),new pa(s,this.wrap,s,c,p+1),new pa(s,this.wrap,s,c+1,p+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new pa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new pa(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Rh(r,e,s,c,p){const y=1<<Math.min(s,22);let x=y*(p%y)+c%y;return r&&s<22&&(x+=y*y*((r<0?-2*r-1:2*r)%(1<<2*(22-s)))),16*(32*x+s)+(e-s)}dn(Xc,"CanonicalTileID"),dn(pa,"OverscaledTileID",{omit:["projMatrix"]});class Du extends Dt{constructor(e,s,c){super(e,s),this.z=c}}function su(r,e){return r.x*e.x+r.y*e.y}function lf(r,e){if(r.length===1){let s=0;const c=e[s++];let p;for(;!p||c.equals(p);)if(p=e[s++],!p)return 1/0;for(;s<e.length;s++){const y=e[s],x=r[0],E=p.sub(c),I=y.sub(c),M=x.sub(c),O=su(E,E),k=su(E,I),U=su(I,I),$=su(M,E),Q=su(M,I),at=O*U-k*k,wt=(U*$-k*Q)/at,zt=(O*Q-k*$)/at,Wt=c.z*(1-wt-zt)+p.z*wt+y.z*zt;if(isFinite(Wt))return Wt}return 1/0}{let s=1/0;for(const c of e)s=Math.min(s,c.z);return s}}function Hg(r,e,s,c,p,y,x,E){const I=x*p.getElevationAt(r,e,!0,!0),M=y[0]!==0,O=M?y[1]===0?x*(y[0]/7-450):x*(function(k,U,$){const Q=Math.floor(U[0]/8),at=Math.floor(U[1]/8),wt=10*(U[0]-8*Q),zt=10*(U[1]-8*at),Wt=k.getElevationAt(Q,at,!0,!0),Ot=k.getMeterToDEM($),Vt=Math.floor(.5*(wt*Ot-1)),ne=Math.floor(.5*(zt*Ot-1)),qt=k.tileCoordToPixel(Q,at),Me=2*Vt+1,Ie=2*ne+1,Ge=(function(hn,Oe,En,si,Ln){return[hn.getElevationAtPixel(Oe,En,!0),hn.getElevationAtPixel(Oe+Ln,En,!0),hn.getElevationAtPixel(Oe,En+Ln,!0),hn.getElevationAtPixel(Oe+si,En+Ln,!0)]})(k,qt.x-Vt,qt.y-ne,Me,Ie),cn=Math.abs(Ge[0]-Ge[1]),Ne=Math.abs(Ge[2]-Ge[3]),Ze=Math.abs(Ge[0]-Ge[2])+Math.abs(Ge[1]-Ge[3]),Ye=Math.min(.25,.5*Ot*(cn+Ne)/Me),on=Math.min(.25,.5*Ot*Ze/Ie);return Wt+Math.max(Ye*wt,on*zt)})(p,y,E):I;return{base:I+(s===0)?-1:s,top:M?Math.max(O+c,I+s+2):I+c}}const Yg=tn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Wg}=Yg,$g=tn([{name:"a_packed",components:4,type:"Float32"}]),{members:Jg}=$g,$m=jc.types,Fp=Math.cos(Math.PI/180*37.5);class rd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((s=>{this.gradients[s.id]={}})),this.layoutVertexArray=new ar,this.layoutVertexArray2=new Xs,this.indexArray=new Bo,this.programConfigurations=new vh(e.layers,e.zoom),this.segments=new Qs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(e,s,c,p){this.hasPattern=td("line",this.layers,s);const y=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:O,id:k,index:U,sourceLayerIndex:$}of e){const Q=this.layers[0]._featureFilter.needGeometry,at=$c(O,Q);if(!this.layers[0]._featureFilter.filter(new Nt(this.zoom),at,c))continue;const wt=y?y.evaluate(at,{},c):void 0,zt={id:k,properties:O.properties,type:O.type,sourceLayerIndex:$,index:U,geometry:Q?at.geometry:Iu(O,c,p),patterns:{},sortKey:wt};x.push(zt)}y&&x.sort(((O,k)=>O.sortKey-k.sortKey));const{lineAtlas:E,featureIndex:I}=s,M=this.addConstantDashes(E);for(const O of x){const{geometry:k,index:U,sourceLayerIndex:$}=O;if(M&&this.addFeatureDashes(O,E),this.hasPattern){const Q=kl("line",this.layers,O,this.zoom,s);this.patternFeatures.push(Q)}else this.addFeature(O,k,U,c,E.positions,s.availableImages);I.insert(e[U].feature,k,U,$,this.index)}}addConstantDashes(e){let s=!1;for(const c of this.layers){const p=c.paint.get("line-dasharray").value,y=c.layout.get("line-cap").value;if(p.kind!=="constant"||y.kind!=="constant")s=!0;else{const x=y.value,E=p.value;if(!E)continue;e.addDash(E.from,x),e.addDash(E.to,x),E.other&&e.addDash(E.other,x)}}return s}addFeatureDashes(e,s){const c=this.zoom;for(const p of this.layers){const y=p.paint.get("line-dasharray").value,x=p.layout.get("line-cap").value;if(y.kind==="constant"&&x.kind==="constant")continue;let E,I,M,O,k,U;if(y.kind==="constant"){const wt=y.value;if(!wt)continue;E=wt.other||wt.to,I=wt.to,M=wt.from}else E=y.evaluate({zoom:c-1},e),I=y.evaluate({zoom:c},e),M=y.evaluate({zoom:c+1},e);x.kind==="constant"?O=k=U=x.value:(O=x.evaluate({zoom:c-1},e),k=x.evaluate({zoom:c},e),U=x.evaluate({zoom:c+1},e)),s.addDash(E,O),s.addDash(I,k),s.addDash(M,U);const $=s.getKey(E,O),Q=s.getKey(I,k),at=s.getKey(M,U);e.patterns[p.id]={min:$,mid:Q,max:at}}}update(e,s,c,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c,p)}addFeatures(e,s,c,p,y){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,c,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Jg)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Wg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,s,c,p,y,x){const E=this.layers[0].layout,I=E.get("line-join").evaluate(e,{}),M=E.get("line-cap").evaluate(e,{}),O=E.get("line-miter-limit"),k=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const U of s)this.addLine(U,e,I,M,O,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,y,x,p)}addLine(e,s,c,p,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let zt=0;zt<e.length-1;zt++)this.totalDistance+=e[zt].dist(e[zt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=$m[s.type]==="Polygon";let I=e.length;for(;I>=2&&e[I-1].equals(e[I-2]);)I--;let M=0;for(;M<I-1&&e[M].equals(e[M+1]);)M++;if(I<(E?3:2))return;c==="bevel"&&(y=1.05);const O=this.overscaling<=16?122880/(512*this.overscaling):0,k=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let U,$,Q,at,wt;this.e1=this.e2=-1,E&&(U=e[I-2],wt=e[M].sub(U)._unit()._perp());for(let zt=M;zt<I;zt++){if(Q=zt===I-1?E?e[M+1]:void 0:e[zt+1],Q&&e[zt].equals(Q))continue;wt&&(at=wt),U&&($=U),U=e[zt],wt=Q?Q.sub(U)._unit()._perp():at,at=at||wt;let Wt=at.add(wt);Wt.x===0&&Wt.y===0||Wt._unit();const Ot=at.x*wt.x+at.y*wt.y,Vt=Wt.x*wt.x+Wt.y*wt.y,ne=Vt!==0?1/Vt:1/0,qt=2*Math.sqrt(2-2*Vt),Me=Vt<Fp&&$&&Q,Ie=at.x*wt.y-at.y*wt.x>0;if(Me&&zt>M){const Ne=U.dist($);if(Ne>2*O){const Ze=U.sub(U.sub($)._mult(O/Ne)._round());this.updateDistance($,Ze),this.addCurrentVertex(Ze,at,0,0,k),$=Ze}}const Ge=$&&Q;let cn=Ge?c:E?"butt":p;if(Ge&&cn==="round"&&(ne<x?cn="miter":ne<=2&&(cn="fakeround")),cn==="miter"&&ne>y&&(cn="bevel"),cn==="bevel"&&(ne>2&&(cn="flipbevel"),ne<y&&(cn="miter")),$&&this.updateDistance($,U),cn==="miter")Wt._mult(ne),this.addCurrentVertex(U,Wt,0,0,k);else if(cn==="flipbevel"){if(ne>100)Wt=wt.mult(-1);else{const Ne=ne*at.add(wt).mag()/at.sub(wt).mag();Wt._perp()._mult(Ne*(Ie?-1:1))}this.addCurrentVertex(U,Wt,0,0,k),this.addCurrentVertex(U,Wt.mult(-1),0,0,k)}else if(cn==="bevel"||cn==="fakeround"){const Ne=-Math.sqrt(ne*ne-1),Ze=Ie?Ne:0,Ye=Ie?0:Ne;if($&&this.addCurrentVertex(U,at,Ze,Ye,k),cn==="fakeround"){const on=Math.round(180*qt/Math.PI/20);for(let hn=1;hn<on;hn++){let Oe=hn/on;if(Oe!==.5){const si=Oe-.5;Oe+=Oe*si*(Oe-1)*((1.0904+Ot*(Ot*(3.55645-1.43519*Ot)-3.2452))*si*si+(.848013+Ot*(.215638*Ot-1.06021)))}const En=wt.sub(at)._mult(Oe)._add(at)._unit()._mult(Ie?-1:1);this.addHalfVertex(U,En.x,En.y,!1,Ie,0,k)}}Q&&this.addCurrentVertex(U,wt,-Ze,-Ye,k)}else if(cn==="butt")this.addCurrentVertex(U,Wt,0,0,k);else if(cn==="square"){const Ne=$?1:-1;$||this.addCurrentVertex(U,Wt,Ne,Ne,k),this.addCurrentVertex(U,Wt,0,0,k),$&&this.addCurrentVertex(U,Wt,Ne,Ne,k)}else cn==="round"&&($&&(this.addCurrentVertex(U,at,0,0,k),this.addCurrentVertex(U,at,1,1,k,!0)),Q&&(this.addCurrentVertex(U,wt,-1,-1,k,!0),this.addCurrentVertex(U,wt,0,0,k)));if(Me&&zt<I-1){const Ne=U.dist(Q);if(Ne>2*O){const Ze=U.add(Q.sub(U)._mult(O/Ne)._round());this.updateDistance(U,Ze),this.addCurrentVertex(Ze,wt,0,0,k),U=Ze}}}}addCurrentVertex(e,s,c,p,y,x=!1){const E=s.y*p-s.x,I=-s.y-s.x*p;this.addHalfVertex(e,s.x+s.y*c,s.y-s.x*c,x,!1,c,y),this.addHalfVertex(e,E,I,x,!0,-p,y)}addHalfVertex({x:e,y:s},c,p,y,x,E,I){this.layoutVertexArray.emplaceBack((e<<1)+(y?1:0),(s<<1)+(x?1:0),Math.round(63*c)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),I.primitiveLength++),x?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,s){this.distance+=e.dist(s),this.updateScaledDistance()}}dn(rd,"LineBucket",{omit:["layers","patternFeatures"]});const Kg=new Xe({"line-cap":new Qt(_e.layout_line["line-cap"]),"line-join":new Qt(_e.layout_line["line-join"]),"line-miter-limit":new ge(_e.layout_line["line-miter-limit"]),"line-round-limit":new ge(_e.layout_line["line-round-limit"]),"line-sort-key":new Qt(_e.layout_line["line-sort-key"])});var Qg={paint:new Xe({"line-opacity":new Qt(_e.paint_line["line-opacity"]),"line-color":new Qt(_e.paint_line["line-color"]),"line-translate":new ge(_e.paint_line["line-translate"]),"line-translate-anchor":new ge(_e.paint_line["line-translate-anchor"]),"line-width":new Qt(_e.paint_line["line-width"]),"line-gap-width":new Qt(_e.paint_line["line-gap-width"]),"line-offset":new Qt(_e.paint_line["line-offset"]),"line-blur":new Qt(_e.paint_line["line-blur"]),"line-dasharray":new fn(_e.paint_line["line-dasharray"]),"line-pattern":new fn(_e.paint_line["line-pattern"]),"line-gradient":new Fe(_e.paint_line["line-gradient"]),"line-trim-offset":new ge(_e.paint_line["line-trim-offset"])}),layout:Kg};const Pd=new class extends Qt{possiblyEvaluate(r,e){return e=new Nt(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,s,c){return e=mt({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,s,c)}}(Qg.paint.properties["line-width"].specification);function Bd(r,e){return e>0?e+2*r:r}Pd.useIntegerZoom=!0;const Jm=tn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Km=tn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),sd=tn([{name:"a_projected_pos",components:4,type:"Float32"}],4);tn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Qm=tn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),tm=tn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);tn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const dr=tn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),kp=tn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);tn([{name:"triangle",components:3,type:"Uint16"}]),tn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),tn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),tn([{type:"Float32",name:"offsetX"}]),tn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Go=24;const Zu=128;function Fd(r,e){const{expression:s}=e;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Nt(r+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:p}=s;let y=0;for(;y<c.length&&c[y]<=r;)y++;y=Math.max(0,y-1);let x=y;for(;x<c.length&&c[x]<r+1;)x++;x=Math.min(c.length-1,x);const E=c[y],I=c[x];return s.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:I,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:I,minSize:s.evaluate(new Nt(E)),maxSize:s.evaluate(new Nt(I)),interpolationType:p}}}function uf(r,{uSize:e,uSizeT:s},{lowerSize:c,upperSize:p}){return r.kind==="source"?c/Zu:r.kind==="composite"?Ii(c/Zu,p/Zu,s):e}function Mc(r,e){let s=0,c=0;if(r.kind==="constant")c=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:p,minZoom:y,maxZoom:x}=r,E=p?ct(De.interpolationFactor(p,e,y,x),0,1):0;r.kind==="camera"?c=Ii(r.minSize,r.maxSize,E):s=E}return{uSizeT:s,uSize:c}}var kd=Object.freeze({__proto__:null,getSizeData:Fd,evaluateSizeForFeature:uf,evaluateSizeForZoom:Mc,SIZE_PACK_FACTOR:Zu});function ty(r,e,s){return r.sections.forEach((c=>{c.text=(function(p,y,x){const E=y.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),Gt.applyArabicShaping&&(p=Gt.applyArabicShaping(p)),p})(c.text,e,s)})),r}const cf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function ey(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}function ny(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}var hf=Br,Up=function(r,e,s,c,p){var y,x,E=8*p-c-1,I=(1<<E)-1,M=I>>1,O=-7,k=p-1,U=-1,$=r[e+k];for(k+=U,y=$&(1<<-O)-1,$>>=-O,O+=E;O>0;y=256*y+r[e+k],k+=U,O-=8);for(x=y&(1<<-O)-1,y>>=-O,O+=c;O>0;x=256*x+r[e+k],k+=U,O-=8);if(y===0)y=1-M;else{if(y===I)return x?NaN:1/0*($?-1:1);x+=Math.pow(2,c),y-=M}return($?-1:1)*x*Math.pow(2,y-c)},us=function(r,e,s,c,p,y){var x,E,I,M=8*y-p-1,O=(1<<M)-1,k=O>>1,U=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=0,Q=1,at=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(E=isNaN(e)?1:0,x=O):(x=Math.floor(Math.log(e)/Math.LN2),e*(I=Math.pow(2,-x))<1&&(x--,I*=2),(e+=x+k>=1?U/I:U*Math.pow(2,1-k))*I>=2&&(x++,I/=2),x+k>=O?(E=0,x=O):x+k>=1?(E=(e*I-1)*Math.pow(2,p),x+=k):(E=e*Math.pow(2,k-1)*Math.pow(2,p),x=0));p>=8;r[s+$]=255&E,$+=Q,E/=256,p-=8);for(x=x<<p|E,M+=p;M>0;r[s+$]=255&x,$+=Q,x/=256,M-=8);r[s+$-Q]|=128*at};function Br(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Br.Varint=0,Br.Fixed64=1,Br.Bytes=2,Br.Fixed32=5;var ga=4294967296,em=1/ga,Gp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Zc(r){return r.type===Br.Bytes?r.readVarint()+r.pos:r.pos+1}function oh(r,e,s){return s?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function Ud(r,e,s){var c=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));s.realloc(c);for(var p=s.pos-1;p>=r;p--)s.buf[p+c]=s.buf[p]}function Gd(r,e){for(var s=0;s<r.length;s++)e.writeVarint(r[s])}function nm(r,e){for(var s=0;s<r.length;s++)e.writeSVarint(r[s])}function im(r,e){for(var s=0;s<r.length;s++)e.writeFloat(r[s])}function Vp(r,e){for(var s=0;s<r.length;s++)e.writeDouble(r[s])}function qp(r,e){for(var s=0;s<r.length;s++)e.writeBoolean(r[s])}function iy(r,e){for(var s=0;s<r.length;s++)e.writeFixed32(r[s])}function rm(r,e){for(var s=0;s<r.length;s++)e.writeSFixed32(r[s])}function ry(r,e){for(var s=0;s<r.length;s++)e.writeFixed64(r[s])}function sm(r,e){for(var s=0;s<r.length;s++)e.writeSFixed64(r[s])}function Vd(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function ff(r,e,s){r[s]=e,r[s+1]=e>>>8,r[s+2]=e>>>16,r[s+3]=e>>>24}function Hc(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}function om(r,e,s){e.glyphs=[],r===1&&s.readMessage(am,e)}function am(r,e,s){if(r===3){const{id:c,bitmap:p,width:y,height:x,left:E,top:I,advance:M}=s.readMessage(jp,{});e.glyphs.push({id:c,bitmap:new Sc({width:y+6,height:x+6},p),metrics:{width:y,height:x,left:E,top:I,advance:M}})}else r===4?e.ascender=s.readSVarint():r===5&&(e.descender=s.readSVarint())}function jp(r,e,s){r===1?e.id=s.readVarint():r===2?e.bitmap=s.readBytes():r===3?e.width=s.readVarint():r===4?e.height=s.readVarint():r===5?e.left=s.readSVarint():r===6?e.top=s.readSVarint():r===7&&(e.advance=s.readVarint())}function Xp(r){let e=0,s=0;for(const x of r)e+=x.w*x.h,s=Math.max(s,x.w);r.sort(((x,E)=>E.h-x.h));const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let p=0,y=0;for(const x of r)for(let E=c.length-1;E>=0;E--){const I=c[E];if(!(x.w>I.w||x.h>I.h)){if(x.x=I.x,x.y=I.y,y=Math.max(y,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===I.w&&x.h===I.h){const M=c.pop();E<c.length&&(c[E]=M)}else x.h===I.h?(I.x+=x.w,I.w-=x.w):x.w===I.w?(I.y+=x.h,I.h-=x.h):(c.push({x:I.x+x.w,y:I.y,w:I.w-x.w,h:x.h}),I.y+=x.h,I.h-=x.h);break}}return{w:p,h:y,fill:e/(p*y)||0}}Br.prototype={destroy:function(){this.buf=null},readFields:function(r,e,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),p=c>>3,y=this.pos;this.type=7&c,r(p,e,this),this.pos===y&&this.skip(c)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=Vd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=Hc(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Vd(this.buf,this.pos)+Vd(this.buf,this.pos+4)*ga;return this.pos+=8,r},readSFixed64:function(){var r=Vd(this.buf,this.pos)+Hc(this.buf,this.pos+4)*ga;return this.pos+=8,r},readFloat:function(){var r=Up(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Up(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,s,c=this.buf;return e=127&(s=c[this.pos++]),s<128?e:(e|=(127&(s=c[this.pos++]))<<7,s<128?e:(e|=(127&(s=c[this.pos++]))<<14,s<128?e:(e|=(127&(s=c[this.pos++]))<<21,s<128?e:(function(p,y,x){var E,I,M=x.buf;if(E=(112&(I=M[x.pos++]))>>4,I<128||(E|=(127&(I=M[x.pos++]))<<3,I<128)||(E|=(127&(I=M[x.pos++]))<<10,I<128)||(E|=(127&(I=M[x.pos++]))<<17,I<128)||(E|=(127&(I=M[x.pos++]))<<24,I<128)||(E|=(1&(I=M[x.pos++]))<<31,I<128))return oh(p,E,y);throw new Error("Expected varint not more than 10 bytes")})(e|=(15&(s=c[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&Gp?(function(s,c,p){return Gp.decode(s.subarray(c,p))})(this.buf,e,r):(function(s,c,p){for(var y="",x=c;x<p;){var E,I,M,O=s[x],k=null,U=O>239?4:O>223?3:O>191?2:1;if(x+U>p)break;U===1?O<128&&(k=O):U===2?(192&(E=s[x+1]))==128&&(k=(31&O)<<6|63&E)<=127&&(k=null):U===3?(I=s[x+2],(192&(E=s[x+1]))==128&&(192&I)==128&&((k=(15&O)<<12|(63&E)<<6|63&I)<=2047||k>=55296&&k<=57343)&&(k=null)):U===4&&(I=s[x+2],M=s[x+3],(192&(E=s[x+1]))==128&&(192&I)==128&&(192&M)==128&&((k=(15&O)<<18|(63&E)<<12|(63&I)<<6|63&M)<=65535||k>=1114112)&&(k=null)),k===null?(k=65533,U=1):k>65535&&(k-=65536,y+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),y+=String.fromCharCode(k),x+=U}return y})(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Br.Bytes)return r.push(this.readVarint(e));var s=Zc(this);for(r=r||[];this.pos<s;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Br.Bytes)return r.push(this.readSVarint());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Br.Bytes)return r.push(this.readBoolean());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Br.Bytes)return r.push(this.readFloat());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Br.Bytes)return r.push(this.readDouble());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Br.Bytes)return r.push(this.readFixed32());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Br.Bytes)return r.push(this.readSFixed32());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Br.Bytes)return r.push(this.readFixed64());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Br.Bytes)return r.push(this.readSFixed64());var e=Zc(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Br.Varint)for(;this.buf[this.pos++]>127;);else if(e===Br.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Br.Fixed32)this.pos+=4;else{if(e!==Br.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var s=new Uint8Array(e);s.set(this.buf),this.buf=s,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),ff(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),ff(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),ff(this.buf,-1&r,this.pos),ff(this.buf,Math.floor(r*em),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),ff(this.buf,-1&r,this.pos),ff(this.buf,Math.floor(r*em),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?(function(e,s){var c,p;if(e>=0?(c=e%4294967296|0,p=e/4294967296|0):(p=~(-e/4294967296),4294967295^(c=~(-e%4294967296))?c=c+1|0:(c=0,p=p+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(y,x,E){E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,E.buf[E.pos]=127&(y>>>=7)})(c,0,s),(function(y,x){var E=(7&y)<<4;x.buf[x.pos++]|=E|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))})(p,s)})(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=(function(c,p,y){for(var x,E,I=0;I<p.length;I++){if((x=p.charCodeAt(I))>55295&&x<57344){if(!E){x>56319||I+1===p.length?(c[y++]=239,c[y++]=191,c[y++]=189):E=x;continue}if(x<56320){c[y++]=239,c[y++]=191,c[y++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(c[y++]=239,c[y++]=191,c[y++]=189,E=null);x<128?c[y++]=x:(x<2048?c[y++]=x>>6|192:(x<65536?c[y++]=x>>12|224:(c[y++]=x>>18|240,c[y++]=x>>12&63|128),c[y++]=x>>6&63|128),c[y++]=63&x|128)}return y})(this.buf,r,this.pos);var s=this.pos-e;s>=128&&Ud(e,s,this),this.pos=e-1,this.writeVarint(s),this.pos+=s},writeFloat:function(r){this.realloc(4),us(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),us(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var s=0;s<e;s++)this.buf[this.pos++]=r[s]},writeRawMessage:function(r,e){this.pos++;var s=this.pos;r(e,this);var c=this.pos-s;c>=128&&Ud(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(r,e,s){this.writeTag(r,Br.Bytes),this.writeRawMessage(e,s)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,Gd,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,nm,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,qp,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,im,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,Vp,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,iy,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,rm,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,ry,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,sm,e)},writeBytesField:function(r,e){this.writeTag(r,Br.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Br.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Br.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Br.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Br.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Br.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Br.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Br.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Br.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Br.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,!!e)}};class Zp{constructor(e,{pixelRatio:s,version:c,stretchX:p,stretchY:y,content:x}){this.paddedRect=e,this.pixelRatio=s,this.stretchX=p,this.stretchY=y,this.content=x,this.version=c}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Hp{constructor(e,s){const c={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(e,c,y),this.addImages(s,p,y);const{w:x,h:E}=Xp(y),I=new Bl({width:x||1,height:E||1});for(const M in e){const O=e[M],k=c[M].paddedRect;Bl.copy(O.data,I,{x:0,y:0},{x:k.x+1,y:k.y+1},O.data)}for(const M in s){const O=s[M],k=p[M].paddedRect,U=k.x+1,$=k.y+1,Q=O.data.width,at=O.data.height;Bl.copy(O.data,I,{x:0,y:0},{x:U,y:$},O.data),Bl.copy(O.data,I,{x:0,y:at-1},{x:U,y:$-1},{width:Q,height:1}),Bl.copy(O.data,I,{x:0,y:0},{x:U,y:$+at},{width:Q,height:1}),Bl.copy(O.data,I,{x:Q-1,y:0},{x:U-1,y:$},{width:1,height:at}),Bl.copy(O.data,I,{x:0,y:0},{x:U+Q,y:$},{width:1,height:at})}this.image=I,this.iconPositions=c,this.patternPositions=p}addImages(e,s,c){for(const p in e){const y=e[p],x={x:0,y:0,w:y.data.width+2,h:y.data.height+2};c.push(x),s[p]=new Zp(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(e,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((c=>e.hasImage(c))),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in e.updatedImages)this.patchUpdatedImage(this.iconPositions[c],e.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],e.getImage(c),s)}patchUpdatedImage(e,s,c){if(!e||!s||e.version===s.version)return;e.version=s.version;const[p,y]=e.tl;c.update(s.data,void 0,{x:p,y})}}dn(Zp,"ImagePosition"),dn(Hp,"ImageAtlas");const Ul={horizontal:1,vertical:2,horizontalOnly:3};class Dh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,s){const c=new Dh;return c.scale=e||1,c.fontStack=s,c}static forImage(e){const s=new Dh;return s.imageName=e,s}}class df{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,s){const c=new df;for(let p=0;p<e.sections.length;p++){const y=e.sections[p];y.image?c.addImageSection(y):c.addTextSection(y,s)}return c}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=(function(s,c){let p="";for(let y=0;y<s.length;y++){const x=s.charCodeAt(y+1)||null,E=s.charCodeAt(y-1)||null;p+=!c&&(x&&L(x)&&!cf[s[y+1]]||E&&L(E)&&!cf[s[y-1]])||!cf[s[y]]?s[y]:cf[s[y]]}return p})(this.text,e)}trim(){let e=0;for(let c=0;c<this.text.length&&pf[this.text.charCodeAt(c)];c++)e++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=e&&pf[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(e,s),this.sectionIndex=this.sectionIndex.slice(e,s)}substring(e,s){const c=new df;return c.text=this.text.substring(e,s),c.sectionIndex=this.sectionIndex.slice(e,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,s)=>Math.max(e,this.sections[s].scale)),0)}addTextSection(e,s){this.text+=e.text,this.sections.push(Dh.forText(e.scale,e.fontStack||s));const c=this.sections.length-1;for(let p=0;p<e.text.length;++p)this.sectionIndex.push(c)}addImageSection(e){const s=e.image?e.image.name:"";if(s.length===0)return void lr("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Dh.forImage(s)),this.sectionIndex.push(this.sections.length-1)):lr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ou(r,e,s,c,p,y,x,E,I,M,O,k,U,$,Q){const at=df.fromFeature(r,p);k===Ul.vertical&&at.verticalizePunctuation(U);let wt=[];const zt=(function(qt,Me,Ie,Ge,cn,Ne){if(!qt)return[];const Ze=[],Ye=(function(En,si,Ln,qn,Cn,li){let Ti=0;for(let Li=0;Li<En.length();Li++){const pr=En.getSection(Li);Ti+=Yp(En.getCharCode(Li),pr,qn,Cn,si,li)}return Ti/Math.max(1,Math.ceil(Ti/Ln))})(qt,Me,Ie,Ge,cn,Ne),on=qt.text.indexOf("")>=0;let hn=0;for(let En=0;En<qt.length();En++){const si=qt.getSection(En),Ln=qt.getCharCode(En);if(pf[Ln]||(hn+=Yp(Ln,si,Ge,cn,Me,Ne)),En<qt.length()-1){const qn=!((Oe=Ln)<11904||!(Bi(Oe)||gc(Oe)||Nl(Oe)||Pc(Oe)||ic(Oe)||hl(Oe)||Ks(Oe)||Ca(Oe)||dl(Oe)||Eu(Oe)||fl(Oe)||o(Oe)||pc(Oe)||Rl(Oe)||dc(Oe)||nc(Oe)||Gu(Oe)||tu(Oe)||Va(Oe)||Dl(Oe)));(lm[Ln]||qn||si.imageName)&&Ze.push(Nu(En+1,hn,Ye,Ze,od(Ln,qt.getCharCode(En+1),qn&&on),!1))}}var Oe;return $p(Nu(qt.length(),hn,Ye,Ze,0,!0))})(at,M,y,e,c,$),{processBidirectionalText:Wt,processStyledBidirectionalText:Ot}=Gt;if(Wt&&at.sections.length===1){const qt=Wt(at.toString(),zt);for(const Me of qt){const Ie=new df;Ie.text=Me,Ie.sections=at.sections;for(let Ge=0;Ge<Me.length;Ge++)Ie.sectionIndex.push(0);wt.push(Ie)}}else if(Ot){const qt=Ot(at.text,at.sectionIndex,zt);for(const Me of qt){const Ie=new df;Ie.text=Me[0],Ie.sectionIndex=Me[1],Ie.sections=at.sections,wt.push(Ie)}}else wt=(function(qt,Me){const Ie=[],Ge=qt.text;let cn=0;for(const Ne of Me)Ie.push(qt.substring(cn,Ne)),cn=Ne;return cn<Ge.length&&Ie.push(qt.substring(cn,Ge.length)),Ie})(at,zt);const Vt=[],ne={positionedLines:Vt,text:at.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return(function(qt,Me,Ie,Ge,cn,Ne,Ze,Ye,on,hn,Oe,En){let si=0,Ln=0,qn=0;const Cn=Ye==="right"?1:Ye==="left"?0:.5;let li=!1;for(const Fi of cn){const $i=Fi.getSections();for(const $r of $i){if($r.imageName)continue;const ws=Me[$r.fontStack];if(ws&&(li=ws.ascender!==void 0&&ws.descender!==void 0,!li))break}if(!li)break}let Ti=0;for(const Fi of cn){Fi.trim();const $i=Fi.getMaxScale(),$r=($i-1)*Go,ws={positionedGlyphs:[],lineOffset:0};qt.positionedLines[Ti]=ws;const cs=ws.positionedGlyphs;let Es=0;if(!Fi.length()){Ln+=Ne,++Ti;continue}let As=0,co=0;for(let Vr=0;Vr<Fi.length();Vr++){const ta=Fi.getSection(Vr),Vo=Fi.getSectionIndex(Vr),xr=Fi.getCharCode(Vr);let Zs=ta.scale,ma=null,Jr=null,To=null,Gl=Go,Za=0;const Ha=!(on===Ul.horizontal||!Oe&&!S(xr)||Oe&&(pf[xr]||(Li=xr,as(Li)||ca(Li)||Ll(Li)||qa(Li)||m(Li))));if(ta.imageName){const cu=Ge[ta.imageName];if(!cu)continue;To=ta.imageName,qt.iconsInText=qt.iconsInText||!0,Jr=cu.paddedRect;const Ya=cu.displaySize;Zs=Zs*Go/En,ma={width:Ya[0],height:Ya[1],left:1,top:-3,advance:Ha?Ya[1]:Ya[0],localGlyph:!1},Za=li?-ma.height*Zs:$i*Go-17-Ya[1]*Zs,Gl=ma.advance;const Gh=(Ha?Ya[0]:Ya[1])*Zs-Go*$i;Gh>0&&Gh>Es&&(Es=Gh)}else{const cu=Ie[ta.fontStack];if(!cu)continue;cu[xr]&&(Jr=cu[xr]);const Ya=Me[ta.fontStack];if(!Ya)continue;const Gh=Ya.glyphs[xr];if(!Gh)continue;if(ma=Gh.metrics,Gl=xr!==8203?Go:0,li){const tp=Ya.ascender!==void 0?Math.abs(Ya.ascender):0,dg=Ya.descender!==void 0?Math.abs(Ya.descender):0,pg=(tp+dg)*Zs;As<pg&&(As=pg,co=(tp-dg)/2*Zs),Za=-tp*Zs}else Za=($i-Zs)*Go-17}Ha?(qt.verticalizable=!0,cs.push({glyph:xr,imageName:To,x:si,y:Ln+Za,vertical:Ha,scale:Zs,localGlyph:ma.localGlyph,fontStack:ta.fontStack,sectionIndex:Vo,metrics:ma,rect:Jr}),si+=Gl*Zs+hn):(cs.push({glyph:xr,imageName:To,x:si,y:Ln+Za,vertical:Ha,scale:Zs,localGlyph:ma.localGlyph,fontStack:ta.fontStack,sectionIndex:Vo,metrics:ma,rect:Jr}),si+=ma.advance*Zs+hn)}cs.length!==0&&(qn=Math.max(si-hn,qn),li?Ac(cs,Cn,Es,co,Ne*$i/2):Ac(cs,Cn,Es,0,Ne/2)),si=0;const Xa=Ne*$i+Es;ws.lineOffset=Math.max(Es,$r),Ln+=Xa,++Ti}var Li;const pr=Ln,{horizontalAlign:bi,verticalAlign:Ms}=gf(Ze);(function(Fi,$i,$r,ws,cs,Es){const As=($i-$r)*cs,co=-Es*ws;for(const Xa of Fi)for(const Vr of Xa.positionedGlyphs)Vr.x+=As,Vr.y+=co})(qt.positionedLines,Cn,bi,Ms,qn,pr),qt.top+=-Ms*pr,qt.bottom=qt.top+pr,qt.left+=-bi*qn,qt.right=qt.left+qn,qt.hasBaseline=li})(ne,e,s,c,wt,x,E,I,k,M,U,Q),!(function(qt){for(const Me of qt)if(Me.positionedGlyphs.length!==0)return!1;return!0})(Vt)&&ne}const pf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lm={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Yp(r,e,s,c,p,y){if(e.imageName){const x=c[e.imageName];return x?x.displaySize[0]*e.scale*Go/y+p:0}{const x=s[e.fontStack],E=x&&x.glyphs[r];return E?E.metrics.advance*e.scale+p:0}}function Wp(r,e,s,c){const p=Math.pow(r-e,2);return c?r<e?p/2:2*p:p+Math.abs(s)*s}function od(r,e,s){let c=0;return r===10&&(c-=1e4),s&&(c+=150),r!==40&&r!==65288||(c+=50),e!==41&&e!==65289||(c+=50),c}function Nu(r,e,s,c,p,y){let x=null,E=Wp(e,s,p,y);for(const I of c){const M=Wp(e-I.x,s,p,y)+I.badness;M<=E&&(x=I,E=M)}return{index:r,x:e,priorBreak:x,badness:E}}function $p(r){return r?$p(r.priorBreak).concat(r.index):[]}function gf(r){let e=.5,s=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:e,verticalAlign:s}}function Ac(r,e,s,c,p){if(!(e||s||c||p))return;const y=r.length-1,x=r[y],E=(x.x+x.metrics.advance*x.scale)*e;for(let I=0;I<=y;I++)r[I].x-=E,r[I].y+=s+c+p}function sy(r,e,s){const{horizontalAlign:c,verticalAlign:p}=gf(s),y=e[0]-r.displaySize[0]*c,x=e[1]-r.displaySize[1]*p;return{image:r,top:x,bottom:x+r.displaySize[1],left:y,right:y+r.displaySize[0]}}function um(r,e,s,c,p,y){const x=r.image;let E;if(x.content){const wt=x.content,zt=x.pixelRatio||1;E=[wt[0]/zt,wt[1]/zt,x.displaySize[0]-wt[2]/zt,x.displaySize[1]-wt[3]/zt]}const I=e.left*y,M=e.right*y;let O,k,U,$;s==="width"||s==="both"?($=p[0]+I-c[3],k=p[0]+M+c[1]):($=p[0]+(I+M-x.displaySize[0])/2,k=$+x.displaySize[0]);const Q=e.top*y,at=e.bottom*y;return s==="height"||s==="both"?(O=p[1]+Q-c[0],U=p[1]+at+c[2]):(O=p[1]+(Q+at-x.displaySize[1])/2,U=O+x.displaySize[1]),{image:x,top:O,right:k,bottom:U,left:$,collisionPadding:E}}class au extends Dt{constructor(e,s,c,p,y){super(e,s),this.angle=p,this.z=c,y!==void 0&&(this.segment=y)}clone(){return new au(this.x,this.y,this.z,this.angle,this.segment)}}function Jp(r,e,s,c,p){if(e.segment===void 0)return!0;let y=e,x=e.segment+1,E=0;for(;E>-s/2;){if(x--,x<0)return!1;E-=r[x].dist(y),y=r[x]}E+=r[x].dist(r[x+1]),x++;const I=[];let M=0;for(;E<s/2;){const O=r[x],k=r[x+1];if(!k)return!1;let U=r[x-1].angleTo(O)-O.angleTo(k);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:E,angleDelta:U}),M+=U;E-I[0].distance>c;)M-=I.shift().angleDelta;if(M>p)return!1;x++,E+=O.dist(k)}return!0}function cm(r){let e=0;for(let s=0;s<r.length-1;s++)e+=r[s].dist(r[s+1]);return e}function hm(r,e,s){return r?.6*e*s:0}function fm(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function oy(r,e,s,c,p,y){const x=hm(s,p,y),E=fm(s,c)*y;let I=0;const M=cm(r)/2;for(let O=0;O<r.length-1;O++){const k=r[O],U=r[O+1],$=k.dist(U);if(I+$>M){const Q=(M-I)/$,at=Ii(k.x,U.x,Q),wt=Ii(k.y,U.y,Q),zt=new au(at,wt,0,U.angleTo(k),O);return!x||Jp(r,zt,E,x,e)?zt:void 0}I+=$}}function ay(r,e,s,c,p,y,x,E,I){const M=hm(c,y,x),O=fm(c,p),k=O*x,U=r[0].x===0||r[0].x===I||r[0].y===0||r[0].y===I;return e-k<e/4&&(e=k+e/4),dm(r,U?e/2*E%e:(O/2+2*y)*x*E%e,e,M,s,k,U,!1,I)}function dm(r,e,s,c,p,y,x,E,I){const M=y/2,O=cm(r);let k=0,U=e-s,$=[];for(let Q=0;Q<r.length-1;Q++){const at=r[Q],wt=r[Q+1],zt=at.dist(wt),Wt=wt.angleTo(at);for(;U+s<k+zt;){U+=s;const Ot=(U-k)/zt,Vt=Ii(at.x,wt.x,Ot),ne=Ii(at.y,wt.y,Ot);if(Vt>=0&&Vt<I&&ne>=0&&ne<I&&U-M>=0&&U+M<=O){const qt=new au(Vt,ne,0,Wt,Q);qt._round(),c&&!Jp(r,qt,y,c,p)||$.push(qt)}}k+=zt}return E||$.length||x||($=dm(r,k/2,s,c,p,y,x,!0,I)),$}function pm(r,e,s,c,p){const y=[];for(let x=0;x<r.length;x++){const E=r[x];let I;for(let M=0;M<E.length-1;M++){let O=E[M],k=E[M+1];O.x<e&&k.x<e||(O.x<e?O=new Dt(e,O.y+(e-O.x)/(k.x-O.x)*(k.y-O.y))._round():k.x<e&&(k=new Dt(e,O.y+(e-O.x)/(k.x-O.x)*(k.y-O.y))._round()),O.y<s&&k.y<s||(O.y<s?O=new Dt(O.x+(s-O.y)/(k.y-O.y)*(k.x-O.x),s)._round():k.y<s&&(k=new Dt(O.x+(s-O.y)/(k.y-O.y)*(k.x-O.x),s)._round()),O.x>=c&&k.x>=c||(O.x>=c?O=new Dt(c,O.y+(c-O.x)/(k.x-O.x)*(k.y-O.y))._round():k.x>=c&&(k=new Dt(c,O.y+(c-O.x)/(k.x-O.x)*(k.y-O.y))._round()),O.y>=p&&k.y>=p||(O.y>=p?O=new Dt(O.x+(p-O.y)/(k.y-O.y)*(k.x-O.x),p)._round():k.y>=p&&(k=new Dt(O.x+(p-O.y)/(k.y-O.y)*(k.x-O.x),p)._round()),I&&O.equals(I[I.length-1])||(I=[O],y.push(I)),I.push(k)))))}}return y}dn(au,"Anchor");const mf=1e20;function Nh(r,e,s,c,p,y,x,E,I){for(let M=e;M<e+c;M++)yf(r,s*y+M,y,p,x,E,I);for(let M=s;M<s+p;M++)yf(r,M*y+e,1,c,x,E,I)}function yf(r,e,s,c,p,y,x){y[0]=0,x[0]=-mf,x[1]=mf,p[0]=r[e];for(let E=1,I=0,M=0;E<c;E++){p[E]=r[e+E*s];const O=E*E;do{const k=y[I];M=(p[E]-p[k]+O-k*k)/(E-k)/2}while(M<=x[I]&&--I>-1);I++,y[I]=E,x[I]=M,x[I+1]=mf}for(let E=0,I=0;E<c;E++){for(;x[I+1]<E;)I++;const M=y[I],O=E-M;r[e+E*s]=p[M]+O*O}}const qd={none:0,ideographs:1,all:2};class _f{constructor(e,s,c){this.requestManager=e,this.localGlyphMode=s,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,s){const c=[];for(const p in e)for(const y of e[p])c.push({stack:p,id:y});ye(c,(({stack:p,id:y},x)=>{let E=this.entries[p];E||(E=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=E.glyphs[y];if(I!==void 0)return void x(null,{stack:p,id:y,glyph:I});if(I=this._tinySDF(E,p,y),I)return E.glyphs[y]=I,void x(null,{stack:p,id:y,glyph:I});const M=Math.floor(y/256);if(256*M>65535)return void x(new Error("glyphs > 65535 not supported"));if(E.ranges[M])return void x(null,{stack:p,id:y,glyph:I});let O=E.requests[M];O||(O=E.requests[M]=[],_f.loadGlyphRange(p,M,this.url,this.requestManager,((k,U)=>{if(U){E.ascender=U.ascender,E.descender=U.descender;for(const $ in U.glyphs)this._doesCharSupportLocalGlyph(+$)||(E.glyphs[+$]=U.glyphs[+$]);E.ranges[M]=!0}for(const $ of O)$(k,U);delete E.requests[M]}))),O.push(((k,U)=>{k?x(k):U&&x(null,{stack:p,id:y,glyph:U.glyphs[y]||null})}))}),((p,y)=>{if(p)s(p);else if(y){const x={};for(const{stack:E,id:I,glyph:M}of y)x[E]===void 0&&(x[E]={}),x[E].glyphs===void 0&&(x[E].glyphs={}),x[E].glyphs[I]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},x[E].ascender=this.entries[E].ascender,x[E].descender=this.entries[E].descender;s(null,x)}}))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==qd.none&&(this.localGlyphMode===qd.all?!!this.localFontFamily:!!this.localFontFamily&&(Eu(e)||Vu(e)||pc(e)||Gu(e)||Ca(e)))}_tinySDF(e,s,c){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let y=e.tinySDF;if(!y){let at="400";/bold/i.test(s)?at="900":/medium/i.test(s)?at="500":/light/i.test(s)&&(at="200"),y=e.tinySDF=new _f.TinySDF({fontFamily:p,fontWeight:at,fontSize:48,buffer:6,radius:16}),y.fontWeight=at}if(this.localGlyphs[y.fontWeight][c])return this.localGlyphs[y.fontWeight][c];const x=String.fromCharCode(c),{data:E,width:I,height:M,glyphWidth:O,glyphHeight:k,glyphLeft:U,glyphTop:$,glyphAdvance:Q}=y.draw(x);return this.localGlyphs[y.fontWeight][c]={id:c,bitmap:new Sc({width:I,height:M},E),metrics:{width:O/2,height:k/2,left:U/2,top:$/2-27,advance:Q/2,localGlyph:!0}}}}function Oh(r,e,s,c){const p=[],y=r.image,x=y.pixelRatio,E=y.paddedRect.w-2,I=y.paddedRect.h-2,M=r.right-r.left,O=r.bottom-r.top,k=y.stretchX||[[0,E]],U=y.stretchY||[[0,I]],$=(Ne,Ze)=>Ne+Ze[1]-Ze[0],Q=k.reduce($,0),at=U.reduce($,0),wt=E-Q,zt=I-at;let Wt=0,Ot=Q,Vt=0,ne=at,qt=0,Me=wt,Ie=0,Ge=zt;if(y.content&&c){const Ne=y.content;Wt=ah(k,0,Ne[0]),Vt=ah(U,0,Ne[1]),Ot=ah(k,Ne[0],Ne[2]),ne=ah(U,Ne[1],Ne[3]),qt=Ne[0]-Wt,Ie=Ne[1]-Vt,Me=Ne[2]-Ne[0]-Ot,Ge=Ne[3]-Ne[1]-ne}const cn=(Ne,Ze,Ye,on)=>{const hn=zh(Ne.stretch-Wt,Ot,M,r.left),Oe=vf(Ne.fixed-qt,Me,Ne.stretch,Q),En=zh(Ze.stretch-Vt,ne,O,r.top),si=vf(Ze.fixed-Ie,Ge,Ze.stretch,at),Ln=zh(Ye.stretch-Wt,Ot,M,r.left),qn=vf(Ye.fixed-qt,Me,Ye.stretch,Q),Cn=zh(on.stretch-Vt,ne,O,r.top),li=vf(on.fixed-Ie,Ge,on.stretch,at),Ti=new Dt(hn,En),Li=new Dt(Ln,En),pr=new Dt(Ln,Cn),bi=new Dt(hn,Cn),Ms=new Dt(Oe/x,si/x),Fi=new Dt(qn/x,li/x),$i=e*Math.PI/180;if($i){const cs=Math.sin($i),Es=Math.cos($i),As=[Es,-cs,cs,Es];Ti._matMult(As),Li._matMult(As),bi._matMult(As),pr._matMult(As)}const $r=Ne.stretch+Ne.fixed,ws=Ze.stretch+Ze.fixed;return{tl:Ti,tr:Li,bl:bi,br:pr,tex:{x:y.paddedRect.x+1+$r,y:y.paddedRect.y+1+ws,w:Ye.stretch+Ye.fixed-$r,h:on.stretch+on.fixed-ws},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ms,pixelOffsetBR:Fi,minFontScaleX:Me/x/M,minFontScaleY:Ge/x/O,isSDF:s}};if(c&&(y.stretchX||y.stretchY)){const Ne=Kp(k,wt,Q),Ze=Kp(U,zt,at);for(let Ye=0;Ye<Ne.length-1;Ye++){const on=Ne[Ye],hn=Ne[Ye+1];for(let Oe=0;Oe<Ze.length-1;Oe++)p.push(cn(on,Ze[Oe],hn,Ze[Oe+1]))}}else p.push(cn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:I+1}));return p}function ah(r,e,s){let c=0;for(const p of r)c+=Math.max(e,Math.min(s,p[1]))-Math.max(e,Math.min(s,p[0]));return c}function Kp(r,e,s){const c=[{fixed:-1,stretch:0}];for(const[p,y]of r){const x=c[c.length-1];c.push({fixed:p-x.stretch,stretch:x.stretch}),c.push({fixed:p-x.stretch,stretch:x.stretch+(y-p)})}return c.push({fixed:e+1,stretch:s}),c}function zh(r,e,s,c){return r/e*s+c}function vf(r,e,s,c){return r-e*s/c}function Qp(r,e,s,c){const p=e+r.positionedLines[c].lineOffset;return c===0?s+p/2:s+(p+(e+r.positionedLines[c-1].lineOffset))/2}_f.loadGlyphRange=function(r,e,s,c,p){const y=256*e,x=y+255,E=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",r).replace("{range}",`${y}-${x}`),Xr.Glyphs);Rs(E,((I,M)=>{if(I)p(I);else if(M){const O={},k=(function(U){return new hf(U).readFields(om,{})})(M);for(const U of k.glyphs)O[U.id]=U;p(null,{glyphs:O,ascender:k.ascender,descender:k.descender})}}))},_f.TinySDF=class{constructor({fontSize:r=24,buffer:e=3,radius:s=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:x="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=s;const E=this.size=r+4*e,I=this._createCanvas(E),M=this.ctx=I.getContext("2d",{willReadFrequently:!0});M.font=`${x} ${y} ${r}px ${p}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(r){const e=document.createElement("canvas");return e.width=e.height=r,e}draw(r){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(r),x=Math.ceil(s),E=Math.min(this.size-this.buffer,Math.ceil(y-p)),I=Math.min(this.size-this.buffer,x+Math.ceil(c)),M=E+2*this.buffer,O=I+2*this.buffer,k=Math.max(M*O,0),U=new Uint8ClampedArray(k),$={data:U,width:M,height:O,glyphWidth:E,glyphHeight:I,glyphTop:x,glyphLeft:0,glyphAdvance:e};if(E===0||I===0)return $;const{ctx:Q,buffer:at,gridInner:wt,gridOuter:zt}=this;Q.clearRect(at,at,E,I),Q.fillText(r,at,at+x);const Wt=Q.getImageData(at,at,E,I);zt.fill(mf,0,k),wt.fill(0,0,k);for(let Ot=0;Ot<I;Ot++)for(let Vt=0;Vt<E;Vt++){const ne=Wt.data[4*(Ot*E+Vt)+3]/255;if(ne===0)continue;const qt=(Ot+at)*M+Vt+at;if(ne===1)zt[qt]=0,wt[qt]=mf;else{const Me=.5-ne;zt[qt]=Me>0?Me*Me:0,wt[qt]=Me<0?Me*Me:0}}Nh(zt,0,0,M,O,M,this.f,this.v,this.z),Nh(wt,at,at,E,I,M,this.f,this.v,this.z);for(let Ot=0;Ot<k;Ot++){const Vt=Math.sqrt(zt[Ot])-Math.sqrt(wt[Ot]);U[Ot]=Math.round(255-255*(Vt/this.radius+this.cutoff))}return $}};class jd{constructor(e=[],s=gm){if(this.data=e,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:s,compare:c}=this,p=s[e];for(;e>0;){const y=e-1>>1,x=s[y];if(c(p,x)>=0)break;s[e]=x,e=y}s[e]=p}_down(e){const{data:s,compare:c}=this,p=this.length>>1,y=s[e];for(;e<p;){let x=1+(e<<1),E=s[x];const I=x+1;if(I<this.length&&c(s[I],E)<0&&(x=I,E=s[I]),c(E,y)>=0)break;s[e]=E,e=x}s[e]=y}}function gm(r,e){return r<e?-1:r>e?1:0}function mm(r,e=1,s=!1){let c=1/0,p=1/0,y=-1/0,x=-1/0;const E=r[0];for(let $=0;$<E.length;$++){const Q=E[$];(!$||Q.x<c)&&(c=Q.x),(!$||Q.y<p)&&(p=Q.y),(!$||Q.x>y)&&(y=Q.x),(!$||Q.y>x)&&(x=Q.y)}const I=Math.min(y-c,x-p);let M=I/2;const O=new jd([],ly);if(I===0)return new Dt(c,p);for(let $=c;$<y;$+=I)for(let Q=p;Q<x;Q+=I)O.push(new Ph($+M,Q+M,M,r));let k=(function($){let Q=0,at=0,wt=0;const zt=$[0];for(let Wt=0,Ot=zt.length,Vt=Ot-1;Wt<Ot;Vt=Wt++){const ne=zt[Wt],qt=zt[Vt],Me=ne.x*qt.y-qt.x*ne.y;at+=(ne.x+qt.x)*Me,wt+=(ne.y+qt.y)*Me,Q+=3*Me}return new Ph(at/Q,wt/Q,0,$)})(r),U=O.length;for(;O.length;){const $=O.pop();($.d>k.d||!k.d)&&(k=$,s&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,U)),$.max-k.d<=e||(M=$.h/2,O.push(new Ph($.p.x-M,$.p.y-M,M,r)),O.push(new Ph($.p.x+M,$.p.y-M,M,r)),O.push(new Ph($.p.x-M,$.p.y+M,M,r)),O.push(new Ph($.p.x+M,$.p.y+M,M,r)),U+=4)}return s&&(console.log(`num probes: ${U}`),console.log(`best distance: ${k.d}`)),k.p}function ly(r,e){return e.max-r.max}function Ph(r,e,s,c){this.p=new Dt(r,e),this.h=s,this.d=(function(p,y){let x=!1,E=1/0;for(let I=0;I<y.length;I++){const M=y[I];for(let O=0,k=M.length,U=k-1;O<k;U=O++){const $=M[O],Q=M[U];$.y>p.y!=Q.y>p.y&&p.x<(Q.x-$.x)*(p.y-$.y)/(Q.y-$.y)+$.x&&(x=!x),E=Math.min(E,bd(p,$,Q))}}return(x?1:-1)*Math.sqrt(E)})(this.p,c),this.max=this.d+this.h*Math.SQRT2}const tg=Number.POSITIVE_INFINITY,eg=Math.sqrt(2);function ym(r,e){return e[1]!==tg?(function(s,c,p){let y=0,x=0;switch(c=Math.abs(c),p=Math.abs(p),s){case"top-right":case"top-left":case"top":x=p-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-p}switch(s){case"top-right":case"bottom-right":case"right":y=-c;break;case"top-left":case"bottom-left":case"left":y=c}return[y,x]})(r,e[0],e[1]):(function(s,c){let p=0,y=0;c<0&&(c=0);const x=c/eg;switch(s){case"top-right":case"top-left":y=x-7;break;case"bottom-right":case"bottom-left":y=7-x;break;case"bottom":y=7-c;break;case"top":y=c-7}switch(s){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=c;break;case"right":p=-c}return[p,y]})(r,e[0])}function Xd(r,e,s,c,p,y,x,E,I,M){r.createArrays(),r.tilePixelRatio=ai/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const O=r.layers[0].layout,k=r.layers[0]._unevaluatedLayout._values,U={};if(r.textSizeData.kind==="composite"){const{minZoom:at,maxZoom:wt}=r.textSizeData;U.compositeTextSizes=[k["text-size"].possiblyEvaluate(new Nt(at),E),k["text-size"].possiblyEvaluate(new Nt(wt),E)]}if(r.iconSizeData.kind==="composite"){const{minZoom:at,maxZoom:wt}=r.iconSizeData;U.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new Nt(at),E),k["icon-size"].possiblyEvaluate(new Nt(wt),E)]}U.layoutTextSize=k["text-size"].possiblyEvaluate(new Nt(I+1),E),U.layoutIconSize=k["icon-size"].possiblyEvaluate(new Nt(I+1),E),U.textMaxSize=k["text-size"].possiblyEvaluate(new Nt(18),E);const $=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",Q=O.get("text-size");for(const at of r.features){const wt=O.get("text-font").evaluate(at,{},E).join(","),zt=Q.evaluate(at,{},E),Wt=U.layoutTextSize.evaluate(at,{},E),Ot=(U.layoutIconSize.evaluate(at,{},E),{horizontal:{},vertical:void 0}),Vt=at.text;let ne,qt=[0,0];if(Vt){const Ge=Vt.toString(),cn=O.get("text-letter-spacing").evaluate(at,{},E)*Go,Ne=O.get("text-line-height").evaluate(at,{},E)*Go,Ze=_(Ge)?cn:0,Ye=O.get("text-anchor").evaluate(at,{},E),on=O.get("text-variable-anchor");if(!on){const Ln=O.get("text-radial-offset").evaluate(at,{},E);qt=Ln?ym(Ye,[Ln*Go,tg]):O.get("text-offset").evaluate(at,{},E).map((qn=>qn*Go))}let hn=$?"center":O.get("text-justify").evaluate(at,{},E);const Oe=O.get("symbol-placement")==="point",En=Oe?O.get("text-max-width").evaluate(at,{},E)*Go:1/0,si=Ln=>{r.allowVerticalPlacement&&f(Ge)&&(Ot.vertical=ou(Vt,e,s,p,wt,En,Ne,Ye,Ln,Ze,qt,Ul.vertical,!0,Wt,zt))};if(!$&&on){const Ln=hn==="auto"?on.map((Cn=>xf(Cn))):[hn];let qn=!1;for(let Cn=0;Cn<Ln.length;Cn++){const li=Ln[Cn];if(!Ot.horizontal[li])if(qn)Ot.horizontal[li]=Ot.horizontal[0];else{const Ti=ou(Vt,e,s,p,wt,En,Ne,"center",li,Ze,qt,Ul.horizontal,!1,Wt,zt);Ti&&(Ot.horizontal[li]=Ti,qn=Ti.positionedLines.length===1)}}si("left")}else{if(hn==="auto"&&(hn=xf(Ye)),Oe||O.get("text-writing-mode").indexOf("horizontal")>=0||!f(Ge)){const Ln=ou(Vt,e,s,p,wt,En,Ne,Ye,hn,Ze,qt,Ul.horizontal,!1,Wt,zt);Ln&&(Ot.horizontal[hn]=Ln)}si(Oe?"left":hn)}}let Me=!1;if(at.icon&&at.icon.name){const Ge=c[at.icon.name];Ge&&(ne=sy(p[at.icon.name],O.get("icon-offset").evaluate(at,{},E),O.get("icon-anchor").evaluate(at,{},E)),Me=Ge.sdf,r.sdfIcons===void 0?r.sdfIcons=Ge.sdf:r.sdfIcons!==Ge.sdf&&lr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ge.pixelRatio!==r.pixelRatio||O.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Ie=_m(Ot.horizontal)||Ot.vertical;r.iconsInText||(r.iconsInText=!!Ie&&Ie.iconsInText),(Ie||ne)&&Zd(r,at,Ot,ne,c,U,Wt,0,qt,Me,x,E,M)}y&&r.generateCollisionDebugBuffers(I,r.collisionBoxArray)}function xf(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Zd(r,e,s,c,p,y,x,E,I,M,O,k,U){let $=y.textMaxSize.evaluate(e,{},k);$===void 0&&($=x);const Q=r.layers[0].layout,at=Q.get("icon-offset").evaluate(e,{},k),wt=_m(s.horizontal)||s.vertical,zt=U.name==="globe",Wt=x/24,Ot=r.tilePixelRatio*$/24,Vt=(Ze=r.overscaling,r.zoom>18&&Ze>2&&(Ze>>=1),Math.max(ai/(512*Ze),1)*Q.get("symbol-spacing")),ne=Q.get("text-padding")*r.tilePixelRatio,qt=Q.get("icon-padding")*r.tilePixelRatio,Me=ie(Q.get("text-max-angle")),Ie=Q.get("text-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",Ge=Q.get("icon-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",cn=Q.get("symbol-placement"),Ne=Vt/2;var Ze;const Ye=Q.get("icon-text-fit");let on;c&&Ye!=="none"&&(r.allowVerticalPlacement&&s.vertical&&(on=um(c,s.vertical,Ye,Q.get("icon-text-fit-padding"),at,Wt)),wt&&(c=um(c,wt,Ye,Q.get("icon-text-fit-padding"),at,Wt)));const hn=(Oe,En,si)=>{if(En.x<0||En.x>=ai||En.y<0||En.y>=ai)return;let Ln=null;if(zt){const{x:qn,y:Cn,z:li}=U.projectTilePoint(En.x,En.y,si);Ln={anchor:new au(qn,Cn,li,0,void 0),up:U.upVector(si,En.x,En.y)}}(function(qn,Cn,li,Ti,Li,pr,bi,Ms,Fi,$i,$r,ws,cs,Es,As,co,Xa,Vr,ta,Vo,xr,Zs,ma,Jr,To){const Gl=qn.addToLineVertexArray(Cn,Ti);let Za,Ha,cu,Ya,Gh,tp,dg,pg=0,Tv=0,Cv=0,Iv=0,yy=-1,_y=-1;const gh={};let Mv=nu.exports("");const fd=li?li.anchor:Cn;let vy=0,xy=0;if(Fi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[vy,xy]=Fi.layout.get("text-offset").evaluate(xr,{},To).map((Yu=>Yu*Go)):(vy=Fi.layout.get("text-radial-offset").evaluate(xr,{},To)*Go,xy=tg),qn.allowVerticalPlacement&&Li.vertical){const Yu=Li.vertical;if(As)tp=Hd(Yu),Ms&&(dg=Hd(Ms));else{const Wu=Fi.layout.get("text-rotate").evaluate(xr,{},To)+90;cu=ad($i,fd,Cn,$r,ws,cs,Yu,Es,Wu,co),Ms&&(Ya=ad($i,fd,Cn,$r,ws,cs,Ms,Vr,Wu))}}if(pr){const Yu=Fi.layout.get("icon-rotate").evaluate(xr,{},To),Wu=Fi.layout.get("icon-text-fit")!=="none",gg=Oh(pr,Yu,ma,Wu),wy=Ms?Oh(Ms,Yu,ma,Wu):void 0;Ha=ad($i,fd,Cn,$r,ws,cs,pr,Vr,Yu),pg=4*gg.length;const Av=qn.iconSizeData;let dd=null;Av.kind==="source"?(dd=[Zu*Fi.layout.get("icon-size").evaluate(xr,{},To)],dd[0]>lh&&lr(`${qn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Av.kind==="composite"&&(dd=[Zu*Zs.compositeIconSizes[0].evaluate(xr,{},To),Zu*Zs.compositeIconSizes[1].evaluate(xr,{},To)],(dd[0]>lh||dd[1]>lh)&&lr(`${qn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),qn.addSymbols(qn.icon,gg,dd,Vo,ta,xr,!1,li,Cn,Gl.lineStartIndex,Gl.lineLength,-1,Jr,To),yy=qn.icon.placedSymbolArray.length-1,wy&&(Tv=4*wy.length,qn.addSymbols(qn.icon,wy,dd,Vo,ta,xr,Ul.vertical,li,Cn,Gl.lineStartIndex,Gl.lineLength,-1,Jr,To),_y=qn.icon.placedSymbolArray.length-1)}for(const Yu in Li.horizontal){const Wu=Li.horizontal[Yu];Za||(Mv=nu.exports(Wu.text),As?Gh=Hd(Wu):Za=ad($i,fd,Cn,$r,ws,cs,Wu,Es,Fi.layout.get("text-rotate").evaluate(xr,{},To),co));const gg=Wu.positionedLines.length===1;if(Cv+=bf(qn,li,Cn,Wu,bi,Fi,As,xr,co,Gl,Li.vertical?Ul.horizontal:Ul.horizontalOnly,gg?Object.keys(Li.horizontal):[Yu],gh,yy,Zs,Jr,To),gg)break}Li.vertical&&(Iv+=bf(qn,li,Cn,Li.vertical,bi,Fi,As,xr,co,Gl,Ul.vertical,["vertical"],gh,_y,Zs,Jr,To));let Rf=-1;const by=(Yu,Wu)=>Yu?Math.max(Yu,Wu):Wu;Rf=by(Gh,Rf),Rf=by(tp,Rf),Rf=by(dg,Rf);const y1=Rf>-1?1:0;qn.glyphOffsetArray.length>=hh.MAX_GLYPHS&&lr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),xr.sortKey!==void 0&&qn.addToSortKeyRanges(qn.symbolInstances.length,xr.sortKey),qn.symbolInstances.emplaceBack(fd.x,fd.y,fd.z,Cn.x,Cn.y,gh.right>=0?gh.right:-1,gh.center>=0?gh.center:-1,gh.left>=0?gh.left:-1,gh.vertical>=0?gh.vertical:-1,yy,_y,Mv,Za!==void 0?Za:qn.collisionBoxArray.length,Za!==void 0?Za+1:qn.collisionBoxArray.length,cu!==void 0?cu:qn.collisionBoxArray.length,cu!==void 0?cu+1:qn.collisionBoxArray.length,Ha!==void 0?Ha:qn.collisionBoxArray.length,Ha!==void 0?Ha+1:qn.collisionBoxArray.length,Ya||qn.collisionBoxArray.length,Ya?Ya+1:qn.collisionBoxArray.length,$r,Cv,Iv,pg,Tv,y1,0,vy,xy,Rf)})(r,En,Ln,Oe,s,c,p,on,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,ne,Ie,I,0,qt,Ge,at,e,y,M,O,k)};if(cn==="line")for(const Oe of pm(e.geometry,0,0,ai,ai)){const En=ay(Oe,Vt,Me,s.vertical||wt,c,24,Ot,r.overscaling,ai);for(const si of En){const Ln=wt;Ln&&vm(r,Ln.text,Ne,si)||hn(Oe,si,k)}}else if(cn==="line-center"){for(const Oe of e.geometry)if(Oe.length>1){const En=oy(Oe,Me,s.vertical||wt,c,24,Ot);En&&hn(Oe,En,k)}}else if(e.type==="Polygon")for(const Oe of Ad(e.geometry,0)){const En=mm(Oe,16);hn(Oe[0],new au(En.x,En.y,0,0,void 0),k)}else if(e.type==="LineString")for(const Oe of e.geometry)hn(Oe,new au(Oe[0].x,Oe[0].y,0,0,void 0),k);else if(e.type==="Point")for(const Oe of e.geometry)for(const En of Oe)hn([En],new au(En.x,En.y,0,0,void 0),k)}const lh=32640;function bf(r,e,s,c,p,y,x,E,I,M,O,k,U,$,Q,at,wt){const zt=(function(Vt,ne,qt,Me,Ie,Ge,cn,Ne){const Ze=[];if(ne.positionedLines.length===0)return Ze;const Ye=Me.layout.get("text-rotate").evaluate(Ge,{})*Math.PI/180,on=(function(Ln){const qn=Ln[0],Cn=Ln[1],li=qn*Cn;return li>0?[qn,-Cn]:li<0?[-qn,Cn]:qn===0?[Cn,qn]:[Cn,-qn]})(qt);let hn=Math.abs(ne.top-ne.bottom);for(const Ln of ne.positionedLines)hn-=Ln.lineOffset;const Oe=ne.positionedLines.length,En=hn/Oe;let si=ne.top-qt[1];for(let Ln=0;Ln<Oe;++Ln){const qn=ne.positionedLines[Ln];si=Qp(ne,En,si,Ln);for(const Cn of qn.positionedGlyphs){if(!Cn.rect)continue;const li=Cn.rect||{};let Ti=4,Li=!0,pr=1,bi=0;if(Cn.imageName){const Jr=cn[Cn.imageName];if(!Jr)continue;if(Jr.sdf){lr("SDF images are not supported in formatted text and will be ignored.");continue}Li=!1,pr=Jr.pixelRatio,Ti=1/pr}const Ms=(Ie||Ne)&&Cn.vertical,Fi=Cn.metrics.advance*Cn.scale/2,$i=Cn.metrics,$r=Cn.rect;if($r===null)continue;Ne&&ne.verticalizable&&(bi=Cn.imageName?Fi-Cn.metrics.width*Cn.scale/2:0);const ws=Ie?[Cn.x+Fi,Cn.y]:[0,0];let cs=[0,0],Es=[0,0],As=!1;Ie||(Ms?(Es=[Cn.x+Fi+on[0],Cn.y+on[1]-bi],As=!0):cs=[Cn.x+Fi+qt[0],Cn.y+qt[1]-bi]);const co=$r.w*Cn.scale/(pr*(Cn.localGlyph?2:1)),Xa=$r.h*Cn.scale/(pr*(Cn.localGlyph?2:1));let Vr,ta,Vo,xr;if(Ms){const Jr=Cn.y-si,To=new Dt(-Fi,Fi-Jr),Gl=-Math.PI/2,Za=new Dt(...Es);Vr=new Dt(-Fi+cs[0],cs[1]),Vr._rotateAround(Gl,To)._add(Za),Vr.x+=-Jr+Fi,Vr.y-=($i.left-Ti)*Cn.scale;const Ha=Cn.imageName?$i.advance*Cn.scale:Go*Cn.scale,cu=String.fromCharCode(Cn.glyph);ey(cu)?Vr.x+=(1-Ti)*Cn.scale:ny(cu)?Vr.x+=Ha-$i.height*Cn.scale+(-Ti-1)*Cn.scale:Vr.x+=Cn.imageName||$i.width+2*Ti===$r.w&&$i.height+2*Ti===$r.h?(Ha-Xa)/2:(Ha-($i.height+2*Ti)*Cn.scale)/2,ta=new Dt(Vr.x,Vr.y-co),Vo=new Dt(Vr.x+Xa,Vr.y),xr=new Dt(Vr.x+Xa,Vr.y-co)}else{const Jr=($i.left-Ti)*Cn.scale-Fi+cs[0],To=(-$i.top-Ti)*Cn.scale+cs[1],Gl=Jr+co,Za=To+Xa;Vr=new Dt(Jr,To),ta=new Dt(Gl,To),Vo=new Dt(Jr,Za),xr=new Dt(Gl,Za)}if(Ye){let Jr;Jr=Ie?new Dt(0,0):As?new Dt(on[0],on[1]):new Dt(qt[0],qt[1]),Vr._rotateAround(Ye,Jr),ta._rotateAround(Ye,Jr),Vo._rotateAround(Ye,Jr),xr._rotateAround(Ye,Jr)}const Zs=new Dt(0,0),ma=new Dt(0,0);Ze.push({tl:Vr,tr:ta,bl:Vo,br:xr,tex:li,writingMode:ne.writingMode,glyphOffset:ws,sectionIndex:Cn.sectionIndex,isSDF:Li,pixelOffsetTL:Zs,pixelOffsetBR:ma,minFontScaleX:0,minFontScaleY:0})}}return Ze})(0,c,I,y,x,E,p,r.allowVerticalPlacement),Wt=r.textSizeData;let Ot=null;Wt.kind==="source"?(Ot=[Zu*y.layout.get("text-size").evaluate(E,{},wt)],Ot[0]>lh&&lr(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Wt.kind==="composite"&&(Ot=[Zu*Q.compositeTextSizes[0].evaluate(E,{},wt),Zu*Q.compositeTextSizes[1].evaluate(E,{},wt)],(Ot[0]>lh||Ot[1]>lh)&&lr(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,zt,Ot,I,x,E,O,e,s,M.lineStartIndex,M.lineLength,$,at,wt);for(const Vt of k)U[Vt]=r.text.placedSymbolArray.length-1;return 4*zt.length}function _m(r){for(const e in r)return r[e];return null}function ad(r,e,s,c,p,y,x,E,I,M){let O=x.top,k=x.bottom,U=x.left,$=x.right;const Q=x.collisionPadding;if(Q&&(U-=Q[0],O-=Q[1],$+=Q[2],k+=Q[3]),I){const at=new Dt(U,O),wt=new Dt($,O),zt=new Dt(U,k),Wt=new Dt($,k),Ot=ie(I);let Vt=new Dt(0,0);M&&(Vt=new Dt(M[0],M[1])),at._rotateAround(Ot,Vt),wt._rotateAround(Ot,Vt),zt._rotateAround(Ot,Vt),Wt._rotateAround(Ot,Vt),U=Math.min(at.x,wt.x,zt.x,Wt.x),$=Math.max(at.x,wt.x,zt.x,Wt.x),O=Math.min(at.y,wt.y,zt.y,Wt.y),k=Math.max(at.y,wt.y,zt.y,Wt.y)}return r.emplaceBack(e.x,e.y,e.z,s.x,s.y,U,O,$,k,E,c,p,y),r.length-1}function Hd(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const e=r.bottom-r.top;return e>0?Math.max(10,e):null}function vm(r,e,s,c){const p=r.compareText;if(e in p){const y=p[e];for(let x=y.length-1;x>=0;x--)if(c.dist(y[x])<s)return!0}else p[e]=[];return p[e].push(c),!1}const xm=tn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Yd}=xm,ng=tn([{name:"a_pos_3",components:3,type:"Int16"}]);var wf=tn([{name:"a_pos",type:"Int16",components:2}]);const Hu=ai/Math.PI/2,ig=2*Cu(1,0)*Hu*Math.PI,Ef=64,uh=[Ef,32,16],Ou=-Hu,lu=Hu,rg=[new Eo([Ou,Ou,Ou],[lu,lu,lu]),new Eo([Ou,Ou,Ou],[0,0,lu]),new Eo([0,Ou,Ou],[lu,0,lu]),new Eo([Ou,0,Ou],[0,lu,lu]),new Eo([0,0,Ou],[lu,lu,lu])];function sg(r,e,s,c=!0){const p=ko([],r._camera.position,r.worldSize),y=[e,s,1,1];th(y,y,r.pixelMatrixInverse),Ap(y,y,1/y[3]);const x=Aa([],Ar([],y,p)),E=r.globeMatrix,I=[E[12],E[13],E[14]],M=Ar([],I,p),O=Hh(M),k=Aa([],M),U=r.worldSize/(2*Math.PI),$=Au(k,x),Q=Math.asin(U/O);if(Q<Math.acos($)){if(!c)return null;const cn=[],Ne=[];ko(cn,x,O/$),Aa(Ne,Ar(Ne,cn,M)),Aa(x,wc(x,M,ko(x,Ne,Math.tan(Q)*O)))}const at=[];new yl(p,x).closestPointOnSphere(I,U,at);const wt=Aa([],Us(E,0)),zt=Aa([],Us(E,1)),Wt=Aa([],Us(E,2)),Ot=Au(wt,at),Vt=Au(zt,at),ne=Au(Wt,at),qt=Yt(Math.asin(-Vt/U));let Me=Yt(Math.atan2(Ot,ne));Me=r.center.lng+(function(cn,Ne){const Ze=(Ne-cn+180)%360-180;return Ze<-180?Ze+360:Ze})(r.center.lng,Me);const Ie=rc(Me),Ge=ct(sc(qt),0,1);return new Xh(Ie,Ge)}class og{constructor(e,s,c){this.a=Ar([],e,c),this.b=Ar([],s,c),this.center=c;const p=Aa([],this.a),y=Aa([],this.b);this.angle=Math.acos(Au(p,y))}}function Lc(r,e){if(r.angle===0)return null;let s;return s=r.a[e]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[e]/r.a[e]/Math.sin(r.angle)-1/Math.tan(r.angle)),s<0||s>1?null:(function(c,p,y,x){const E=Math.sin(y);return c*(Math.sin((1-x)*y)/E)+p*(Math.sin(x*y)/E)})(r.a[e],r.b[e],r.angle,ct(s,0,1))+r.center[e]}function ja(r){if(r.z<=1)return rg[r.z+2*r.y+r.x];const e=$d(Wd(r));return Eo.fromPoints(e)}function uu(r,e,s){return ko(r,r,1-s),to(r,r,e,s)}function Sf(r,e){const s=Fh(e.zoom);if(s===0)return ja(r);const c=Wd(r),p=$d(c),y=rc(c.getWest())*e.worldSize,x=rc(c.getEast())*e.worldSize,E=sc(c.getNorth())*e.worldSize,I=sc(c.getSouth())*e.worldSize,M=[y,E,0],O=[x,E,0],k=[y,I,0],U=[x,I,0],$=wh([],e.globeMatrix);return wo(M,M,$),wo(O,O,$),wo(k,k,$),wo(U,U,$),p[0]=uu(p[0],k,s),p[1]=uu(p[1],U,s),p[2]=uu(p[2],O,s),p[3]=uu(p[3],M,s),Eo.fromPoints(p)}function Tf(r,e,s){for(const c of r)wo(c,c,e),ko(c,c,s)}function ch(r,e,s){const c=e/r.worldSize,p=r.globeMatrix;if(s.z<=1){const Ie=ja(s).getCorners();return Tf(Ie,p,c),Eo.fromPoints(Ie)}const y=Wd(s),x=$d(y);Tf(x,p,c);const E=Number.MAX_VALUE,I=[-E,-E,-E],M=[E,E,E];if(y.contains(r.center)){for(const cn of x)Qc(M,M,cn),Yh(I,I,cn);I[2]=0;const Ie=r.point,Ge=[Ie.x*c,Ie.y*c,0];return Qc(M,M,Ge),Yh(I,I,Ge),new Eo(M,I)}const O=[p[12]*c,p[13]*c,p[14]*c],k=y.getCenter(),U=ct(r.center.lat,-85.051129,oc),$=ct(k.lat,-85.051129,oc),Q=rc(r.center.lng),at=sc(U);let wt=Q-rc(k.lng);const zt=at-sc($);wt>.5?wt-=1:wt<-.5&&(wt+=1);let Wt=0;Math.abs(wt)>Math.abs(zt)?Wt=wt>=0?1:3:(Wt=zt>=0?0:2,to(O,O,[p[4]*c,p[5]*c,p[6]*c],-Math.sin(ie(zt>=0?y.getSouth():y.getNorth()))*Hu));const Ot=x[Wt],Vt=x[(Wt+1)%4],ne=new og(Ot,Vt,O),qt=[Lc(ne,0)||Ot[0],Lc(ne,1)||Ot[1],Lc(ne,2)||Ot[2]],Me=Fh(r.zoom);if(Me>0){const Ie=(function({x:cn,y:Ne,z:Ze},Ye,on,hn,Oe){const En=1/(1<<Ze);let si=cn*En,Ln=si+En,qn=Ne*En,Cn=qn+En,li=0;const Ti=(si+Ln)/2-hn;return Ti>.5?li=-1:Ti<-.5&&(li=1),si=((si+li)*Ye-(hn*=Ye))*on+hn,Ln=((Ln+li)*Ye-hn)*on+hn,qn=(qn*Ye-(Oe*=Ye))*on+Oe,Cn=(Cn*Ye-Oe)*on+Oe,[[si,Cn,0],[Ln,Cn,0],[Ln,qn,0],[si,qn,0]]})(s,e,r._pixelsPerMercatorPixel,Q,at);for(let cn=0;cn<x.length;cn++)uu(x[cn],Ie[cn],Me);const Ge=wc([],Ie[Wt],Ie[(Wt+1)%4]);ko(Ge,Ge,.5),uu(qt,Ge,Me)}for(const Ie of x)Qc(M,M,Ie),Yh(I,I,Ie);return M[2]=Math.min(Ot[2],Vt[2]),Qc(M,M,qt),Yh(I,I,qt),new Eo(M,I)}function Wd({x:r,y:e,z:s}){const c=1/(1<<s),p=new fr(ml(r*c),fa((e+1)*c)),y=new fr(ml((r+1)*c),fa(e*c));return new xc(p,y)}function $d(r){const e=ie(r.getNorth()),s=ie(r.getSouth()),c=Math.cos(e),p=Math.cos(s),y=Math.sin(e),x=Math.sin(s),E=r.getWest(),I=r.getEast();return[Rc(p,x,E),Rc(p,x,I),Rc(c,y,I),Rc(c,y,E)]}function Rc(r,e,s,c=Hu){return s=ie(s),[r*Math.sin(s)*c,-e*c,r*Math.cos(s)*c]}function ld(r,e,s){return Rc(Math.cos(ie(r)),Math.sin(ie(r)),e,s)}function Cf(r,e,s,c){const p=1<<s.z,y=(r/ai+s.x)/p;return ld(fa((e/ai+s.y)/p),ml(y),c)}function Bh({min:r,max:e}){return 16383/Math.max(e[0]-r[0],e[1]-r[1],e[2]-r[2])}const ag=new Float64Array(16);function ud(r){const e=Bh(r),s=Gc(ag,[e,e,e]);return Zf(s,s,((c=[])[0]=-(p=r.min)[0],c[1]=-p[1],c[2]=-p[2],c));var c,p}function If(r){const e=(c=r.min,(s=ag)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=c[0],s[13]=c[1],s[14]=c[2],s[15]=1,s);var s,c;const p=1/Bh(r);return Eh(e,e,[p,p,p])}function cd(r,e,s,c,p){const y=(function(I){const M=ai/(2*Math.PI);return I/(2*Math.PI)/M})(s),x=[r,e,-s/(2*Math.PI)],E=Mu(new Float64Array(16));return Zf(E,E,x),Eh(E,E,[y,y,y]),Ed(E,E,ie(-p)),Jc(E,E,ie(-c)),E}function Fh(r){return kt(5,6,r)}function kh(r,e){const s=ld(e.lat,e.lng),c=(function(Q){const at=ld(Q._center.lat,Q._center.lng);let wt=Qo([],Kc(0,1,0),at);const zt=Ip([],-Q.angle,at);wt=wo(wt,wt,zt),Ip(zt,-Q._pitch,wt);const Wt=Aa([],at);return ko(Wt,Wt,Q.cameraToCenterDistance/Q.pixelsPerMeter*ig),wo(Wt,Wt,zt),wc([],at,Wt)})(r);return x=(p=Hf([],c,s))[0],E=p[1],I=p[2],M=(y=s)[0],O=y[1],k=y[2],$=(U=Math.sqrt(x*x+E*E+I*I)*Math.sqrt(M*M+O*O+k*k))&&Au(p,y)/U,Math.acos(Math.min(Math.max($,-1),1));var p,y,x,E,I,M,O,k,U,$}const lg=ie(85),ug=Math.cos(lg),Jd=Math.sin(lg);function cg(r,e){const s=r.fovAboveCenter,c=r.elevation?r.elevation.getMinElevationBelowMSL()*e:0,p=(r._camera.position[2]*r.worldSize-c)/Math.cos(r._pitch),y=Math.sin(s)*p/Math.sin(Math.max(Math.PI/2-r._pitch-s,.01)),x=Math.sin(r._pitch)*y+p;return Math.min(1.01*x,p*(1/r._horizonShift))}function Uh(r,e){if(!e.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:e};const s=Math.pow(2,-r.z),c=r.x*s,p=(r.x+1)*s,y=r.y*s,x=(r.y+1)*s,E=ml(c),I=ml(p),M=fa(y),O=fa(x),k=e.project(E,M),U=e.project(I,M),$=e.project(I,O),Q=e.project(E,O);let at=Math.min(k.x,U.x,$.x,Q.x),wt=Math.min(k.y,U.y,$.y,Q.y),zt=Math.max(k.x,U.x,$.x,Q.x),Wt=Math.max(k.y,U.y,$.y,Q.y);const Ot=s/16;function Vt(qt,Me,Ie,Ge,cn,Ne){const Ze=(Ie+cn)/2,Ye=(Ge+Ne)/2,on=e.project(ml(Ze),fa(Ye)),hn=Math.max(0,at-on.x,wt-on.y,on.x-zt,on.y-Wt);at=Math.min(at,on.x),zt=Math.max(zt,on.x),wt=Math.min(wt,on.y),Wt=Math.max(Wt,on.y),hn>Ot&&(Vt(qt,on,Ie,Ge,Ze,Ye),Vt(on,Me,Ze,Ye,cn,Ne))}Vt(k,U,c,y,p,y),Vt(U,$,p,y,p,x),Vt($,Q,p,x,c,x),Vt(Q,k,c,x,c,y),at-=Ot,wt-=Ot,zt+=Ot,Wt+=Ot;const ne=1/Math.max(zt-at,Wt-wt);return{scale:ne,x:at*ne,y:wt*ne,x2:zt*ne,y2:Wt*ne,projection:e}}const Kd=Mu(new Float32Array(16));class a{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,s){return{x:0,y:0,z:0}}unproject(e,s){return new fr(0,0)}projectTilePoint(e,s,c){return{x:e,y:s,z:0}}locationPoint(e,s,c=!0){return e._coordinatePoint(e.locationCoordinate(s),c)}pixelsPerMeter(e,s){return Cu(1,e)*s}pixelSpaceConversion(e,s,c){return 1}farthestPixelDistance(e){return cg(e,e.pixelsPerMeter)}pointCoordinate(e,s,c,p){const y=e.horizonLineFromTop(!1),x=new Dt(s,Math.max(y,c));return e.rayIntersectionCoordinate(e.pointRayIntersection(x,p))}pointCoordinate3D(e,s,c){const p=new Dt(s,c);if(e.elevation)return e.elevation.pointCoordinate(p);{const y=this.pointCoordinate(e,p.x,p.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(e,s){if(e.elevation)return!this.pointCoordinate3D(e,s.x,s.y);const c=e.horizonLineFromTop();return s.y<c}createInversionMatrix(e,s){return Kd}createTileMatrix(e,s,c){let p,y,x;const E=c.canonical,I=Mu(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=Uh(E,this);p=1,y=M.x+c.wrap*M.scale,x=M.y,Eh(I,I,[p/M.scale,p/M.scale,e.pixelsPerMeter/s])}else p=s/e.zoomScale(E.z),y=(E.x+Math.pow(2,E.z)*c.wrap)*p,x=E.y*p;return Zf(I,I,[y,x,0]),Eh(I,I,[p/ai,p/ai,1]),I}upVector(e,s,c){return[0,0,1]}upVectorScale(e,s,c){return{metersToTile:1}}}class u extends a{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[s,c]=this.parallels=e.parallels||[29.5,45.5],p=Math.sin(ie(s));this.n=(p+Math.sin(ie(c)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(e,s){const{n:c,c:p,r0:y}=this,x=ie(e-this.center[0]),E=ie(s),I=Math.sqrt(p-2*c*Math.sin(E))/c;return{x:I*Math.sin(x*c),y:I*Math.cos(x*c)-y,z:0}}unproject(e,s){const{n:c,c:p,r0:y}=this,x=y+s;let E=Math.atan2(e,Math.abs(x))*Math.sign(x);x*c<0&&(E-=Math.PI*Math.sign(e)*Math.sign(x));const I=ie(this.center[0])*c;E=ut(E,-Math.PI-I,Math.PI-I);const M=ct(Yt(E/c)+this.center[0],-180,180),O=Math.asin(ct((p-(e*e+x*x)*c*c)/(2*c),-1,1)),k=ct(Yt(O),-85.051129,oc);return new fr(M,k)}}const g=1.340264,b=-.081106,A=893e-6,D=.003796,K=Math.sqrt(3)/2;class bt extends a{project(e,s){s=s/180*Math.PI,e=e/180*Math.PI;const c=Math.asin(K*Math.sin(s)),p=c*c,y=p*p*p;return{x:.5*(e*Math.cos(c)/(K*(g+3*b*p+y*(7*A+9*D*p)))/Math.PI+.5),y:1-.5*(c*(g+b*p+y*(A+D*p))/Math.PI+1),z:0}}unproject(e,s){e=(2*e-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,p=c*c,y=p*p*p;for(let O,k,U,$=0;$<12&&(k=c*(g+b*p+y*(A+D*p))-s,U=g+3*b*p+y*(7*A+9*D*p),O=k/U,c=ct(c-O,-Math.PI/3,Math.PI/3),p=c*c,y=p*p*p,!(Math.abs(O)<1e-12));++$);const x=K*e*(g+3*b*p+y*(7*A+9*D*p))/Math.cos(c),E=Math.asin(Math.sin(c)/K),I=ct(180*x/Math.PI,-180,180),M=ct(180*E/Math.PI,-85.051129,oc);return new fr(I,M)}}class ee extends a{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,s){return{x:.5+e/360,y:.5-s/360,z:0}}unproject(e,s){const c=360*(e-.5),p=ct(360*(.5-s),-85.051129,oc);return new fr(c,p)}}const Le=Math.PI/2;function He(r){return Math.tan((Le+r)/2)}class ln extends a{constructor(e){super(e),this.center=e.center||[0,30];const[s,c]=this.parallels=e.parallels||[30,30];let p=ie(s),y=ie(c);this.southernCenter=p+y<0,this.southernCenter&&(p=-p,y=-y);const x=Math.cos(p),E=He(p);this.n=p===y?Math.sin(p):Math.log(x/Math.cos(y))/Math.log(He(y)/E),this.f=x*Math.pow(He(p),this.n)/this.n}project(e,s){s=ie(s),this.southernCenter&&(s=-s),e=ie(e-this.center[0]);const c=1e-6,{n:p,f:y}=this;y>0?s<-Le+c&&(s=-Le+c):s>Le-c&&(s=Le-c);const x=y/Math.pow(He(s),p);let E=x*Math.sin(p*e),I=y-x*Math.cos(p*e);return E=.5*(E/Math.PI+.5),I=.5*(I/Math.PI+.5),{x:E,y:this.southernCenter?I:1-I,z:0}}unproject(e,s){e=(2*e-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f:p}=this,y=p-s,x=Math.sign(y),E=Math.sign(c)*Math.sqrt(e*e+y*y);let I=Math.atan2(e,Math.abs(y))*x;y*c<0&&(I-=Math.PI*Math.sign(e)*x);const M=ct(Yt(I/c)+this.center[0],-180,180),O=ct(Yt(2*Math.atan(Math.pow(p/E,1/c))-Le),-85.051129,oc);return new fr(M,this.southernCenter?-O:O)}}class ze extends a{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,s){return{x:rc(e),y:sc(s),z:0}}unproject(e,s){const c=ml(e),p=fa(s);return new fr(c,p)}}const Ue=ie(oc);class ti extends a{project(e,s){const c=(s=ie(s))*s,p=c*c;return{x:.5*((e=ie(e))*(.8707-.131979*c+p*(p*(.003971*c-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+p*(.028874*c-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(e,s){e=(2*e-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,p=25,y=0,x=c*c;do{x=c*c;const M=x*x;y=(c*(1.007226+x*(.015085+M*(.028874*x-.044475-.005916*M)))-s)/(1.007226+x*(.045255+M*(.259866*x-.311325-.005916*11*M))),c=ct(c-y,-Ue,Ue)}while(Math.abs(y)>1e-6&&--p>0);x=c*c;const E=ct(Yt(e/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),I=Yt(c);return new fr(E,I)}}const Si=ie(oc);class bs extends a{project(e,s){s=ie(s),e=ie(e);const c=Math.cos(s),p=2/Math.PI,y=Math.acos(c*Math.cos(e/2)),x=Math.sin(y)/y,E=.5*(e*p+2*c*Math.sin(e/2)/x)||0,I=.5*(s+Math.sin(s)/x)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(I/Math.PI+1),z:0}}unproject(e,s){let c=e=(2*e-.5)*Math.PI,p=s=(2*(1-s)-1)*Math.PI,y=25;const x=1e-6;let E=0,I=0;do{const M=Math.cos(p),O=Math.sin(p),k=2*O*M,U=O*O,$=M*M,Q=Math.cos(c/2),at=Math.sin(c/2),wt=2*Q*at,zt=at*at,Wt=1-$*Q*Q,Ot=Wt?1/Wt:0,Vt=Wt?Math.acos(M*Q)*Math.sqrt(1/Wt):0,ne=.5*(2*Vt*M*at+2*c/Math.PI)-e,qt=.5*(Vt*O+p)-s,Me=.5*Ot*($*zt+Vt*M*Q*U)+1/Math.PI,Ie=Ot*(wt*k/4-Vt*O*at),Ge=.125*Ot*(k*at-Vt*O*$*wt),cn=.5*Ot*(U*Q+Vt*zt*M)+.5,Ne=Ie*Ge-cn*Me;E=(qt*Ie-ne*cn)/Ne,I=(ne*Ge-qt*Me)/Ne,c=ct(c-E,-Math.PI,Math.PI),p=ct(p-I,-Si,Si)}while((Math.abs(E)>x||Math.abs(I)>x)&&--y>0);return new fr(Yt(c),Yt(p))}}class Te extends a{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ie(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,s){const{scale:c,cosPhi:p}=this;return{x:ie(e)*p*c+.5,y:-Math.sin(ie(s))/p*c+.5,z:0}}unproject(e,s){const{scale:c,cosPhi:p}=this,y=-(s-.5)/c,x=ct(Yt((e-.5)/c)/p,-180,180),E=Math.asin(ct(y*p,-1,1)),I=ct(Yt(E),-85.051129,oc);return new fr(x,I)}}class he extends ze{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,s,c){const p=Cf(e,s,c);return wo(p,p,ud(ja(c))),{x:p[0],y:p[1],z:p[2]}}locationPoint(e,s){const c=ld(s.lat,s.lng),p=Aa([],c),y=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(s),e._centerAltitude):e._centerAltitude;to(c,c,p,Cu(1,0)*ai*y);const x=Mu(new Float64Array(16));return is(x,e.pixelMatrix,e.globeMatrix),wo(c,c,x),new Dt(c[0],c[1])}pixelsPerMeter(e,s){return Cu(1,0)*s}pixelSpaceConversion(e,s,c){const p=Cu(1,e)*s,y=Ii(Cu(1,45)*s,p,c);return this.pixelsPerMeter(e,s)/y}createTileMatrix(e,s,c){const p=If(ja(c.canonical));return is(new Float64Array(16),e.globeMatrix,p)}createInversionMatrix(e,s){const{center:c}=e,p=ud(ja(s));return Jc(p,p,ie(c.lng)),Ed(p,p,ie(c.lat)),Eh(p,p,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(e,s,c,p){return sg(e,s,c,!0)||new Xh(0,0)}pointCoordinate3D(e,s,c){const p=this.pointCoordinate(e,s,c,0);return[p.x,p.y,p.z]}isPointAboveHorizon(e,s){return!sg(e,s.x,s.y,!1)}farthestPixelDistance(e){const s=(function(p,y){const x=p.cameraToCenterDistance,E=p._centerAltitude*y,I=p._camera,M=p._camera.forward(),O=wc([],ko([],M,-x),[0,0,E]),k=p.worldSize/(2*Math.PI),U=[0,0,-k],$=p.width/p.height,Q=Math.tan(p.fovAboveCenter),at=ko([],I.up(),Q),wt=ko([],I.right(),Q*$),zt=Aa([],wc([],wc([],M,at),wt)),Wt=[];let Ot;if(new yl(O,zt).closestPointOnSphere(U,k,Wt)){const Vt=wc([],Wt,U),ne=Ar([],Vt,O);Ot=Math.cos(p.fovAboveCenter)*Hh(ne)}else{const Vt=Ar([],O,U),ne=Ar([],U,O);Aa(ne,ne);const qt=Hh(Vt)-k;Ot=Math.sqrt(qt*(qt+2*k));const Me=Math.acos(Ot/(k+qt))-Math.acos(Au(M,ne));Ot*=Math.cos(Me)}return 1.01*Ot})(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),c=Fh(e.zoom);if(c>0){const p=cg(e,Cu(1,e.center.lat)*e.worldSize),y=e.worldSize/(2*Math.PI),x=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Ii(s,p+y*(1-Math.cos(x)),Math.pow(c,10))}return s}upVector(e,s,c){return Cf(s,c,e,1)}upVectorScale(e){return{metersToTile:ig*Bh(ja(e))}}}function Re(r){const e=r.parallels,s=!!e&&Math.abs(e[0]+e[1])<.01;switch(r.name){case"mercator":return new ze(r);case"equirectangular":return new ee(r);case"naturalEarth":return new ti(r);case"equalEarth":return new bt(r);case"winkelTripel":return new bs(r);case"albers":return s?new Te(r):new u(r);case"lambertConformalConic":return s?new Te(r):new ln(r);case"globe":return new he(r)}throw new Error(`Invalid projection name: ${r.name}`)}const sn=jc.types,mi=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sr(r,e,s,c,p,y,x,E,I,M,O,k,U){const $=E?Math.min(lh,Math.round(E[0])):0,Q=E?Math.min(lh,Math.round(E[1])):0;r.emplaceBack(e,s,Math.round(32*c),Math.round(32*p),y,x,($<<1)+(I?1:0),Q,16*M,16*O,256*k,256*U)}function ni(r,e,s,c,p,y,x){r.emplaceBack(e,s,c,p,y,x)}function Zi(r,e,s,c,p){r.emplaceBack(e,s,c,p),r.emplaceBack(e,s,c,p),r.emplaceBack(e,s,c,p),r.emplaceBack(e,s,c,p)}function vr(r){for(const e of r.sections)if(Z(e.text))return!0;return!1}class Rr{constructor(e){this.layoutVertexArray=new Wr,this.indexArray=new Bo,this.programConfigurations=e,this.segments=new Qs,this.dynamicLayoutVertexArray=new Xs,this.opacityVertexArray=new Is,this.placedSymbolArray=new W,this.globeExtVertexArray=new nr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,s,c,p){this.isEmpty()||(c&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jm.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,sd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,mi,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Km.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||p)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}dn(Rr,"SymbolBuffers");class Dc{constructor(e,s,c){this.layoutVertexArray=new e,this.layoutAttributes=s,this.indexArray=new c,this.segments=new Qs,this.collisionVertexArray=new Ol,this.collisionVertexArrayExt=new Ia}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Qm.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,tm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}dn(Dc,"CollisionBuffers");class hh{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((x=>x.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Mu([]),this.placementViewportMatrix=Mu([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fd(this.zoom,s["text-size"]),this.iconSizeData=Fd(this.zoom,s["icon-size"]);const c=this.layers[0].layout,p=c.get("symbol-sort-key"),y=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map((x=>Ul[x])),this.stateDependentLayerIds=this.layers.filter((x=>x.isStateDependent())).map((x=>x.id)),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Rr(new vh(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new Rr(new vh(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new Se,this.lineVertexArray=new Ae,this.symbolInstances=new Bt}calculateGlyphDependencies(e,s,c,p,y){for(let x=0;x<e.length;x++)if(s[e.charCodeAt(x)]=!0,p&&y){const E=cf[e.charAt(x)];E&&(s[E.charCodeAt(0)]=!0)}}populate(e,s,c,p){const y=this.layers[0],x=y.layout,E=this.projection.name==="globe",I=x.get("text-font"),M=x.get("text-field"),O=x.get("icon-image"),k=(M.value.kind!=="constant"||M.value.value instanceof Pn&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),U=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,$=x.get("symbol-sort-key");if(this.features=[],!k&&!U)return;const Q=s.iconDependencies,at=s.glyphDependencies,wt=s.availableImages,zt=new Nt(this.zoom);for(const{feature:Wt,id:Ot,index:Vt,sourceLayerIndex:ne}of e){const qt=y._featureFilter.needGeometry,Me=$c(Wt,qt);if(!y._featureFilter.filter(zt,Me,c))continue;if(qt||(Me.geometry=Iu(Wt,c,p)),E&&Wt.type!==1&&c.z<=5){const Ne=Me.geometry,Ze=.98078528056,Ye=(on,hn)=>Au(Cf(on.x,on.y,c,1),Cf(hn.x,hn.y,c,1))<Ze;for(let on=0;on<Ne.length;on++)Ne[on]=Mg(Ne[on],Ye)}let Ie,Ge;if(k){const Ne=y.getValueAndResolveTokens("text-field",Me,c,wt),Ze=Pn.factory(Ne);vr(Ze)&&(this.hasRTLText=!0),(!this.hasRTLText||Tt()==="unavailable"||this.hasRTLText&&Gt.isParsed())&&(Ie=ty(Ze,y,Me))}if(U){const Ne=y.getValueAndResolveTokens("icon-image",Me,c,wt);Ge=Ne instanceof Ni?Ne:Ni.fromString(Ne)}if(!Ie&&!Ge)continue;const cn=this.sortFeaturesByKey?$.evaluate(Me,{},c):void 0;if(this.features.push({id:Ot,text:Ie,icon:Ge,index:Vt,sourceLayerIndex:ne,geometry:Me.geometry,properties:Wt.properties,type:sn[Wt.type],sortKey:cn}),Ge&&(Q[Ge.name]=!0),Ie){const Ne=I.evaluate(Me,{},c).join(","),Ze=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ul.vertical)>=0;for(const Ye of Ie.sections)if(Ye.image)Q[Ye.image.name]=!0;else{const on=f(Ie.toString()),hn=Ye.fontStack||Ne,Oe=at[hn]=at[hn]||{};this.calculateGlyphDependencies(Ye.text,Oe,Ze,this.allowVerticalPlacement,on)}}}x.get("symbol-placement")==="line"&&(this.features=(function(Wt){const Ot={},Vt={},ne=[];let qt=0;function Me(Ne){ne.push(Wt[Ne]),qt++}function Ie(Ne,Ze,Ye){const on=Vt[Ne];return delete Vt[Ne],Vt[Ze]=on,ne[on].geometry[0].pop(),ne[on].geometry[0]=ne[on].geometry[0].concat(Ye[0]),on}function Ge(Ne,Ze,Ye){const on=Ot[Ze];return delete Ot[Ze],Ot[Ne]=on,ne[on].geometry[0].shift(),ne[on].geometry[0]=Ye[0].concat(ne[on].geometry[0]),on}function cn(Ne,Ze,Ye){const on=Ye?Ze[0][Ze[0].length-1]:Ze[0][0];return`${Ne}:${on.x}:${on.y}`}for(let Ne=0;Ne<Wt.length;Ne++){const Ze=Wt[Ne],Ye=Ze.geometry,on=Ze.text?Ze.text.toString():null;if(!on){Me(Ne);continue}const hn=cn(on,Ye),Oe=cn(on,Ye,!0);if(hn in Vt&&Oe in Ot&&Vt[hn]!==Ot[Oe]){const En=Ge(hn,Oe,Ye),si=Ie(hn,Oe,ne[En].geometry);delete Ot[hn],delete Vt[Oe],Vt[cn(on,ne[si].geometry,!0)]=si,ne[En].geometry=null}else hn in Vt?Ie(hn,Oe,Ye):Oe in Ot?Ge(hn,Oe,Ye):(Me(Ne),Ot[hn]=qt-1,Vt[Oe]=qt-1)}return ne.filter((Ne=>Ne.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Wt,Ot)=>Wt.sortKey-Ot.sortKey))}update(e,s,c,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,s,this.layers,c,p),this.icon.programConfigurations.updatePaintArrays(e,s,this.layers,c,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Re(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,s){const c=this.lineVertexArray.length,p=e.segment;if(p!==void 0){let y=e.dist(s[p+1]),x=e.dist(s[p]);const E={};for(let I=p+1;I<s.length;I++)E[I]={x:s[I].x,y:s[I].y,tileUnitDistanceFromAnchor:y},I<s.length-1&&(y+=s[I+1].dist(s[I]));for(let I=p||0;I>=0;I--)E[I]={x:s[I].x,y:s[I].y,tileUnitDistanceFromAnchor:x},I>0&&(x+=s[I-1].dist(s[I]));for(let I=0;I<s.length;I++){const M=E[I];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(e,s,c,p,y,x,E,I,M,O,k,U,$,Q){const at=e.indexArray,wt=e.layoutVertexArray,zt=e.globeExtVertexArray,Wt=e.segments.prepareSegment(4*s.length,wt,at,this.canOverlap?x.sortKey:void 0),Ot=this.glyphOffsetArray.length,Vt=Wt.vertexLength,ne=this.allowVerticalPlacement&&E===Ul.vertical?Math.PI/2:0,qt=x.text&&x.text.sections;for(let Ie=0;Ie<s.length;Ie++){const{tl:Ge,tr:cn,bl:Ne,br:Ze,tex:Ye,pixelOffsetTL:on,pixelOffsetBR:hn,minFontScaleX:Oe,minFontScaleY:En,glyphOffset:si,isSDF:Ln,sectionIndex:qn}=s[Ie],Cn=Wt.vertexLength,li=si[1];if(Sr(wt,M.x,M.y,Ge.x,li+Ge.y,Ye.x,Ye.y,c,Ln,on.x,on.y,Oe,En),Sr(wt,M.x,M.y,cn.x,li+cn.y,Ye.x+Ye.w,Ye.y,c,Ln,hn.x,on.y,Oe,En),Sr(wt,M.x,M.y,Ne.x,li+Ne.y,Ye.x,Ye.y+Ye.h,c,Ln,on.x,hn.y,Oe,En),Sr(wt,M.x,M.y,Ze.x,li+Ze.y,Ye.x+Ye.w,Ye.y+Ye.h,c,Ln,hn.x,hn.y,Oe,En),I){const Ti=I.anchor,Li=I.up;ni(zt,Ti.x,Ti.y,Ti.z,Li[0],Li[1],Li[2]),ni(zt,Ti.x,Ti.y,Ti.z,Li[0],Li[1],Li[2]),ni(zt,Ti.x,Ti.y,Ti.z,Li[0],Li[1],Li[2]),ni(zt,Ti.x,Ti.y,Ti.z,Li[0],Li[1],Li[2]),Zi(e.dynamicLayoutVertexArray,Ti.x,Ti.y,Ti.z,ne)}else Zi(e.dynamicLayoutVertexArray,M.x,M.y,M.z,ne);at.emplaceBack(Cn,Cn+1,Cn+2),at.emplaceBack(Cn+1,Cn+2,Cn+3),Wt.vertexLength+=4,Wt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(si[0]),Ie!==s.length-1&&qn===s[Ie+1].sectionIndex||e.programConfigurations.populatePaintArrays(wt.length,x,x.index,{},$,Q,qt&&qt[qn])}const Me=I?I.anchor:M;e.placedSymbolArray.emplaceBack(Me.x,Me.y,Me.z,M.x,M.y,Ot,this.glyphOffsetArray.length-Ot,Vt,O,k,M.segment,c?c[0]:0,c?c[1]:0,p[0],p[1],E,0,!1,0,U,0)}_commitLayoutVertex(e,s,c,p,y,x,E){e.emplaceBack(s,c,p,y,x,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(e,s,c,p,y,x,E){const I=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),M=I.vertexLength,O=E.tileAnchorX,k=E.tileAnchorY;for(let $=0;$<4;$++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(s,-e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(s,e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(s,e.padding,e.padding),c.collisionVertexArrayExt.emplaceBack(s,-e.padding,e.padding),this._commitLayoutVertex(c.layoutVertexArray,p,y,x,O,k,new Dt(e.x1,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,p,y,x,O,k,new Dt(e.x2,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,p,y,x,O,k,new Dt(e.x2,e.y2)),this._commitLayoutVertex(c.layoutVertexArray,p,y,x,O,k,new Dt(e.x1,e.y2)),I.vertexLength+=4;const U=c.indexArray;U.emplaceBack(M,M+1),U.emplaceBack(M+1,M+2),U.emplaceBack(M+2,M+3),U.emplaceBack(M+3,M),I.primitiveLength+=4}_addTextDebugCollisionBoxes(e,s,c,p,y,x){for(let E=p;E<y;E++){const I=c.get(E),M=this.getSymbolInstanceTextSize(e,x,s,E);this._addCollisionDebugVertices(I,M,this.textCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(e,s,c,p,y,x){for(let E=p;E<y;E++){const I=c.get(E),M=this.getSymbolInstanceIconSize(e,s,x.placedIconSymbolIndex);this._addCollisionDebugVertices(I,M,this.iconCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,x)}}generateCollisionDebugBuffers(e,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dc(xi,dr.members,gl),this.iconCollisionBox=new Dc(xi,dr.members,gl);const c=Mc(this.iconSizeData,e),p=Mc(this.textSizeData,e);for(let y=0;y<this.symbolInstances.length;y++){const x=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(p,e,s,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(p,e,s,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(c,e,s,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(c,e,s,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(e,s,c,p){const y=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:p),x=uf(this.textSizeData,e,y)/Go;return this.tilePixelRatio*x}getSymbolInstanceIconSize(e,s,c){const p=this.icon.placedSymbolArray.get(c),y=uf(this.iconSizeData,e,p);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(e,s,c){e.emplaceBack(s,-c,-c),e.emplaceBack(s,c,-c),e.emplaceBack(s,c,c),e.emplaceBack(s,-c,c)}_updateTextDebugCollisionBoxes(e,s,c,p,y,x){for(let E=p;E<y;E++){const I=c.get(E),M=this.getSymbolInstanceTextSize(e,x,s,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,I.padding)}}_updateIconDebugCollisionBoxes(e,s,c,p,y,x){for(let E=p;E<y;E++){const I=c.get(E),M=this.getSymbolInstanceIconSize(e,s,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,I.padding)}}updateCollisionDebugBuffers(e,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Mc(this.iconSizeData,e),p=Mc(this.textSizeData,e);for(let y=0;y<this.symbolInstances.length;y++){const x=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(p,e,s,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(p,e,s,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(c,e,s,x.iconBoxStartIndex,x.iconBoxEndIndex,x.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,e,s,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,s,c,p,y,x,E,I,M){const O={};for(let k=s;k<c;k++){const U=e.get(k);O.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},O.textFeatureIndex=U.featureIndex;break}for(let k=p;k<y;k++){const U=e.get(k);O.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},O.verticalTextFeatureIndex=U.featureIndex;break}for(let k=x;k<E;k++){const U=e.get(k);O.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},O.iconFeatureIndex=U.featureIndex;break}for(let k=I;k<M;k++){const U=e.get(k);O.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,padding:U.padding,projectedAnchorX:U.projectedAnchorX,projectedAnchorY:U.projectedAnchorY,projectedAnchorZ:U.projectedAnchorZ,tileAnchorX:U.tileAnchorX,tileAnchorY:U.tileAnchorY},O.verticalIconFeatureIndex=U.featureIndex;break}return O}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,s){const c=e.placedSymbolArray.get(s),p=c.vertexStartIndex+4*c.numGlyphs;for(let y=c.vertexStartIndex;y<p;y+=4)e.indexArray.emplaceBack(y,y+1,y+2),e.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(e),c=Math.cos(e),p=[],y=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const I=this.symbolInstances.get(E);p.push(0|Math.round(s*I.tileAnchorX+c*I.tileAnchorY)),y.push(I.featureIndex)}return x.sort(((E,I)=>p[E]-p[I]||y[I]-y[E])),x}addToSortKeyRanges(e,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach(((p,y,x)=>{p>=0&&x.indexOf(p)===y&&this.addIndicesForPlacedSymbol(this.text,p)})),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}dn(hh,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),hh.MAX_GLYPHS=65535,hh.addDynamicAttributes=Zi;const r1=new Xe({"symbol-placement":new ge(_e.layout_symbol["symbol-placement"]),"symbol-spacing":new ge(_e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ge(_e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qt(_e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ge(_e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ge(_e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ge(_e.layout_symbol["icon-ignore-placement"]),"icon-optional":new ge(_e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ge(_e.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qt(_e.layout_symbol["icon-size"]),"icon-text-fit":new ge(_e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ge(_e.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qt(_e.layout_symbol["icon-image"]),"icon-rotate":new Qt(_e.layout_symbol["icon-rotate"]),"icon-padding":new ge(_e.layout_symbol["icon-padding"]),"icon-keep-upright":new ge(_e.layout_symbol["icon-keep-upright"]),"icon-offset":new Qt(_e.layout_symbol["icon-offset"]),"icon-anchor":new Qt(_e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ge(_e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ge(_e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ge(_e.layout_symbol["text-rotation-alignment"]),"text-field":new Qt(_e.layout_symbol["text-field"]),"text-font":new Qt(_e.layout_symbol["text-font"]),"text-size":new Qt(_e.layout_symbol["text-size"]),"text-max-width":new Qt(_e.layout_symbol["text-max-width"]),"text-line-height":new Qt(_e.layout_symbol["text-line-height"]),"text-letter-spacing":new Qt(_e.layout_symbol["text-letter-spacing"]),"text-justify":new Qt(_e.layout_symbol["text-justify"]),"text-radial-offset":new Qt(_e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ge(_e.layout_symbol["text-variable-anchor"]),"text-anchor":new Qt(_e.layout_symbol["text-anchor"]),"text-max-angle":new ge(_e.layout_symbol["text-max-angle"]),"text-writing-mode":new ge(_e.layout_symbol["text-writing-mode"]),"text-rotate":new Qt(_e.layout_symbol["text-rotate"]),"text-padding":new ge(_e.layout_symbol["text-padding"]),"text-keep-upright":new ge(_e.layout_symbol["text-keep-upright"]),"text-transform":new Qt(_e.layout_symbol["text-transform"]),"text-offset":new Qt(_e.layout_symbol["text-offset"]),"text-allow-overlap":new ge(_e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ge(_e.layout_symbol["text-ignore-placement"]),"text-optional":new ge(_e.layout_symbol["text-optional"])});var uy={paint:new Xe({"icon-opacity":new Qt(_e.paint_symbol["icon-opacity"]),"icon-color":new Qt(_e.paint_symbol["icon-color"]),"icon-halo-color":new Qt(_e.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qt(_e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qt(_e.paint_symbol["icon-halo-blur"]),"icon-translate":new ge(_e.paint_symbol["icon-translate"]),"icon-translate-anchor":new ge(_e.paint_symbol["icon-translate-anchor"]),"text-opacity":new Qt(_e.paint_symbol["text-opacity"]),"text-color":new Qt(_e.paint_symbol["text-color"],{runtimeType:Ts,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Qt(_e.paint_symbol["text-halo-color"]),"text-halo-width":new Qt(_e.paint_symbol["text-halo-width"]),"text-halo-blur":new Qt(_e.paint_symbol["text-halo-blur"]),"text-translate":new ge(_e.paint_symbol["text-translate"]),"text-translate-anchor":new ge(_e.paint_symbol["text-translate-anchor"])}),layout:r1};class iv{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:kr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(e.formattedSection))return s.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn(iv,"FormatSectionOverride",{omit:["defaultValue"]});class bm extends qu{constructor(e){super(e,uy)}recalculate(e,s){super.recalculate(e,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const p=[];for(const y of c)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,s,c,p){const y=this.layout.get(e).evaluate(s,{},c,p),x=this._unevaluatedLayout._values[e];return x.isDataDriven()||Jl(x.value)||!y?y:(function(E,I){return I.replace(/{([^{}]+)}/g,((M,O)=>O in E?String(E[O]):""))})(s.properties,y)}createBucket(e){return new hh(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of uy.paint.overridableProperties){if(!bm.hasPaintOverride(this.layout,e))continue;const s=this.paint.get(e),c=new iv(s),p=new mu(c,s.property.specification);let y=null;y=s.value.kind==="constant"||s.value.kind==="source"?new Cl("source",p):new $s("composite",p,s.value.zoomStops,s.value._interpolationType),this.paint._values[e]=new Ve(s.property,y,s.parameters)}}_handleOverridablePaintPropertyUpdate(e,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&bm.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,s){const c=e.get("text-field"),p=uy.paint.properties[s];let y=!1;const x=E=>{for(const I of E)if(p.overrides&&p.overrides.hasOverride(I))return void(y=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Pn)x(c.value.value.sections);else if(c.value.kind==="source"){const E=M=>{y||(M instanceof xn&&kn(M.value)===Ur?x(M.value.sections):M instanceof ss?x(M.sections):M.eachChild(E))},I=c.value;I._styleExpression&&E(I._styleExpression.expression)}return y}getProgramConfiguration(e){return new Fc(this,e)}}var s1={paint:new Xe({"background-color":new ge(_e.paint_background["background-color"]),"background-pattern":new an(_e.paint_background["background-pattern"]),"background-opacity":new ge(_e.paint_background["background-opacity"])})},o1={paint:new Xe({"raster-opacity":new ge(_e.paint_raster["raster-opacity"]),"raster-hue-rotate":new ge(_e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ge(_e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ge(_e.paint_raster["raster-brightness-max"]),"raster-saturation":new ge(_e.paint_raster["raster-saturation"]),"raster-contrast":new ge(_e.paint_raster["raster-contrast"]),"raster-resampling":new ge(_e.paint_raster["raster-resampling"]),"raster-fade-duration":new ge(_e.paint_raster["raster-fade-duration"])})};class a1 extends qu{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var l1={paint:new Xe({"sky-type":new ge(_e.paint_sky["sky-type"]),"sky-atmosphere-sun":new ge(_e.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ge(_e.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ge(_e.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ge(_e.paint_sky["sky-gradient-radius"]),"sky-gradient":new Fe(_e.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ge(_e.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ge(_e.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ge(_e.paint_sky["sky-opacity"])})};function cy(r,e,s){const c=[0,0,1],p=Yf([]);return ju(p,p,s?-ie(r)+Math.PI:ie(r)),Pl(p,p,-ie(e)),Mp(c,c,p),Aa(c,c)}const u1={circle:class extends qu{constructor(r){super(r,qm)}createBucket(r){return new _p(r)}queryRadius(r){const e=r;return bh("circle-radius",this,e)+bh("circle-stroke-width",this,e)+Zh(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,s,c,p,y,x,E){const I=bc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,r.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(e,s)+this.paint.get("circle-stroke-width").evaluate(e,s);return Ec(r,c,y,x,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",I,M)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new Fc(this,r)}},heatmap:class extends qu{createBucket(r){return new Th(r)}constructor(r){super(r,Wf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Id({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return bh("heatmap-radius",this,r)}queryIntersectsFeature(r,e,s,c,p,y,x,E){const I=this.paint.get("heatmap-radius").evaluate(e,s);return Ec(r,c,y,x,E,!0,!0,new Dt(0,0),I)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new Fc(this,r)}},hillshade:class extends qu{constructor(r){super(r,Md)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends qu{constructor(r){super(r,Pg)}getProgramIds(){const r=this.paint.get("fill-pattern"),e=r&&r.constantOr(1),s=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(r){return new Fc(this,r)}recalculate(r,e){super.recalculate(r,e);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new ed(r)}queryRadius(){return Zh(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,s,c,p,y){return!r.queryGeometry.isAboveHorizon&&xp(Sp(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,r.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends qu{constructor(r){super(r,Wm)}createBucket(r){return new af(r)}queryRadius(){return Zh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new Fc(this,r)}queryIntersectsFeature(r,e,s,c,p,y,x,E,I){const M=bc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,r.pixelToTileUnitsFactor),O=this.paint.get("fill-extrusion-height").evaluate(e,s),k=this.paint.get("fill-extrusion-base").evaluate(e,s),U=[0,0],$=E&&y.elevation,Q=y.elevation?y.elevation.exaggeration():1,at=r.tile.getBucket(this);if($&&at instanceof af){const Vt=at.centroidVertexArray,ne=I+1;if(ne<Vt.length){const qt=Vt.get(ne);U[0]=qt.a_centroid_pos0,U[1]=qt.a_centroid_pos1}}if(U[0]===0&&U[1]===1)return!1;y.projection.name==="globe"&&(c=Zg([c],[new Dt(0,0),new Dt(ai,ai)],r.tileID.canonical).map((Vt=>Vt.polygon)).flat());const wt=$?E:null,[zt,Wt]=(function(Vt,ne,qt,Me,Ie,Ge,cn,Ne,Ze,Ye,on){return Vt.projection.name==="globe"?(function(hn,Oe,En,si,Ln,qn,Cn,li,Ti,Li,pr){const bi=[],Ms=[],Fi=hn.projection.upVectorScale(pr,hn.center.lat,hn.worldSize).metersToTile,$i=[0,0,0,1],$r=[0,0,0,1],ws=(Es,As,co,Xa)=>{Es[0]=As,Es[1]=co,Es[2]=Xa,Es[3]=1},cs=Bp();En>0&&(En+=cs),si+=cs;for(const Es of Oe){const As=[],co=[];for(const Xa of Es){const Vr=Xa.x+Ln.x,ta=Xa.y+Ln.y,Vo=hn.projection.projectTilePoint(Vr,ta,pr),xr=hn.projection.upVector(pr,Xa.x,Xa.y);let Zs=En,ma=si;if(Cn){const Jr=Hg(Vr,ta,En,si,Cn,li,Ti,Li);Zs+=Jr.base,ma+=Jr.top}En!==0?ws($i,Vo.x+xr[0]*Fi*Zs,Vo.y+xr[1]*Fi*Zs,Vo.z+xr[2]*Fi*Zs):ws($i,Vo.x,Vo.y,Vo.z),ws($r,Vo.x+xr[0]*Fi*ma,Vo.y+xr[1]*Fi*ma,Vo.z+xr[2]*Fi*ma),wo($i,$i,qn),wo($r,$r,qn),As.push(new Du($i[0],$i[1],$i[2])),co.push(new Du($r[0],$r[1],$r[2]))}bi.push(As),Ms.push(co)}return[bi,Ms]})(Vt,ne,qt,Me,Ie,Ge,cn,Ne,Ze,Ye,on):cn?(function(hn,Oe,En,si,Ln,qn,Cn,li,Ti){const Li=[],pr=[],bi=[0,0,0,1];for(const Ms of hn){const Fi=[],$i=[];for(const $r of Ms){const ws=$r.x+si.x,cs=$r.y+si.y,Es=Hg(ws,cs,Oe,En,qn,Cn,li,Ti);bi[0]=ws,bi[1]=cs,bi[2]=Es.base,bi[3]=1,th(bi,bi,Ln),bi[3]=Math.max(bi[3],1e-5);const As=new Du(bi[0]/bi[3],bi[1]/bi[3],bi[2]/bi[3]);bi[0]=ws,bi[1]=cs,bi[2]=Es.top,bi[3]=1,th(bi,bi,Ln),bi[3]=Math.max(bi[3],1e-5);const co=new Du(bi[0]/bi[3],bi[1]/bi[3],bi[2]/bi[3]);Fi.push(As),$i.push(co)}Li.push(Fi),pr.push($i)}return[Li,pr]})(ne,qt,Me,Ie,Ge,cn,Ne,Ze,Ye):(function(hn,Oe,En,si,Ln){const qn=[],Cn=[],li=Ln[8]*Oe,Ti=Ln[9]*Oe,Li=Ln[10]*Oe,pr=Ln[11]*Oe,bi=Ln[8]*En,Ms=Ln[9]*En,Fi=Ln[10]*En,$i=Ln[11]*En;for(const $r of hn){const ws=[],cs=[];for(const Es of $r){const As=Es.x+si.x,co=Es.y+si.y,Xa=Ln[0]*As+Ln[4]*co+Ln[12],Vr=Ln[1]*As+Ln[5]*co+Ln[13],ta=Ln[2]*As+Ln[6]*co+Ln[14],Vo=Ln[3]*As+Ln[7]*co+Ln[15],xr=Xa+li,Zs=Vr+Ti,ma=ta+Li,Jr=Math.max(Vo+pr,1e-5),To=Xa+bi,Gl=Vr+Ms,Za=ta+Fi,Ha=Math.max(Vo+$i,1e-5);ws.push(new Du(xr/Jr,Zs/Jr,ma/Jr)),cs.push(new Du(To/Ha,Gl/Ha,Za/Ha))}qn.push(ws),Cn.push(cs)}return[qn,Cn]})(ne,qt,Me,Ie,Ge)})(y,c,k,O,M,x,wt,U,Q,y.center.lat,r.tileID.canonical),Ot=r.queryGeometry;return(function(Vt,ne,qt){let Me=1/0;xp(qt,ne)&&(Me=lf(qt,ne[0]));for(let Ie=0;Ie<ne.length;Ie++){const Ge=ne[Ie],cn=Vt[Ie];for(let Ne=0;Ne<Ge.length-1;Ne++){const Ze=Ge[Ne],Ye=[Ze,Ge[Ne+1],cn[Ne+1],cn[Ne],Ze];Vf(qt,Ye)&&(Me=Math.min(Me,lf(qt,Ye)))}}return Me!==1/0&&Me})(zt,Wt,Ot.isPointQuery()?Ot.screenBounds:Ot.screenGeometry)}},line:class extends qu{constructor(r){super(r,Qg),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof bl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=Pd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new rd(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new Fc(this,r)}queryRadius(r){const e=r,s=Bd(bh("line-width",this,e),bh("line-gap-width",this,e)),c=bh("line-offset",this,e);return s/2+Math.abs(c)+Zh(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,s,c,p,y){if(r.queryGeometry.isAboveHorizon)return!1;const x=Sp(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,r.pixelToTileUnitsFactor),E=r.pixelToTileUnitsFactor/2*Bd(this.paint.get("line-width").evaluate(e,s),this.paint.get("line-gap-width").evaluate(e,s)),I=this.paint.get("line-offset").evaluate(e,s);return I&&(c=(function(M,O){const k=[],U=new Dt(0,0);for(let $=0;$<M.length;$++){const Q=M[$],at=[];for(let wt=0;wt<Q.length;wt++){const zt=Q[wt-1],Wt=Q[wt],Ot=Q[wt+1],Vt=wt===0?U:Wt.sub(zt)._unit()._perp(),ne=wt===Q.length-1?U:Ot.sub(Wt)._unit()._perp(),qt=Vt._add(ne)._unit();qt._mult(1/(qt.x*ne.x+qt.y*ne.y)),at.push(qt._mult(O)._add(Wt))}k.push(at)}return k})(c,I*r.pixelToTileUnitsFactor)),(function(M,O,k){for(let U=0;U<O.length;U++){const $=O[U];if(M.length>=3){for(let Q=0;Q<$.length;Q++)if(Uc(M,$[Q]))return!0}if(Lg(M,$,k))return!0}return!1})(x,c,E)}isTileClipped(){return!0}},symbol:bm,background:class extends qu{constructor(r){super(r,s1)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends qu{constructor(r){super(r,o1)}getProgramIds(){return["raster"]}},sky:class extends qu{constructor(r){super(r,l1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Id({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(r,e){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),p=!c,y=r.style.light,x=y.properties.get("position");return p&&y.properties.get("anchor")==="viewport"&&lr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?cy(x.azimuthal,90-x.polar,e):cy(c[0],90-c[1],e)}const s=this.paint.get("sky-gradient-center");return cy(s[0],90-s[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}}};class hg{constructor(e,s,c,p){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(s,p)}update(e,s,c){const{width:p,height:y}=e,{context:x}=this,{gl:E}=x,{HTMLImageElement:I,HTMLCanvasElement:M,HTMLVideoElement:O,ImageData:k,ImageBitmap:U}=X;if(E.bindTexture(E.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!s||s.premultiply!==!1)),c||this.size&&this.size[0]===p&&this.size[1]===y){const{x:$,y:Q}=c||{x:0,y:0};e instanceof I||e instanceof M||e instanceof O||e instanceof k||U&&e instanceof U?E.texSubImage2D(E.TEXTURE_2D,0,$,Q,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,$,Q,p,y,E.RGBA,E.UNSIGNED_BYTE,e.data)}else this.size=[p,y],e instanceof I||e instanceof M||e instanceof O||e instanceof k||U&&e instanceof U?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,p,y,0,this.format,E.UNSIGNED_BYTE,e.data);this.useMipmap=!!(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(e,s){const{context:c}=this,{gl:p}=c;p.bindTexture(p.TEXTURE_2D,this.texture),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?e===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:e),this.filter=e),s!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class c1{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class h1{constructor(){this.tasks={},this.taskQueue=[],An(["process"],this),this.invoker=new c1(this.process),this.nextId=0}add(e,s){const c=this.nextId++,p=(function({type:y,isSymbolTile:x,zoom:E}){return E=E||0,y==="message"?0:y!=="maybePrepare"||x?y!=="parseTile"||x?y==="parseTile"&&x?300-E:y==="maybePrepare"&&x?400-E:500:200-E:100-E})(s);if(p===0){ui();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:e,metadata:s,priority:p,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){ui();try{if(this.taskQueue=this.taskQueue.filter((c=>!!this.tasks[c])),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const s=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let e=null,s=1/0;for(let p=0;p<this.taskQueue.length;p++){const y=this.tasks[this.taskQueue[p]];y.priority<s&&(s=y.priority,e=p)}if(e===null)return null;const c=this.taskQueue[e];return this.taskQueue.splice(e,1),c}remove(){this.invoker.remove()}}class rv{constructor(e){this._stringToNumber={},this._numberToString=[];for(let s=0;s<e.length;s++){const c=e[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const f1=["tile","layer","source","sourceLayer","state"];class sv{constructor(e,s,c,p,y){this.type="Feature",this._vectorTileFeature=e,this._z=s,this._x=c,this._y=p,this.properties=e.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const s of f1)this[s]!==void 0&&(e[s]=this[s]);return e}}const Nc=32,fh=33,Mf=new Uint16Array(8184);for(let r=0;r<2046;r++){let e=r+2,s=0,c=0,p=0,y=0,x=0,E=0;for(1&e?p=y=x=Nc:s=c=E=Nc;(e>>=1)>1;){const M=s+p>>1,O=c+y>>1;1&e?(p=s,y=c,s=x,c=E):(s=p,c=y,p=x,y=E),x=M,E=O}const I=4*r;Mf[I+0]=s,Mf[I+1]=c,Mf[I+2]=p,Mf[I+3]=y}const dh=new Uint16Array(2178),Af=new Uint8Array(1089),wm=new Uint16Array(1089);function ov(r){return r===0?-.03125:r===32?.03125:0}var av=tn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const lv={type:2,extent:ai,loadGeometry:()=>[[new Dt(0,0),new Dt(8193,0),new Dt(8193,8193),new Dt(0,8193),new Dt(0,0)]]};class hy{constructor(e,s,c,p,y){this.tileID=e,this.uid=ve(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(e){const s=e+this.timeAdded;s<ki.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Uh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,s,c){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(p,y){const x={};if(!y)return x;for(const E of p){const I=E.layerIds.map((M=>y.getLayer(M))).filter(Boolean);if(I.length!==0){E.layers=I,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map((M=>I.filter((O=>O.id===M))[0])));for(const M of I)x[M.id]=E}}return x})(e.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const y=this.buckets[p];if(y instanceof hh){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const y=this.buckets[p];if(y instanceof hh&&y.hasRTLText){this.hasRTLText=!0,Gt.isLoading()||Gt.isLoaded()||Tt()!=="deferred"||Ut();break}}this.queryPadding=0;for(const p in this.buckets){const y=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(y))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new C}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new hg(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new hg(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new hg(e,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,c,p,y,x,E,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:E,transform:x,params:y,tileTransform:this.tileTransform},e,s,c):{}}querySourceFeatures(e,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),y=s?s.sourceLayer:"",x=p._geojsonTileLayer||p[y];if(!x)return;const E=_u(s&&s.filter),{z:I,x:M,y:O}=this.tileID.canonical,k={z:I,x:M,y:O};for(let U=0;U<x.length;U++){const $=x.feature(U);if(E.needGeometry){const wt=$c($,!0);if(!E.filter(new Nt(this.tileID.overscaledZ),wt,this.tileID.canonical))continue}else if(!E.filter(new Nt(this.tileID.overscaledZ),$))continue;const Q=c.getId($,y),at=new sv($,I,M,O,Q);at.tile=k,e.push(at)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const c=Vl(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const y=this.expirationTime-s;y?this.expirationTime=c+Math.max(y,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!s)return;const c=this.latestFeatureIndex.loadVTLayers(),p=s.style.listImages();for(const y in this.buckets){if(!s.style.hasLayer(y))continue;const x=this.buckets[y],E=x.layers[0].sourceLayer||"_geojsonTileLayer",I=c[E],M=e[E];if(!I||!M||Object.keys(M).length===0)continue;if(x.update(M,I,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof rd||x instanceof ed){const k=s.style._getSourceCache(x.layers[0].source);s._terrain&&s._terrain.enabled&&k&&x.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(k.id,this.tileID)}const O=s&&s.style&&s.style.getLayer(y);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ki.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ki.now()+e}setTexture(e,s){const c=s.context,p=c.gl;this.texture=this.texture||s.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new hg(c,e,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),c.extTextureFilterAnisotropic&&p.texParameterf(p.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax))}setDependencies(e,s){const c={};for(const p of s)c[p]=!0;this.dependencies[e]=c}hasDependency(e,s){for(const c of e){const p=this.dependencies[c];if(p){for(const y of s)if(p[y])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const c=Iu(lv,this.tileID.canonical,this.tileTransform)[0],p=new di,y=new t;for(let x=0;x<c.length;x++){const{x:E,y:I}=c[x];p.emplaceBack(E,I),y.emplaceBack(x)}y.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(y),this._tileDebugBuffer=e.createVertexBuffer(p,wf.members),this._tileDebugSegments=Qs.simpleSegment(0,0,p.length,y.length)}_makeTileBoundsBuffers(e,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const c=Iu(lv,this.tileID.canonical,this.tileTransform)[0];let p,y;if(this.isRaster){const x=(function(E,I){const M=Uh(E,I),O=Math.pow(2,E.z);for(let wt=0;wt<fh;wt++)for(let zt=0;zt<fh;zt++){const Wt=ml((E.x+(zt+ov(zt))/Nc)/O),Ot=fa((E.y+(wt+ov(wt))/Nc)/O),Vt=I.project(Wt,Ot),ne=wt*fh+zt;dh[2*ne+0]=Math.round((Vt.x*M.scale-M.x)*ai),dh[2*ne+1]=Math.round((Vt.y*M.scale-M.y)*ai)}Af.fill(0),wm.fill(0);for(let wt=2045;wt>=0;wt--){const zt=4*wt,Wt=Mf[zt+0],Ot=Mf[zt+1],Vt=Mf[zt+2],ne=Mf[zt+3],qt=Wt+Vt>>1,Me=Ot+ne>>1,Ie=qt+Me-Ot,Ge=Me+Wt-qt,cn=Ot*fh+Wt,Ne=ne*fh+Vt,Ze=Me*fh+qt,Ye=Math.hypot((dh[2*cn+0]+dh[2*Ne+0])/2-dh[2*Ze+0],(dh[2*cn+1]+dh[2*Ne+1])/2-dh[2*Ze+1])>=16;if(Af[Ze]=Af[Ze]||(Ye?1:0),wt<1022){const on=(Ot+Ge>>1)*fh+(Wt+Ie>>1),hn=(ne+Ge>>1)*fh+(Vt+Ie>>1);Af[Ze]=Af[Ze]||Af[on]||Af[hn]}}const k=new pi,U=new Bo;let $=0;function Q(wt,zt){const Wt=zt*fh+wt;return wm[Wt]===0&&(k.emplaceBack(dh[2*Wt+0],dh[2*Wt+1],wt*ai/Nc,zt*ai/Nc),wm[Wt]=++$),wm[Wt]-1}function at(wt,zt,Wt,Ot,Vt,ne){const qt=wt+Wt>>1,Me=zt+Ot>>1;if(Math.abs(wt-Vt)+Math.abs(zt-ne)>1&&Af[Me*fh+qt])at(Vt,ne,wt,zt,qt,Me),at(Wt,Ot,Vt,ne,qt,Me);else{const Ie=Q(wt,zt),Ge=Q(Wt,Ot),cn=Q(Vt,ne);U.emplaceBack(Ie,Ge,cn)}}return at(0,0,Nc,Nc,Nc,0),at(Nc,Nc,0,0,0,Nc),{vertices:k,indices:U}})(this.tileID.canonical,s);p=x.vertices,y=x.indices}else{p=new pi,y=new Bo;for(const{x:E,y:I}of c)p.emplaceBack(E,I,0,0);const x=$f.exports(p.int16,void 0,4);for(let E=0;E<x.length;E+=3)y.emplaceBack(x[E],x[E+1],x[E+2])}this._tileBoundsBuffer=e.createVertexBuffer(p,av.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(y),this._tileBoundsSegments=Qs.simpleSegment(0,0,p.length,y.length)}_makeGlobeTileDebugBuffers(e,s){const c=s.projection;if(!c||c.name!=="globe"||s.freezeTileCoverage)return;const p=this.tileID.canonical,y=ud(Sf(p,s)),x=Fh(s.zoom);let E;x>0&&(E=wh(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,p,s,y,E,x),this._makeGlobeTileDebugTextBuffer(e,p,s,y,E,x)}_globePoint(e,s,c,p,y,x,E){let I=Cf(e,s,c);if(x){const M=1<<c.z,O=rc(p.center.lng),k=sc(p.center.lat),U=(c.x+.5)/M-O;let $=0;U>.5?$=-1:U<-.5&&($=1);let Q=(e/ai+c.x)/M+$,at=(s/ai+c.y)/M;Q=(Q-O)*p._pixelsPerMercatorPixel+O,at=(at-k)*p._pixelsPerMercatorPixel+k;const wt=[Q*p.worldSize,at*p.worldSize,0];wo(wt,wt,x),I=uu(I,wt,E)}return wo(I,I,y)}_makeGlobeTileDebugBorderBuffer(e,s,c,p,y,x){const E=new di,I=new t,M=new Er,O=(U,$,Q,at,wt)=>{const zt=(Q-U)/(wt-1),Wt=(at-$)/(wt-1),Ot=E.length;for(let Vt=0;Vt<wt;Vt++){const ne=U+Vt*zt,qt=$+Vt*Wt;E.emplaceBack(ne,qt);const Me=this._globePoint(ne,qt,s,c,p,y,x);M.emplaceBack(Me[0],Me[1],Me[2]),I.emplaceBack(Ot+Vt)}},k=ai;O(0,0,k,0,16),O(k,0,k,k,16),O(k,k,0,k,16),O(0,k,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(I),this._tileDebugBuffer=e.createVertexBuffer(E,wf.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(M,ng.members),this._tileDebugSegments=Qs.simpleSegment(0,0,E.length,I.length)}_makeGlobeTileDebugTextBuffer(e,s,c,p,y,x){const E=new di,I=new Bo,M=new Er,O=25;I.reserve(32),E.reserve(O),M.reserve(O);const k=(U,$)=>O*U+$;for(let U=0;U<O;U++){const $=2048*U;for(let Q=0;Q<O;Q++){const at=2048*Q;E.emplaceBack(at,$);const wt=this._globePoint(at,$,s,c,p,y,x);M.emplaceBack(wt[0],wt[1],wt[2])}}for(let U=0;U<4;U++)for(let $=0;$<4;$++){const Q=k(U,$),at=k(U,$+1),wt=k(U+1,$),zt=k(U+1,$+1);I.emplaceBack(Q,at,wt),I.emplaceBack(wt,at,zt)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(I),this._tileDebugTextBuffer=e.createVertexBuffer(E,wf.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(M,ng.members),this._tileDebugTextSegments=Qs.simpleSegment(0,0,O,32)}}class d1{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,c){const p=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][p]=this.stateChanges[e][p]||{},mt(this.stateChanges[e][p],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const y in this.state[e])y!==p&&(this.deletedStates[e][y]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][p]===null){this.deletedStates[e][p]={};for(const y in this.state[e][p])c[y]||(this.deletedStates[e][p][y]=null)}else for(const y in c)this.deletedStates[e]&&this.deletedStates[e][p]&&this.deletedStates[e][p][y]===null&&delete this.deletedStates[e][p][y]}removeFeatureState(e,s,c){if(this.deletedStates[e]===null)return;const p=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&s!==void 0)this.deletedStates[e][p]!==null&&(this.deletedStates[e][p]=this.deletedStates[e][p]||{},this.deletedStates[e][p][c]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][p])for(c in this.deletedStates[e][p]={},this.stateChanges[e][p])this.deletedStates[e][p][c]=null;else this.deletedStates[e][p]=null;else this.deletedStates[e]=null}getState(e,s){const c=String(s),p=mt({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const y=this.deletedStates[e][s];if(y===null)return{};for(const x in y)delete p[x]}return p}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const y={};for(const x in this.stateChanges[p])this.state[p][x]||(this.state[p][x]={}),mt(this.state[p][x],this.stateChanges[p][x]),y[x]=this.state[p][x];c[p]=y}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const y={};if(this.deletedStates[p]===null)for(const x in this.state[p])y[x]={},this.state[p][x]={};else for(const x in this.deletedStates[p]){if(this.deletedStates[p][x]===null)this.state[p][x]={};else for(const E of Object.keys(this.deletedStates[p][x]))delete this.state[p][x][E];y[x]=this.state[p][x]}c[p]=c[p]||{},mt(c[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const p in e)e[p].setFeatureState(c,s)}}class uv{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,s){const c=this.toIdx(e,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(e,s){return this.leaves[this.toIdx(e,s)]}toIdx(e,s){return s*this.size+e}}function cv(r,e,s,c){let p=0,y=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(c[x])<1e-15){if(s[x]<r[x]||s[x]>e[x])return null}else{const E=1/c[x];let I=(r[x]-s[x])*E,M=(e[x]-s[x])*E;if(I>M){const O=I;I=M,M=O}if(I>p&&(p=I),M<y&&(y=M),p>y)return null}return p}function hv(r,e,s,c,p,y,x,E,I,M,O){const k=c-r,U=p-e,$=y-s,Q=x-r,at=E-e,wt=I-s,zt=O[1]*wt-O[2]*at,Wt=O[2]*Q-O[0]*wt,Ot=O[0]*at-O[1]*Q,Vt=k*zt+U*Wt+$*Ot;if(Math.abs(Vt)<1e-15)return null;const ne=1/Vt,qt=M[0]-r,Me=M[1]-e,Ie=M[2]-s,Ge=(qt*zt+Me*Wt+Ie*Ot)*ne;if(Ge<0||Ge>1)return null;const cn=Me*$-Ie*U,Ne=Ie*k-qt*$,Ze=qt*U-Me*k,Ye=(O[0]*cn+O[1]*Ne+O[2]*Ze)*ne;return Ye<0||Ge+Ye>1?null:(Q*cn+at*Ne+wt*Ze)*ne}function fv(r,e,s){return(r-e)/(s-e)}function dv(r,e,s,c,p,y,x,E,I){const M=1<<s,O=y-c,k=x-p,U=(r+1)/M*O+c,$=(e+0)/M*k+p,Q=(e+1)/M*k+p;E[0]=(r+0)/M*O+c,E[1]=$,I[0]=U,I[1]=Q}class pv{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=(function(y){const x=Math.ceil(Math.log2(y.dim/8)),E=[];let I=Math.ceil(Math.pow(2,x));const M=1/I,O=($,Q,at,wt,zt)=>{const Wt=wt?1:0,Ot=($+1)*at-Wt,Vt=Q*at,ne=(Q+1)*at-Wt;zt[0]=$*at,zt[1]=Vt,zt[2]=Ot,zt[3]=ne};let k=new uv(I);const U=[];for(let $=0;$<I*I;$++){O($%I,Math.floor($/I),M,!1,U);const Q=Lf(U[0],U[1],y),at=Lf(U[2],U[1],y),wt=Lf(U[2],U[3],y),zt=Lf(U[0],U[3],y);k.minimums.push(Math.min(Q,at,wt,zt)),k.maximums.push(Math.max(Q,at,wt,zt)),k.leaves.push(1)}for(E.push(k),I/=2;I>=1;I/=2){const $=E[E.length-1];k=new uv(I);for(let Q=0;Q<I*I;Q++){O(Q%I,Math.floor(Q/I),2,!0,U);const at=$.getElevation(U[0],U[1]),wt=$.getElevation(U[2],U[1]),zt=$.getElevation(U[2],U[3]),Wt=$.getElevation(U[0],U[3]),Ot=$.isLeaf(U[0],U[1]),Vt=$.isLeaf(U[2],U[1]),ne=$.isLeaf(U[2],U[3]),qt=$.isLeaf(U[0],U[3]),Me=Math.min(at.min,wt.min,zt.min,Wt.min),Ie=Math.max(at.max,wt.max,zt.max,Wt.max),Ge=Ot&&Vt&&ne&&qt;k.maximums.push(Ie),k.minimums.push(Me),k.leaves.push(Ie-Me<=5&&Ge?1:0)}E.push(k)}return E})(this.dem),c=s.length-1,p=s[c];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(e,s,c,p,y,x,E=1){return cv([e,s,-100],[c,p,this.maximums[0]*E],y,x)}raycast(e,s,c,p,y,x,E=1){if(!this.nodeCount)return null;const I=this.raycastRoot(e,s,c,p,y,x,E);if(I==null)return null;const M=[],O=[],k=[],U=[],$=[{idx:0,t:I,nodex:0,nodey:0,depth:0}];for(;$.length>0;){const{idx:Q,t:at,nodex:wt,nodey:zt,depth:Wt}=$.pop();if(this.leaves[Q]){dv(wt,zt,Wt,e,s,c,p,k,U);const Vt=1<<Wt,ne=(wt+0)/Vt,qt=(wt+1)/Vt,Me=(zt+0)/Vt,Ie=(zt+1)/Vt,Ge=Lf(ne,Me,this.dem)*E,cn=Lf(qt,Me,this.dem)*E,Ne=Lf(qt,Ie,this.dem)*E,Ze=Lf(ne,Ie,this.dem)*E,Ye=hv(k[0],k[1],Ge,U[0],k[1],cn,U[0],U[1],Ne,y,x),on=hv(U[0],U[1],Ne,k[0],U[1],Ze,k[0],k[1],Ge,y,x),hn=Math.min(Ye!==null?Ye:Number.MAX_VALUE,on!==null?on:Number.MAX_VALUE);if(hn!==Number.MAX_VALUE)return hn;{const Oe=to([],y,x,at);if(gv(Ge,cn,Ze,Ne,fv(Oe[0],k[0],U[0]),fv(Oe[1],k[1],U[1]))>=Oe[2])return at}continue}let Ot=0;for(let Vt=0;Vt<this._siblingOffset.length;Vt++){dv((wt<<1)+this._siblingOffset[Vt][0],(zt<<1)+this._siblingOffset[Vt][1],Wt+1,e,s,c,p,k,U),k[2]=-100,U[2]=this.maximums[this.childOffsets[Q]+Vt]*E;const ne=cv(k,U,y,x);if(ne!=null){const qt=ne;M[Vt]=qt;let Me=!1;for(let Ie=0;Ie<Ot&&!Me;Ie++)qt>=M[O[Ie]]&&(O.splice(Ie,0,Vt),Me=!0);Me||(O[Ot]=Vt),Ot++}}for(let Vt=0;Vt<Ot;Vt++){const ne=O[Vt];$.push({idx:this.childOffsets[Q]+ne,t:M[ne],nodex:(wt<<1)+this._siblingOffset[ne][0],nodey:(zt<<1)+this._siblingOffset[ne][1],depth:Wt+1})}}return null}_addNode(e,s,c){return this.minimums.push(e),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(e,s,c,p,y){if(e[p].isLeaf(s,c)===1)return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const x=p-1,E=e[x];let I=0,M=0;for(let O=0;O<this._siblingOffset.length;O++){const k=2*s+this._siblingOffset[O][0],U=2*c+this._siblingOffset[O][1],$=E.getElevation(k,U),Q=E.isLeaf(k,U),at=this._addNode($.min,$.max,Q);Q&&(I|=1<<O),M||(M=at)}for(let O=0;O<this._siblingOffset.length;O++)I&1<<O||this._construct(e,2*s+this._siblingOffset[O][0],2*c+this._siblingOffset[O][1],x,M+O)}}function gv(r,e,s,c,p,y){return Ii(Ii(r,s,y),Ii(e,c,y),p)}function Lf(r,e,s){const c=s.dim,p=ct(r*c-.5,0,c-1),y=ct(e*c-.5,0,c-1),x=Math.floor(p),E=Math.floor(y),I=Math.min(x+1,c-1),M=Math.min(E+1,c-1);return gv(s.get(x,E),s.get(I,E),s.get(x,M),s.get(I,M),p-x,y-E)}const mv={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Em{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,s,c,p=!1,y=!1){if(this.uid=e,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return lr(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const x=this.dim=s.height-2,E=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=c||"mapbox",this.borderReady=p,!p){for(let I=0;I<x;I++)E[this._idx(-1,I)]=E[this._idx(0,I)],E[this._idx(x,I)]=E[this._idx(x-1,I)],E[this._idx(I,-1)]=E[this._idx(I,0)],E[this._idx(I,x)]=E[this._idx(I,x-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(x,-1)]=E[this._idx(x-1,0)],E[this._idx(-1,x)]=E[this._idx(0,x-1)],E[this._idx(x,x)]=E[this._idx(x-1,x-1)],y&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new pv(this)}get(e,s,c=!1){c&&(e=ct(e,-1,this.dim),s=ct(s,-1,this.dim));const p=4*this._idx(e,s);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(e){return mv[e]}get unpackVector(){return mv[this.encoding]}_idx(e,s){if(e<-1||e>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(e+1)}_unpackMapbox(e,s,c){return(256*e*256+256*s+c)/10-1e4}_unpackTerrarium(e,s,c){return 256*e+s+c/256-32768}static pack(e,s){const c=[0,0,0,0],p=Em.getUnpackVector(s);let y=Math.floor((e+p[3])/p[2]);return c[2]=y%256,y=Math.floor(y/256),c[1]=y%256,y=Math.floor(y/256),c[0]=y,c}getPixels(){return new Bl({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,s,c){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,y=s*this.dim+this.dim,x=c*this.dim,E=c*this.dim+this.dim;switch(s){case-1:p=y-1;break;case 1:y=p+1}switch(c){case-1:x=E-1;break;case 1:E=x+1}const I=-s*this.dim,M=-c*this.dim;for(let O=x;O<E;O++)for(let k=p;k<y;k++){const U=4*this._idx(k,O),$=4*this._idx(k+I,O+M);this.pixels[U+0]=e.pixels[$+0],this.pixels[U+1]=e.pixels[$+1],this.pixels[U+2]=e.pixels[$+2],this.pixels[U+3]=e.pixels[$+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}dn(Em,"DEMData"),dn(pv,"DemMinMaxQuadTree",{omit:["dem"]});class p1{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,c){const p=e.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const y={value:s,timeout:void 0};if(c!==void 0&&(y.timeout=setTimeout((()=>{this.remove(e,y)}),c)),this.data[p].push(y),this.order.push(p),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const c=e.wrapped().key,p=s===void 0?0:this.data[c].indexOf(s),y=this.data[c][p];return this.data[c].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(y.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const c in this.data)for(const p of this.data[c])e(p.value)||s.push(p);for(const c of s)this.remove(c.value.tileID,c)}}class Qd{constructor(e,s,c){this.func=e,this.mask=s,this.range=c}}Qd.ReadOnly=!1,Qd.ReadWrite=!0,Qd.disabled=new Qd(519,Qd.ReadOnly,[0,1]);const fy=7680;class dy{constructor(e,s,c,p,y,x){this.test=e,this.ref=s,this.mask=c,this.fail=p,this.depthFail=y,this.pass=x}}dy.disabled=new dy({func:519,mask:0},0,0,fy,fy,fy);class ph{constructor(e,s,c){this.blendFunction=e,this.blendColor=s,this.mask=c}}ph.Replace=[1,0],ph.disabled=new ph(ph.Replace,Qe.transparent,[!1,!1,!1,!1]),ph.unblended=new ph(ph.Replace,Qe.transparent,[!0,!0,!0,!0]),ph.alphaBlended=new ph([1,771],Qe.transparent,[!0,!0,!0,!0]);const py=1029,gy=2305;class Yc{constructor(e,s,c){this.enable=e,this.mode=s,this.frontFace=c}}Yc.disabled=new Yc(!1,py,gy),Yc.backCCW=new Yc(!0,py,gy),Yc.backCW=new Yc(!0,py,2304),Yc.frontCW=new Yc(!0,1028,2304),Yc.frontCCW=new Yc(!0,1028,gy);class hd extends Ss{constructor(e,s,c){super(),this.id=e,this._onlySymbols=c,s.on("data",(p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),s.on("error",(()=>{this._sourceErrored=!0})),this._source=s,this._tiles={},this._cache=new p1(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new d1,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,s){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,s)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,(()=>{}))}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,(()=>{}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return te(this._tiles).map((e=>e.tileID)).sort(yv).map((e=>e.key))}getRenderableIds(e){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,e)&&s.push(this._tiles[c]);return e?s.sort(((c,p)=>{const y=c.tileID,x=p.tileID,E=new Dt(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),I=new Dt(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-x.overscaledZ||I.y-E.y||I.x-E.x})).map((c=>c.tileID.key)):s.map((c=>c.tileID)).sort(yv).map((c=>c.key))}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,s){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,e,s)))}_tileLoaded(e,s,c,p){if(p)if(e.state="errored",p.status!==404)this._source.fire(new Ra(p,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=ki.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new _i("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const y=s[p];if(e.neighboringTiles&&e.neighboringTiles[y]){const x=this.getTileByID(y);c(e,x),c(x,e)}}function c(p,y){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let x=y.tileID.canonical.x-p.tileID.canonical.x;const E=y.tileID.canonical.y-p.tileID.canonical.y,I=Math.pow(2,p.tileID.canonical.z),M=y.tileID.key;x===0&&E===0||Math.abs(E)>1||(Math.abs(x)>1&&(Math.abs(x+I)===1?x+=I:Math.abs(x-I)===1&&(x-=I)),y.dem&&p.dem&&(p.dem.backfillBorder(y.dem,x,E),p.neighboringTiles&&p.neighboringTiles[M]&&(p.neighboringTiles[M].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,c,p){for(const y in this._tiles){let x=this._tiles[y];if(p[y]||!x.hasData()||x.tileID.overscaledZ<=s||x.tileID.overscaledZ>c)continue;let E=x.tileID;for(;x&&x.tileID.overscaledZ>s+1;){const M=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[M.key],x&&x.hasData()&&(E=M)}let I=E;for(;I.overscaledZ>s;)if(I=I.scaledTo(I.overscaledZ-1),e[I.key]){p[E.key]=E;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=e.overscaledZ-1;c>=s;c--){const p=e.scaledTo(c),y=this._getLoadedTile(p);if(y)return y}}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,s){s=s||this._source.tileSize;const c=Math.ceil(e.width/s)+1,p=Math.ceil(e.height/s)+1,y=Math.floor(c*p*5),x=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,y):y,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(E)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const c={};for(const p in this._tiles){const y=this._tiles[p];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),c[y.tileID.key]=y}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(e,s,c){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let p;this.updateCacheSize(e,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((E=>new pa(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y))):(p=e.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter((E=>this._source.hasTile(E))))):p=[];const y=this._updateRetainedTiles(p);if(_v(this._source.type)&&p.length!==0){const E={},I={},M=Object.keys(y);for(const k of M){const U=y[k],$=this._tiles[k];if(!$||$.fadeEndTime&&$.fadeEndTime<=ki.now())continue;const Q=this.findLoadedParent(U,Math.max(U.overscaledZ-hd.maxOverzooming,this._source.minzoom));Q&&(this._addTile(Q.tileID),E[Q.tileID.key]=Q.tileID),I[k]=U}const O=p[p.length-1].overscaledZ;for(const k in this._tiles){const U=this._tiles[k];if(y[k]||!U.hasData())continue;let $=U.tileID;for(;$.overscaledZ>O;){$=$.scaledTo($.overscaledZ-1);const Q=this._tiles[$.key];if(Q&&Q.hasData()&&I[$.key]){y[k]=U.tileID;break}}}for(const k in E)y[k]||(this._coveredTiles[k]=!0,y[k]=E[k])}for(const E in y)this._tiles[E].clearFadeHold();const x=(function(E,I){const M=[];for(const O in E)O in I||M.push(O);return M})(this._tiles,y);for(const E of x){const I=this._tiles[E];I.hasSymbolBuckets&&!I.holdingForFade()?I.setHoldDuration(this.map._fadeDuration):I.hasSymbolBuckets&&!I.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const s={};if(e.length===0)return s;const c={},p=e.reduce(((M,O)=>Math.min(M,O.overscaledZ)),1/0),y=e[0].overscaledZ,x=Math.max(y-hd.maxOverzooming,this._source.minzoom),E=Math.max(y+hd.maxUnderzooming,this._source.minzoom),I={};for(const M of e){const O=this._addTile(M);s[M.key]=M,O.hasData()||p<this._source.maxzoom&&(I[M.key]=M)}this._retainLoadedChildren(I,p,E,s);for(const M of e){let O=this._tiles[M.key];if(O.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const U=M.children(this._source.maxzoom)[0],$=this.getTile(U);if($&&$.hasData()){s[U.key]=U;continue}}else{const U=M.children(this._source.maxzoom);if(s[U[0].key]&&s[U[1].key]&&s[U[2].key]&&s[U[3].key])continue}let k=O.wasRequested();for(let U=M.overscaledZ-1;U>=x;--U){const $=M.scaledTo(U);if(c[$.key]||(c[$.key]=!0,O=this.getTile($),!O&&k&&(O=this._addTile($)),O&&(s[$.key]=$,k=O.wasRequested(),O.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let c,p=this._tiles[e].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}s.push(p.key);const y=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(y),c)break;p=y}for(const y of s)this._loadedParentTiles[y]=c}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const c=!!s;if(!c){const p=this.map?this.map.painter:null;s=new hy(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,e.key,s.state))}return s?(s.uses++,this._tiles[e.key]=s,c||this._source.fire(new _i("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=s.getExpiryTimeout();c&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),c))}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,s,c){const p=[],y=this.transform;if(!y)return p;const x=y.projection.name==="globe",E=rc(y.center.lng);for(const I in this._tiles){const M=this._tiles[I];if(c&&M.clearQueryDebugViz(),M.holdingForFade())continue;let O;if(x){const k=M.tileID.canonical;if(k.z===0){const U=[Math.abs(ct(E,...fg(k,-1))-E),Math.abs(ct(E,...fg(k,1))-E)];O=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(ct(E,...fg(k,-1))-E),Math.abs(ct(E,...fg(k,0))-E),Math.abs(ct(E,...fg(k,1))-E)];O=[U.indexOf(Math.min(...U))-1]}}else O=[0];for(const k of O){const U=e.containsTile(M,y,s,k);U&&p.push(U)}}return p}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map((c=>this._tiles[c].tileID));for(const c of s)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(_v(this._source.type))for(const e in this._tiles){const s=this._tiles[e];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=ki.now())return!0}return!1}setFeatureState(e,s,c){this._state.updateState(e=e||"_geojsonTileLayer",s,c)}removeFeatureState(e,s,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,c)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,c){const p=this._tiles[e];p&&p.setDependencies(s,c)}reloadTilesForDependencies(e,s){for(const c in this._tiles)this._tiles[c].hasDependency(e,s)&&this._reloadTile(+c,"reloading");this._cache.filter((c=>!c.hasDependency(e,s)))}_preloadTiles(e,s){const c=new Map,p=Array.isArray(e)?e:[e],y=this.map.painter.terrain,x=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const E of p){const I=E.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of I)c.set(M.key,M);this.usedForTerrain&&E.updateElevation(!1)}ye(Array.from(c.values()),((E,I)=>{const M=new hy(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,(O=>{this._source.type==="raster-dem"&&M.dem&&this._backfillDEM(M),I(O,M)}))}),s)}}function yv(r,e){const s=Math.abs(2*r.wrap)-+(r.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return r.overscaledZ-e.overscaledZ||c-s||e.canonical.y-r.canonical.y||e.canonical.x-r.canonical.x}function _v(r){return r==="raster"||r==="image"||r==="video"||r==="custom"}function fg(r,e){const s=1<<r.z;return[r.x/s+e,(r.x+1)/s+e]}hd.maxOverzooming=10,hd.maxUnderzooming=3;class Sm{constructor(e,s,c){this._demTile=e,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(e,s,c){const p=c||e.findDEMTileFor(s);if(!p||!p.dem)return;const y=p.dem,x=p.tileID,E=1<<s.canonical.z-x.canonical.z;return new Sm(p,p.tileSize/ai/E,[(s.canonical.x/E-x.canonical.x)*y.dim,(s.canonical.y/E-x.canonical.y)*y.dim])}tileCoordToPixel(e,s){const c=s*this._scale+this._offset[1],p=Math.floor(e*this._scale+this._offset[0]),y=Math.floor(c);return new Dt(p,y)}getElevationAt(e,s,c,p){const y=e*this._scale+this._offset[0],x=s*this._scale+this._offset[1],E=Math.floor(y),I=Math.floor(x),M=this._dem;return p=!!p,c?Ii(Ii(M.get(E,I,p),M.get(E,I+1,p),x-I),Ii(M.get(E+1,I,p),M.get(E+1,I+1,p),x-I),y-E):M.get(E,I,p)}getElevationAtPixel(e,s,c){return this._dem.get(e,s,!!c)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Cu(1,e)*this._dem.stride}}class vv{constructor(e,s){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ei(ai,16,0),this.featureIndexArray=new Nn,this.promoteId=s}insert(e,s,c,p,y,x=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,p,y,x);const I=this.grid;for(let M=0;M<s.length;M++){const O=s[M],k=[1/0,1/0,-1/0,-1/0];for(let U=0;U<O.length;U++){const $=O[U];k[0]=Math.min(k[0],$.x),k[1]=Math.min(k[1],$.y),k[2]=Math.max(k[2],$.x),k[3]=Math.max(k[3],$.y)}k[0]<ai&&k[1]<ai&&k[2]>=0&&k[3]>=0&&I.insert(E,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Nd(new hf(this.rawTileData)).layers,this.sourceLayerCoder=new rv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,s,c,p){this.loadVTLayers();const y=e.params||{},x=_u(y.filter),E=e.tileResult,I=e.transform,M=E.bufferedTilespaceBounds,O=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,((Q,at,wt,zt)=>jf(E.bufferedTilespaceGeometry,Q,at,wt,zt)));O.sort(g1);let k=null;I.elevation&&O.length>0&&(k=Sm.create(I.elevation,this.tileID));const U={};let $;for(let Q=0;Q<O.length;Q++){const at=O[Q];if(at===$)continue;$=at;const wt=this.featureIndexArray.get(at);let zt=null;this.loadMatchingFeature(U,wt,x,y.layers,y.availableImages,s,c,p,((Wt,Ot,Vt,ne=0)=>(zt||(zt=Iu(Wt,this.tileID.canonical,e.tileTransform)),Ot.queryIntersectsFeature(E,Wt,Vt,zt,this.z,e.transform,e.pixelPosMatrix,k,ne))))}return U}loadMatchingFeature(e,s,c,p,y,x,E,I,M){const{featureIndex:O,bucketIndex:k,sourceLayerIndex:U,layoutVertexArrayOffset:$}=s,Q=this.bucketLayerIDs[k];if(p&&!(function(Wt,Ot){for(let Vt=0;Vt<Wt.length;Vt++)if(Ot.indexOf(Wt[Vt])>=0)return!0;return!1})(p,Q))return;const at=this.sourceLayerCoder.decode(U),wt=this.vtLayers[at].feature(O);if(c.needGeometry){const Wt=$c(wt,!0);if(!c.filter(new Nt(this.tileID.overscaledZ),Wt,this.tileID.canonical))return}else if(!c.filter(new Nt(this.tileID.overscaledZ),wt))return;const zt=this.getId(wt,at);for(let Wt=0;Wt<Q.length;Wt++){const Ot=Q[Wt];if(p&&p.indexOf(Ot)<0)continue;const Vt=x[Ot];if(!Vt)continue;let ne={};zt!==void 0&&I&&(ne=I.getState(Vt.sourceLayer||"_geojsonTileLayer",zt));const qt=mt({},E[Ot]);qt.paint=xv(qt.paint,Vt.paint,wt,ne,y),qt.layout=xv(qt.layout,Vt.layout,wt,ne,y);const Me=!M||M(wt,Vt,ne,$);if(!Me)continue;const Ie=new sv(wt,this.z,this.x,this.y,zt);Ie.layer=qt;let Ge=e[Ot];Ge===void 0&&(Ge=e[Ot]=[]),Ge.push({featureIndex:O,feature:Ie,intersectionZ:Me})}}lookupSymbolFeatures(e,s,c,p,y,x,E,I){const M={};this.loadVTLayers();const O=_u(y);for(const k of e)this.loadMatchingFeature(M,{bucketIndex:c,sourceLayerIndex:p,featureIndex:k,layoutVertexArrayOffset:0},O,x,E,I,s);return M}loadFeature(e){const{featureIndex:s,sourceLayerIndex:c}=e;this.loadVTLayers();const p=this.sourceLayerCoder.decode(c),y=this.vtFeatures[p];if(y[s])return y[s];const x=this.vtLayers[p].feature(s);return y[s]=x,x}hasLayer(e){for(const s of this.bucketLayerIDs)for(const c of s)if(e===c)return!0;return!1}getId(e,s){let c=e.id;if(this.promoteId){const p=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];p!=null&&(c=e.properties[p]),typeof c=="boolean"&&(c=Number(c))}return c}}function xv(r,e,s,c,p){return yi(r,((y,x)=>{const E=e instanceof Pe?e.get(x):null;return E&&E.evaluate?E.evaluate(s,c,p):E}))}function g1(r,e){return e-r}dn(vv,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class bv{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.image=new Sc({width:e,height:s}),this.positions={},this.uploaded=!1}getDash(e,s){const c=this.getKey(e,s);return this.positions[c]}trim(){const e=this.width,s=this.height=de(this.nextRow);this.image.resize({width:e,height:s})}getKey(e,s){return e.join(",")+s}getDashRanges(e,s,c){const p=[];let y=e.length%2==1?-e[e.length-1]*c:0,x=e[0]*c,E=!0;p.push({left:y,right:x,isDash:E,zeroLength:e[0]===0});let I=e[0];for(let M=1;M<e.length;M++){E=!E;const O=e[M];y=I*c,I+=O,x=I*c,p.push({left:y,right:x,isDash:E,zeroLength:O===0})}return p}addRoundDash(e,s,c){const p=s/2;for(let y=-c;y<=c;y++){const x=this.width*(this.nextRow+c+y);let E=0,I=e[E];for(let M=0;M<this.width;M++){M/I.right>1&&(I=e[++E]);const O=Math.abs(M-I.left),k=Math.abs(M-I.right),U=Math.min(O,k);let $;const Q=y/c*(p+1);if(I.isDash){const at=p-Math.abs(Q);$=Math.sqrt(U*U+at*at)}else $=p-Math.sqrt(U*U+Q*Q);this.image.data[x+M]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e,s){for(let I=e.length-1;I>=0;--I){const M=e[I],O=e[I+1];M.zeroLength?e.splice(I,1):O&&O.isDash===M.isDash&&(O.left=M.left,e.splice(I,1))}const c=e[0],p=e[e.length-1];c.isDash===p.isDash&&(c.left=p.left-this.width,p.right=c.right+this.width);const y=this.width*this.nextRow;let x=0,E=e[x];for(let I=0;I<this.width;I++){I/E.right>1&&(E=e[++x]);const M=Math.abs(I-E.left),O=Math.abs(I-E.right),k=Math.min(M,O);this.image.data[y+I]=Math.max(0,Math.min(255,(E.isDash?k:-k)+s+128))}}addDash(e,s){const c=this.getKey(e,s);if(this.positions[c])return this.positions[c];const p=s==="round",y=p?7:0,x=2*y+1;if(this.nextRow+x>this.height)return lr("LineAtlas out of space"),null;e.length===0&&e.push(1);let E=0;for(let O=0;O<e.length;O++)e[O]<0&&(lr("Negative value is found in line dasharray, replacing values with 0"),e[O]=0),E+=e[O];if(E!==0){const O=this.width/E,k=this.getDashRanges(e,this.width,O);p?this.addRoundDash(k,O,y):this.addRegularDash(k,s==="square"?.5*O:0)}const I=this.nextRow+y;this.nextRow+=x;const M={tl:[I,y],br:[E,0]};return this.positions[c]=M,M}}dn(bv,"LineAtlas");class wv{constructor(e){const s={},c=[];for(const E in e){const I=e[E],M=s[E]={};for(const O in I.glyphs){const k=I.glyphs[+O];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const U=k.metrics.localGlyph?2:1,$={x:0,y:0,w:k.bitmap.width+2*U,h:k.bitmap.height+2*U};c.push($),M[O]=$}}const{w:p,h:y}=Xp(c),x=new Sc({width:p||1,height:y||1});for(const E in e){const I=e[E];for(const M in I.glyphs){const O=I.glyphs[+M];if(!O||O.bitmap.width===0||O.bitmap.height===0)continue;const k=s[E][M],U=O.metrics.localGlyph?2:1;Sc.copy(O.bitmap,x,{x:0,y:0},{x:k.x+U,y:k.y+U},O.bitmap)}}this.image=x,this.positions=s}}dn(wv,"GlyphAtlas");class m1{constructor(e){this.tileID=new pa(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Uh(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,s,c,p,y){this.status="parsing",this.data=e,this.collisionBoxArray=new C;const x=new rv(Object.keys(e.layers).sort()),E=new vv(this.tileID,this.promoteId);E.bucketLayerIDs=[];const I={},M=new bv(256,256),O={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:c},k=s.familiesBySource[this.source];for(const ne in k){const qt=e.layers[ne];if(!qt)continue;let Me=!1,Ie=!1;for(const Ne of k[ne])Ne[0].type==="symbol"?Me=!0:Ie=!0;if(this.isSymbolTile===!0&&!Me||this.isSymbolTile===!1&&!Ie)continue;qt.version===1&&lr(`Vector tile source "${this.source}" layer "${ne}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ge=x.encode(ne),cn=[];for(let Ne=0;Ne<qt.length;Ne++){const Ze=qt.feature(Ne),Ye=E.getId(Ze,ne);cn.push({feature:Ze,id:Ye,index:Ne,sourceLayerIndex:Ge})}for(const Ne of k[ne]){const Ze=Ne[0];this.isSymbolTile!==void 0&&Ze.type==="symbol"!==this.isSymbolTile||Ze.minzoom&&this.zoom<Math.floor(Ze.minzoom)||Ze.maxzoom&&this.zoom>=Ze.maxzoom||Ze.visibility!=="none"&&(my(Ne,this.zoom,c),(I[Ze.id]=Ze.createBucket({index:E.bucketLayerIDs.length,layers:Ne,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ge,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(cn,O,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(Ne.map((Ye=>Ye.id))))}}let U,$,Q,at;M.trim();const wt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},zt=yi(O.glyphDependencies,(ne=>Object.keys(ne).map(Number)));Object.keys(zt).length?p.send("getGlyphs",{uid:this.uid,stacks:zt},((ne,qt)=>{U||(U=ne,$=qt,Vt.call(this))}),void 0,!1,wt):$={};const Wt=Object.keys(O.iconDependencies);Wt.length?p.send("getImages",{icons:Wt,source:this.source,tileID:this.tileID,type:"icons"},((ne,qt)=>{U||(U=ne,Q=qt,Vt.call(this))}),void 0,!1,wt):Q={};const Ot=Object.keys(O.patternDependencies);function Vt(){if(U)return y(U);if($&&Q&&at){const ne=new wv($),qt=new Hp(Q,at);for(const Me in I){const Ie=I[Me];Ie instanceof hh?(my(Ie.layers,this.zoom,c),Xd(Ie,$,ne.positions,Q,qt.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Ie.hasPattern&&(Ie instanceof rd||Ie instanceof ed||Ie instanceof af)&&(my(Ie.layers,this.zoom,c),Ie.addFeatures(O,this.tileID.canonical,qt.patternPositions,c,this.tileTransform))}this.status="done",y(null,{buckets:te(I).filter((Me=>!Me.isEmpty())),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ne.image,lineAtlas:M,imageAtlas:qt,glyphMap:this.returnDependencies?$:null,iconMap:this.returnDependencies?Q:null,glyphPositions:this.returnDependencies?ne.positions:null})}}Ot.length?p.send("getImages",{icons:Ot,source:this.source,tileID:this.tileID,type:"patterns"},((ne,qt)=>{U||(U=ne,at=qt,Vt.call(this))}),void 0,!1,wt):at={},Vt.call(this)}}function my(r,e,s){const c=new Nt(e);for(const p of r)p.recalculate(c,s)}class Ev{constructor(e){this.entries={},this.scheduler=e}request(e,s,c,p){const y=this.entries[e]=this.entries[e]||{callbacks:[]};if(y.result){const[x,E]=y.result;return this.scheduler?this.scheduler.add((()=>{p(x,E)}),s):p(x,E),()=>{}}return y.callbacks.push(p),y.cancel||(y.cancel=c(((x,E)=>{y.result=[x,E];for(const I of y.callbacks)this.scheduler?this.scheduler.add((()=>{I(x,E)}),s):I(x,E);setTimeout((()=>delete this.entries[e]),3e3)}))),()=>{y.result||(y.callbacks=y.callbacks.filter((x=>x!==p)),y.callbacks.length||(y.cancel(),delete this.entries[e]))}}}function Sv(r,e,s){const c=JSON.stringify(r.request);return r.data&&(this.deduped.entries[c]={result:[null,r.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},(p=>{const y=Rs(r.request,((x,E,I,M)=>{x?p(x):E&&p(null,{vectorTile:s?void 0:new Nd(new hf(E)),rawData:E,cacheControl:I,expires:M})}));return()=>{y.cancel(),p()}}),e)}h.ARRAY_TYPE=bo,h.AUTH_ERR_MSG=ya,h.Aabb=Eo,h.Actor=class{constructor(r,e,s){this.target=r,this.parent=e,this.mapId=s,this.callbacks={},this.cancelCallbacks={},An(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ui()?r:X,this.scheduler=new h1}send(r,e,s,c,p=!1,y){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=y,this.callbacks[x]=s);const E=_l(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:r,hasCallback:!!s,targetMapId:c,mustQueue:p,sourceMapId:this.mapId,data:wu(e,E)},E),{cancel:()=>{s&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(r){const e=r.data,s=e.id;if(s&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(e.mustQueue||ui()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add((()=>this.processTask(s,e)),c&&c.metadata||{type:"message"})}else this.processTask(s,e)}processTask(r,e){if(e.type==="<response>"){const s=this.callbacks[r];delete this.callbacks[r],s&&(e.error?s(xo(e.error)):s(null,xo(e.data)))}else{const s=_l(this.globalScope)?void 0:[],c=e.hasCallback?(y,x)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:y?wu(y):null,data:wu(x,s)},s)}:y=>{},p=xo(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,p,c);else if(this.parent.getWorkerSource){const y=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,y[0],p.source)[y[1]](p,c)}else c(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},h.CanonicalTileID=Xc,h.Color=Qe,h.ColorMode=ph,h.CullFaceMode=Yc,h.DEMData=Em,h.DataConstantProperty=ge,h.DedupedRequest=Ev,h.DepthMode=Qd,h.EXTENT=ai,h.Elevation=class{isDataAvailableAtPoint(r){const e=this._source();if(this.isUsingMockSource()||!e||r.y<0||r.y>1)return!1;const s=e.getSource().maxzoom,c=1<<s,p=Math.floor(r.x),y=Math.floor((r.x-p)*c),x=Math.floor(r.y*c),E=this.findDEMTileFor(new pa(s,p,s,y,x));return!(!E||!E.dem)}getAtPointOrZero(r,e=0){return this.getAtPoint(r,e)||0}getAtPoint(r,e,s=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const c=this._source();if(!c||r.y<0||r.y>1)return e;const p=c.getSource().maxzoom,y=1<<p,x=Math.floor(r.x),E=r.x-x,I=new pa(p,x,p,Math.floor(E*y),Math.floor(r.y*y)),M=this.findDEMTileFor(I);if(!M||!M.dem)return e;const O=M.dem,k=1<<M.tileID.canonical.z,U=(E*k-M.tileID.canonical.x)*O.dim,$=(r.y*k-M.tileID.canonical.y)*O.dim,Q=Math.floor(U),at=Math.floor($);return(s?this.exaggeration():1)*Ii(Ii(O.get(Q,at),O.get(Q,at+1),$-at),Ii(O.get(Q+1,at),O.get(Q+1,at+1),$-at),U-Q)}getAtTileOffset(r,e,s){const c=1<<r.canonical.z;return this.getAtPointOrZero(new Xh(r.wrap+(r.canonical.x+e/ai)/c,(r.canonical.y+s/ai)/c))}getAtTileOffsetFunc(r,e,s,c){return p=>{const y=this.getAtTileOffset(r,p.x,p.y),x=c.upVector(r.canonical,p.x,p.y);return ko(x,x,y*c.upVectorScale(r.canonical,e,s).metersToTile),x}}getForTilePoints(r,e,s,c){if(this.isUsingMockSource())return!1;const p=Sm.create(this,r,c);return!!p&&(e.forEach((y=>{y[2]=this.exaggeration()*p.getElevationAt(y[0],y[1],s)})),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(r);if(!e||!e.dem)return null;const s=e.dem.tree,c=e.tileID,p=1<<r.canonical.z-c.canonical.z;let y=r.canonical.x/p-c.canonical.x,x=r.canonical.y/p-c.canonical.y,E=0;for(let I=0;I<r.canonical.z-c.canonical.z&&!s.leaves[E];I++){y*=2,x*=2;const M=2*Math.floor(x)+Math.floor(y);E=s.childOffsets[E]+M,y%=1,x%=1}return{min:this.exaggeration()*s.minimums[E],max:this.exaggeration()*s.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,e,s){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},h.ErrorEvent=Ra,h.EvaluationParameters=Nt,h.Event=_i,h.Evented=Ss,h.FillExtrusionBucket=af,h.Frustum=lc,h.FrustumCorners=Td,h.GLOBE_METERS_TO_ECEF=ig,h.GLOBE_RADIUS=Hu,h.GLOBE_SCALE_MATCH_LATITUDE=45,h.GLOBE_ZOOM_THRESHOLD_MAX=6,h.GLOBE_ZOOM_THRESHOLD_MIN=5,h.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_createGrid(r){const e=new di,s=new Bo,c=65;for(let p=0;p<c;p++)for(let y=0;y<c;y++)e.emplaceBack(y,p);this._gridSegments=[];for(let p=0,y=0;p<uh.length;p++){const x=uh[p];for(let I=0;I<x;I++)for(let M=0;M<64;M++){const O=I*c+M;s.emplaceBack(O+1,O,O+c),s.emplaceBack(O+c,O+c+1,O+1)}const E=64*x*2;this._gridSegments.push(Qs.simpleSegment(0,y,(x+1)*c,E)),y+=E}this._gridBuffer=r.createVertexBuffer(e,wf.members),this._gridIndexBuffer=r.createIndexBuffer(s,!0)}_createPoles(r){const e=new Bo;for(let p=0;p<=Ef;p++)e.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=r.createIndexBuffer(e,!0);const s=new pl,c=new pl;this._poleSegments=[];for(let p=0,y=0;p<5;p++){const x=360/(1<<p);s.emplaceBack(0,-Hu,0,.5,0),c.emplaceBack(0,-Hu,0,.5,1);for(let E=0;E<=Ef;E++){const I=E/Ef,M=Ii(0,x,I),[O,k,U]=Rc(ug,Jd,M,Hu);s.emplaceBack(O,k,U,I,0),c.emplaceBack(O,k,U,I,1)}this._poleSegments.push(Qs.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(s,Yd,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(c,Yd,!1)}getGridBuffers(r){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[r]]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,e){if(!this._wireframeSegments){const s=new gl,c=Ef,p=c+1;this._wireframeSegments=[];for(let y=0,x=0;y<uh.length;y++){const E=uh[y];for(let M=0;M<E;M++)for(let O=0;O<c;O++){const k=M*p+O;s.emplaceBack(k,k+1),s.emplaceBack(k,k+p),s.emplaceBack(k,k+p+1)}const I=E*c*3;this._wireframeSegments.push(Qs.simpleSegment(0,x,(E+1)*p,I)),x+=I}this._wireframeIndexBuffer=r.createIndexBuffer(s)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},h.GlyphManager=_f,h.ImagePosition=Zp,h.LivePerformanceUtils=je,h.LngLat=fr,h.LngLatBounds=xc,h.LocalGlyphMode=qd,h.MAX_MERCATOR_LATITUDE=oc,h.MercatorCoordinate=Xh,h.ONE_EM=Go,h.OverscaledTileID=pa,h.PerformanceMarkers=me,h.Properties=Xe,h.RGBAImage=Bl,h.Ray=yl,h.RequestManager=class{constructor(r,e,s){this._transformRequestFn=r,this._customAccessToken=e,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const r=(function(){let e="";for(let s=0;s<10;s++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",lt,e].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,e){return this._transformRequestFn&&this._transformRequestFn(r,e)||{url:r}}normalizeStyleURL(r,e){if(!Dr(r))return r;const s=ts(r);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||e)}normalizeGlyphsURL(r,e){if(!Dr(r))return r;const s=ts(r);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||e)}normalizeSourceURL(r,e,s,c){if(!Dr(r))return r;const p=ts(r);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),s&&p.params.push(`language=${s}`),c&&p.params.push(`worldview=${c}`),this._makeAPIURL(p,this._customAccessToken||e)}normalizeSpriteURL(r,e,s,c){const p=ts(r);return Dr(r)?(p.path=`/styles/v1${p.path}/sprite${e}${s}`,this._makeAPIURL(p,this._customAccessToken||c)):(p.path+=`${e}${s}`,Pi(p))}normalizeTileURL(r,e,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!Dr(r))return r;const c=ts(r);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||s&&c.authority!=="raster"&&s===512?"@2x":""}${At.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${st.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${st.TILE_URL_VERSION}${c.path}`);const p=this._customAccessToken||(function(y){for(const x of y){const E=x.match(/^access_token=(.*)$/);if(E)return E[1]}return null})(c.params)||st.ACCESS_TOKEN;return st.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,p)}canonicalizeTileURL(r,e){const s=ts(r);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return r;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${st.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${st.TILE_URL_VERSION}/`,"")}`;let p=s.params;return e&&(p=p.filter((y=>!y.match(/^access_token=/)))),p.length&&(c+=`?${p.join("&")}`),c}canonicalizeTileset(r,e){const s=!!e&&Dr(e),c=[];for(const p of r.tiles||[])Kn(p)?c.push(this.canonicalizeTileURL(p,s)):c.push(p);return c}_makeAPIURL(r,e){const s="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",c=ts(st.API_URL);if(r.protocol=c.protocol,r.authority=c.authority,r.protocol==="http"){const p=r.params.indexOf("secure");p>=0&&r.params.splice(p,1)}if(c.path!=="/"&&(r.path=`${c.path}${r.path}`),!st.REQUIRE_ACCESS_TOKEN)return Pi(r);if(e=e||st.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return r.params=r.params.filter((p=>p.indexOf("access_token")===-1)),r.params.push(`access_token=${e||""}`),Pi(r)}},h.ResourceType=Xr,h.SegmentVector=Qs,h.SourceCache=hd,h.StencilMode=dy,h.StructArrayLayout1ui2=t,h.StructArrayLayout2f1f2i16=Po,h.StructArrayLayout2i4=di,h.StructArrayLayout2ui4=gl,h.StructArrayLayout3f12=Ia,h.StructArrayLayout3ui6=Bo,h.StructArrayLayout4i8=pi,h.StructArrayLayout5f20=pl,h.Texture=hg,h.Tile=hy,h.Transitionable=Ee,h.Uniform1f=qh,h.Uniform1i=class extends _c{constructor(r){super(r),this.current=0}set(r,e,s){this.fetchUniformLocation(r,e)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},h.Uniform2f=class extends _c{constructor(r){super(r),this.current=[0,0]}set(r,e,s){this.fetchUniformLocation(r,e)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}},h.Uniform3f=class extends _c{constructor(r){super(r),this.current=[0,0,0]}set(r,e,s){this.fetchUniformLocation(r,e)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}},h.Uniform4f=cp,h.UniformColor=hp,h.UniformMatrix2f=class extends _c{constructor(r){super(r),this.current=Tg}set(r,e,s){if(this.fetchUniformLocation(r,e)){for(let c=0;c<4;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}},h.UniformMatrix3f=class extends _c{constructor(r){super(r),this.current=Sg}set(r,e,s){if(this.fetchUniformLocation(r,e)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},h.UniformMatrix4f=class extends _c{constructor(r){super(r),this.current=fp}set(r,e,s){if(this.fetchUniformLocation(r,e)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let c=1;c<16;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}},h.UnwrappedTileID=zd,h.ValidationError=bn,h.VectorTileFeature=jc,h.VectorTileWorkerSource=class extends Ss{constructor(r,e,s,c,p){super(),this.actor=r,this.layerIndex=e,this.availableImages=s,this.loadVectorData=p||Sv,this.loading={},this.loaded={},this.deduped=new Ev(r.scheduler),this.isSpriteLoaded=c,this.scheduler=r.scheduler}loadTile(r,e){const s=r.uid,c=r&&r.request,p=c&&c.collectResourceTiming,y=this.loading[s]=new m1(r);y.abort=this.loadVectorData(r,((x,E)=>{const I=!this.loading[s];if(delete this.loading[s],I||x||!E)return y.status="done",I||(this.loaded[s]=y),e(x);const M=E.rawData,O={};E.expires&&(O.expires=E.expires),E.cacheControl&&(O.cacheControl=E.cacheControl),y.vectorTile=E.vectorTile||new Nd(new hf(M));const k=()=>{y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,((U,$)=>{if(U||!$)return e(U);const Q={};if(p){const at=Zn(c);at.length>0&&(Q.resourceTiming=JSON.parse(JSON.stringify(at)))}e(null,mt({rawTileData:M.slice(0)},$,O,Q))}))};this.isSpriteLoaded?k():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(k,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):k()})),this.loaded=this.loaded||{},this.loaded[s]=y}))}reloadTile(r,e){const s=this.loaded,c=r.uid,p=this;if(s&&s[c]){const y=s[c];y.showCollisionBoxes=r.showCollisionBoxes,y.enableTerrain=!!r.enableTerrain,y.projection=r.projection,y.tileTransform=Uh(r.tileID.canonical,r.projection);const x=(E,I)=>{const M=y.reloadCallback;M&&(delete y.reloadCallback,y.parse(y.vectorTile,p.layerIndex,this.availableImages,p.actor,M)),e(E,I)};y.status==="parsing"?y.reloadCallback=x:y.status==="done"&&(y.vectorTile?y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(r,e){const s=r.uid,c=this.loading[s];c&&(c.abort&&c.abort(),delete this.loading[s]),e()}removeTile(r,e){const s=this.loaded,c=r.uid;s&&s[c]&&delete s[c],e()}},h.WritingMode=Ul,h.ZoomHistory=Al,h.add=wc,h.addDynamicAttributes=Zi,h.adjoint=function(r,e){var s=e[0],c=e[1],p=e[2],y=e[3],x=e[4],E=e[5],I=e[6],M=e[7],O=e[8];return r[0]=x*O-E*M,r[1]=p*M-c*O,r[2]=c*E-p*x,r[3]=E*I-y*O,r[4]=s*O-p*I,r[5]=p*y-s*E,r[6]=y*M-x*I,r[7]=c*I-s*M,r[8]=s*x-c*y,r},h.asyncAll=ye,h.bezier=Sn,h.bindAll=An,h.boundsAttributes=av,h.bufferConvexPolygon=function(r,e){const s=[];for(let c=0;c<r.length;c++){const p=ut(c-1,-1,r.length-1),y=ut(c+1,-1,r.length-1),x=r[c],E=r[y],I=r[p].sub(x).unit(),M=E.sub(x).unit(),O=M.angleWithSep(I.x,I.y),k=I.add(M).unit().mult(-1*e/Math.sin(O/2));s.push(x.add(k))}return s},h.cacheEntryPossiblyAdded=function(r){yr++,yr>ql&&(r.getActor().send("enforceCacheSizeLimit",$a),yr=0)},h.calculateGlobeLabelMatrix=function(r,e){const{x:s,y:c}=r.point,p=cd(s,c,r.worldSize/r._pixelsPerMercatorPixel,0,0);return is(p,p,If(ja(e)))},h.calculateGlobeMatrix=function(r){const{x:e,y:s}=r.point,{lng:c,lat:p}=r._center;return cd(e,s,r.worldSize,c,p)},h.calculateGlobeMercatorMatrix=function(r){const e=r.pixelsPerMeter,s=e/Cu(1,r.center.lat),c=Mu(new Float64Array(16));return Zf(c,c,[r.point.x,r.point.y,0]),Eh(c,c,[s,s,e]),Float32Array.from(c)},h.circumferenceAtLatitude=kc,h.clamp=ct,h.clearTileCache=function(r){if(!Qr())return;const e=X.caches.delete(Wa);r&&e.catch(r).then((()=>r()))},h.clipLine=pm,h.clone=function(r){var e=new bo(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},h.clone$1=jr,h.collisionCircleLayout=kp,h.config=st,h.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},h.create=function(){var r=new bo(16);return bo!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},h.create$1=wd,h.createExpression=Jo,h.createLayout=tn,h.createStyleLayer=function(r){return r.type==="custom"?new a1(r):new u1[r.type](r)},h.cross=Qo,h.degToRad=ie,h.distance=function(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1],e[2]-r[2])},h.div=function(r,e,s){return r[0]=e[0]/s[0],r[1]=e[1]/s[1],r[2]=e[2]/s[2],r},h.dot=Au,h.earthRadius=jh,h.ease=Xn,h.easeCubicInOut=qe,h.ecefToLatLng=function([r,e,s]){const c=Math.hypot(r,e,s),p=Math.atan2(r,s),y=.5*Math.PI-Math.acos(-e/c);return new fr(Yt(p),Yt(y))},h.emitValidationErrors=Uu,h.endsWith=$n,h.enforceCacheSizeLimit=function(r){hs(),eo&&eo.then((e=>{e.keys().then((s=>{for(let c=0;c<s.length-r;c++)e.delete(s[c])}))}))},h.evaluateSizeForFeature=uf,h.evaluateSizeForZoom=Mc,h.evaluateVariableOffset=ym,h.evented=Rt,h.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},h.exactEquals$1=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]},h.exported=ki,h.exported$1=At,h.extend=mt,h.extend$1=Hr,h.fillExtrusionHeightLift=Bp,h.filterObject=Gi,h.fromMat4=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},h.fromQuat=function(r,e){var s=e[0],c=e[1],p=e[2],y=e[3],x=s+s,E=c+c,I=p+p,M=s*x,O=c*x,k=c*E,U=p*x,$=p*E,Q=p*I,at=y*x,wt=y*E,zt=y*I;return r[0]=1-k-Q,r[1]=O+zt,r[2]=U-wt,r[3]=0,r[4]=O-zt,r[5]=1-M-Q,r[6]=$+at,r[7]=0,r[8]=U+wt,r[9]=$-at,r[10]=1-M-k,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},h.fromRotation=function(r,e){var s=Math.sin(e),c=Math.cos(e);return r[0]=c,r[1]=s,r[2]=0,r[3]=-s,r[4]=c,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},h.fromScaling=Gc,h.furthestTileCorner=function(r){const e=Math.round((r+45+360)%360/90)%4;return rt[e]},h.getAABBPointSquareDist=function(r,e,s){let c=0;for(let p=0;p<2;++p){const y=s?s[p]:0;r[p]>y&&(c+=(r[p]-y)*(r[p]-y)),e[p]<y&&(c+=(y-e[p])*(y-e[p]))}return c},h.getAnchorAlignment=gf,h.getAnchorJustification=xf,h.getBounds=function(r){let e=1/0,s=1/0,c=-1/0,p=-1/0;for(const y of r)e=Math.min(e,y.x),s=Math.min(s,y.y),c=Math.max(c,y.x),p=Math.max(p,y.y);return{min:new Dt(e,s),max:new Dt(c,p)}},h.getColumn=Us,h.getGridMatrix=function(r,e,s,c){const p=e.getNorth(),y=e.getSouth(),x=e.getWest(),E=e.getEast(),I=1<<r.z,M=E-x,O=p-y,k=M/Ef,U=-O/uh[s],$=[0,k,0,U,0,0,p,x,0];if(r.z>0){const Q=180/c;Cp($,$,[Q/M+1,0,0,0,Q/O+1,0,-.5*Q/k,.5*Q/U,1])}return $[2]=I,$[5]=r.x,$[8]=r.y,$},h.getImage=vl,h.getJSON=function(r,e){return Tr(mt(r,{type:"json"}),e)},h.getLatitudinalLod=function(r){const e=80.051129;r=ct(r,-80.051129,e)/e*90;const s=Math.pow(Math.abs(Math.sin(ie(r))),3);return Math.round(s*(uh.length-1))},h.getMapSessionAPI=se,h.getPerformanceMeasurement=Zn,h.getProjection=Re,h.getRTLTextPluginStatus=Tt,h.getReferrer=Ki,h.getTilePoint=function(r,{x:e,y:s},c=0){return new Dt(((e-c)*r.scale-r.x)*ai,(s*r.scale-r.y)*ai)},h.getTileVec3=function(r,e,s=0){return Kc(((e.x-s)*r.scale-r.x)*ai,(e.y*r.scale-r.y)*ai,_d(e.z,e.y))},h.getVideo=function(r,e){const s=X.document.createElement("video");s.muted=!0,s.onloadstart=function(){e(null,s)};for(let c=0;c<r.length;c++){const p=X.document.createElement("source");_r(r[c])||(s.crossOrigin="Anonymous"),p.src=r[c],s.appendChild(p)}return{cancel:()=>{}}},h.globeCenterToScreenPoint=function(r){const e=[0,0,0],s=Mu(new Float64Array(16));return is(s,r.pixelMatrix,r.globeMatrix),wo(e,e,s),new Dt(e[0],e[1])},h.globeDenormalizeECEF=If,h.globeECEFOrigin=function(r,e){const s=[0,0,0];return wo(s,s,ud(ja(e.canonical))),wo(s,s,r),s},h.globeNormalizeECEF=ud,h.globePixelsToTileUnits=function(r,e){return ai/(512*Math.pow(2,r))*Bh(ja(e))},h.globePoleMatrixForTile=function(r,e,s){const c=Mu(new Float64Array(16)),p=(e/(1<<r)-.5)*Math.PI*2;return Jc(c,s.globeMatrix,p),Float32Array.from(c)},h.globeTileBounds=ja,h.globeTiltAtLngLat=kh,h.globeToMercatorTransition=Fh,h.globeUseCustomAntiAliasing=function(r,e,s){const c=Fh(s.zoom),p=r.style.map._antialias,y=!!e.extStandardDerivatives,x=e.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return c===0&&!p&&!x&&y},h.identity=Mu,h.identity$1=Yf,h.invert=wh,h.isFullscreen=function(){return!!X.document.fullscreenElement||!!X.document.webkitFullscreenElement},h.isLngLatBehindGlobe=function(r,e){return kh(r,e)>Math.PI/2*1.01},h.isMapAuthenticated=function(r){return $t.has(r)},h.isMapboxURL=Dr,h.isSafariWithAntialiasingBug=function(r){const e=r.navigator?r.navigator.userAgent:null;return!!_l(r)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},h.latFromMercatorY=fa,h.latLngToECEF=ld,h.len=Vc,h.length=Hh,h.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},h.lngFromMercatorX=ml,h.loadVectorTile=Sv,h.makeRequest=Tr,h.mapValue=function(r,e,s,c,p){return ct((r-e)/(s-e)*(p-c)+c,c,p)},h.mercatorScale=mp,h.mercatorXfromLng=rc,h.mercatorYfromLat=sc,h.mercatorZfromAltitude=Cu,h.mul=Rg,h.mul$1=iu,h.multiply=is,h.multiply$1=Cp,h.multiply$2=Sd,h.nextPowerOfTwo=de,h.normalize=Aa,h.normalize$1=Ng,h.normalize$2=Lp,h.number=Ii,h.ortho=function(r,e,s,c,p,y,x){var E=1/(e-s),I=1/(c-p),M=1/(y-x);return r[0]=-2*E,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*I,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*M,r[11]=0,r[12]=(e+s)*E,r[13]=(p+c)*I,r[14]=(x+y)*M,r[15]=1,r},h.pbf=hf,h.perspective=function(r,e,s,c,p){var y,x=1/Math.tan(e/2);return r[0]=x/s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=x,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,p!=null&&p!==1/0?(r[10]=(p+c)*(y=1/(c-p)),r[14]=2*p*c*y):(r[10]=-1,r[14]=-2*c),r},h.pick=function(r,e){const s={};for(let c=0;c<e.length;c++){const p=e[c];p in r&&(s[p]=r[p])}return s},h.plugin=Gt,h.pointGeometry=Dt,h.polygonContainsPoint=Uc,h.polygonIntersectsBox=jf,h.polygonIntersectsPolygon=Vf,h.polygonizeBounds=function(r,e,s=0,c=!0){const p=new Dt(s,s),y=r.sub(p),x=e.add(p),E=[y,new Dt(x.x,y.y),x,new Dt(y.x,x.y)];return c&&E.push(y.clone()),E},h.posAttributes=wf,h.postMapLoadEvent=Lt,h.postPerformanceEvent=Kt,h.postTurnstileEvent=et,h.potpack=Xp,h.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},h.radToDeg=Yt,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.registerForPluginStateChange=function(r){return r({pluginStatus:xt,pluginURL:Mt}),Rt.on("pluginStateChange",r),r},h.removeAuthState=function(r){$t.delete(r)},h.renderColorRamp=Id,h.resample=Fo,h.rotateX=Ed,h.rotateX$1=Pl,h.rotateY=Jc,h.rotateY$1=ju,h.rotateZ=function(r,e,s){var c=Math.sin(s),p=Math.cos(s),y=e[0],x=e[1],E=e[2],I=e[3],M=e[4],O=e[5],k=e[6],U=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=y*p+M*c,r[1]=x*p+O*c,r[2]=E*p+k*c,r[3]=I*p+U*c,r[4]=M*p-y*c,r[5]=O*p-x*c,r[6]=k*p-E*c,r[7]=U*p-I*c,r},h.rotateZ$1=function(r,e,s){s*=.5;var c=e[0],p=e[1],y=e[2],x=e[3],E=Math.sin(s),I=Math.cos(s);return r[0]=c*I+p*E,r[1]=p*I-c*E,r[2]=y*I+x*E,r[3]=x*I-y*E,r},h.scale=Eh,h.scale$1=Ap,h.scale$2=ko,h.scaleAndAdd=to,h.set=function(r,e,s,c){return r[0]=e,r[1]=s,r[2]=c,r},h.setCacheLimits=function(r,e){$a=r,ql=e},h.setColumn=function(r,e,s){r[4*e+0]=s[0],r[4*e+1]=s[1],r[4*e+2]=s[2],r[4*e+3]=s[3]},h.setRTLTextPlugin=function(r,e,s=!1){if(xt===Y||xt===nt||xt===dt)throw new Error("setRTLTextPlugin cannot be called multiple times.");Mt=ki.resolveURL(r),xt=Y,Et=e,vt(),s||Ut()},h.smoothstep=kt,h.spec=_e,h.squaredLength=function(r){var e=r[0],s=r[1],c=r[2];return e*e+s*s+c*c},h.storeAuthState=function(r,e){e?$t.add(r):$t.delete(r)},h.sub=Ar,h.subtract=Hf,h.symbolSize=kd,h.tileAABB=function(r,e,s,c,p,y,x,E,I){if(I.name==="globe")return ch(r,e,new Xc(s,c,p));const M=Uh({z:s,x:c,y:p},I);return new Eo([(y+M.x/M.scale)*e,e*(M.y/M.scale),x],[(y+M.x2/M.scale)*e,e*(M.y2/M.scale),E])},h.tileCornersToBounds=Wd,h.tileTransform=Uh,h.transformMat3=function(r,e,s){var c=e[0],p=e[1],y=e[2];return r[0]=c*s[0]+p*s[3]+y*s[6],r[1]=c*s[1]+p*s[4]+y*s[7],r[2]=c*s[2]+p*s[5]+y*s[8],r},h.transformMat4=wo,h.transformMat4$1=th,h.transformQuat=Mp,h.transitionTileAABBinECEF=Sf,h.translate=Zf,h.transpose=function(r,e){if(r===e){var s=e[1],c=e[2],p=e[5];r[1]=e[3],r[2]=e[6],r[3]=s,r[5]=e[7],r[6]=c,r[7]=p}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r},h.triggerPluginCompletionEvent=St,h.uniqueId=ve,h.updateGlobeVertexNormal=function(r,e,s,c,p){const y=5*e+2;r.float32[y+0]=s,r.float32[y+1]=c,r.float32[y+2]=p},h.validateCustomStyleLayer=function(r){const e=[],s=r.id;return s===void 0&&e.push({message:`layers.${s}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${s}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),e},h.validateFilter=r=>Sa(os(r)),h.validateFog=r=>Sa(ku(r)),h.validateLayer=r=>Sa(lo(r)),h.validateLight=r=>Sa(Ua(r)),h.validateSource=r=>Sa(bu(r)),h.validateStyle=Oo,h.validateTerrain=r=>Sa(ul(r)),h.values=te,h.vectorTile=nf,h.version=tt,h.warnOnce=lr,h.window=X,h.wrap=ut})),j(["./shared"],(function(h){function X(Ct){if(typeof Ct=="number"||typeof Ct=="boolean"||typeof Ct=="string"||Ct==null)return JSON.stringify(Ct);if(Array.isArray(Ct)){let ot="[";for(const Lt of Ct)ot+=`${X(Lt)},`;return`${ot}]`}let et="{";for(const ot of Object.keys(Ct).sort())et+=`${ot}:${X(Ct[ot])},`;return`${et}}`}function tt(Ct){let et="";for(const ot of h.refProperties)et+=`/${X(Ct[ot])}`;return et}class ht{constructor(et){this.keyCache={},et&&this.replace(et)}replace(et){this._layerConfigs={},this._layers={},this.update(et,[])}update(et,ot){for(const Pt of et)this._layerConfigs[Pt.id]=Pt,(this._layers[Pt.id]=h.createStyleLayer(Pt)).compileFilter(),this.keyCache[Pt.id]&&delete this.keyCache[Pt.id];for(const Pt of ot)delete this.keyCache[Pt],delete this._layerConfigs[Pt],delete this._layers[Pt];this.familiesBySource={};const Lt=(function(Pt,Kt){const ue={};for(let $t=0;$t<Pt.length;$t++){const me=Kt&&Kt[Pt[$t].id]||tt(Pt[$t]);Kt&&(Kt[Pt[$t].id]=me);let je=ue[me];je||(je=ue[me]=[]),je.push(Pt[$t])}const se=[];for(const $t in ue)se.push(ue[$t]);return se})(h.values(this._layerConfigs),this.keyCache);for(const Pt of Lt){const Kt=Pt.map((yn=>this._layers[yn.id])),ue=Kt[0];if(ue.visibility==="none")continue;const se=ue.source||"";let $t=this.familiesBySource[se];$t||($t=this.familiesBySource[se]={});const me=ue.sourceLayer||"_geojsonTileLayer";let je=$t[me];je||(je=$t[me]=[]),je.push(Kt)}}}class st{loadTile(et,ot){const{uid:Lt,encoding:Pt,rawImageData:Kt,padding:ue,buildQuadTree:se}=et,$t=h.window.ImageBitmap&&Kt instanceof h.window.ImageBitmap?this.getImageData(Kt,ue):Kt;ot(null,new h.DEMData(Lt,$t,Pt,ue<1,se))}getImageData(et,ot){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(et.width,et.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=et.width,this.offscreenCanvas.height=et.height,this.offscreenCanvasContext.drawImage(et,0,0,et.width,et.height);const Lt=this.offscreenCanvasContext.getImageData(-ot,-ot,et.width+2*ot,et.height+2*ot);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Lt}}var At=function Ct(et,ot){var Lt,Pt=et&&et.type;if(Pt==="FeatureCollection")for(Lt=0;Lt<et.features.length;Lt++)Ct(et.features[Lt],ot);else if(Pt==="GeometryCollection")for(Lt=0;Lt<et.geometries.length;Lt++)Ct(et.geometries[Lt],ot);else if(Pt==="Feature")Ct(et.geometry,ot);else if(Pt==="Polygon")yt(et.coordinates,ot);else if(Pt==="MultiPolygon")for(Lt=0;Lt<et.coordinates.length;Lt++)yt(et.coordinates[Lt],ot);return et};function yt(Ct,et){if(Ct.length!==0){it(Ct[0],et);for(var ot=1;ot<Ct.length;ot++)it(Ct[ot],!et)}}function it(Ct,et){for(var ot=0,Lt=0,Pt=0,Kt=Ct.length,ue=Kt-1;Pt<Kt;ue=Pt++){var se=(Ct[Pt][0]-Ct[ue][0])*(Ct[ue][1]+Ct[Pt][1]),$t=ot+se;Lt+=Math.abs(ot)>=Math.abs(se)?ot-$t+se:se-$t+ot,ot=$t}ot+Lt>=0!=!!et&&Ct.reverse()}const ae=h.VectorTileFeature.prototype.toGeoJSON;class le{constructor(et){this._feature=et,this.extent=h.EXTENT,this.type=et.type,this.properties=et.tags,"id"in et&&!isNaN(et.id)&&(this.id=parseInt(et.id,10))}loadGeometry(){if(this._feature.type===1){const et=[];for(const ot of this._feature.geometry)et.push([new h.pointGeometry(ot[0],ot[1])]);return et}{const et=[];for(const ot of this._feature.geometry){const Lt=[];for(const Pt of ot)Lt.push(new h.pointGeometry(Pt[0],Pt[1]));et.push(Lt)}return et}}toGeoJSON(et,ot,Lt){return ae.call(this,et,ot,Lt)}}class Ft{constructor(et){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=et.length,this._features=et}feature(et){return new le(this._features[et])}}var lt={exports:{}},pt=h.pointGeometry,It=h.vectorTile.VectorTileFeature,Dt=_t;function _t(Ct,et){this.options=et||{},this.features=Ct,this.length=Ct.length}function Jt(Ct,et){this.id=typeof Ct.id=="number"?Ct.id:void 0,this.type=Ct.type,this.rawGeometry=Ct.type===1?[Ct.geometry]:Ct.geometry,this.properties=Ct.tags,this.extent=et||4096}_t.prototype.feature=function(Ct){return new Jt(this.features[Ct],this.options.extent)},Jt.prototype.loadGeometry=function(){var Ct=this.rawGeometry;this.geometry=[];for(var et=0;et<Ct.length;et++){for(var ot=Ct[et],Lt=[],Pt=0;Pt<ot.length;Pt++)Lt.push(new pt(ot[Pt][0],ot[Pt][1]));this.geometry.push(Lt)}return this.geometry},Jt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ct=this.geometry,et=1/0,ot=-1/0,Lt=1/0,Pt=-1/0,Kt=0;Kt<Ct.length;Kt++)for(var ue=Ct[Kt],se=0;se<ue.length;se++){var $t=ue[se];et=Math.min(et,$t.x),ot=Math.max(ot,$t.x),Lt=Math.min(Lt,$t.y),Pt=Math.max(Pt,$t.y)}return[et,Lt,ot,Pt]},Jt.prototype.toGeoJSON=It.prototype.toGeoJSON;var Xt=h.pbf,ie=Dt;function Yt(Ct){var et=new Xt;return(function(ot,Lt){for(var Pt in ot.layers)Lt.writeMessage(3,rt,ot.layers[Pt])})(Ct,et),et.finish()}function rt(Ct,et){var ot;et.writeVarintField(15,Ct.version||1),et.writeStringField(1,Ct.name||""),et.writeVarintField(5,Ct.extent||4096);var Lt={keys:[],values:[],keycache:{},valuecache:{}};for(ot=0;ot<Ct.length;ot++)Lt.feature=Ct.feature(ot),et.writeMessage(2,qe,Lt);var Pt=Lt.keys;for(ot=0;ot<Pt.length;ot++)et.writeStringField(3,Pt[ot]);var Kt=Lt.values;for(ot=0;ot<Kt.length;ot++)et.writeMessage(4,ut,Kt[ot])}function qe(Ct,et){var ot=Ct.feature;ot.id!==void 0&&et.writeVarintField(1,ot.id),et.writeMessage(2,Sn,Ct),et.writeVarintField(3,ot.type),et.writeMessage(4,kt,ot)}function Sn(Ct,et){var ot=Ct.feature,Lt=Ct.keys,Pt=Ct.values,Kt=Ct.keycache,ue=Ct.valuecache;for(var se in ot.properties){var $t=ot.properties[se],me=Kt[se];if($t!==null){me===void 0&&(Lt.push(se),Kt[se]=me=Lt.length-1),et.writeVarint(me);var je=typeof $t;je!=="string"&&je!=="boolean"&&je!=="number"&&($t=JSON.stringify($t));var yn=je+":"+$t,Je=ue[yn];Je===void 0&&(Pt.push($t),ue[yn]=Je=Pt.length-1),et.writeVarint(Je)}}}function Xn(Ct,et){return(et<<3)+(7&Ct)}function ct(Ct){return Ct<<1^Ct>>31}function kt(Ct,et){for(var ot=Ct.loadGeometry(),Lt=Ct.type,Pt=0,Kt=0,ue=ot.length,se=0;se<ue;se++){var $t=ot[se],me=1;Lt===1&&(me=$t.length),et.writeVarint(Xn(1,me));for(var je=Lt===3?$t.length-1:$t.length,yn=0;yn<je;yn++){yn===1&&Lt!==1&&et.writeVarint(Xn(2,je-1));var Je=$t[yn].x-Pt,Zn=$t[yn].y-Kt;et.writeVarint(ct(Je)),et.writeVarint(ct(Zn)),Pt+=Je,Kt+=Zn}Lt===3&&et.writeVarint(Xn(7,1))}}function ut(Ct,et){var ot=typeof Ct;ot==="string"?et.writeStringField(1,Ct):ot==="boolean"?et.writeBooleanField(7,Ct):ot==="number"&&(Ct%1!=0?et.writeDoubleField(3,Ct):Ct<0?et.writeSVarintField(6,Ct):et.writeVarintField(5,Ct))}function ye(Ct,et,ot,Lt,Pt,Kt){if(Pt-Lt<=ot)return;const ue=Lt+Pt>>1;te(Ct,et,ue,Lt,Pt,Kt%2),ye(Ct,et,ot,Lt,ue-1,Kt+1),ye(Ct,et,ot,ue+1,Pt,Kt+1)}function te(Ct,et,ot,Lt,Pt,Kt){for(;Pt>Lt;){if(Pt-Lt>600){const me=Pt-Lt+1,je=ot-Lt+1,yn=Math.log(me),Je=.5*Math.exp(2*yn/3),Zn=.5*Math.sqrt(yn*Je*(me-Je)/me)*(je-me/2<0?-1:1);te(Ct,et,ot,Math.max(Lt,Math.floor(ot-je*Je/me+Zn)),Math.min(Pt,Math.floor(ot+(me-je)*Je/me+Zn)),Kt)}const ue=et[2*ot+Kt];let se=Lt,$t=Pt;for(mt(Ct,et,Lt,ot),et[2*Pt+Kt]>ue&&mt(Ct,et,Lt,Pt);se<$t;){for(mt(Ct,et,se,$t),se++,$t--;et[2*se+Kt]<ue;)se++;for(;et[2*$t+Kt]>ue;)$t--}et[2*Lt+Kt]===ue?mt(Ct,et,Lt,$t):($t++,mt(Ct,et,$t,Pt)),$t<=ot&&(Lt=$t+1),ot<=$t&&(Pt=$t-1)}}function mt(Ct,et,ot,Lt){Zt(Ct,ot,Lt),Zt(et,2*ot,2*Lt),Zt(et,2*ot+1,2*Lt+1)}function Zt(Ct,et,ot){const Lt=Ct[et];Ct[et]=Ct[ot],Ct[ot]=Lt}function ve(Ct,et,ot,Lt){const Pt=Ct-ot,Kt=et-Lt;return Pt*Pt+Kt*Kt}lt.exports=Yt,lt.exports.fromVectorTileJs=Yt,lt.exports.fromGeojsonVt=function(Ct,et){et=et||{};var ot={};for(var Lt in Ct)ot[Lt]=new ie(Ct[Lt].features,et),ot[Lt].name=Lt,ot[Lt].version=et.version,ot[Lt].extent=et.extent;return Yt({layers:ot})},lt.exports.GeoJSONWrapper=ie;const Be=Ct=>Ct[0],de=Ct=>Ct[1];class On{constructor(et,ot=Be,Lt=de,Pt=64,Kt=Float64Array){this.nodeSize=Pt,this.points=et;const ue=et.length<65536?Uint16Array:Uint32Array,se=this.ids=new ue(et.length),$t=this.coords=new Kt(2*et.length);for(let me=0;me<et.length;me++)se[me]=me,$t[2*me]=ot(et[me]),$t[2*me+1]=Lt(et[me]);ye(se,$t,Pt,0,se.length-1,0)}range(et,ot,Lt,Pt){return(function(Kt,ue,se,$t,me,je,yn){const Je=[0,Kt.length-1,0],Zn=[];let jn,Fn;for(;Je.length;){const Qn=Je.pop(),fi=Je.pop(),ki=Je.pop();if(fi-ki<=yn){for(let _i=ki;_i<=fi;_i++)jn=ue[2*_i],Fn=ue[2*_i+1],jn>=se&&jn<=me&&Fn>=$t&&Fn<=je&&Zn.push(Kt[_i]);continue}const Dn=Math.floor((ki+fi)/2);jn=ue[2*Dn],Fn=ue[2*Dn+1],jn>=se&&jn<=me&&Fn>=$t&&Fn<=je&&Zn.push(Kt[Dn]);const Vi=(Qn+1)%2;(Qn===0?se<=jn:$t<=Fn)&&(Je.push(ki),Je.push(Dn-1),Je.push(Vi)),(Qn===0?me>=jn:je>=Fn)&&(Je.push(Dn+1),Je.push(fi),Je.push(Vi))}return Zn})(this.ids,this.coords,et,ot,Lt,Pt,this.nodeSize)}within(et,ot,Lt){return(function(Pt,Kt,ue,se,$t,me){const je=[0,Pt.length-1,0],yn=[],Je=$t*$t;for(;je.length;){const Zn=je.pop(),jn=je.pop(),Fn=je.pop();if(jn-Fn<=me){for(let Vi=Fn;Vi<=jn;Vi++)ve(Kt[2*Vi],Kt[2*Vi+1],ue,se)<=Je&&yn.push(Pt[Vi]);continue}const Qn=Math.floor((Fn+jn)/2),fi=Kt[2*Qn],ki=Kt[2*Qn+1];ve(fi,ki,ue,se)<=Je&&yn.push(Pt[Qn]);const Dn=(Zn+1)%2;(Zn===0?ue-$t<=fi:se-$t<=ki)&&(je.push(Fn),je.push(Qn-1),je.push(Dn)),(Zn===0?ue+$t>=fi:se+$t>=ki)&&(je.push(Qn+1),je.push(jn),je.push(Dn))}return yn})(this.ids,this.coords,et,ot,Lt,this.nodeSize)}}const An={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ct=>Ct},$n=Math.fround||(yi=new Float32Array(1),Ct=>(yi[0]=+Ct,yi[0]));var yi;class Gi{constructor(et){this.options=mr(Object.create(An),et),this.trees=new Array(this.options.maxZoom+1)}load(et){const{log:ot,minZoom:Lt,maxZoom:Pt,nodeSize:Kt}=this.options;ot&&console.time("total time");const ue=`prepare ${et.length} points`;ot&&console.time(ue),this.points=et;let se=[];for(let $t=0;$t<et.length;$t++)et[$t].geometry&&se.push(Bn(et[$t],$t));this.trees[Pt+1]=new On(se,_l,vi,Kt,Float32Array),ot&&console.timeEnd(ue);for(let $t=Pt;$t>=Lt;$t--){const me=+Date.now();se=this._cluster(se,$t),this.trees[$t]=new On(se,_l,vi,Kt,Float32Array),ot&&console.log("z%d: %d clusters in %dms",$t,se.length,+Date.now()-me)}return ot&&console.timeEnd("total time"),this}getClusters(et,ot){let Lt=((et[0]+180)%360+360)%360-180;const Pt=Math.max(-90,Math.min(90,et[1]));let Kt=et[2]===180?180:((et[2]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,et[3]));if(et[2]-et[0]>=360)Lt=-180,Kt=180;else if(Lt>Kt){const je=this.getClusters([Lt,Pt,180,ue],ot),yn=this.getClusters([-180,Pt,Kt,ue],ot);return je.concat(yn)}const se=this.trees[this._limitZoom(ot)],$t=se.range(Mn(Lt),ui(ue),Mn(Kt),ui(Pt)),me=[];for(const je of $t){const yn=se.points[je];me.push(yn.numPoints?lr(yn):this.points[yn.index])}return me}getChildren(et){const ot=this._getOriginId(et),Lt=this._getOriginZoom(et),Pt="No cluster with the specified id.",Kt=this.trees[Lt];if(!Kt)throw new Error(Pt);const ue=Kt.points[ot];if(!ue)throw new Error(Pt);const se=this.options.radius/(this.options.extent*Math.pow(2,Lt-1)),$t=Kt.within(ue.x,ue.y,se),me=[];for(const je of $t){const yn=Kt.points[je];yn.parentId===et&&me.push(yn.numPoints?lr(yn):this.points[yn.index])}if(me.length===0)throw new Error(Pt);return me}getLeaves(et,ot,Lt){const Pt=[];return this._appendLeaves(Pt,et,ot=ot||10,Lt=Lt||0,0),Pt}getTile(et,ot,Lt){const Pt=this.trees[this._limitZoom(et)],Kt=Math.pow(2,et),{extent:ue,radius:se}=this.options,$t=se/ue,me=(Lt-$t)/Kt,je=(Lt+1+$t)/Kt,yn={features:[]};return this._addTileFeatures(Pt.range((ot-$t)/Kt,me,(ot+1+$t)/Kt,je),Pt.points,ot,Lt,Kt,yn),ot===0&&this._addTileFeatures(Pt.range(1-$t/Kt,me,1,je),Pt.points,Kt,Lt,Kt,yn),ot===Kt-1&&this._addTileFeatures(Pt.range(0,me,$t/Kt,je),Pt.points,-1,Lt,Kt,yn),yn.features.length?yn:null}getClusterExpansionZoom(et){let ot=this._getOriginZoom(et)-1;for(;ot<=this.options.maxZoom;){const Lt=this.getChildren(et);if(ot++,Lt.length!==1)break;et=Lt[0].properties.cluster_id}return ot}_appendLeaves(et,ot,Lt,Pt,Kt){const ue=this.getChildren(ot);for(const se of ue){const $t=se.properties;if($t&&$t.cluster?Kt+$t.point_count<=Pt?Kt+=$t.point_count:Kt=this._appendLeaves(et,$t.cluster_id,Lt,Pt,Kt):Kt<Pt?Kt++:et.push(se),et.length===Lt)break}return Kt}_addTileFeatures(et,ot,Lt,Pt,Kt,ue){for(const se of et){const $t=ot[se],me=$t.numPoints;let je,yn,Je;if(me)je=Fr($t),yn=$t.x,Je=$t.y;else{const Fn=this.points[$t.index];je=Fn.properties,yn=Mn(Fn.geometry.coordinates[0]),Je=ui(Fn.geometry.coordinates[1])}const Zn={type:1,geometry:[[Math.round(this.options.extent*(yn*Kt-Lt)),Math.round(this.options.extent*(Je*Kt-Pt))]],tags:je};let jn;me?jn=$t.id:this.options.generateId?jn=$t.index:this.points[$t.index].id&&(jn=this.points[$t.index].id),jn!==void 0&&(Zn.id=jn),ue.features.push(Zn)}}_limitZoom(et){return Math.max(this.options.minZoom,Math.min(Math.floor(+et),this.options.maxZoom+1))}_cluster(et,ot){const Lt=[],{radius:Pt,extent:Kt,reduce:ue,minPoints:se}=this.options,$t=Pt/(Kt*Math.pow(2,ot));for(let me=0;me<et.length;me++){const je=et[me];if(je.zoom<=ot)continue;je.zoom=ot;const yn=this.trees[ot+1],Je=yn.within(je.x,je.y,$t),Zn=je.numPoints||1;let jn=Zn;for(const Fn of Je){const Qn=yn.points[Fn];Qn.zoom>ot&&(jn+=Qn.numPoints||1)}if(jn>Zn&&jn>=se){let Fn=je.x*Zn,Qn=je.y*Zn,fi=ue&&Zn>1?this._map(je,!0):null;const ki=(me<<5)+(ot+1)+this.points.length;for(const Dn of Je){const Vi=yn.points[Dn];if(Vi.zoom<=ot)continue;Vi.zoom=ot;const _i=Vi.numPoints||1;Fn+=Vi.x*_i,Qn+=Vi.y*_i,Vi.parentId=ki,ue&&(fi||(fi=this._map(je,!0)),ue(fi,this._map(Vi)))}je.parentId=ki,Lt.push(jr(Fn/jn,Qn/jn,ki,jn,fi))}else if(Lt.push(je),jn>1)for(const Fn of Je){const Qn=yn.points[Fn];Qn.zoom<=ot||(Qn.zoom=ot,Lt.push(Qn))}}return Lt}_getOriginId(et){return et-this.points.length>>5}_getOriginZoom(et){return(et-this.points.length)%32}_map(et,ot){if(et.numPoints)return ot?mr({},et.properties):et.properties;const Lt=this.points[et.index].properties,Pt=this.options.map(Lt);return ot&&Pt===Lt?mr({},Pt):Pt}}function jr(Ct,et,ot,Lt,Pt){return{x:$n(Ct),y:$n(et),zoom:1/0,id:ot,parentId:-1,numPoints:Lt,properties:Pt}}function Bn(Ct,et){const[ot,Lt]=Ct.geometry.coordinates;return{x:$n(Mn(ot)),y:$n(ui(Lt)),zoom:1/0,index:et,parentId:-1}}function lr(Ct){return{type:"Feature",id:Ct.id,properties:Fr(Ct),geometry:{type:"Point",coordinates:[(et=Ct.x,360*(et-.5)),Vl(Ct.y)]}};var et}function Fr(Ct){const et=Ct.numPoints,ot=et>=1e4?`${Math.round(et/1e3)}k`:et>=1e3?Math.round(et/100)/10+"k":et;return mr(mr({},Ct.properties),{cluster:!0,cluster_id:Ct.id,point_count:et,point_count_abbreviated:ot})}function Mn(Ct){return Ct/360+.5}function ui(Ct){const et=Math.sin(Ct*Math.PI/180),ot=.5-.25*Math.log((1+et)/(1-et))/Math.PI;return ot<0?0:ot>1?1:ot}function Vl(Ct){const et=(180-360*Ct)*Math.PI/180;return 360*Math.atan(Math.exp(et))/Math.PI-90}function mr(Ct,et){for(const ot in et)Ct[ot]=et[ot];return Ct}function _l(Ct){return Ct.x}function vi(Ct){return Ct.y}function Us(Ct,et,ot,Lt){for(var Pt,Kt=Lt,ue=ot-et>>1,se=ot-et,$t=Ct[et],me=Ct[et+1],je=Ct[ot],yn=Ct[ot+1],Je=et+3;Je<ot;Je+=3){var Zn=Wa(Ct[Je],Ct[Je+1],$t,me,je,yn);if(Zn>Kt)Pt=Je,Kt=Zn;else if(Zn===Kt){var jn=Math.abs(Je-ue);jn<se&&(Pt=Je,se=jn)}}Kt>Lt&&(Pt-et>3&&Us(Ct,et,Pt,Lt),Ct[Pt+2]=Kt,ot-Pt>3&&Us(Ct,Pt,ot,Lt))}function Wa(Ct,et,ot,Lt,Pt,Kt){var ue=Pt-ot,se=Kt-Lt;if(ue!==0||se!==0){var $t=((Ct-ot)*ue+(et-Lt)*se)/(ue*ue+se*se);$t>1?(ot=Pt,Lt=Kt):$t>0&&(ot+=ue*$t,Lt+=se*$t)}return(ue=Ct-ot)*ue+(se=et-Lt)*se}function eo(Ct,et,ot,Lt){var Pt={id:Ct===void 0?null:Ct,type:et,geometry:ot,tags:Lt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return(function(Kt){var ue=Kt.geometry,se=Kt.type;if(se==="Point"||se==="MultiPoint"||se==="LineString")Ri(Kt,ue);else if(se==="Polygon"||se==="MultiLineString")for(var $t=0;$t<ue.length;$t++)Ri(Kt,ue[$t]);else if(se==="MultiPolygon")for($t=0;$t<ue.length;$t++)for(var me=0;me<ue[$t].length;me++)Ri(Kt,ue[$t][me])})(Pt),Pt}function Ri(Ct,et){for(var ot=0;ot<et.length;ot+=3)Ct.minX=Math.min(Ct.minX,et[ot]),Ct.minY=Math.min(Ct.minY,et[ot+1]),Ct.maxX=Math.max(Ct.maxX,et[ot]),Ct.maxY=Math.max(Ct.maxY,et[ot+1])}function $a(Ct,et,ot,Lt){if(et.geometry){var Pt=et.geometry.coordinates,Kt=et.geometry.type,ue=Math.pow(ot.tolerance/((1<<ot.maxZoom)*ot.extent),2),se=[],$t=et.id;if(ot.promoteId?$t=et.properties[ot.promoteId]:ot.generateId&&($t=Lt||0),Kt==="Point")ql(Pt,se);else if(Kt==="MultiPoint")for(var me=0;me<Pt.length;me++)ql(Pt[me],se);else if(Kt==="LineString")Qr(Pt,se,ue,!1);else if(Kt==="MultiLineString"){if(ot.lineMetrics){for(me=0;me<Pt.length;me++)Qr(Pt[me],se=[],ue,!1),Ct.push(eo($t,"LineString",se,et.properties));return}hs(Pt,se,ue,!1)}else if(Kt==="Polygon")hs(Pt,se,ue,!0);else{if(Kt!=="MultiPolygon"){if(Kt==="GeometryCollection"){for(me=0;me<et.geometry.geometries.length;me++)$a(Ct,{id:$t,geometry:et.geometry.geometries[me],properties:et.properties},ot,Lt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<Pt.length;me++){var je=[];hs(Pt[me],je,ue,!0),se.push(je)}}Ct.push(eo($t,Kt,se,et.properties))}}function ql(Ct,et){et.push($e(Ct[0])),et.push(yr(Ct[1])),et.push(0)}function Qr(Ct,et,ot,Lt){for(var Pt,Kt,ue=0,se=0;se<Ct.length;se++){var $t=$e(Ct[se][0]),me=yr(Ct[se][1]);et.push($t),et.push(me),et.push(0),se>0&&(ue+=Lt?(Pt*me-$t*Kt)/2:Math.sqrt(Math.pow($t-Pt,2)+Math.pow(me-Kt,2))),Pt=$t,Kt=me}var je=et.length-3;et[2]=1,Us(et,0,je,ot),et[je+2]=1,et.size=Math.abs(ue),et.start=0,et.end=et.size}function hs(Ct,et,ot,Lt){for(var Pt=0;Pt<Ct.length;Pt++){var Kt=[];Qr(Ct[Pt],Kt,ot,Lt),et.push(Kt)}}function $e(Ct){return Ct/360+.5}function yr(Ct){var et=Math.sin(Ct*Math.PI/180),ot=.5-.25*Math.log((1+et)/(1-et))/Math.PI;return ot<0?0:ot>1?1:ot}function Xr(Ct,et,ot,Lt,Pt,Kt,ue,se){if(Lt/=et,Kt>=(ot/=et)&&ue<Lt)return Ct;if(ue<ot||Kt>=Lt)return null;for(var $t=[],me=0;me<Ct.length;me++){var je=Ct[me],yn=je.geometry,Je=je.type,Zn=Pt===0?je.minX:je.minY,jn=Pt===0?je.maxX:je.maxY;if(Zn>=ot&&jn<Lt)$t.push(je);else if(!(jn<ot||Zn>=Lt)){var Fn=[];if(Je==="Point"||Je==="MultiPoint")ri(yn,Fn,ot,Lt,Pt);else if(Je==="LineString")Ki(yn,Fn,ot,Lt,Pt,!1,se.lineMetrics);else if(Je==="MultiLineString")Rs(yn,Fn,ot,Lt,Pt,!1);else if(Je==="Polygon")Rs(yn,Fn,ot,Lt,Pt,!0);else if(Je==="MultiPolygon")for(var Qn=0;Qn<yn.length;Qn++){var fi=[];Rs(yn[Qn],fi,ot,Lt,Pt,!0),fi.length&&Fn.push(fi)}if(Fn.length){if(se.lineMetrics&&Je==="LineString"){for(Qn=0;Qn<Fn.length;Qn++)$t.push(eo(je.id,Je,Fn[Qn],je.tags));continue}Je!=="LineString"&&Je!=="MultiLineString"||(Fn.length===1?(Je="LineString",Fn=Fn[0]):Je="MultiLineString"),Je!=="Point"&&Je!=="MultiPoint"||(Je=Fn.length===3?"Point":"MultiPoint"),$t.push(eo(je.id,Je,Fn,je.tags))}}}return $t.length?$t:null}function ri(Ct,et,ot,Lt,Pt){for(var Kt=0;Kt<Ct.length;Kt+=3){var ue=Ct[Kt+Pt];ue>=ot&&ue<=Lt&&(et.push(Ct[Kt]),et.push(Ct[Kt+1]),et.push(Ct[Kt+2]))}}function Ki(Ct,et,ot,Lt,Pt,Kt,ue){for(var se,$t,me=Tr(Ct),je=Pt===0?Di:fu,yn=Ct.start,Je=0;Je<Ct.length-3;Je+=3){var Zn=Ct[Je],jn=Ct[Je+1],Fn=Ct[Je+2],Qn=Ct[Je+3],fi=Ct[Je+4],ki=Pt===0?Zn:jn,Dn=Pt===0?Qn:fi,Vi=!1;ue&&(se=Math.sqrt(Math.pow(Zn-Qn,2)+Math.pow(jn-fi,2))),ki<ot?Dn>ot&&($t=je(me,Zn,jn,Qn,fi,ot),ue&&(me.start=yn+se*$t)):ki>Lt?Dn<Lt&&($t=je(me,Zn,jn,Qn,fi,Lt),ue&&(me.start=yn+se*$t)):_r(me,Zn,jn,Fn),Dn<ot&&ki>=ot&&($t=je(me,Zn,jn,Qn,fi,ot),Vi=!0),Dn>Lt&&ki<=Lt&&($t=je(me,Zn,jn,Qn,fi,Lt),Vi=!0),!Kt&&Vi&&(ue&&(me.end=yn+se*$t),et.push(me),me=Tr(Ct)),ue&&(yn+=se)}var _i=Ct.length-3;Zn=Ct[_i],jn=Ct[_i+1],Fn=Ct[_i+2],(ki=Pt===0?Zn:jn)>=ot&&ki<=Lt&&_r(me,Zn,jn,Fn),_i=me.length-3,Kt&&_i>=3&&(me[_i]!==me[0]||me[_i+1]!==me[1])&&_r(me,me[0],me[1],me[2]),me.length&&et.push(me)}function Tr(Ct){var et=[];return et.size=Ct.size,et.start=Ct.start,et.end=Ct.end,et}function Rs(Ct,et,ot,Lt,Pt,Kt){for(var ue=0;ue<Ct.length;ue++)Ki(Ct[ue],et,ot,Lt,Pt,Kt,!1)}function _r(Ct,et,ot,Lt){Ct.push(et),Ct.push(ot),Ct.push(Lt)}function Di(Ct,et,ot,Lt,Pt,Kt){var ue=(Kt-et)/(Lt-et);return Ct.push(Kt),Ct.push(ot+(Pt-ot)*ue),Ct.push(1),ue}function fu(Ct,et,ot,Lt,Pt,Kt){var ue=(Kt-ot)/(Pt-ot);return Ct.push(et+(Lt-et)*ue),Ct.push(Kt),Ct.push(1),ue}function jl(Ct,et){for(var ot=[],Lt=0;Lt<Ct.length;Lt++){var Pt,Kt=Ct[Lt],ue=Kt.type;if(ue==="Point"||ue==="MultiPoint"||ue==="LineString")Pt=vl(Kt.geometry,et);else if(ue==="MultiLineString"||ue==="Polygon"){Pt=[];for(var se=0;se<Kt.geometry.length;se++)Pt.push(vl(Kt.geometry[se],et))}else if(ue==="MultiPolygon")for(Pt=[],se=0;se<Kt.geometry.length;se++){for(var $t=[],me=0;me<Kt.geometry[se].length;me++)$t.push(vl(Kt.geometry[se][me],et));Pt.push($t)}ot.push(eo(Kt.id,ue,Pt,Kt.tags))}return ot}function vl(Ct,et){var ot=[];ot.size=Ct.size,Ct.start!==void 0&&(ot.start=Ct.start,ot.end=Ct.end);for(var Lt=0;Lt<Ct.length;Lt+=3)ot.push(Ct[Lt]+et,Ct[Lt+1],Ct[Lt+2]);return ot}function ya(Ct,et){if(Ct.transformed)return Ct;var ot,Lt,Pt,Kt=1<<Ct.z,ue=Ct.x,se=Ct.y;for(ot=0;ot<Ct.features.length;ot++){var $t=Ct.features[ot],me=$t.geometry,je=$t.type;if($t.geometry=[],je===1)for(Lt=0;Lt<me.length;Lt+=2)$t.geometry.push(Dr(me[Lt],me[Lt+1],et,Kt,ue,se));else for(Lt=0;Lt<me.length;Lt++){var yn=[];for(Pt=0;Pt<me[Lt].length;Pt+=2)yn.push(Dr(me[Lt][Pt],me[Lt][Pt+1],et,Kt,ue,se));$t.geometry.push(yn)}}return Ct.transformed=!0,Ct}function Dr(Ct,et,ot,Lt,Pt,Kt){return[Math.round(ot*(Ct*Lt-Pt)),Math.round(ot*(et*Lt-Kt))]}function Kn(Ct,et,ot,Lt,Pt){for(var Kt=et===Pt.maxZoom?0:Pt.tolerance/((1<<et)*Pt.extent),ue={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ot,y:Lt,z:et,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},se=0;se<Ct.length;se++){ue.numFeatures++,oi(ue,Ct[se],Kt,Pt);var $t=Ct[se].minX,me=Ct[se].minY,je=Ct[se].maxX,yn=Ct[se].maxY;$t<ue.minX&&(ue.minX=$t),me<ue.minY&&(ue.minY=me),je>ue.maxX&&(ue.maxX=je),yn>ue.maxY&&(ue.maxY=yn)}return ue}function oi(Ct,et,ot,Lt){var Pt=et.geometry,Kt=et.type,ue=[];if(Kt==="Point"||Kt==="MultiPoint")for(var se=0;se<Pt.length;se+=3)ue.push(Pt[se]),ue.push(Pt[se+1]),Ct.numPoints++,Ct.numSimplified++;else if(Kt==="LineString")Ds(ue,Pt,Ct,ot,!1,!1);else if(Kt==="MultiLineString"||Kt==="Polygon")for(se=0;se<Pt.length;se++)Ds(ue,Pt[se],Ct,ot,Kt==="Polygon",se===0);else if(Kt==="MultiPolygon")for(var $t=0;$t<Pt.length;$t++){var me=Pt[$t];for(se=0;se<me.length;se++)Ds(ue,me[se],Ct,ot,!0,se===0)}if(ue.length){var je=et.tags||null;if(Kt==="LineString"&&Lt.lineMetrics){for(var yn in je={},et.tags)je[yn]=et.tags[yn];je.mapbox_clip_start=Pt.start/Pt.size,je.mapbox_clip_end=Pt.end/Pt.size}var Je={geometry:ue,type:Kt==="Polygon"||Kt==="MultiPolygon"?3:Kt==="LineString"||Kt==="MultiLineString"?2:1,tags:je};et.id!==null&&(Je.id=et.id),Ct.features.push(Je)}}function Ds(Ct,et,ot,Lt,Pt,Kt){var ue=Lt*Lt;if(Lt>0&&et.size<(Pt?ue:Lt))ot.numPoints+=et.length/3;else{for(var se=[],$t=0;$t<et.length;$t+=3)(Lt===0||et[$t+2]>ue)&&(ot.numSimplified++,se.push(et[$t]),se.push(et[$t+1])),ot.numPoints++;Pt&&(function(me,je){for(var yn=0,Je=0,Zn=me.length,jn=Zn-2;Je<Zn;jn=Je,Je+=2)yn+=(me[Je]-me[jn])*(me[Je+1]+me[jn+1]);if(yn>0===je)for(Je=0,Zn=me.length;Je<Zn/2;Je+=2){var Fn=me[Je],Qn=me[Je+1];me[Je]=me[Zn-2-Je],me[Je+1]=me[Zn-1-Je],me[Zn-2-Je]=Fn,me[Zn-1-Je]=Qn}})(se,Kt),Ct.push(se)}}function rr(Ct,et){var ot=(et=this.options=(function(Pt,Kt){for(var ue in Kt)Pt[ue]=Kt[ue];return Pt})(Object.create(this.options),et)).debug;if(ot&&console.time("preprocess data"),et.maxZoom<0||et.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(et.promoteId&&et.generateId)throw new Error("promoteId and generateId cannot be used together.");var Lt=(function(Pt,Kt){var ue=[];if(Pt.type==="FeatureCollection")for(var se=0;se<Pt.features.length;se++)$a(ue,Pt.features[se],Kt,se);else $a(ue,Pt.type==="Feature"?Pt:{geometry:Pt},Kt);return ue})(Ct,et);this.tiles={},this.tileCoords=[],ot&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",et.indexMaxZoom,et.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Lt=(function(Pt,Kt){var ue=Kt.buffer/Kt.extent,se=Pt,$t=Xr(Pt,1,-1-ue,ue,0,-1,2,Kt),me=Xr(Pt,1,1-ue,2+ue,0,-1,2,Kt);return($t||me)&&(se=Xr(Pt,1,-ue,1+ue,0,-1,2,Kt)||[],$t&&(se=jl($t,1).concat(se)),me&&(se=se.concat(jl(me,-1)))),se})(Lt,et),Lt.length&&this.splitTile(Lt,0,0,0),ot&&(Lt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ts(Ct,et,ot){return 32*((1<<Ct)*ot+et)+Ct}function Pi(Ct,et){const ot=Ct.tileID.canonical;if(!this._geoJSONIndex)return et(null,null);const Lt=this._geoJSONIndex.getTile(ot.z,ot.x,ot.y);if(!Lt)return et(null,null);const Pt=new Ft(Lt.features);let Kt=lt.exports(Pt);Kt.byteOffset===0&&Kt.byteLength===Kt.buffer.byteLength||(Kt=new Uint8Array(Kt)),et(null,{vectorTile:Pt,rawData:Kt.buffer})}rr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},rr.prototype.splitTile=function(Ct,et,ot,Lt,Pt,Kt,ue){for(var se=[Ct,et,ot,Lt],$t=this.options,me=$t.debug;se.length;){Lt=se.pop(),ot=se.pop(),et=se.pop(),Ct=se.pop();var je=1<<et,yn=ts(et,ot,Lt),Je=this.tiles[yn];if(!Je&&(me>1&&console.time("creation"),Je=this.tiles[yn]=Kn(Ct,et,ot,Lt,$t),this.tileCoords.push({z:et,x:ot,y:Lt}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",et,ot,Lt,Je.numFeatures,Je.numPoints,Je.numSimplified),console.timeEnd("creation"));var Zn="z"+et;this.stats[Zn]=(this.stats[Zn]||0)+1,this.total++}if(Je.source=Ct,Pt){if(et===$t.maxZoom||et===Pt)continue;var jn=1<<Pt-et;if(ot!==Math.floor(Kt/jn)||Lt!==Math.floor(ue/jn))continue}else if(et===$t.indexMaxZoom||Je.numPoints<=$t.indexMaxPoints)continue;if(Je.source=null,Ct.length!==0){me>1&&console.time("clipping");var Fn,Qn,fi,ki,Dn,Vi,_i=.5*$t.buffer/$t.extent,Ra=.5-_i,Ss=.5+_i,_e=1+_i;Fn=Qn=fi=ki=null,Dn=Xr(Ct,je,ot-_i,ot+Ss,0,Je.minX,Je.maxX,$t),Vi=Xr(Ct,je,ot+Ra,ot+_e,0,Je.minX,Je.maxX,$t),Ct=null,Dn&&(Fn=Xr(Dn,je,Lt-_i,Lt+Ss,1,Je.minY,Je.maxY,$t),Qn=Xr(Dn,je,Lt+Ra,Lt+_e,1,Je.minY,Je.maxY,$t),Dn=null),Vi&&(fi=Xr(Vi,je,Lt-_i,Lt+Ss,1,Je.minY,Je.maxY,$t),ki=Xr(Vi,je,Lt+Ra,Lt+_e,1,Je.minY,Je.maxY,$t),Vi=null),me>1&&console.timeEnd("clipping"),se.push(Fn||[],et+1,2*ot,2*Lt),se.push(Qn||[],et+1,2*ot,2*Lt+1),se.push(fi||[],et+1,2*ot+1,2*Lt),se.push(ki||[],et+1,2*ot+1,2*Lt+1)}}},rr.prototype.getTile=function(Ct,et,ot){var Lt=this.options,Pt=Lt.extent,Kt=Lt.debug;if(Ct<0||Ct>24)return null;var ue=1<<Ct,se=ts(Ct,et=(et%ue+ue)%ue,ot);if(this.tiles[se])return ya(this.tiles[se],Pt);Kt>1&&console.log("drilling down to z%d-%d-%d",Ct,et,ot);for(var $t,me=Ct,je=et,yn=ot;!$t&&me>0;)me--,je=Math.floor(je/2),yn=Math.floor(yn/2),$t=this.tiles[ts(me,je,yn)];return $t&&$t.source?(Kt>1&&console.log("found parent tile z%d-%d-%d",me,je,yn),Kt>1&&console.time("drilling down"),this.splitTile($t.source,me,je,yn,Ct,et,ot),Kt>1&&console.timeEnd("drilling down"),this.tiles[se]?ya(this.tiles[se],Pt):null):null};class Zr extends h.VectorTileWorkerSource{constructor(et,ot,Lt,Pt,Kt){super(et,ot,Lt,Pt,Pi),Kt&&(this.loadGeoJSON=Kt)}loadData(et,ot){const Lt=et&&et.request,Pt=Lt&&Lt.collectResourceTiming;this.loadGeoJSON(et,((Kt,ue)=>{if(Kt||!ue)return ot(Kt);if(typeof ue!="object")return ot(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));{At(ue,!0);try{if(et.filter){const $t=h.createExpression(et.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if($t.result==="error")throw new Error($t.value.map((je=>`${je.key}: ${je.message}`)).join(", "));ue={type:"FeatureCollection",features:ue.features.filter((je=>$t.value.evaluate({zoom:0},je)))}}this._geoJSONIndex=et.cluster?new Gi((function({superclusterOptions:$t,clusterProperties:me}){if(!me||!$t)return $t;const je={},yn={},Je={accumulated:null,zoom:0},Zn={properties:null},jn=Object.keys(me);for(const Fn of jn){const[Qn,fi]=me[Fn],ki=h.createExpression(fi),Dn=h.createExpression(typeof Qn=="string"?[Qn,["accumulated"],["get",Fn]]:Qn);je[Fn]=ki.value,yn[Fn]=Dn.value}return $t.map=Fn=>{Zn.properties=Fn;const Qn={};for(const fi of jn)Qn[fi]=je[fi].evaluate(Je,Zn);return Qn},$t.reduce=(Fn,Qn)=>{Zn.properties=Qn;for(const fi of jn)Je.accumulated=Fn[fi],Fn[fi]=yn[fi].evaluate(Je,Zn)},$t})(et)).load(ue.features):(function($t,me){return new rr($t,me)})(ue,et.geojsonVtOptions)}catch($t){return ot($t)}this.loaded={};const se={};if(Pt){const $t=h.getPerformanceMeasurement(Lt);$t&&(se.resourceTiming={},se.resourceTiming[et.source]=JSON.parse(JSON.stringify($t)))}ot(null,se)}}))}reloadTile(et,ot){const Lt=this.loaded;return Lt&&Lt[et.uid]?super.reloadTile(et,ot):this.loadTile(et,ot)}loadGeoJSON(et,ot){if(et.request)h.getJSON(et.request,ot);else{if(typeof et.data!="string")return ot(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));try{return ot(null,JSON.parse(et.data))}catch{return ot(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(et,ot){try{ot(null,this._geoJSONIndex.getClusterExpansionZoom(et.clusterId))}catch(Lt){ot(Lt)}}getClusterChildren(et,ot){try{ot(null,this._geoJSONIndex.getChildren(et.clusterId))}catch(Lt){ot(Lt)}}getClusterLeaves(et,ot){try{ot(null,this._geoJSONIndex.getLeaves(et.clusterId,et.limit,et.offset))}catch(Lt){ot(Lt)}}}class Yi{constructor(et){this.self=et,this.actor=new h.Actor(et,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=h.getProjection({name:"mercator"}),this.workerSourceTypes={vector:h.VectorTileWorkerSource,geojson:Zr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ot,Lt)=>{if(this.workerSourceTypes[ot])throw new Error(`Worker source with name "${ot}" already registered.`);this.workerSourceTypes[ot]=Lt},this.self.registerRTLTextPlugin=ot=>{if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=ot.applyArabicShaping,h.plugin.processBidirectionalText=ot.processBidirectionalText,h.plugin.processStyledBidirectionalText=ot.processStyledBidirectionalText}}clearCaches(et,ot,Lt){delete this.layerIndexes[et],delete this.availableImages[et],delete this.workerSources[et],delete this.demWorkerSources[et],Lt()}checkIfReady(et,ot,Lt){Lt()}setReferrer(et,ot){this.referrer=ot}spriteLoaded(et,ot){this.isSpriteLoaded[et]=ot;for(const Lt in this.workerSources[et]){const Pt=this.workerSources[et][Lt];for(const Kt in Pt)Pt[Kt]instanceof h.VectorTileWorkerSource&&(Pt[Kt].isSpriteLoaded=ot,Pt[Kt].fire(new h.Event("isSpriteLoaded")))}}setImages(et,ot,Lt){this.availableImages[et]=ot;for(const Pt in this.workerSources[et]){const Kt=this.workerSources[et][Pt];for(const ue in Kt)Kt[ue].availableImages=ot}Lt()}enableTerrain(et,ot,Lt){this.terrain=ot,Lt()}setProjection(et,ot){this.projections[et]=h.getProjection(ot)}setLayers(et,ot,Lt){this.getLayerIndex(et).replace(ot),Lt()}updateLayers(et,ot,Lt){this.getLayerIndex(et).update(ot.layers,ot.removedIds),Lt()}loadTile(et,ot,Lt){const Pt=this.enableTerrain?h.extend({enableTerrain:this.terrain},ot):ot;Pt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,ot.type,ot.source).loadTile(Pt,Lt)}loadDEMTile(et,ot,Lt){const Pt=this.enableTerrain?h.extend({buildQuadTree:this.terrain},ot):ot;this.getDEMWorkerSource(et,ot.source).loadTile(Pt,Lt)}reloadTile(et,ot,Lt){const Pt=this.enableTerrain?h.extend({enableTerrain:this.terrain},ot):ot;Pt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,ot.type,ot.source).reloadTile(Pt,Lt)}abortTile(et,ot,Lt){this.getWorkerSource(et,ot.type,ot.source).abortTile(ot,Lt)}removeTile(et,ot,Lt){this.getWorkerSource(et,ot.type,ot.source).removeTile(ot,Lt)}removeSource(et,ot,Lt){if(!this.workerSources[et]||!this.workerSources[et][ot.type]||!this.workerSources[et][ot.type][ot.source])return;const Pt=this.workerSources[et][ot.type][ot.source];delete this.workerSources[et][ot.type][ot.source],Pt.removeSource!==void 0?Pt.removeSource(ot,Lt):Lt()}loadWorkerSource(et,ot,Lt){try{this.self.importScripts(ot.url),Lt()}catch(Pt){Lt(Pt.toString())}}syncRTLPluginState(et,ot,Lt){try{h.plugin.setState(ot);const Pt=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&Pt!=null){this.self.importScripts(Pt);const Kt=h.plugin.isParsed();Lt(Kt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Pt}`),Kt)}}catch(Pt){Lt(Pt.toString())}}getAvailableImages(et){let ot=this.availableImages[et];return ot||(ot=[]),ot}getLayerIndex(et){let ot=this.layerIndexes[et];return ot||(ot=this.layerIndexes[et]=new ht),ot}getWorkerSource(et,ot,Lt){if(this.workerSources[et]||(this.workerSources[et]={}),this.workerSources[et][ot]||(this.workerSources[et][ot]={}),!this.workerSources[et][ot][Lt]){const Pt={send:(Kt,ue,se,$t,me,je)=>{this.actor.send(Kt,ue,se,et,me,je)},scheduler:this.actor.scheduler};this.workerSources[et][ot][Lt]=new this.workerSourceTypes[ot](Pt,this.getLayerIndex(et),this.getAvailableImages(et),this.isSpriteLoaded[et])}return this.workerSources[et][ot][Lt]}getDEMWorkerSource(et,ot){return this.demWorkerSources[et]||(this.demWorkerSources[et]={}),this.demWorkerSources[et][ot]||(this.demWorkerSources[et][ot]=new st),this.demWorkerSources[et][ot]}enforceCacheSizeLimit(et,ot){h.enforceCacheSizeLimit(ot)}getWorkerPerformanceMetrics(et,ot,Lt){Lt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Yi(self)),Yi})),j(["./shared"],(function(h){function X(m,o){if(Array.isArray(m)){if(!Array.isArray(o)||m.length!==o.length)return!1;for(let f=0;f<m.length;f++)if(!X(m[f],o[f]))return!1;return!0}if(typeof m=="object"&&m!==null&&o!==null){if(typeof o!="object"||Object.keys(m).length!==Object.keys(o).length)return!1;for(const f in m)if(!X(m[f],o[f]))return!1;return!0}return m===o}var tt=ht;function ht(m){return!(function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,w,S=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(S);try{w=new Worker(L),_=!0}catch{_=!1}return w&&w.terminate(),URL.revokeObjectURL(L),_})()?"Uint8ClampedArray"in window?ArrayBuffer.isView?(function(){var _=document.createElement("canvas");_.width=_.height=1;var w=_.getContext("2d");if(!w)return!1;var S=w.getImageData(0,0,1,1);return S&&S.width===_.width})()?(st[f=o&&o.failIfMajorPerformanceCaveat]===void 0&&(st[f]=(function(_){var w,S=(function(L){var N=document.createElement("canvas"),P=Object.create(ht.webGLContextAttributes);return P.failIfMajorPerformanceCaveat=L,N.getContext("webgl",P)||N.getContext("experimental-webgl",P)})(_);if(!S)return!1;try{w=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!w||S.isContextLost())&&(S.shaderSource(w,"void main() {}"),S.compileShader(w),S.getShaderParameter(w,S.COMPILE_STATUS)===!0)})(f)),st[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f})(m)}var st={};function At(m,o,f){const _=h.window.document.createElement(m);return o!==void 0&&(_.className=o),f&&f.appendChild(_),_}function yt(m,o,f){const _=h.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const w of Object.keys(o))_.setAttributeNS(null,w,o[w]);return f&&f.appendChild(_),_}ht.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const it=h.window.document&&h.window.document.documentElement.style,ae=it&&it.userSelect!==void 0?"userSelect":"WebkitUserSelect";let le;function Ft(){it&&ae&&(le=it[ae],it[ae]="none")}function lt(){it&&ae&&(it[ae]=le)}function pt(m){m.preventDefault(),m.stopPropagation(),h.window.removeEventListener("click",pt,!0)}function It(){h.window.addEventListener("click",pt,!0),h.window.setTimeout((()=>{h.window.removeEventListener("click",pt,!0)}),0)}function Dt(m,o){const f=m.getBoundingClientRect();return Xt(m,f,o)}function _t(m,o){const f=m.getBoundingClientRect(),_=[];for(let w=0;w<o.length;w++)_.push(Xt(m,f,o[w]));return _}function Jt(m){return h.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function Xt(m,o,f){const _=m.offsetWidth===o.width?1:m.offsetWidth/o.width;return new h.pointGeometry((f.clientX-o.left)*_,(f.clientY-o.top)*_)}function ie(m,o){var f=o[0],_=o[1],w=o[2],S=o[3],L=f*S-w*_;return L?(m[0]=S*(L=1/L),m[1]=-_*L,m[2]=-w*L,m[3]=f*L,m):null}function Yt(m){const{userImage:o}=m;return!!(o&&o.render&&o.render())&&(m.data.replace(new Uint8Array(o.data.buffer)),!0)}class rt extends h.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:f,callback:_}of this.requestors)this._notify(f,_);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,f){this._validate(o,f)&&(this.images[o]=f)}_validate(o,f){let _=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new h.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),_=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new h.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),_=!1),this._validateContent(f.content,f)||(this.fire(new h.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),_=!1),_}_validateStretch(o,f){if(!o)return!0;let _=0;for(const w of o){if(w[0]<_||w[1]<w[0]||f<w[1])return!1;_=w[1]}return!0}_validateContent(o,f){return!(o&&(o.length!==4||o[0]<0||f.data.width<o[0]||o[1]<0||f.data.height<o[1]||o[2]<0||f.data.width<o[2]||o[3]<0||f.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,f){f.version=this.images[o].version+1,this.images[o]=f,this.updatedImages[o]=!0}removeImage(o){const f=this.images[o];delete this.images[o],delete this.patterns[o],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,f){let _=!0;if(!this.isLoaded())for(const w of o)this.images[w]||(_=!1);this.isLoaded()||_?this._notify(o,f):this.requestors.push({ids:o,callback:f})}_notify(o,f){const _={};for(const w of o){this.images[w]||this.fire(new h.Event("styleimagemissing",{id:w}));const S=this.images[w];S?_[w]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:h.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,_)}getPixelSize(){const{width:o,height:f}=this.atlasImage;return{width:o,height:f}}getPattern(o){const f=this.patterns[o],_=this.getImage(o);if(!_)return null;if(f&&f.position.version===_.version)return f.position;if(f)f.position.version=_.version;else{const w={w:_.data.width+2,h:_.data.height+2,x:0,y:0},S=new h.ImagePosition(w,_);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const f=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(o,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const S in this.patterns)o.push(this.patterns[S].bin);const{w:f,h:_}=h.potpack(o),w=this.atlasImage;w.resize({width:f||1,height:_||1});for(const S in this.patterns){const{bin:L}=this.patterns[S],N=L.x+1,P=L.y+1,Z=this.images[S].data,Y=Z.width,nt=Z.height;h.RGBAImage.copy(Z,w,{x:0,y:0},{x:N,y:P},{width:Y,height:nt}),h.RGBAImage.copy(Z,w,{x:0,y:nt-1},{x:N,y:P-1},{width:Y,height:1}),h.RGBAImage.copy(Z,w,{x:0,y:0},{x:N,y:P+nt},{width:Y,height:1}),h.RGBAImage.copy(Z,w,{x:Y-1,y:0},{x:N-1,y:P},{width:1,height:nt}),h.RGBAImage.copy(Z,w,{x:0,y:0},{x:N+Y,y:P},{width:1,height:nt})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const f of o){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const _=this.images[f];Yt(_)&&this.updateImage(f,_)}}}const qe=new h.Properties({anchor:new h.DataConstantProperty(h.spec.light.anchor),position:new class{constructor(){this.specification=h.spec.light.position}possiblyEvaluate(m,o){return(function([f,_,w]){const S=h.degToRad(_+90),L=h.degToRad(w);return{x:f*Math.cos(S)*Math.sin(L),y:f*Math.sin(S)*Math.sin(L),z:f*Math.cos(L),azimuthal:_,polar:w}})(m.expression.evaluate(o))}interpolate(m,o,f){return{x:h.number(m.x,o.x,f),y:h.number(m.y,o.y,f),z:h.number(m.z,o.z,f),azimuthal:h.number(m.azimuthal,o.azimuthal,f),polar:h.number(m.polar,o.polar,f)}}},color:new h.DataConstantProperty(h.spec.light.color),intensity:new h.DataConstantProperty(h.spec.light.intensity)}),Sn="-transition";class Xn extends h.Evented{constructor(o){super(),this._transitionable=new h.Transitionable(qe),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,f={}){if(!this._validate(h.validateLight,o,f))for(const _ in o){const w=o[_];h.endsWith(_,Sn)?this._transitionable.setTransition(_.slice(0,-Sn.length),w):this._transitionable.setValue(_,w)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,_){return(!_||_.validate!==!1)&&h.emitValidationErrors(this,o.call(h.validateStyle,h.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:h.spec})))}}const ct=new h.Properties({source:new h.DataConstantProperty(h.spec.terrain.source),exaggeration:new h.DataConstantProperty(h.spec.terrain.exaggeration)}),kt="-transition";class ut extends h.Evented{constructor(o,f){super(),this._transitionable=new h.Transitionable(ct),this.set(o),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=f}get(){return this._transitionable.serialize()}set(o){for(const f in o){const _=o[f];h.endsWith(f,kt)?this._transitionable.setTransition(f.slice(0,-kt.length),_):this._transitionable.setValue(f,_)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}}function ye(m,o,f,_){const w=h.smoothstep(45,65,f),[S,L]=te(m,_),N=h.length(o);let P=1-Math.min(1,Math.exp((N-S)/(L-S)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*w*m.alpha}function te(m,o){const f=.5/Math.tan(.5*o);return[m.range[0]+f,m.range[1]+f]}const mt=new h.Properties({range:new h.DataConstantProperty(h.spec.fog.range),color:new h.DataConstantProperty(h.spec.fog.color),"high-color":new h.DataConstantProperty(h.spec.fog["high-color"]),"space-color":new h.DataConstantProperty(h.spec.fog["space-color"]),"horizon-blend":new h.DataConstantProperty(h.spec.fog["horizon-blend"]),"star-intensity":new h.DataConstantProperty(h.spec.fog["star-intensity"])}),Zt="-transition";class ve extends h.Evented{constructor(o,f){super(),this._transitionable=new h.Transitionable(mt),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const o=this._transform,f=o.projection.name==="globe",_=h.globeToMercatorTransition(o.zoom),w=this.properties.get("range"),S=[.5,3];return{range:f?[h.number(S[0],w[0],_),h.number(S[1],w[1],_)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,f={}){if(!this._validate(h.validateFog,o,f)){for(const _ of Object.keys(h.spec.fog))o&&o[_]===void 0&&(o[_]=h.spec.fog[_].default);for(const _ in o){const w=o[_];h.endsWith(_,Zt)?this._transitionable.setTransition(_.slice(0,-Zt.length),w):this._transitionable.setValue(_,w)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:h.smoothstep(45,65,o))*f.a}getOpacityAtLatLng(o,f){return this._transform.projection.supportsFog?(function(_,w,S){const L=h.MercatorCoordinate.fromLngLat(w),N=S.elevation?S.elevation.getAtPointOrZero(L):0,P=[L.x,L.y,N];return h.transformMat4(P,P,S.mercatorFogMatrix),ye(_,P,S.pitch,S._fov)})(this.state,o,f):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?te(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,_){return(!_||_.validate!==!1)&&h.emitValidationErrors(this,o.call(h.validateStyle,h.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:h.spec})))}}class Be{constructor(o,f){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=h.uniqueId();const _=this.workerPool.acquire(this.id);for(let w=0;w<_.length;w++){const S=new Be.Actor(_[w],f,this.id);S.name=`Worker ${w}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(o,f,_){h.asyncAll(this.actors,((w,S)=>{w.send(o,f,S)}),_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((o=>{o.remove()})),this.actors=[],this.workerPool.release(this.id)}}function de(m,o,f){return o*(h.EXTENT/(m.tileSize*Math.pow(2,f-m.tileID.overscaledZ)))}Be.Actor=h.Actor;class On{constructor(o,f,_,w){this.screenBounds=o,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(o,f){let _,w;if(o instanceof h.pointGeometry||typeof o[0]=="number"){const S=h.pointGeometry.convert(o);_=[S],w=f.isPointAboveHorizon(S)}else{const S=h.pointGeometry.convert(o[0]),L=h.pointGeometry.convert(o[1]);_=[S,L],w=h.polygonizeBounds(S,L).every((N=>f.isPointAboveHorizon(N)))}return new On(_,f.getCameraPoint(),w,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return h.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const f=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new h.pointGeometry(1,1)):this.screenBounds[1],w=h.polygonizeBounds(f,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<_.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?w[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(w[3]=this.cameraPoint)),h.bufferConvexPolygon(w,o)}bufferedCameraGeometryGlobe(o){const f=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new h.pointGeometry(1,1)):this.screenBounds[1],w=h.polygonizeBounds(f,_,o),S=this.cameraPoint.clone();switch(3*((S.y>f.y)+(S.y>_.y))+((S.x>f.x)+(S.x>_.x))){case 0:w[0]=S,w[4]=S.clone();break;case 1:w.splice(1,0,S);break;case 2:w[1]=S;break;case 3:w.splice(4,0,S);break;case 5:w.splice(2,0,S);break;case 6:w[3]=S;break;case 7:w.splice(3,0,S);break;case 8:w[2]=S}return w}containsTile(o,f,_,w=0){const S=o.queryPadding/f._pixelsPerMercatorPixel+1,L=_?this._bufferedCameraMercator(S,f):this._bufferedScreenMercator(S,f);let N=o.tileID.wrap+(L.unwrapped?w:0);const P=L.polygon.map((St=>h.getTilePoint(o.tileTransform,St,N)));if(!h.polygonIntersectsBox(P,0,0,h.EXTENT,h.EXTENT))return;N=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const Z=this.screenGeometryMercator.polygon.map((St=>h.getTileVec3(o.tileTransform,St,N))),Y=Z.map((St=>new h.pointGeometry(St[0],St[1]))),nt=f.getFreeCameraOptions().position||new h.MercatorCoordinate(0,0,0),dt=h.getTileVec3(o.tileTransform,nt,N),Et=Z.map((St=>{const vt=h.sub(St,St,dt);return h.normalize(vt,vt),new h.Ray(dt,vt)})),xt=de(o,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:Et,bufferedTilespaceGeometry:P,bufferedTilespaceBounds:(Mt=h.getBounds(P),Mt.min.x=h.clamp(Mt.min.x,0,h.EXTENT),Mt.min.y=h.clamp(Mt.min.y,0,h.EXTENT),Mt.max.x=h.clamp(Mt.max.x,0,h.EXTENT),Mt.max.y=h.clamp(Mt.max.y,0,h.EXTENT),Mt),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:xt};var Mt}_bufferedScreenMercator(o,f){const _=yi(o);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),f):{polygon:this.bufferedScreenGeometry(o).map((S=>f.pointCoordinate3D(S))),unwrapped:!0},this._screenRaycastCache[_]=w,w}}_bufferedCameraMercator(o,f){const _=yi(o);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),f):{polygon:this.bufferedCameraGeometry(o).map((S=>f.pointCoordinate3D(S))),unwrapped:!0},this._cameraRaycastCache[_]=w,w}}_projectAndResample(o,f){const _=(function(S,L){const N=h.multiply([],L.pixelMatrix,L.globeMatrix),P=[0,-h.GLOBE_RADIUS,0,1],Z=[0,h.GLOBE_RADIUS,0,1],Y=[0,0,0,1];h.transformMat4$1(P,P,N),h.transformMat4$1(Z,Z,N),h.transformMat4$1(Y,Y,N);const nt=new h.pointGeometry(P[0]/P[3],P[1]/P[3]),dt=new h.pointGeometry(Z[0]/Z[3],Z[1]/Z[3]),Et=h.polygonContainsPoint(S,nt)&&P[3]<Y[3],xt=h.polygonContainsPoint(S,dt)&&Z[3]<Y[3];if(!Et&&!xt)return null;const Mt=(function(jt,fe,Ee){for(let xe=1;xe<jt.length;xe++){const We=$n(fe.pointCoordinate3D(jt[xe-1]).x),ce=$n(fe.pointCoordinate3D(jt[xe]).x);if(Ee<0){if(We<ce)return{idx:xe,t:-We/(ce-1-We)}}else if(ce<We)return{idx:xe,t:(1-We)/(ce+1-We)}}return null})(S,L,Et?-1:1);if(!Mt)return null;const{idx:St,t:vt}=Mt;let Rt=St>1?An(S.slice(0,St),L):[],Tt=St<S.length?An(S.slice(St),L):[];Rt=Rt.map((jt=>new h.pointGeometry($n(jt.x),jt.y))),Tt=Tt.map((jt=>new h.pointGeometry($n(jt.x),jt.y)));const Ut=[...Rt];Ut.length===0&&Ut.push(Tt[Tt.length-1]);const Gt=h.number(Ut[Ut.length-1].y,(Tt.length===0?Rt[0]:Tt[0]).y,vt);let Nt;return Nt=Et?[new h.pointGeometry(0,Gt),new h.pointGeometry(0,0),new h.pointGeometry(1,0),new h.pointGeometry(1,Gt)]:[new h.pointGeometry(1,Gt),new h.pointGeometry(1,1),new h.pointGeometry(0,1),new h.pointGeometry(0,Gt)],Ut.push(...Nt),Tt.length===0?Ut.push(Rt[0]):Ut.push(...Tt),{polygon:Ut.map((jt=>new h.MercatorCoordinate(jt.x,jt.y))),unwrapped:!1}})(o,f);if(_)return _;const w=(function(S,L){let N=!1,P=-1/0,Z=0;for(let nt=0;nt<S.length-1;nt++)S[nt].x>P&&(P=S[nt].x,Z=nt);for(let nt=0;nt<S.length-1;nt++){const dt=(Z+nt)%(S.length-1),Et=S[dt],xt=S[dt+1];Math.abs(Et.x-xt.x)>.5&&(Et.x<xt.x?(Et.x+=1,dt===0&&(S[S.length-1].x+=1)):(xt.x+=1,dt+1===S.length-1&&(S[0].x+=1)),N=!0)}const Y=h.mercatorXfromLng(L.center.lng);return N&&Y<Math.abs(Y-1)&&S.forEach((nt=>{nt.x-=1})),{polygon:S,unwrapped:N}})(An(o,f).map((S=>new h.pointGeometry($n(S.x),S.y))),f);return{polygon:w.polygon.map((S=>new h.MercatorCoordinate(S.x,S.y))),unwrapped:w.unwrapped}}}function An(m,o){return h.resample(m,(f=>{const _=o.pointCoordinate3D(f);f.x=_.x,f.y=_.y}),1/256)}function $n(m){return m<0?1+m%1:m%1}function yi(m){return 100*m|0}function Gi(m,o,f,_,w){const S=function(L,N){if(L)return w(L);if(N){m.url&&N.tiles&&m.tiles&&delete m.tiles;const P=h.pick(h.extend(N,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);N.vector_layers&&(P.vectorLayers=N.vector_layers,P.vectorLayerIds=P.vectorLayers.map((Z=>Z.id))),P.tiles=o.canonicalizeTileset(P,m.url),w(null,P)}};return m.url?h.getJSON(o.transformRequest(o.normalizeSourceURL(m.url,null,f,_),h.ResourceType.Source),S):h.exported.frame((()=>S(null,m)))}class jr{constructor(o,f,_){this.bounds=h.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=f||0,this.maxzoom=_||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const f=Math.pow(2,o.z),_=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*f),w=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*f),S=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*f),L=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*f);return o.x>=_&&o.x<S&&o.y>=w&&o.y<L}}class Bn{constructor(o,f,_){this.context=o;const w=o.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const lr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Fr{constructor(o,f,_,w){this.length=f.length,this.attributes=_,this.itemSize=f.bytesPerElement,this.dynamicDraw=w,this.context=o;const S=o.gl;this.buffer=S.createBuffer(),o.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,f){for(let _=0;_<this.attributes.length;_++){const w=f.attributes[this.attributes[_].name];w!==void 0&&o.enableVertexAttribArray(w)}}setVertexAttribPointers(o,f,_){for(let w=0;w<this.attributes.length;w++){const S=this.attributes[w],L=f.attributes[S.name];L!==void 0&&o.vertexAttribPointer(L,S.components,o[lr[S.type]],!1,this.itemSize,S.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Mn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ui extends Mn{getDefault(){return h.Color.transparent}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Vl extends Mn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class mr extends Mn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class _l extends Mn{getDefault(){return[!0,!0,!0,!0]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class vi extends Mn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Us extends Mn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Wa extends Mn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const f=this.current;(o.func!==f.func||o.ref!==f.ref||o.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class eo extends Mn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Ri extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=o,this.dirty=!1}}class $a extends Mn{getDefault(){return[0,1]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class ql extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=o,this.dirty=!1}}class Qr extends Mn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class hs extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.BLEND):f.disable(f.BLEND),this.current=o,this.dirty=!1}}class $e extends Mn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class yr extends Mn{getDefault(){return h.Color.transparent}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Xr extends Mn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class ri extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=o,this.dirty=!1}}class Ki extends Mn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Tr extends Mn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Rs extends Mn{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class _r extends Mn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Di extends Mn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class fu extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class jl extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class vl extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class ya extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Dr extends Mn{getDefault(){return null}set(o){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Kn extends Mn{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class oi extends Mn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Ds extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class rr extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class ts extends Mn{constructor(o,f){super(o),this.context=o,this.parent=f}getDefault(){return null}}class Pi extends ts{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Zr extends ts{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Yi extends Zr{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ct{constructor(o,f,_,w){this.context=o,this.width=f,this.height=_;const S=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Pi(o,S),w&&(this.depthAttachment=new Zr(o,S))}destroy(){const o=this.context.gl,f=this.colorAttachment.get();if(f&&o.deleteTexture(f),this.depthAttachment){const _=this.depthAttachment.get();_&&o.deleteRenderbuffer(_)}o.deleteFramebuffer(this.framebuffer)}}class et{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ui(this),this.clearDepth=new Vl(this),this.clearStencil=new mr(this),this.colorMask=new _l(this),this.depthMask=new vi(this),this.stencilMask=new Us(this),this.stencilFunc=new Wa(this),this.stencilOp=new eo(this),this.stencilTest=new Ri(this),this.depthRange=new $a(this),this.depthTest=new ql(this),this.depthFunc=new Qr(this),this.blend=new hs(this),this.blendFunc=new $e(this),this.blendColor=new yr(this),this.blendEquation=new Xr(this),this.cullFace=new ri(this),this.cullFaceSide=new Ki(this),this.frontFace=new Tr(this),this.program=new Rs(this),this.activeTexture=new _r(this),this.viewport=new Di(this),this.bindFramebuffer=new fu(this),this.bindRenderbuffer=new jl(this),this.bindTexture=new vl(this),this.bindVertexBuffer=new ya(this),this.bindElementBuffer=new Dr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Kn(this),this.pixelStoreUnpack=new oi(this),this.pixelStoreUnpackPremultiplyAlpha=new Ds(this),this.pixelStoreUnpackFlipY=new rr(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,f){return new Bn(this,o,f)}createVertexBuffer(o,f,_){return new Fr(this,o,f,_)}createRenderbuffer(o,f,_){const w=this.gl,S=w.createRenderbuffer();return this.bindRenderbuffer.set(S),w.renderbufferStorage(w.RENDERBUFFER,o,f,_),this.bindRenderbuffer.set(null),S}createFramebuffer(o,f,_){return new Ct(this,o,f,_)}clear({color:o,depth:f,stencil:_}){const w=this.gl;let S=0;o&&(S|=w.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(S|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),_!==void 0&&(S|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),w.clear(S)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){X(o.blendFunction,h.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ot extends h.Evented{constructor(o,f,_,w){super(),this.id=o,this.dispatcher=_,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},f),h.extend(this,h.pick(f,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Gi(this._options,this.map._requestManager,null,null,((o,f)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new h.ErrorEvent(o)):f&&(h.extend(this,f),f.bounds&&(this.tileBounds=new jr(f.bounds,this.minzoom,this.maxzoom)),h.postTurnstileEvent(f.tiles),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return h.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,f){const _=h.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);o.request=h.getImage(this.map._requestManager.transformRequest(w,h.ResourceType.Tile),((S,L,N,P)=>(delete o.request,o.aborted?(o.state="unloaded",f(null)):S?(o.state="errored",f(S)):L?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:N,expires:P}),o.setTexture(L,this.map.painter),o.state="loaded",h.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null))))}static loadTileData(o,f,_){o.setTexture(f,_)}static unloadTileData(o,f){o.texture&&f.saveTileTexture(o.texture)}abortTile(o,f){o.request&&(o.request.cancel(),delete o.request),f()}unloadTile(o,f){o.texture&&this.map.painter.saveTileTexture(o.texture),f()}hasTransition(){return!1}}let Lt;function Pt(m,o,f,_,w,S,L,N){const P=[m,f,w,o,_,S,1,1,1],Z=[L,N,1],Y=h.adjoint([],P),[nt,dt,Et]=h.transformMat3(Z,Z,h.transpose(Y,Y));return h.multiply$1(P,[nt,0,0,0,dt,0,0,0,Et],P)}class Kt extends h.Evented{constructor(o,f,_,w){super(),this.id=o,this.dispatcher=_,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=f,this._dirty=!1}load(o,f){this._loaded=f||!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),((_,w)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new h.ErrorEvent(_));else if(w){const{HTMLImageElement:S}=h.window;this.image=w instanceof S?h.exported.getImageData(w):w,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const f=o.map(h.MercatorCoordinate.fromLngLat);return this.tileID=(function(_){let w=1/0,S=1/0,L=-1/0,N=-1/0;for(const nt of _)w=Math.min(w,nt.x),S=Math.min(S,nt.y),L=Math.max(L,nt.x),N=Math.max(N,nt.y);const P=Math.max(L-w,N-S),Z=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),Y=Math.pow(2,Z);return new h.CanonicalTileID(Z,Math.floor((w+L)/2*Y),Math.floor((S+N)/2*Y))})(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const P in this.tiles){const Z=this.tiles[P];Z.state!=="loaded"&&(Z.state="loaded",Z.texture=this.texture)}if(this._boundsArray)return;const f=h.tileTransform(this.tileID,this.map.transform.projection),[_,w,S,L]=this.coordinates.map((P=>{const Z=f.projection.project(P[0],P[1]);return h.getTilePoint(f,Z)._round()}));this.perspectiveTransform=(function(P,Z,Y,nt,dt,Et,xt,Mt,St,vt){const Rt=Pt(0,0,P,0,0,Z,P,Z),Tt=Pt(Y,nt,dt,Et,xt,Mt,St,vt);return h.multiply$1(Tt,h.adjoint(Rt,Rt),Tt),[Tt[6]/Tt[8]*P/h.EXTENT,Tt[7]/Tt[8]*Z/h.EXTENT]})(this.width,this.height,_.x,_.y,w.x,w.y,L.x,L.y,S.x,S.y);const N=this._boundsArray=new h.StructArrayLayout4i8;N.emplaceBack(_.x,_.y,0,0),N.emplaceBack(w.x,w.y,h.EXTENT,0),N.emplaceBack(L.x,L.y,0,h.EXTENT),N.emplaceBack(S.x,S.y,h.EXTENT,h.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(N,h.boundsAttributes.members),this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,f=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new h.Texture(o,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,f){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},f(null)):(o.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ue={vector:class extends h.Evented{constructor(m,o,f,_){if(super(),this.id=m,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(o,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new h.DedupedRequest}load(m){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map._worldview;this._tileJSONRequest=Gi(this._options,this.map._requestManager,o,f,((_,w)=>{this._tileJSONRequest=null,this._loaded=!0,_?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),f&&f.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new h.ErrorEvent(_))):w&&(h.extend(this,w),w.bounds&&(this.tileBounds=new jr(w.bounds,this.minzoom,this.maxzoom)),h.postTurnstileEvent(w.tiles,this.map._requestManager._customAccessToken),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))),m&&m(_)}))}loaded(){return this._loaded}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>{const m=this.map.style._getSourceCaches(this.id);for(const o of m)o.clearTiles()}))}setSourceProperty(m){m(),this.reload()}setTiles(m){return this._options.tiles=m,this.reload(),this}setUrl(m){return this.url=m,this._options.url=m,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return h.extend({},this._options)}loadTile(m,o){const f=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(f,h.ResourceType.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:m.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,m.actor&&m.state!=="expired")m.state==="loading"?m.reloadCallback=o:m.request=m.actor.send("reloadTile",_,w.bind(this));else if(m.actor=this._tileWorkers[f]=this._tileWorkers[f]||this.dispatcher.getActor(),this.dispatcher.ready)m.request=m.actor.send("loadTile",_,w.bind(this),void 0,!0);else{const S=h.loadVectorTile.call({deduped:this._deduped},_,((L,N)=>{L||!N?w.call(this,L):(_.data={cacheControl:N.cacheControl,expires:N.expires,rawData:N.rawData.slice(0)},m.actor&&m.actor.send("loadTile",_,w.bind(this),void 0,!0))}),!0);m.request={cancel:S}}function w(S,L){return delete m.request,m.aborted?o(null):S&&S.status!==404?o(S):(L&&L.resourceTiming&&(m.resourceTiming=L.resourceTiming),this.map._refreshExpiredTiles&&L&&m.setExpiryData(L),m.loadVectorData(L,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),o(null),void(m.reloadCallback&&(this.loadTile(m,m.reloadCallback),m.reloadCallback=null)))}}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.actor&&m.actor.send("abortTile",{uid:m.uid,type:this.type,source:this.id})}unloadTile(m){m.unloadVectorData(),m.actor&&m.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:ot,"raster-dem":class extends ot{constructor(m,o,f,_){super(m,o,f,_),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(m,o){const f=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(w,S){w&&(m.state="errored",o(w)),S&&(m.dem=S,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",o(null))}m.request=h.getImage(this.map._requestManager.transformRequest(f,h.ResourceType.Tile),(function(w,S,L,N){if(delete m.request,m.aborted)m.state="unloaded",o(null);else if(w)m.state="errored",o(w);else if(S){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:L,expires:N});const P=h.window.ImageBitmap&&S instanceof h.window.ImageBitmap&&(Lt==null&&(Lt=h.window.OffscreenCanvas&&new h.window.OffscreenCanvas(1,1).getContext("2d")&&typeof h.window.createImageBitmap=="function"),Lt),Z=1-(S.width-h.prevPowerOfTwo(S.width))/2;Z<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const Y=P?S:h.exported.getImageData(S,Z),nt={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:Y,encoding:this.encoding,padding:Z};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",nt,_.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const o=m.canonical,f=Math.pow(2,o.z),_=(o.x-1+f)%f,w=o.x===0?m.wrap-1:m.wrap,S=(o.x+1+f)%f,L=o.x+1===f?m.wrap+1:m.wrap,N={};return N[new h.OverscaledTileID(m.overscaledZ,w,o.z,_,o.y).key]={backfilled:!1},N[new h.OverscaledTileID(m.overscaledZ,L,o.z,S,o.y).key]={backfilled:!1},o.y>0&&(N[new h.OverscaledTileID(m.overscaledZ,w,o.z,_,o.y-1).key]={backfilled:!1},N[new h.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},N[new h.OverscaledTileID(m.overscaledZ,L,o.z,S,o.y-1).key]={backfilled:!1}),o.y+1<f&&(N[new h.OverscaledTileID(m.overscaledZ,w,o.z,_,o.y+1).key]={backfilled:!1},N[new h.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},N[new h.OverscaledTileID(m.overscaledZ,L,o.z,S,o.y+1).key]={backfilled:!1}),N}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends h.Evented{constructor(m,o,f,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(_),this._data=o.data,this._options=h.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const w=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*w,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*w,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:h.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*w,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},o),this}getClusterChildren(m,o){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},o),this}getClusterLeaves(m,o,f,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:o,offset:f},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new h.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=h.extend({},this.workerOptions),o=this._data;typeof o=="string"?(m.request=this.map._requestManager.transformRequest(h.exported.resolveURL(o),h.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,((f,_)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new h.ErrorEvent(f));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(w.resourceTiming=_.resourceTiming[this.id]),this.fire(new h.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(m,o){const f=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(f,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((_,w)=>(delete m.request,m.unloadVectorData(),m.aborted?o(null):_?o(_):(m.loadVectorData(w,this.map.painter,f==="reloadTile"),o(null)))),void 0,f==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return h.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Kt{constructor(m,o,f,_){super(m,o,f,_),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const o of m.urls)this.urls.push(this.map._requestManager.transformRequest(o,h.ResourceType.Source).url);h.getVideo(this.urls,((o,f)=>{this._loaded=!0,o?this.fire(new h.ErrorEvent(o)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const o=this.video.seekable;m<o.start(0)||m>o.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,o=m.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(m,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Kt,canvas:class extends Kt{constructor(m,o,f,_){super(m,o,f,_),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((w=>!Array.isArray(w)||w.length!==2||w.some((S=>typeof S!="number"))))||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends h.Evented{constructor(m,o,f,_){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=o,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new h.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new h.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new jr(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),h.extend(this,h.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return h.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:o,y:f,z:_}=m.canonical;return this._implementation.hasTile({x:o,y:f,z:_})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,o){const{x:f,y:_,z:w}=m.tileID.canonical,S=new h.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:f,y:_,z:w},{signal:S.signal})).then((function(L){return delete m.request,m.aborted?(m.state="unloaded",o(null)):L===void 0?(m.state="errored",o(null)):L===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",o(null)):(function(N){return N instanceof h.window.ImageData||N instanceof h.window.HTMLCanvasElement||N instanceof h.window.ImageBitmap||N instanceof h.window.HTMLImageElement})(L)?(this.loadTileData(m,L),m.state="loaded",void o(null)):(m.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((L=>{L.code!==20&&(m.state="errored",o(L))})),m.request.cancel=()=>S.abort()}loadTileData(m,o){ot.loadTileData(m,o,this._map.painter)}unloadTileData(m){ot.unloadTileData(m,this._map.painter)}unloadTile(m,o){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:f,y:_,z:w}=m.tileID.canonical;this._implementation.unloadTile({x:f,y:_,z:w})}o()}abortTile(m,o){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))}}},se=function(m,o,f,_){const w=new ue[o.type](m,o,f,_);if(w.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${w.id}`);return h.bindAll(["load","abort","unload","serialize","prepare"],w),w};function $t(m,o){const f=h.identity([]);return h.scale(f,f,[.5*m.width,.5*-m.height,1]),h.translate(f,f,[1,-1,0]),h.multiply(f,f,m.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(f)}function me(m,o,f,_,w,S,L,N=!1){const P=m.tilesIn(_,L,N);P.sort(yn);const Z=[];for(const nt of P)Z.push({wrappedTileID:nt.tile.tileID.wrapped().key,queryResults:nt.tile.queryRenderedFeatures(o,f,m._state,nt,w,S,$t(m.transform,nt.tile.tileID),N)});const Y=(function(nt){const dt={},Et={};for(const xt of nt){const Mt=xt.queryResults,St=xt.wrappedTileID,vt=Et[St]=Et[St]||{};for(const Rt in Mt){const Tt=Mt[Rt],Ut=vt[Rt]=vt[Rt]||{},Gt=dt[Rt]=dt[Rt]||[];for(const Nt of Tt)Ut[Nt.featureIndex]||(Ut[Nt.featureIndex]=!0,Gt.push(Nt))}}return dt})(Z);for(const nt in Y)Y[nt].forEach((dt=>{const Et=dt.feature,xt=Et.layer;xt&&xt.type!=="background"&&xt.type!=="sky"&&(Et.source=xt.source,xt["source-layer"]&&(Et.sourceLayer=xt["source-layer"]),Et.state=Et.id!==void 0?m.getFeatureState(xt["source-layer"],Et.id):{})}));return Y}function je(m,o){const f=m.getRenderableIds().map((S=>m.getTileByID(S))),_=[],w={};for(let S=0;S<f.length;S++){const L=f[S],N=L.tileID.canonical.key;w[N]||(w[N]=!0,L.querySourceFeatures(_,o))}return _}function yn(m,o){const f=m.tileID,_=o.tileID;return f.overscaledZ-_.overscaledZ||f.canonical.y-_.canonical.y||f.wrap-_.wrap||f.canonical.x-_.canonical.x}function Je(){return eu.workerClass!=null?new eu.workerClass:new h.window.Worker(eu.workerUrl)}const Zn="mapboxgl_preloaded_worker_pool";class jn{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<jn.workerCount;)this.workers.push(new Je);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach((f=>{f.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Zn]}numActive(){return Object.keys(this.active).length}}let Fn;function Qn(){return Fn||(Fn=new jn),Fn}function fi(m,o){const f={};for(const _ in m)_!=="ref"&&(f[_]=m[_]);return h.refProperties.forEach((_=>{_ in o&&(f[_]=o[_])})),f}function ki(m){m=m.slice();const o=Object.create(null);for(let f=0;f<m.length;f++)o[m[f].id]=m[f];for(let f=0;f<m.length;f++)"ref"in m[f]&&(m[f]=fi(m[f],o[m[f].ref]));return m}jn.workerCount=2;const Dn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Vi(m,o,f){f.push({command:Dn.addSource,args:[m,o[m]]})}function _i(m,o,f){o.push({command:Dn.removeSource,args:[m]}),f[m]=!0}function Ra(m,o,f,_){_i(m,f,_),Vi(m,o,f)}function Ss(m,o,f){let _;for(_ in m[f])if(m[f].hasOwnProperty(_)&&_!=="data"&&!X(m[f][_],o[f][_]))return!1;for(_ in o[f])if(o[f].hasOwnProperty(_)&&_!=="data"&&!X(m[f][_],o[f][_]))return!1;return!0}function _e(m,o,f,_,w,S){let L;for(L in o=o||{},m=m||{})m.hasOwnProperty(L)&&(X(m[L],o[L])||f.push({command:S,args:[_,L,o[L],w]}));for(L in o)o.hasOwnProperty(L)&&!m.hasOwnProperty(L)&&(X(m[L],o[L])||f.push({command:S,args:[_,L,o[L],w]}))}function Hr(m){return m.id}function Rn(m,o){return m[o.id]=o,m}class _a{constructor(o,f){this.reset(o,f)}reset(o,f){this.points=o||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=h.clamp(o,0,1);let f=1,_=this._distances[f];const w=o*this.paddedLength+this.padding;for(;_<w&&f<this._distances.length;)_=this._distances[++f];const S=f-1,L=this._distances[S],N=_-L,P=N>0?(w-L)/N:0;return this.points[S].mult(1-P).add(this.points[f].mult(P))}}class Ns{constructor(o,f,_){const w=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(o/_),this.yCellCount=Math.ceil(f/_);for(let L=0;L<this.xCellCount*this.yCellCount;L++)w.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=f,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,f,_,w,S){this._forEachCell(f,_,w,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(w),this.bboxes.push(S)}insertCircle(o,f,_,w){this._forEachCell(f-w,_-w,f+w,_+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(f),this.circles.push(_),this.circles.push(w)}_insertBoxCell(o,f,_,w,S,L){this.boxCells[S].push(L)}_insertCircleCell(o,f,_,w,S,L){this.circleCells[S].push(L)}_query(o,f,_,w,S,L){if(_<0||o>this.width||w<0||f>this.height)return!S&&[];const N=[];if(o<=0&&f<=0&&this.width<=_&&this.height<=w){if(S)return!0;for(let P=0;P<this.boxKeys.length;P++)N.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const Z=this.circles[3*P],Y=this.circles[3*P+1],nt=this.circles[3*P+2];N.push({key:this.circleKeys[P],x1:Z-nt,y1:Y-nt,x2:Z+nt,y2:Y+nt})}return L?N.filter(L):N}return this._forEachCell(o,f,_,w,this._queryCell,N,{hitTest:S,seenUids:{box:{},circle:{}}},L),S?N.length>0:N}_queryCircle(o,f,_,w,S){const L=o-_,N=o+_,P=f-_,Z=f+_;if(N<0||L>this.width||Z<0||P>this.height)return!w&&[];const Y=[];return this._forEachCell(L,P,N,Z,this._queryCellCircle,Y,{hitTest:w,circle:{x:o,y:f,radius:_},seenUids:{box:{},circle:{}}},S),w?Y.length>0:Y}query(o,f,_,w,S){return this._query(o,f,_,w,!1,S)}hitTest(o,f,_,w,S){return this._query(o,f,_,w,!0,S)}hitTestCircle(o,f,_,w){return this._queryCircle(o,f,_,!0,w)}_queryCell(o,f,_,w,S,L,N,P){const Z=N.seenUids,Y=this.boxCells[S];if(Y!==null){const dt=this.bboxes;for(const Et of Y)if(!Z.box[Et]){Z.box[Et]=!0;const xt=4*Et;if(o<=dt[xt+2]&&f<=dt[xt+3]&&_>=dt[xt+0]&&w>=dt[xt+1]&&(!P||P(this.boxKeys[Et]))){if(N.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[Et],x1:dt[xt],y1:dt[xt+1],x2:dt[xt+2],y2:dt[xt+3]})}}}const nt=this.circleCells[S];if(nt!==null){const dt=this.circles;for(const Et of nt)if(!Z.circle[Et]){Z.circle[Et]=!0;const xt=3*Et;if(this._circleAndRectCollide(dt[xt],dt[xt+1],dt[xt+2],o,f,_,w)&&(!P||P(this.circleKeys[Et]))){if(N.hitTest)return L.push(!0),!0;{const Mt=dt[xt],St=dt[xt+1],vt=dt[xt+2];L.push({key:this.circleKeys[Et],x1:Mt-vt,y1:St-vt,x2:Mt+vt,y2:St+vt})}}}}}_queryCellCircle(o,f,_,w,S,L,N,P){const Z=N.circle,Y=N.seenUids,nt=this.boxCells[S];if(nt!==null){const Et=this.bboxes;for(const xt of nt)if(!Y.box[xt]){Y.box[xt]=!0;const Mt=4*xt;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,Et[Mt+0],Et[Mt+1],Et[Mt+2],Et[Mt+3])&&(!P||P(this.boxKeys[xt])))return L.push(!0),!0}}const dt=this.circleCells[S];if(dt!==null){const Et=this.circles;for(const xt of dt)if(!Y.circle[xt]){Y.circle[xt]=!0;const Mt=3*xt;if(this._circlesCollide(Et[Mt],Et[Mt+1],Et[Mt+2],Z.x,Z.y,Z.radius)&&(!P||P(this.circleKeys[xt])))return L.push(!0),!0}}}_forEachCell(o,f,_,w,S,L,N,P){const Z=this._convertToXCellCoord(o),Y=this._convertToYCellCoord(f),nt=this._convertToXCellCoord(_),dt=this._convertToYCellCoord(w);for(let Et=Z;Et<=nt;Et++)for(let xt=Y;xt<=dt;xt++)if(S.call(this,o,f,_,w,this.xCellCount*xt+Et,L,N,P))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,f,_,w,S,L){const N=w-o,P=S-f,Z=_+L;return Z*Z>N*N+P*P}_circleAndRectCollide(o,f,_,w,S,L,N){const P=(L-w)/2,Z=Math.abs(o-(w+P));if(Z>P+_)return!1;const Y=(N-S)/2,nt=Math.abs(f-(S+Y));if(nt>Y+_)return!1;if(Z<=P||nt<=Y)return!0;const dt=Z-P,Et=nt-Y;return dt*dt+Et*Et<=_*_}}const gi=Math.tan(85*Math.PI/180);function ji(m,o,f,_,w,S,L){const N=h.create();if(f)if(S.name==="globe"){const P=h.calculateGlobeLabelMatrix(w,o);h.multiply(N,N,P)}else{const P=ie([],L);N[0]=P[0],N[1]=P[1],N[4]=P[2],N[5]=P[3],_||h.rotateZ(N,N,w.angle)}else h.multiply(N,w.labelPlaneMatrix,m);return N}function ea(m,o,f,_,w,S,L){const N=ji(m,o,f,_,w,S,L);return S.name==="globe"&&f||(N[2]=N[6]=N[10]=N[14]=0),N}function kr(m,o,f,_,w,S,L){if(f){if(S.name==="globe"){const N=ji(m,o,f,_,w,S,L);return h.invert(N,N),h.multiply(N,m,N),N}{const N=h.clone(m),P=h.identity([]);return P[0]=L[0],P[1]=L[1],P[4]=L[2],P[5]=L[3],h.multiply(N,N,P),_||h.rotateZ(N,N,-w.angle),N}}return w.glCoordMatrix}function re(m,o,f=0){const _=[m.x,m.y,f,1];f?h.transformMat4$1(_,_,o):ft(_,_,o);const w=_[3];return{point:[_[0]/w,_[1]/w,_[2]/w],signedDistanceFromCamera:w}}function gn(m,o){const f=[m[0],m[1],m[2],1];h.transformMat4$1(f,f,o);const _=f[3];return{point:[f[0]/_,f[1]/_,f[2]/_],signedDistanceFromCamera:_}}function zn(m,o){return Math.min(.5+m/o*.5,1.5)}function Ts(m,o){const f=m[0]/m[3],_=m[1]/m[3];return f>=-o[0]&&f<=o[0]&&_>=-o[1]&&_<=o[1]}function Ja(m,o,f,_,w,S,L,N,P,Z){const Y=f.transform,nt=_?m.textSizeData:m.iconSizeData,dt=h.evaluateSizeForZoom(nt,f.transform.zoom),Et=Y.projection.name==="globe",xt=[256/f.width*2+1,256/f.height*2+1],Mt=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;Mt.clear();let St=null;Et&&(St=_?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const vt=m.lineVertexArray,Rt=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,Tt=f.transform.width/f.transform.height;let Ut=!1;for(let Gt=0;Gt<Rt.length;Gt++){const Nt=Rt.get(Gt);if(Nt.writingMode!==h.WritingMode.vertical||Ut||Gt!==0&&Rt.get(Gt-1).writingMode===h.WritingMode.horizontal||(Ut=!0),(Nt.hidden||Nt.writingMode===h.WritingMode.vertical)&&!Ut){H(Nt.numGlyphs,Mt);continue}Ut=!1;const jt=new h.pointGeometry(Nt.tileAnchorX,Nt.tileAnchorY),fe=P?P(jt):[0,0,0],Ee=Y.projection.projectTilePoint(jt.x,jt.y,Z.canonical),xe=[Ee.x+fe[0],Ee.y+fe[1],Ee.z+fe[2]],We=[...xe,1];if(h.transformMat4$1(We,We,o),!Ts(We,xt)){H(Nt.numGlyphs,Mt);continue}const ce=zn(f.transform.cameraToCenterDistance,We[3]),Ve=h.evaluateSizeForFeature(nt,dt,Nt),Pe=L?Ve/ce:Ve*ce,ge=re(new h.pointGeometry(xe[0],xe[1]),w,xe[2]);if(ge.signedDistanceFromCamera<=0){H(Nt.numGlyphs,Mt);continue}let Qt={};const fn=L?null:P,an=Ur(Nt,Pe,!1,N,o,w,S,m.glyphOffsetArray,vt,Mt,St,ge.point,jt,Qt,Tt,fn,Y.projection,Z,L);Ut=an.useVertical,fn&&an.needsFlipping&&(Qt={}),(an.notEnoughRoom||Ut||an.needsFlipping&&Ur(Nt,Pe,!0,N,o,w,S,m.glyphOffsetArray,vt,Mt,St,ge.point,jt,Qt,Tt,fn,Y.projection,Z,L).notEnoughRoom)&&H(Nt.numGlyphs,Mt)}_?(m.text.dynamicLayoutVertexBuffer.updateData(Mt),St&&m.text.globeExtVertexBuffer.updateData(St)):(m.icon.dynamicLayoutVertexBuffer.updateData(Mt),St&&m.icon.globeExtVertexBuffer.updateData(St))}function Hn(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt){const St=N.glyphStartIndex+N.numGlyphs,vt=N.lineStartIndex,Rt=N.lineStartIndex+N.lineLength,Tt=o.getoffsetX(N.glyphStartIndex),Ut=o.getoffsetX(St-1),Gt=Qi(m*Tt,f,_,w,S,L,N.segment,vt,Rt,P,Z,Y,nt,dt,!0,Et,xt,Mt);if(!Gt)return null;const Nt=Qi(m*Ut,f,_,w,S,L,N.segment,vt,Rt,P,Z,Y,nt,dt,!0,Et,xt,Mt);return Nt?{first:Gt,last:Nt}:null}function Ka(m,o,f,_){return m.writingMode===h.WritingMode.horizontal&&Math.abs(f.y-o.y)>Math.abs(f.x-o.x)*_?{useVertical:!0}:m.writingMode===h.WritingMode.vertical?o.y<f.y?{needsFlipping:!0}:null:m.flipState!==0&&(function(w,S,L){const N=(S.x-w.x)*L;return N===0||Math.abs((S.y-w.y)/N)>gi})(o,f,_)?m.flipState===1?{needsFlipping:!0}:null:o.x>f.x?{needsFlipping:!0}:null}function Ur(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt,St,vt,Rt){const Tt=o/24,Ut=m.lineOffsetX*Tt,Gt=m.lineOffsetY*Tt;let Nt=[];if(m.numGlyphs>1){const jt=m.glyphStartIndex+m.numGlyphs,fe=m.lineStartIndex,Ee=m.lineStartIndex+m.lineLength,xe=Hn(Tt,N,Ut,Gt,f,nt,dt,m,P,S,Et,Mt,!1,St,vt,Rt);if(!xe)return{notEnoughRoom:!0};const We=gn(xe.first.point,L).point,ce=gn(xe.last.point,L).point,Ve=new h.pointGeometry(We[0],We[1]),Pe=new h.pointGeometry(ce[0],ce[1]);if(_&&!f){const ge=Ka(m,Ve,Pe,xt);if(m.flipState=ge&&ge.needsFlipping?1:2,ge)return ge}Nt=[xe.first];for(let ge=m.glyphStartIndex+1;ge<jt-1;ge++){const Qt=Qi(Tt*N.getoffsetX(ge),Ut,Gt,f,nt,dt,m.segment,fe,Ee,P,S,Et,Mt,!1,!1,St,vt,Rt);if(!Qt)return{notEnoughRoom:!0};Nt.push(Qt)}Nt.push(xe.last)}else{if(_&&!f){const fe=re(dt,w).point,Ee=m.lineStartIndex+m.segment+1,xe=new h.pointGeometry(P.getx(Ee),P.gety(Ee)),We=re(xe,w),ce=We.signedDistanceFromCamera>0?We.point:br(dt,xe,fe,1,w,void 0,St,vt.canonical),Ve=Ka(m,new h.pointGeometry(fe[0],fe[1]),new h.pointGeometry(ce[0],ce[1]),xt);if(m.flipState=Ve&&Ve.needsFlipping?1:2,Ve)return Ve}const jt=Qi(Tt*N.getoffsetX(m.glyphStartIndex),Ut,Gt,f,nt,dt,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,P,S,Et,Mt,!1,!1,St,vt,Rt);if(!jt)return{notEnoughRoom:!0};Nt=[jt]}if(Y)for(const jt of Nt)h.updateGlobeVertexNormal(Y,Z.length+0,jt.up[0],jt.up[1],jt.up[2]),h.updateGlobeVertexNormal(Y,Z.length+1,jt.up[0],jt.up[1],jt.up[2]),h.updateGlobeVertexNormal(Y,Z.length+2,jt.up[0],jt.up[1],jt.up[2]),h.updateGlobeVertexNormal(Y,Z.length+3,jt.up[0],jt.up[1],jt.up[2]),h.addDynamicAttributes(Z,jt.point[0],jt.point[1],jt.point[2],jt.angle);else for(const jt of Nt)h.addDynamicAttributes(Z,jt.point[0],jt.point[1],jt.point[2],jt.angle);return{}}function na(m,o,f,_,w){const S=_.projectTilePoint(m.x,m.y,o);if(!w)return re(S,f,S.z);const L=w(m);return re(new h.pointGeometry(S.x+L[0],S.y+L[1]),f,S.z+L[2])}function br(m,o,f,_,w,S,L,N){const P=na(m.add(m.sub(o)._unit()),N,w,L,S).point,Z=h.sub([],f,P);return h.scaleAndAdd([],f,Z,_/h.length(Z))}function Qi(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt,St,vt){const Rt=_?m-o:m+o;let Tt=Rt>0?1:-1,Ut=0;_&&(Tt*=-1,Ut=Math.PI),Tt<0&&(Ut+=Math.PI);let Gt=Tt>0?N+L:N+L+1,Nt=w,jt=w,fe=0,Ee=0;const xe=Math.abs(Rt),We=[],ce=[];let Ve=S;const Pe=()=>{const tn=Gt-Tt;return fe===0?S:new h.pointGeometry(Z.getx(tn),Z.gety(tn))},ge=()=>{const tn=Pe();return br(tn,Ve||tn,jt,xe-fe+1,Y,dt,Mt,St.canonical)};for(;fe+Ee<=xe;){if(Gt+=Tt,Gt<N||Gt>=P)return null;if(jt=Nt,We.push(Nt),Et&&ce.push(Ve||Pe()),Nt=nt[Gt],Nt===void 0){Ve=new h.pointGeometry(Z.getx(Gt),Z.gety(Gt));const tn=na(Ve,St.canonical,Y,Mt,dt);Nt=tn.signedDistanceFromCamera>0?nt[Gt]=tn.point:ge()}else Ve=null;fe+=Ee,Ee=h.distance(jt,Nt)}Ve=Ve||new h.pointGeometry(Z.getx(Gt),Z.gety(Gt));const Qt=Pe();xt&&dt&&(nt[Gt]=Nt=nt[Gt]===void 0?Nt:ge(),Ee=h.distance(jt,Nt));const fn=(xe-fe)/Ee,an=Ve.sub(Qt).mult(fn)._add(Qt),Fe=h.sub([],Nt,jt),Xe=h.scaleAndAdd([],jt,Fe,fn);let pn=[0,0,1],Vn=Fe[0],Gn=Fe[1];if(vt&&(pn=Mt.upVector(St.canonical,an.x,an.y),pn[0]!==0||pn[1]!==0||pn[2]!==1)){const tn=[1,0,0],ii=[0,1,0];tn[0]=pn[2],tn[1]=0,tn[2]=-pn[0],h.cross(ii,pn,tn),h.normalize(tn,tn),h.normalize(ii,ii),Vn=h.dot(Fe,tn),Gn=h.dot(Fe,ii)}if(f){const tn=h.cross([],pn,Fe);h.normalize(tn,tn),h.scaleAndAdd(Xe,Xe,tn,f*Tt)}const Un=Ut+Math.atan2(Gn,Vn);return We.push(Xe),Et&&ce.push(an),{point:Xe,angle:Un,path:We,tilePath:ce,up:pn}}const R=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function H(m,o){for(let f=0;f<m;f++){const _=o.length;o.resize(_+4),o.float32.set(R,4*_)}}function ft(m,o,f){const _=o[0],w=o[1];return m[0]=f[0]*_+f[4]*w+f[12],m[1]=f[1]*_+f[5]*w+f[13],m[3]=f[3]*_+f[7]*w+f[15],m}const Ht=100;class Ce{constructor(o,f,_=new Ns(o.width+200,o.height+200,25),w=new Ns(o.width+200,o.height+200,25)){this.transform=o,this.grid=_,this.ignoredGrid=w,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Ht,this.screenBottomBoundary=o.height+Ht,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=f}placeCollisionBox(o,f,_,w,S,L,N,P){let Z=_.projectedAnchorX,Y=_.projectedAnchorY,nt=_.projectedAnchorZ;const dt=_.elevation,Et=_.tileID;if(dt&&Et){const Gt=o.getProjection().upVector(Et.canonical,_.tileAnchorX,_.tileAnchorY),Nt=o.getProjection().upVectorScale(Et.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=Gt[0]*dt*Nt,Y+=Gt[1]*dt*Nt,nt+=Gt[2]*dt*Nt}const xt=this.projectAndGetPerspectiveRatio(N,[Z,Y,nt],_.tileID,o.projection.name==="globe"||!!dt||this.transform.pitch>0,o.getProjection()),Mt=L*xt.perspectiveRatio,St=(_.x1*f+w.x-_.padding)*Mt+xt.point.x,vt=(_.y1*f+w.y-_.padding)*Mt+xt.point.y,Rt=(_.x2*f+w.x+_.padding)*Mt+xt.point.x,Tt=(_.y2*f+w.y+_.padding)*Mt+xt.point.y,Ut=xt.perspectiveRatio<=.55||xt.occluded;return!this.isInsideGrid(St,vt,Rt,Tt)||!S&&this.grid.hitTest(St,vt,Rt,Tt,P)||Ut?{box:[],offscreen:!1,occluded:xt.occluded}:{box:[St,vt,Rt,Tt],offscreen:this.isOffscreen(St,vt,Rt,Tt),occluded:!1}}placeCollisionCircles(o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt){const St=[],vt=this.transform.elevation,Rt=vt?vt.getAtTileOffsetFunc(Mt,this.transform.center.lat,this.transform.worldSize,o.getProjection()):Qt=>[0,0,0],Tt=new h.pointGeometry(_.tileAnchorX,_.tileAnchorY),Ut=o.getProjection().projectTilePoint(_.tileAnchorX,_.tileAnchorY,Mt.canonical),Gt=Rt(Tt),Nt=[Ut.x+Gt[0],Ut.y+Gt[1],Ut.z+Gt[2]],jt=o.projection.name==="globe",fe=this.projectAndGetPerspectiveRatio(N,[Nt[0],Nt[1],Nt[2]],Mt,jt||!!vt||this.transform.pitch>0,o.getProjection()),{perspectiveRatio:Ee}=fe,xe=(nt?L/Ee:L*Ee)/h.ONE_EM,We=re(new h.pointGeometry(Nt[0],Nt[1]),P,Nt[2]).point,ce=fe.signedDistanceFromCamera>0?Hn(xe,S,_.lineOffsetX*xe,_.lineOffsetY*xe,!1,We,Tt,_,w,P,{},vt&&!nt?Rt:null,nt&&!!vt,o.getProjection(),Mt,nt):null;let Ve=!1,Pe=!1,ge=!0;if(ce&&!fe.occluded){const Qt=.5*Et*Ee+xt,fn=new h.pointGeometry(-100,-100),an=new h.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Fe=new _a,Xe=ce.first,pn=ce.last;let Vn=[];for(let tn=Xe.path.length-1;tn>=1;tn--)Vn.push(Xe.path[tn]);for(let tn=1;tn<pn.path.length;tn++)Vn.push(pn.path[tn]);const Gn=2.5*Qt;if(Z){const tn=Vn.map(vt&&!jt?(ii,di)=>{const Er=Rt(di<Xe.path.length-1?Xe.tilePath[Xe.path.length-1-di]:pn.tilePath[di-Xe.path.length+2]);return ii[2]=Er[2],gn(ii,Z)}:ii=>gn(ii,Z));Vn=tn.some((ii=>ii.signedDistanceFromCamera<=0))?[]:tn.map((ii=>ii.point))}let Un=[];if(Vn.length>0){const tn=Vn.map((ar=>new h.pointGeometry(ar[0],ar[1])));let ii=1/0,di=-1/0,Er=1/0,pi=-1/0;for(let ar=0;ar<tn.length;ar++)ii=Math.min(ii,tn[ar].x),Er=Math.min(Er,tn[ar].y),di=Math.max(di,tn[ar].x),pi=Math.max(pi,tn[ar].y);Un=ii>=fn.x&&di<=an.x&&Er>=fn.y&&pi<=an.y?[tn]:di<fn.x||ii>an.x||pi<fn.y||Er>an.y?[]:h.clipLine([tn],fn.x,fn.y,an.x,an.y)}for(const tn of Un){Fe.reset(tn,.25*Qt);let ii=0;ii=Fe.length<=.5*Qt?1:Math.ceil(Fe.paddedLength/Gn)+1;for(let di=0;di<ii;di++){const Er=di/Math.max(ii-1,1),pi=Fe.lerp(Er),ar=pi.x+Ht,Xs=pi.y+Ht;St.push(ar,Xs,Qt,0);const Ko=ar-Qt,ks=Xs-Qt,er=ar+Qt,Wr=Xs+Qt;if(ge=ge&&this.isOffscreen(Ko,ks,er,Wr),Pe=Pe||this.isInsideGrid(Ko,ks,er,Wr),!f&&this.grid.hitTestCircle(ar,Xs,Qt,dt)&&(Ve=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:Ve,occluded:!1}}}}return{circles:!Y&&Ve||!Pe?[]:St,offscreen:ge,collisionDetected:Ve,occluded:fe.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let _=1/0,w=1/0,S=-1/0,L=-1/0;for(const Y of o){const nt=new h.pointGeometry(Y.x+Ht,Y.y+Ht);_=Math.min(_,nt.x),w=Math.min(w,nt.y),S=Math.max(S,nt.x),L=Math.max(L,nt.y),f.push(nt)}const N=this.grid.query(_,w,S,L).concat(this.ignoredGrid.query(_,w,S,L)),P={},Z={};for(const Y of N){const nt=Y.key;if(P[nt.bucketInstanceId]===void 0&&(P[nt.bucketInstanceId]={}),P[nt.bucketInstanceId][nt.featureIndex])continue;const dt=[new h.pointGeometry(Y.x1,Y.y1),new h.pointGeometry(Y.x2,Y.y1),new h.pointGeometry(Y.x2,Y.y2),new h.pointGeometry(Y.x1,Y.y2)];h.polygonIntersectsPolygon(f,dt)&&(P[nt.bucketInstanceId][nt.featureIndex]=!0,Z[nt.bucketInstanceId]===void 0&&(Z[nt.bucketInstanceId]=[]),Z[nt.bucketInstanceId].push(nt.featureIndex))}return Z}insertCollisionBox(o,f,_,w,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:w,collisionGroupID:S},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,f,_,w,S){const L=f?this.ignoredGrid:this.grid,N={bucketInstanceId:_,featureIndex:w,collisionGroupID:S};for(let P=0;P<o.length;P+=4)L.insertCircle(N,o[P],o[P+1],o[P+2])}projectAndGetPerspectiveRatio(o,f,_,w,S){const L=[f[0],f[1],f[2],1];let N=!1;if(f[2]||this.transform.pitch>0){h.transformMat4$1(L,L,o);const P=S.name==="globe";this.fogState&&_&&!P&&(N=(function(Z,Y,nt,dt,Et,xt){const Mt=xt.calculateFogTileMatrix(Et),St=[Y,nt,dt];return h.transformMat4(St,St,Mt),ye(Z,St,xt.pitch,xt._fov)})(this.fogState,f[0],f[1],f[2],_.toUnwrapped(),this.transform)>.9)}else ft(L,L,o);return{point:new h.pointGeometry((L[0]/L[3]+1)/2*this.transform.width+Ht,(-L[1]/L[3]+1)/2*this.transform.height+Ht),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(S)/L[3]*.5,1.5),signedDistanceFromCamera:L[3],occluded:w&&L[2]>L[3]||N}}isOffscreen(o,f,_,w){return _<Ht||o>=this.screenRightBoundary||w<Ht||f>this.screenBottomBoundary}isInsideGrid(o,f,_,w){return _>=0&&o<this.gridRightBoundary&&w>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const o=h.identity([]);return h.translate(o,o,[-100,-100,0]),o}}function pe(m,o,f){const _=o.createTileMatrix(m,m.worldSize,f.toUnwrapped());return h.multiply(new Float32Array(16),m.projMatrix,_)}function be(m,o,f){if(o.projection.name===f.projection.name)return m.projMatrix;const _=f.clone();return _.setProjection(o.projection),pe(_,o.getProjection(),m)}function en(m,o,f){return o.name===f.projection.name?m.projMatrix:pe(f,o,m)}class nn{constructor(o,f,_,w){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?f:-f))):w&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class wn{constructor(o,f,_,w,S,L=!1){this.text=new nn(o?o.text:null,f,_,S),this.icon=new nn(o?o.icon:null,f,w,S),this.clipped=L}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class we{constructor(o,f,_,w=!1){this.text=o,this.icon=f,this.skipFade=_,this.clipped=w}}class Qe{constructor(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]}}class Tn{constructor(o,f,_,w,S){this.bucketInstanceId=o,this.featureIndex=f,this.sourceLayerIndex=_,this.bucketIndex=w,this.tileID=S}}class Yn{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const f=++this.maxGroupID;this.collisionGroups[o]={ID:f,predicate:_=>_.collisionGroupID===f}}return this.collisionGroups[o]}}function Pn(m,o,f,_,w){const{horizontalAlign:S,verticalAlign:L}=h.getAnchorAlignment(m),N=-(S-.5)*o,P=-(L-.5)*f,Z=h.evaluateVariableOffset(m,_);return new h.pointGeometry(N+Z[0]*w,P+Z[1]*w)}function Ni(m,o,f,_,w){const S=new h.pointGeometry(m,o);return f&&S._rotate(_?w:-w),S}class ke{constructor(o,f,_,w,S){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Ce(this.transform,S),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Yn(_),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,f,_,w){const S=_.getBucket(f),L=_.latestFeatureIndex;if(!S||!L||f.id!==S.layerIds[0])return;const N=S.layers[0].layout,P=_.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),Y=_.tileSize/h.EXTENT,nt=_.tileID.toUnwrapped();this.transform.setProjection(S.projection);const dt=(Et=_.tileID,xt=S.getProjection(),Mt=this.transform,xt.name===this.projection?Mt.calculateProjMatrix(Et.toUnwrapped()):pe(Mt,xt,Et));var Et,xt,Mt;const St=N.get("text-pitch-alignment")==="map",vt=N.get("text-rotation-alignment")==="map";f.compileFilter();const Rt=f.dynamicFilter(),Tt=f.dynamicFilterNeedsFeature(),Ut=this.transform.calculatePixelsToTileUnitsMatrix(_),Gt=ea(dt,_.tileID.canonical,St,vt,this.transform,S.getProjection(),Ut);let Nt=null;if(St){const Ee=kr(dt,_.tileID.canonical,St,vt,this.transform,S.getProjection(),Ut);Nt=h.multiply([],this.transform.labelPlaneMatrix,Ee)}let jt=null;Rt&&_.latestFeatureIndex&&(jt={unwrappedTileID:nt,dynamicFilter:Rt,dynamicFilterNeedsFeature:Tt,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[S.bucketInstanceId]=new Tn(S.bucketInstanceId,L,S.sourceLayerIndex,S.index,_.tileID);const fe={bucket:S,layout:N,posMatrix:dt,textLabelPlaneMatrix:Gt,labelToScreenMatrix:Nt,clippingData:jt,scale:Z,textPixelRatio:Y,holdingForFade:_.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:h.evaluateSizeForZoom(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(w)for(const Ee of S.sortKeyRanges){const{sortKey:xe,symbolInstanceStart:We,symbolInstanceEnd:ce}=Ee;o.push({sortKey:xe,symbolInstanceStart:We,symbolInstanceEnd:ce,parameters:fe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:fe})}attemptAnchorPlacement(o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt,St,vt,Rt){const Tt=[dt.textOffset0,dt.textOffset1],Ut=Pn(o,_,w,Tt,S),Gt=this.collisionIndex.placeCollisionBox(xt,S,f,Ni(Ut.x,Ut.y,L,N,this.transform.angle),nt,P,Z,Y.predicate);if(St){const Nt=xt.getSymbolInstanceIconSize(Rt,this.transform.zoom,dt.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(xt,Nt,St,Ni(Ut.x,Ut.y,L,N,this.transform.angle),nt,P,Z,Y.predicate).box.length===0)return}if(Gt.box.length>0){let Nt;return this.prevPlacement&&this.prevPlacement.variableOffsets[dt.crossTileID]&&this.prevPlacement.placements[dt.crossTileID]&&this.prevPlacement.placements[dt.crossTileID].text&&(Nt=this.prevPlacement.variableOffsets[dt.crossTileID].anchor),this.variableOffsets[dt.crossTileID]={textOffset:Tt,width:_,height:w,anchor:o,textScale:S,prevAnchor:Nt},this.markUsedJustification(xt,o,dt,Mt),xt.allowVerticalPlacement&&(this.markUsedOrientation(xt,Mt,dt),this.placedOrientations[dt.crossTileID]=Mt),{shift:Ut,placedGlyphBoxes:Gt}}}placeLayerBucketPart(o,f,_,w){const{bucket:S,layout:L,posMatrix:N,textLabelPlaneMatrix:P,labelToScreenMatrix:Z,clippingData:Y,textPixelRatio:nt,holdingForFade:dt,collisionBoxArray:Et,partiallyEvaluatedTextSize:xt,partiallyEvaluatedIconSize:Mt,collisionGroup:St}=o.parameters,vt=L.get("text-optional"),Rt=L.get("icon-optional"),Tt=L.get("text-allow-overlap"),Ut=L.get("icon-allow-overlap"),Gt=L.get("text-rotation-alignment")==="map",Nt=L.get("text-pitch-alignment")==="map",jt=L.get("icon-text-fit")!=="none",fe=L.get("symbol-z-order")==="viewport-y";this.transform.setProjection(S.projection);let Ee=Tt&&(Ut||!S.hasIconData()||Rt),xe=Ut&&(Tt||!S.hasTextData()||vt);!S.collisionArrays&&Et&&S.deserializeCollisionBoxes(Et),_&&w&&S.updateCollisionDebugBuffers(this.transform.zoom,Et);const We=(ce,Ve,Pe)=>{if(Y){const er={zoom:this.transform.zoom,pitch:this.transform.pitch};let Wr=null;if(Y.dynamicFilterNeedsFeature){const nr=this.retainedQueryData[S.bucketInstanceId];Wr=Y.featureIndex.loadFeature({featureIndex:ce.featureIndex,bucketIndex:nr.bucketIndex,sourceLayerIndex:nr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Y.dynamicFilter)(er,Wr,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new h.pointGeometry(ce.tileAnchorX,ce.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[ce.crossTileID]=new we(!1,!1,!1,!0),void(f[ce.crossTileID]=!0)}if(f[ce.crossTileID])return;if(dt)return void(this.placements[ce.crossTileID]=new we(!1,!1,!1));let ge=!1,Qt=!1,fn=!0,an=!1,Fe=!1,Xe=null,pn={box:null,offscreen:null,occluded:null},Vn={box:null},Gn=null,Un=null,tn=null,ii=0,di=0,Er=0;Pe.textFeatureIndex?ii=Pe.textFeatureIndex:ce.useRuntimeCollisionCircles&&(ii=ce.featureIndex),Pe.verticalTextFeatureIndex&&(di=Pe.verticalTextFeatureIndex);const pi=er=>{er.tileID=this.retainedQueryData[S.bucketInstanceId].tileID,(this.transform.elevation||er.elevation)&&(er.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[S.bucketInstanceId].tileID,er.tileAnchorX,er.tileAnchorY):0)},ar=Pe.textBox;if(ar){pi(ar);const er=nr=>{let Is=h.WritingMode.horizontal;if(S.allowVerticalPlacement&&!nr&&this.prevPlacement){const Ir=this.prevPlacement.placedOrientations[ce.crossTileID];Ir&&(this.placedOrientations[ce.crossTileID]=Ir,Is=Ir,this.markUsedOrientation(S,Is,ce))}return Is},Wr=(nr,Is)=>{if(S.allowVerticalPlacement&&ce.numVerticalGlyphVertices>0&&Pe.verticalTextBox){for(const Ir of S.writingModes)if(Ir===h.WritingMode.vertical?(pn=Is(),Vn=pn):pn=nr(),pn&&pn.box&&pn.box.length)break}else pn=nr()};if(L.get("text-variable-anchor")){let nr=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]){const xi=this.prevPlacement.variableOffsets[ce.crossTileID];nr.indexOf(xi.anchor)>0&&(nr=nr.filter((Po=>Po!==xi.anchor)),nr.unshift(xi.anchor))}const Is=(xi,Po,Ol)=>{const Ia=S.getSymbolInstanceTextSize(xt,ce,this.transform.zoom,Ve),Bo=(xi.x2-xi.x1)*Ia+2*xi.padding,Ma=(xi.y2-xi.y1)*Ia+2*xi.padding,zl=jt&&!Ut?Po:null;zl&&pi(zl);let uo={box:[],offscreen:!1,occluded:!1};const pl=Tt?2*nr.length:nr.length;for(let Su=0;Su<pl;++Su){const gl=this.attemptAnchorPlacement(nr[Su%nr.length],xi,Bo,Ma,Ia,Gt,Nt,nt,N,St,Su>=nr.length,ce,Ve,S,Ol,zl,xt,Mt);if(gl&&(uo=gl.placedGlyphBoxes,uo&&uo.box&&uo.box.length)){ge=!0,Xe=gl.shift;break}}return uo};Wr((()=>Is(ar,Pe.iconBox,h.WritingMode.horizontal)),(()=>{const xi=Pe.verticalTextBox;return xi&&pi(xi),S.allowVerticalPlacement&&!(pn&&pn.box&&pn.box.length)&&ce.numVerticalGlyphVertices>0&&xi?Is(xi,Pe.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),pn&&(ge=pn.box,fn=pn.offscreen,an=pn.occluded);const Ir=er(pn&&pn.box);if(!ge&&this.prevPlacement){const xi=this.prevPlacement.variableOffsets[ce.crossTileID];xi&&(this.variableOffsets[ce.crossTileID]=xi,this.markUsedJustification(S,xi.anchor,ce,Ir))}}else{const nr=(Is,Ir)=>{const xi=S.getSymbolInstanceTextSize(xt,ce,this.transform.zoom,Ve),Po=this.collisionIndex.placeCollisionBox(S,xi,Is,new h.pointGeometry(0,0),Tt,nt,N,St.predicate);return Po&&Po.box&&Po.box.length&&(this.markUsedOrientation(S,Ir,ce),this.placedOrientations[ce.crossTileID]=Ir),Po};Wr((()=>nr(ar,h.WritingMode.horizontal)),(()=>{const Is=Pe.verticalTextBox;return S.allowVerticalPlacement&&ce.numVerticalGlyphVertices>0&&Is?(pi(Is),nr(Is,h.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),er(pn&&pn.box&&pn.box.length)}}if(Gn=pn,ge=Gn&&Gn.box&&Gn.box.length>0,fn=Gn&&Gn.offscreen,an=Gn&&Gn.occluded,ce.useRuntimeCollisionCircles){const er=S.text.placedSymbolArray.get(ce.centerJustifiedTextSymbolIndex>=0?ce.centerJustifiedTextSymbolIndex:ce.verticalPlacedTextSymbolIndex),Wr=h.evaluateSizeForFeature(S.textSizeData,xt,er),nr=L.get("text-padding");Un=this.collisionIndex.placeCollisionCircles(S,Tt,er,S.lineVertexArray,S.glyphOffsetArray,Wr,N,P,Z,_,Nt,St.predicate,ce.collisionCircleDiameter*Wr/h.ONE_EM,nr,this.retainedQueryData[S.bucketInstanceId].tileID),ge=Tt||Un.circles.length>0&&!Un.collisionDetected,fn=fn&&Un.offscreen,an=Un.occluded}if(Pe.iconFeatureIndex&&(Er=Pe.iconFeatureIndex),Pe.iconBox){const er=Wr=>{pi(Wr);const nr=jt&&Xe?Ni(Xe.x,Xe.y,Gt,Nt,this.transform.angle):new h.pointGeometry(0,0),Is=S.getSymbolInstanceIconSize(Mt,this.transform.zoom,ce.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,Is,Wr,nr,Ut,nt,N,St.predicate)};Vn&&Vn.box&&Vn.box.length&&Pe.verticalIconBox?(tn=er(Pe.verticalIconBox),Qt=tn.box.length>0):(tn=er(Pe.iconBox),Qt=tn.box.length>0),fn=fn&&tn.offscreen,Fe=tn.occluded}const Xs=vt||ce.numHorizontalGlyphVertices===0&&ce.numVerticalGlyphVertices===0,Ko=Rt||ce.numIconVertices===0;if(Xs||Ko?Ko?Xs||(Qt=Qt&&ge):ge=Qt&&ge:Qt=ge=Qt&&ge,ge&&Gn&&Gn.box&&this.collisionIndex.insertCollisionBox(Gn.box,L.get("text-ignore-placement"),S.bucketInstanceId,Vn&&Vn.box&&di?di:ii,St.ID),Qt&&tn&&this.collisionIndex.insertCollisionBox(tn.box,L.get("icon-ignore-placement"),S.bucketInstanceId,Er,St.ID),Un&&(ge&&this.collisionIndex.insertCollisionCircles(Un.circles,L.get("text-ignore-placement"),S.bucketInstanceId,ii,St.ID),_)){const er=S.bucketInstanceId;let Wr=this.collisionCircleArrays[er];Wr===void 0&&(Wr=this.collisionCircleArrays[er]=new Qe);for(let nr=0;nr<Un.circles.length;nr+=4)Wr.circles.push(Un.circles[nr+0]),Wr.circles.push(Un.circles[nr+1]),Wr.circles.push(Un.circles[nr+2]),Wr.circles.push(Un.collisionDetected?1:0)}const ks=S.projection.name!=="globe";Ee=Ee&&(ks||!an),xe=xe&&(ks||!Fe),this.placements[ce.crossTileID]=new we(ge||Ee,Qt||xe,fn||S.justReloaded),f[ce.crossTileID]=!0};if(fe){const ce=S.getSortedSymbolIndexes(this.transform.angle);for(let Ve=ce.length-1;Ve>=0;--Ve){const Pe=ce[Ve];We(S.symbolInstances.get(Pe),Pe,S.collisionArrays[Pe])}}else for(let ce=o.symbolInstanceStart;ce<o.symbolInstanceEnd;ce++)We(S.symbolInstances.get(ce),ce,S.collisionArrays[ce]);if(_&&S.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[S.bucketInstanceId];h.invert(ce.invProjMatrix,N),ce.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(o,f,_,w){let S;S=w===h.WritingMode.vertical?_.verticalPlacedTextSymbolIndex:{left:_.leftJustifiedTextSymbolIndex,center:_.centerJustifiedTextSymbolIndex,right:_.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(f)];const L=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex,_.verticalPlacedTextSymbolIndex];for(const N of L)N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=S>=0&&N!==S?0:_.crossTileID)}markUsedOrientation(o,f,_){const w=f===h.WritingMode.horizontal||f===h.WritingMode.horizontalOnly?f:0,S=f===h.WritingMode.vertical?f:0,L=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex].filter((N=>N!==-1));for(const N of L)o.text.placedSymbolArray.get(N).placedOrientation=w;_.verticalPlacedTextSymbolIndex!==-1&&(o.text.placedSymbolArray.get(_.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let _=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const w=f?f.symbolFadeChange(o):1,S=f?f.opacities:{},L=f?f.variableOffsets:{},N=f?f.placedOrientations:{};for(const P in this.placements){const Z=this.placements[P],Y=S[P];Y?(this.opacities[P]=new wn(Y,w,Z.text,Z.icon,null,Z.clipped),_=_||Z.text!==Y.text.placed||Z.icon!==Y.icon.placed):(this.opacities[P]=new wn(null,w,Z.text,Z.icon,Z.skipFade,Z.clipped),_=_||Z.text||Z.icon)}for(const P in S){const Z=S[P];if(!this.opacities[P]){const Y=new wn(Z,w,!1,!1);Y.isHidden()||(this.opacities[P]=Y,_=_||Z.text.placed||Z.icon.placed)}}for(const P in L)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=L[P]);for(const P in N)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=N[P]);_?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:o)}updateLayerOpacities(o,f){const _={};for(const w of f){const S=w.getBucket(o);S&&w.latestFeatureIndex&&o.id===S.layerIds[0]&&this.updateBucketOpacities(S,_,w.collisionBoxArray)}}updateBucketOpacities(o,f,_){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const w=o.layers[0].layout,S=!!o.layers[0].dynamicFilter(),L=new wn(null,0,!1,!1,!0),N=w.get("text-allow-overlap"),P=w.get("icon-allow-overlap"),Z=w.get("text-variable-anchor"),Y=w.get("text-rotation-alignment")==="map",nt=w.get("text-pitch-alignment")==="map",dt=w.get("icon-text-fit")!=="none",Et=new wn(null,0,N&&(P||!o.hasIconData()||w.get("icon-optional")),P&&(N||!o.hasTextData()||w.get("text-optional")),!0);!o.collisionArrays&&_&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(_);const xt=(St,vt,Rt)=>{for(let Tt=0;Tt<vt/4;Tt++)St.opacityVertexArray.emplaceBack(Rt)};let Mt=0;for(let St=0;St<o.symbolInstances.length;St++){const vt=o.symbolInstances.get(St),{numHorizontalGlyphVertices:Rt,numVerticalGlyphVertices:Tt,crossTileID:Ut}=vt;let Gt=this.opacities[Ut];f[Ut]?Gt=L:Gt||(Gt=Et,this.opacities[Ut]=Gt),f[Ut]=!0;const Nt=Rt>0||Tt>0,jt=vt.numIconVertices>0,fe=this.placedOrientations[vt.crossTileID],Ee=fe===h.WritingMode.vertical,xe=fe===h.WritingMode.horizontal||fe===h.WritingMode.horizontalOnly;if(!Nt&&!jt||Gt.isHidden()||Mt++,Nt){const We=Yr(Gt.text);xt(o.text,Rt,Ee?ss:We),xt(o.text,Tt,xe?ss:We);const ce=Gt.text.isHidden();[vt.rightJustifiedTextSymbolIndex,vt.centerJustifiedTextSymbolIndex,vt.leftJustifiedTextSymbolIndex].forEach((ge=>{ge>=0&&(o.text.placedSymbolArray.get(ge).hidden=ce||Ee?1:0)})),vt.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(vt.verticalPlacedTextSymbolIndex).hidden=ce||xe?1:0);const Ve=this.variableOffsets[vt.crossTileID];Ve&&this.markUsedJustification(o,Ve.anchor,vt,fe);const Pe=this.placedOrientations[vt.crossTileID];Pe&&(this.markUsedJustification(o,"left",vt,Pe),this.markUsedOrientation(o,Pe,vt))}if(jt){const We=Yr(Gt.icon);vt.placedIconSymbolIndex>=0&&(xt(o.icon,vt.numIconVertices,Ee?ss:We),o.icon.placedSymbolArray.get(vt.placedIconSymbolIndex).hidden=Gt.icon.isHidden()),vt.verticalPlacedIconSymbolIndex>=0&&(xt(o.icon,vt.numVerticalIconVertices,xe?ss:We),o.icon.placedSymbolArray.get(vt.verticalPlacedIconSymbolIndex).hidden=Gt.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const We=o.collisionArrays[St];if(We){let ce=new h.pointGeometry(0,0),Ve=!0;if(We.textBox||We.verticalTextBox){if(Z){const ge=this.variableOffsets[Ut];ge?(ce=Pn(ge.anchor,ge.width,ge.height,ge.textOffset,ge.textScale),Y&&ce._rotate(nt?this.transform.angle:-this.transform.angle)):Ve=!1}S&&(Ve=!Gt.clipped),We.textBox&&_n(o.textCollisionBox.collisionVertexArray,Gt.text.placed,!Ve||Ee,ce.x,ce.y),We.verticalTextBox&&_n(o.textCollisionBox.collisionVertexArray,Gt.text.placed,!Ve||xe,ce.x,ce.y)}const Pe=Ve&&!!(!xe&&We.verticalIconBox);We.iconBox&&_n(o.iconCollisionBox.collisionVertexArray,Gt.icon.placed,Pe,dt?ce.x:0,dt?ce.y:0),We.verticalIconBox&&_n(o.iconCollisionBox.collisionVertexArray,Gt.icon.placed,!Pe,dt?ce.x:0,dt?ce.y:0)}}}if(o.fullyClipped=Mt===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const St=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=St.invProjMatrix,o.placementViewportMatrix=St.viewportMatrix,o.collisionCircleArray=St.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,f){const _=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*_>o}setStale(){this.stale=!0}}function _n(m,o,f,_,w){m.emplaceBack(o?1:0,f?1:0,_||0,w||0),m.emplaceBack(o?1:0,f?1:0,_||0,w||0),m.emplaceBack(o?1:0,f?1:0,_||0,w||0),m.emplaceBack(o?1:0,f?1:0,_||0,w||0)}const kn=Math.pow(2,25),Xi=Math.pow(2,24),Wi=Math.pow(2,17),xn=Math.pow(2,16),gr=Math.pow(2,9),ur=Math.pow(2,8),qi=Math.pow(2,1);function Yr(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const o=m.placed?1:0,f=Math.floor(127*m.opacity);return f*kn+o*Xi+f*Wi+o*xn+f*gr+o*ur+f*qi+o}const ss=0;class Da{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,f,_,w,S){const L=this._bucketParts;for(;this._currentTileIndex<o.length;)if(f.getBucketParts(L,w,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort(((N,P)=>N.sortKey-P.sortKey)));this._currentPartIndex<L.length;){const N=L[this._currentPartIndex];if(f.placeLayerBucketPart(N,this._seenCrossTileIDs,_,N.symbolInstanceStart===0),this._currentPartIndex++,S())return!0}return!1}}class Co{constructor(o,f,_,w,S,L,N,P){this.placement=new ke(o,S,L,N,P),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(o,f,_){const w=h.exported.now(),S=()=>{const L=h.exported.now()-w;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=f[o[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=N)&&(!L.maxzoom||L.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new Da(L)),this._inProgressLayer.continuePlacement(_[L.source],this.placement,this._showCollisionBoxes,L,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const no=512/h.EXTENT/2;class fs{constructor(o,f,_){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(let w=0;w<f.length;w++){const S=f.get(w),L=S.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,o)})}}getScaledCoordinates(o,f){const _=no/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*h.EXTENT+o.tileAnchorX)*_),y:Math.floor((f.canonical.y*h.EXTENT+o.tileAnchorY)*_)}}findMatches(o,f,_){const w=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let S=0;S<o.length;S++){const L=o.get(S);if(L.crossTileID)continue;const N=this.indexedSymbolInstances[L.key];if(!N)continue;const P=this.getScaledCoordinates(L,f);for(const Z of N)if(Math.abs(Z.coord.x-P.x)<=w&&Math.abs(Z.coord.y-P.y)<=w&&!_[Z.crossTileID]){_[Z.crossTileID]=!0,L.crossTileID=Z.crossTileID;break}}}}class Ci{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ho{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const f=Math.round((o-this.lng)/360);if(f!==0)for(const _ in this.indexes){const w=this.indexes[_],S={};for(const L in w){const N=w[L];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+f),S[N.tileID.key]=N}this.indexes[_]=S}this.lng=o}addBucket(o,f,_){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let S=0;S<f.symbolInstances.length;S++)f.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const w=this.usedCrossTileIDs[o.overscaledZ];for(const S in this.indexes){const L=this.indexes[S];if(Number(S)>o.overscaledZ)for(const N in L){const P=L[N];P.tileID.isChildOf(o)&&P.findMatches(f.symbolInstances,o,w)}else{const N=L[o.scaledTo(Number(S)).key];N&&N.findMatches(f.symbolInstances,o,w)}}for(let S=0;S<f.symbolInstances.length;S++){const L=f.symbolInstances.get(S);L.crossTileID||(L.crossTileID=_.generate(),w[L.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new fs(o,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(o,f){for(const _ in f.indexedSymbolInstances)for(const w of f.indexedSymbolInstances[_])delete this.usedCrossTileIDs[o][w.crossTileID]}removeStaleBuckets(o){let f=!1;for(const _ in this.indexes){const w=this.indexes[_];for(const S in w)o[w[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,w[S]),delete w[S],f=!0)}return f}}class fo{constructor(){this.layerIndexes={},this.crossTileIDs=new Ci,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,f,_,w){let S=this.layerIndexes[o.id];S===void 0&&(S=this.layerIndexes[o.id]=new ho);let L=!1;const N={};w.name!=="globe"&&S.handleWrapJump(_);for(const P of f){const Z=P.getBucket(o);Z&&o.id===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(P.tileID,Z,this.crossTileIDs)&&(L=!0),N[Z.bucketInstanceId]=!0)}return S.removeStaleBuckets(N)&&(L=!0),L}pruneUnusedLayers(o){const f={};o.forEach((_=>{f[_]=!0}));for(const _ in this.layerIndexes)f[_]||delete this.layerIndexes[_]}}const io=(m,o)=>h.emitValidationErrors(m,o&&o.filter((f=>f.identifier!=="source.canvas"))),jo=h.pick(Dn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Io=h.pick(Dn,["setCenter","setZoom","setBearing","setPitch"]),Cs={version:8,layers:[],sources:{}},ro={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Os extends h.Evented{constructor(o,f={}){super(),this.map=o,this.dispatcher=new Be(Qn(),this),this.imageManager=new rt,this.imageManager.setEventedParent(this),this.glyphManager=new h.GlyphManager(o._requestManager,f.localFontFamily?h.LocalGlyphMode.all:f.localIdeographFontFamily?h.LocalGlyphMode.ideographs:h.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.crossTileSymbolIndex=new fo,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());const _=this;this._rtlTextPluginCallback=Os.registerForPluginStateChange((w=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},((S,L)=>{if(h.triggerPluginCompletionEvent(S),L&&L.every((N=>N)))for(const N in _._sourceCaches){const P=_._sourceCaches[N],Z=P.getSource().type;Z!=="vector"&&Z!=="geojson"||P.reload()}}))})),this.on("data",(w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const S=this.getSource(w.sourceId);if(S&&S.vectorLayerIds)for(const L in this._layers){const N=this._layers[L];N.source===S.id&&this._validateLayer(N)}}))}loadURL(o,f={}){this.fire(new h.Event("dataloading",{dataType:"style"}));const _=typeof f.validate=="boolean"?f.validate:!h.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,f.accessToken);const w=this.map._requestManager.transformRequest(o,h.ResourceType.Style);this._request=h.getJSON(w,((S,L)=>{this._request=null,S?this.fire(new h.ErrorEvent(S)):L&&this._load(L,_)}))}loadJSON(o,f={}){this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.exported.frame((()=>{this._request=null,this._load(o,f.validate!==!1)}))}loadEmpty(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(Cs,!1)}_updateLayerCount(o,f){const _=f?1:-1;o.is3D()&&(this._num3DLayers+=_),o.type==="circle"&&(this._numCircleLayers+=_),o.type==="symbol"&&(this._numSymbolLayers+=_)}_load(o,f){if(f&&io(this,h.validateStyle(o)))return;this._loaded=!0,this.stylesheet=h.clone$1(o),this._updateMapProjection();for(const w in o.sources)this.addSource(w,o.sources[w],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const _=ki(this.stylesheet.layers);this._order=_.map((w=>w.id)),this._layers={},this._serializedLayers={};for(let w of _)w=h.createStyleLayer(w),w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Xn(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=(function(f,_,w){let S,L,N;const P=h.exported.devicePixelRatio>1?"@2x":"";let Z=h.getJSON(_.transformRequest(_.normalizeSpriteURL(f,P,".json"),h.ResourceType.SpriteJSON),((dt,Et)=>{Z=null,N||(N=dt,S=Et,nt())})),Y=h.getImage(_.transformRequest(_.normalizeSpriteURL(f,P,".png"),h.ResourceType.SpriteImage),((dt,Et)=>{Y=null,N||(N=dt,L=Et,nt())}));function nt(){if(N)w(N);else if(S&&L){const dt=h.exported.getImageData(L),Et={};for(const xt in S){const{width:Mt,height:St,x:vt,y:Rt,sdf:Tt,pixelRatio:Ut,stretchX:Gt,stretchY:Nt,content:jt}=S[xt],fe=new h.RGBAImage({width:Mt,height:St});h.RGBAImage.copy(dt,fe,{x:vt,y:Rt},{x:0,y:0},{width:Mt,height:St}),Et[xt]={data:fe,pixelRatio:Ut,sdf:Tt,stretchX:Gt,stretchY:Nt,content:jt}}w(null,Et)}}return{cancel(){Z&&(Z.cancel(),Z=null),Y&&(Y.cancel(),Y=null)}}})(o,this.map._requestManager,((f,_)=>{if(this._spriteRequest=null,f)this.fire(new h.ErrorEvent(f));else if(_)for(const w in _)this.imageManager.addImage(w,_[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new h.Event("data",{dataType:"style"}))}))}_validateLayer(o){const f=this.getSource(o.source);if(!f)return;const _=o.sourceLayer;_&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(_)===-1)&&this.fire(new h.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${f.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const f=[];for(const _ of o){const w=this._layers[_];w.type!=="custom"&&f.push(w.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&ro[o.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const f=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(w.length||S.length)&&this._updateWorkerLayers(w,S);for(const L in this._updatedSources){const N=this._updatedSources[L];N==="reload"?this._reloadSource(L):N==="clear"&&this._clearSource(L)}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const _={};for(const w in this._sourceCaches){const S=this._sourceCaches[w];_[w]=S.used,S.used=!1}for(const w of this._order){const S=this._layers[w];if(S.recalculate(o,this._availableImages),!S.isHidden(o.zoom)){const N=this._getLayerSourceCache(S);N&&(N.used=!0)}const L=this.map.painter;if(L){const N=S.getProgramIds();if(!N)continue;const P=S.getProgramConfiguration(o.zoom);for(const Z of N)L.useProgram(Z,P)}}for(const w in _){const S=this._sourceCaches[w];_[w]!==S.used&&S.getSource().fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:S.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new h.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),io(this,h.validateStyle(o)))return!1;(o=h.clone$1(o)).layers=ki(o.layers);const f=(function(w,S){if(!w)return[{command:Dn.setStyle,args:[S]}];let L=[];try{if(!X(w.version,S.version))return[{command:Dn.setStyle,args:[S]}];X(w.center,S.center)||L.push({command:Dn.setCenter,args:[S.center]}),X(w.zoom,S.zoom)||L.push({command:Dn.setZoom,args:[S.zoom]}),X(w.bearing,S.bearing)||L.push({command:Dn.setBearing,args:[S.bearing]}),X(w.pitch,S.pitch)||L.push({command:Dn.setPitch,args:[S.pitch]}),X(w.sprite,S.sprite)||L.push({command:Dn.setSprite,args:[S.sprite]}),X(w.glyphs,S.glyphs)||L.push({command:Dn.setGlyphs,args:[S.glyphs]}),X(w.transition,S.transition)||L.push({command:Dn.setTransition,args:[S.transition]}),X(w.light,S.light)||L.push({command:Dn.setLight,args:[S.light]}),X(w.fog,S.fog)||L.push({command:Dn.setFog,args:[S.fog]}),X(w.projection,S.projection)||L.push({command:Dn.setProjection,args:[S.projection]});const N={},P=[];(function(nt,dt,Et,xt){let Mt;for(Mt in dt=dt||{},nt=nt||{})nt.hasOwnProperty(Mt)&&(dt.hasOwnProperty(Mt)||_i(Mt,Et,xt));for(Mt in dt)dt.hasOwnProperty(Mt)&&(nt.hasOwnProperty(Mt)?X(nt[Mt],dt[Mt])||(nt[Mt].type==="geojson"&&dt[Mt].type==="geojson"&&Ss(nt,dt,Mt)?Et.push({command:Dn.setGeoJSONSourceData,args:[Mt,dt[Mt].data]}):Ra(Mt,dt,Et,xt)):Vi(Mt,dt,Et))})(w.sources,S.sources,P,N);const Z=[];w.layers&&w.layers.forEach((nt=>{nt.source&&N[nt.source]?L.push({command:Dn.removeLayer,args:[nt.id]}):Z.push(nt)}));let Y=w.terrain;Y&&N[Y.source]&&(L.push({command:Dn.setTerrain,args:[void 0]}),Y=void 0),L=L.concat(P),X(Y,S.terrain)||L.push({command:Dn.setTerrain,args:[S.terrain]}),(function(nt,dt,Et){dt=dt||[];const xt=(nt=nt||[]).map(Hr),Mt=dt.map(Hr),St=nt.reduce(Rn,{}),vt=dt.reduce(Rn,{}),Rt=xt.slice(),Tt=Object.create(null);let Ut,Gt,Nt,jt,fe,Ee,xe;for(Ut=0,Gt=0;Ut<xt.length;Ut++)Nt=xt[Ut],vt.hasOwnProperty(Nt)?Gt++:(Et.push({command:Dn.removeLayer,args:[Nt]}),Rt.splice(Rt.indexOf(Nt,Gt),1));for(Ut=0,Gt=0;Ut<Mt.length;Ut++)Nt=Mt[Mt.length-1-Ut],Rt[Rt.length-1-Ut]!==Nt&&(St.hasOwnProperty(Nt)?(Et.push({command:Dn.removeLayer,args:[Nt]}),Rt.splice(Rt.lastIndexOf(Nt,Rt.length-Gt),1)):Gt++,Ee=Rt[Rt.length-Ut],Et.push({command:Dn.addLayer,args:[vt[Nt],Ee]}),Rt.splice(Rt.length-Ut,0,Nt),Tt[Nt]=!0);for(Ut=0;Ut<Mt.length;Ut++)if(Nt=Mt[Ut],jt=St[Nt],fe=vt[Nt],!Tt[Nt]&&!X(jt,fe))if(X(jt.source,fe.source)&&X(jt["source-layer"],fe["source-layer"])&&X(jt.type,fe.type)){for(xe in _e(jt.layout,fe.layout,Et,Nt,null,Dn.setLayoutProperty),_e(jt.paint,fe.paint,Et,Nt,null,Dn.setPaintProperty),X(jt.filter,fe.filter)||Et.push({command:Dn.setFilter,args:[Nt,fe.filter]}),X(jt.minzoom,fe.minzoom)&&X(jt.maxzoom,fe.maxzoom)||Et.push({command:Dn.setLayerZoomRange,args:[Nt,fe.minzoom,fe.maxzoom]}),jt)jt.hasOwnProperty(xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?_e(jt[xe],fe[xe],Et,Nt,xe.slice(6),Dn.setPaintProperty):X(jt[xe],fe[xe])||Et.push({command:Dn.setLayerProperty,args:[Nt,xe,fe[xe]]}));for(xe in fe)fe.hasOwnProperty(xe)&&!jt.hasOwnProperty(xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?_e(jt[xe],fe[xe],Et,Nt,xe.slice(6),Dn.setPaintProperty):X(jt[xe],fe[xe])||Et.push({command:Dn.setLayerProperty,args:[Nt,xe,fe[xe]]}))}else Et.push({command:Dn.removeLayer,args:[Nt]}),Ee=Rt[Rt.lastIndexOf(Nt)+1],Et.push({command:Dn.addLayer,args:[fe,Ee]})})(Z,S.layers,L)}catch(N){console.warn("Unable to compute style diff:",N),L=[{command:Dn.setStyle,args:[S]}]}return L})(this.serialize(),o).filter((w=>!(w.command in Io)));if(f.length===0)return!1;const _=f.filter((w=>!(w.command in jo)));if(_.length>0)throw new Error(`Unimplemented: ${_.map((w=>w.command)).join(", ")}.`);return f.forEach((w=>{w.command!=="setTransition"&&w.command!=="setProjection"&&this[w.command].apply(this,w.args)})),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,f){return this.getImage(o)?this.fire(new h.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,f),this._afterImageUpdated(o),this)}updateImage(o,f){this.imageManager.updateImage(o,f)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new h.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,f,_={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(h.validateSource,`sources.${o}`,f,null,_))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const w=se(o,f,this.dispatcher,this);w.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:w.serialize(),sourceId:o})));const S=L=>{const N=(L?"symbol:":"other:")+o,P=this._sourceCaches[N]=new h.SourceCache(N,w,L);(L?this._symbolSourceCaches:this._otherSourceCaches)[o]=P,P.style=this,P.onAdd(this.map)};S(!1),f.type!=="vector"&&f.type!=="geojson"||S(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const f=this.getSource(o);if(!f)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===o)return this.fire(new h.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new h.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(o);for(const w of _)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,f){this._checkLoaded(),this.getSource(o).setData(f),this._changed=!0}getSource(o){const f=this._getSourceCache(o);return f&&f.getSource()}_getSources(){const o=[];for(const f in this._otherSourceCaches){const _=this._getSourceCache(f);_&&o.push(_.getSource())}return o}addLayer(o,f,_={}){this._checkLoaded();const w=o.id;if(this.getLayer(w))return void this.fire(new h.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let S;if(o.type==="custom"){if(io(this,h.validateCustomStyleLayer(o)))return;S=h.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=h.clone$1(o),o=h.extend(o,{source:w})),this._validate(h.validateLayer,`layers.${w}`,o,{arrayIndex:-1},_))return;S=h.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0)}const L=f?this._order.indexOf(f):this._order.length;if(f&&L===-1)return void this.fire(new h.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(L,0,w),this._layerOrderChanged=!0,this._layers[w]=S;const N=this._getLayerSourceCache(S);if(this._removedLayers[w]&&S.source&&N&&S.type!=="custom"){const P=this._removedLayers[w];delete this._removedLayers[w],P.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",N.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,f){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===f)return;const _=this._order.indexOf(o);this._order.splice(_,1);const w=f?this._order.indexOf(f):this._order.length;f&&w===-1?this.fire(new h.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(w,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const f=this._layers[o];if(!f)return void this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const _=this._order.indexOf(o);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=f,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const f in this._layers)if(this._layers[f].type===o)return!0;return!1}setLayerZoomRange(o,f,_){this._checkLoaded();const w=this.getLayer(o);w?w.minzoom===f&&w.maxzoom===_||(f!=null&&(w.minzoom=f),_!=null&&(w.maxzoom=_),this._updateLayer(w)):this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,f,_={}){this._checkLoaded();const w=this.getLayer(o);if(w){if(!X(w.filter,f))return f==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(h.validateFilter,`layers.${w.id}.filter`,f,{layerType:w.type},_)||(w.filter=h.clone$1(f),this._updateLayer(w)))}else this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const f=this.getLayer(o);return f&&h.clone$1(f.filter)}setLayoutProperty(o,f,_,w={}){this._checkLoaded();const S=this.getLayer(o);S?X(S.getLayoutProperty(f),_)||(S.setLayoutProperty(f,_,w),this._updateLayer(S)):this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,f){const _=this.getLayer(o);if(_)return _.getLayoutProperty(f);this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,f,_,w={}){this._checkLoaded();const S=this.getLayer(o);S?X(S.getPaintProperty(f),_)||(S.setPaintProperty(f,_,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,f){const _=this.getLayer(o);return _&&_.getPaintProperty(f)}setFeatureState(o,f){this._checkLoaded();const _=o.source,w=o.sourceLayer,S=this.getSource(_);if(!S)return void this.fire(new h.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const L=S.type;if(L==="geojson"&&w)return void this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(L==="vector"&&!w)return void this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided.")));const N=this._getSourceCaches(_);for(const P of N)P.setFeatureState(w,o.id,f)}removeFeatureState(o,f){this._checkLoaded();const _=o.source,w=this.getSource(_);if(!w)return void this.fire(new h.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const S=w.type,L=S==="vector"?o.sourceLayer:void 0;if(S==="vector"&&!L)return void this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const N=this._getSourceCaches(_);for(const P of N)P.removeFeatureState(L,o.id,f)}getFeatureState(o){this._checkLoaded();const f=o.source,_=o.sourceLayer,w=this.getSource(f);if(w){if(w.type!=="vector"||_)return o.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(_,o.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const f in this._sourceCaches){const _=this._sourceCaches[f].getSource();o[_.id]||(o[_.id]=_.serialize())}return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},(f=>f!==void 0))}_updateLayer(o){this._updatedLayers[o.id]=!0;const f=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",f.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const f=L=>this._layers[L].type==="fill-extrusion",_={},w=[];for(let L=this._order.length-1;L>=0;L--){const N=this._order[L];if(f(N)){_[N]=L;for(const P of o){const Z=P[N];if(Z)for(const Y of Z)w.push(Y)}}}w.sort(((L,N)=>N.intersectionZ-L.intersectionZ));const S=[];for(let L=this._order.length-1;L>=0;L--){const N=this._order[L];if(f(N))for(let P=w.length-1;P>=0;P--){const Z=w[P].feature;if(_[Z.layer.id]<L)break;S.push(Z),w.pop()}else for(const P of o){const Z=P[N];if(Z)for(const Y of Z)S.push(Y.feature)}}return S}queryRenderedFeatures(o,f,_){f&&f.filter&&this._validate(h.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const w={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const P of f.layers){const Z=this._layers[P];if(!Z)return this.fire(new h.ErrorEvent(new Error(`The layer '${P}' does not exist in the map's style and cannot be queried for features.`))),[];w[Z.source]=!0}}const S=[];f.availableImages=this._availableImages;const L=f&&f.layers?f.layers.some((P=>{const Z=this.getLayer(P);return Z&&Z.is3D()})):this.has3DLayers(),N=On.createFromScreenPoints(o,_);for(const P in this._sourceCaches){const Z=this._sourceCaches[P].getSource().id;f.layers&&!w[Z]||S.push(me(this._sourceCaches[P],this._layers,this._serializedLayers,N,f,_,L,!!this.map._showQueryGeometry))}return this.placement&&S.push((function(P,Z,Y,nt,dt,Et,xt){const Mt={},St=Et.queryRenderedSymbols(nt),vt=[];for(const Rt of Object.keys(St).map(Number))vt.push(xt[Rt]);vt.sort(yn);for(const Rt of vt){const Tt=Rt.featureIndex.lookupSymbolFeatures(St[Rt.bucketInstanceId],Z,Rt.bucketIndex,Rt.sourceLayerIndex,dt.filter,dt.layers,dt.availableImages,P);for(const Ut in Tt){const Gt=Mt[Ut]=Mt[Ut]||[],Nt=Tt[Ut];Nt.sort(((jt,fe)=>{const Ee=Rt.featureSortOrder;if(Ee){const xe=Ee.indexOf(jt.featureIndex);return Ee.indexOf(fe.featureIndex)-xe}return fe.featureIndex-jt.featureIndex}));for(const jt of Nt)Gt.push(jt)}}for(const Rt in Mt)Mt[Rt].forEach((Tt=>{const Ut=Tt.feature,Gt=Y(P[Rt]).getFeatureState(Ut.layer["source-layer"],Ut.id);Ut.source=Ut.layer.source,Ut.layer["source-layer"]&&(Ut.sourceLayer=Ut.layer["source-layer"]),Ut.state=Gt}));return Mt})(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),N.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(o,f){f&&f.filter&&this._validate(h.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const _=this._getSourceCaches(o);let w=[];for(const S of _)w=w.concat(je(S,f));return w}addSourceType(o,f,_){return Os.getSourceType(o)?_(new Error(`A source type called "${o}" already exists.`)):(Os.setSourceType(o,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:f.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(o,f={}){this._checkLoaded();const _=this.light.getLight();let w=!1;for(const L in o)if(!X(o[L],_[L])){w=!0;break}if(!w)return;const S=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,f),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,f=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(f===1){if(typeof o.source=="object"){const _="terrain-dem-src";this.addSource(_,o.source),o=h.clone$1(o),o=h.extend(o,{source:_})}if(this._validate(h.validateTerrain,"terrain",o))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode)this._createTerrain(o,f);else{const _=this.terrain,w=_.get();for(const S of Object.keys(h.spec.terrain))!o.hasOwnProperty(S)&&h.spec.terrain[S].default&&(o[S]=h.spec.terrain[S].default);for(const S in o)if(!X(o[S],w[S])){_.set(o),this.stylesheet.terrain=o;const L=this._setTransitionParameters({duration:0});_.updateTransitions(L);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const f=this.fog=new ve(o,this.map.transform);this.stylesheet.fog=o;const _=this._setTransitionParameters({duration:0});f.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const o of this.map._markers)o._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,_=f.get();Object.keys(o).length===0&&f.set(o);for(const w in o)if(!X(o[w],_[w])){f.set(o),this.stylesheet.fog=o;const S=this._setTransitionParameters({duration:0});f.updateTransitions(S);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:h.exported.now(),transition:h.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter((_=>this.isLayerDraped(this._layers[_]))),f=this._order.filter((_=>!this.isLayerDraped(this._layers[_])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...f)}_createTerrain(o,f){const _=this.terrain=new ut(o,f);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});_.updateTransitions(w)}_force3DLayerUpdate(){for(const o in this._layers){const f=this._layers[o];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const f=this._layers[o];f.type==="symbol"&&this._updateLayer(f)}}_validate(o,f,_,w,S={}){return(!S||S.validate!==!1)&&io(this,o.call(h.validateStyle,h.extend({key:f,style:this.serialize(),value:_,styleSpec:h.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const f=this._getSourceCaches(o);for(const _ of f)_.clearTiles()}_reloadSource(o){const f=this._getSourceCaches(o);for(const _ of f)_.resume(),_.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const f in this._sourceCaches)this._sourceCaches[f].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const f=this._sourceCaches[o];f.resume(),f.reload()}}_updatePlacement(o,f,_,w,S=!1){let L=!1,N=!1;const P={};for(const Z of this._order){const Y=this._layers[Z];if(Y.type!=="symbol")continue;if(!P[Y.source]){const dt=this._getLayerSourceCache(Y);if(!dt)continue;P[Y.source]=dt.getRenderableIds(!0).map((Et=>dt.getTileByID(Et))).sort(((Et,xt)=>xt.tileID.overscaledZ-Et.tileID.overscaledZ||(Et.tileID.isLessThan(xt.tileID)?-1:1)))}const nt=this.crossTileSymbolIndex.addLayer(Y,P[Y.source],o.center.lng,o.projection);L=L||nt}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),S=S||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new h.Event("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.exported.now(),o.zoom))&&(this.pauseablePlacement=new Co(o,this._order,S,f,_,w,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.exported.now()),N=!0),L&&this.pauseablePlacement.placement.setStale()),N||L)for(const Z of this._order){const Y=this._layers[Z];Y.type==="symbol"&&this.placement.updateLayerOpacities(Y,P[Y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,f,_){this.imageManager.getImages(f.icons,_),this._updateTilesForChangedImages();const w=S=>{S&&S.setDependencies(f.tileID.key,f.type,f.icons)};w(this._otherSourceCaches[f.source]),w(this._symbolSourceCaches[f.source])}getGlyphs(o,f,_){this.glyphManager.getGlyphs(f.stacks,_)}getResource(o,f,_){return h.makeRequest(f,_)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const f=[];return this._otherSourceCaches[o]&&f.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&f.push(this._symbolSourceCaches[o]),f}_isSourceCacheLoaded(o){const f=this._getSourceCaches(o);return f.length===0?(this.fire(new h.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):f.every((_=>_.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Os.getSourceType=function(m){return ue[m]},Os.setSourceType=function(m,o){ue[m]=o},Os.registerForPluginStateChange=h.registerForPluginStateChange;var Pu=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Qa="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",xl=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Ke=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Hs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let wr={},tl={};const Xo=[];zs(Pu,Xo),zs(xl,Xo),zs(Ke,Xo),zs(Hs,Xo),wr=Oi("",xl),tl=Oi(Hs,Ke);const du=Oi(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Na=Pu,ia=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Xl={background:Oi(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Oi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Oi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Oi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Oi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Oi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Oi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Oi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Oi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Oi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Oi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Oi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Oi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Oi(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);float roof_radiance=clamp(u_lightpos.z,0.0,1.0);roof_radiance=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roof_radiance);v_roof_color.rgb+=clamp(color.rgb*roof_radiance*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Oi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Oi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Oi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Oi(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
highp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);
#else
vec4 out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Oi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Oi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Oi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Oi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Oi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Oi(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Oi(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Oi(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Qa),skyboxGradient:Oi(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Qa),skyboxCapture:Oi(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Oi(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;
#ifdef GLOBE_POLES
vec3 up_vector=normalize(globe_pos)*u_tile_up_scale;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Oi(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function zs(m,o){const f=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let _ of f)if(_=_.trim(),_[0]==="#"&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=_.split(" ");for(const S of w)o.includes(S)||o.push(S)}}function Oi(m,o){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w={},S=[...Xo];return zs(m,S),zs(o,S),{fragmentSource:m=m.replace(f,((L,N,P,Z,Y)=>(w[Y]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
varying ${P} ${Z} ${Y};
#else
uniform ${P} ${Z} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${P} ${Z} ${Y} = u_${Y};
#endif
`))),vertexSource:o=o.replace(f,((L,N,P,Z,Y)=>{const nt=Z==="float"?"vec2":"vec4",dt=Y.match(/color/)?"color":nt;return w[Y]?N==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${P} ${nt} a_${Y};
varying ${P} ${Z} ${Y};
#else
uniform ${P} ${Z} u_${Y};
#endif
`:dt==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${P} ${Z} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${dt}(a_${Y}, u_${Y}_t);
#else
    ${P} ${Z} ${Y} = u_${Y};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${P} ${nt} a_${Y};
#else
uniform ${P} ${Z} u_${Y};
#endif
`:dt==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${P} ${Z} ${Y} = a_${Y};
#else
    ${P} ${Z} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${P} ${Z} ${Y} = unpack_mix_${dt}(a_${Y}, u_${Y}_t);
#else
    ${P} ${Z} ${Y} = u_${Y};
#endif
`})),staticAttributes:_,usedDefines:S}}class Mo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,f,_,w,S,L,N){this.context=o;let P=this.boundPaintVertexBuffers.length!==w.length;for(let Y=0;!P&&Y<w.length;Y++)this.boundPaintVertexBuffers[Y]!==w[Y]&&(P=!0);let Z=this.boundDynamicVertexBuffers.length!==N.length;for(let Y=0;!Z&&Y<N.length;Y++)this.boundDynamicVertexBuffers[Y]!==N[Y]&&(Z=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==_||P||Z||this.boundIndexBuffer!==S||this.boundVertexOffset!==L)this.freshBind(f,_,w,S,L,N);else{o.bindVertexArrayOES.set(this.vao);for(const Y of N)Y&&Y.bind();S&&S.dynamicDraw&&S.bind()}}freshBind(o,f,_,w,S,L){let N;const P=o.numAttributes,Z=this.context,Y=Z.gl;if(Z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Z.extVertexArrayObject.createVertexArrayOES(),Z.bindVertexArrayOES.set(this.vao),N=0,this.boundProgram=o,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=w,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=L;else{N=Z.currentNumAttributes||0;for(let nt=P;nt<N;nt++)Y.disableVertexAttribArray(nt)}f.enableAttributes(Y,o),f.bind(),f.setVertexAttribPointers(Y,o,S);for(const nt of _)nt.enableAttributes(Y,o),nt.bind(),nt.setVertexAttribPointers(Y,o,S);for(const nt of L)nt&&(nt.enableAttributes(Y,o),nt.bind(),nt.setVertexAttribPointers(Y,o,S));w&&w.bind(),Z.currentNumAttributes=P}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ps(m,o){const f=Math.pow(2,o.canonical.z),_=o.canonical.y;return[new h.MercatorCoordinate(0,_/f).toLngLat().lat,new h.MercatorCoordinate(0,(_+1)/f).toLngLat().lat]}function Ao(m,o,f,_,w,S,L){const N=m.context,P=N.gl,Z=f.fbo;if(!Z)return;m.prepareDrawTile();const Y=m.useProgram("hillshade");N.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,Z.colorAttachment.get());const nt=((Mt,St,vt,Rt)=>{const Tt=vt.paint.get("hillshade-shadow-color"),Ut=vt.paint.get("hillshade-highlight-color"),Gt=vt.paint.get("hillshade-accent-color");let Nt=vt.paint.get("hillshade-illumination-direction")*(Math.PI/180);vt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Nt-=Mt.transform.angle);const jt=!Mt.options.moving;return{u_matrix:Rt||Mt.transform.calculateProjMatrix(St.tileID.toUnwrapped(),jt),u_image:0,u_latrange:Ps(0,St.tileID),u_light:[vt.paint.get("hillshade-exaggeration"),Nt],u_shadow:Tt,u_highlight:Ut,u_accent:Gt}})(m,f,_,m.terrain?o.projMatrix:null);m.prepareDrawProgram(N,Y,o.toUnwrapped());const{tileBoundsBuffer:dt,tileBoundsIndexBuffer:Et,tileBoundsSegments:xt}=m.getTileBoundsBuffers(f);Y.draw(N,P.TRIANGLES,w,S,L,h.CullFaceMode.disabled,nt,_.id,dt,Et,xt)}function va(m,o,f){if(!o.needsDEMTextureUpload)return;const _=m.context,w=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||m.getTileTexture(f.stride);const S=f.getPixels();o.demTexture?o.demTexture.update(S,{premultiply:!1}):o.demTexture=new h.Texture(_,S,w.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Zl(m,o,f,_,w,S){const L=m.context,N=L.gl;if(!o.dem)return;const P=o.dem;if(L.activeTexture.set(N.TEXTURE1),va(m,o,P),!o.demTexture)return;o.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);const Z=P.dim;L.activeTexture.set(N.TEXTURE0);let Y=o.fbo;if(!Y){const xt=new h.Texture(L,{width:Z,height:Z,data:null},N.RGBA);xt.bind(N.LINEAR,N.CLAMP_TO_EDGE),Y=o.fbo=L.createFramebuffer(Z,Z,!0),Y.colorAttachment.set(xt.texture)}L.bindFramebuffer.set(Y.framebuffer),L.viewport.set([0,0,Z,Z]);const{tileBoundsBuffer:nt,tileBoundsIndexBuffer:dt,tileBoundsSegments:Et}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(L,N.TRIANGLES,_,w,S,h.CullFaceMode.disabled,((xt,Mt)=>{const St=Mt.stride,vt=h.create();return h.ortho(vt,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(vt,vt,[0,-h.EXTENT,0]),{u_matrix:vt,u_image:1,u_dimension:[St,St],u_zoom:xt.overscaledZ,u_unpack:Mt.unpackVector}})(o.tileID,P),f.id,nt,dt,Et),o.needsHillshadePrepare=!1}const Zo=m=>({u_matrix:new h.UniformMatrix4f(m),u_image0:new h.Uniform1i(m),u_skirt_height:new h.Uniform1f(m)}),po=(m,o)=>({u_matrix:m,u_image0:0,u_skirt_height:o}),ra=(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:f,u_zoom_transition:w,u_merc_center:S,u_image0:0,u_frustum_tl:L,u_frustum_tr:N,u_frustum_br:P,u_frustum_bl:Z,u_globe_pos:Y,u_globe_radius:nt,u_viewport:dt,u_grid_matrix:Et?Float32Array.from(Et):new Float32Array(9)});function xa(m,o){return m!=null&&o!=null&&!(!m.hasData()||!o.hasData())&&m.demTexture!=null&&o.demTexture!=null&&m.tileID.key!==o.tileID.key}const Ho=new class{constructor(){this.operations={}}newMorphing(m,o,f,_,w){if(m in this.operations){const S=this.operations[m];S.to.tileID.key!==f.tileID.key&&(S.queued=f)}else this.operations[m]={startTime:_,phase:0,duration:w,from:o,to:f,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const o=this.operations[m];return{from:o.from,to:o.to,phase:o.phase}}update(m){for(const o in this.operations){const f=this.operations[o];for(f.phase=(m-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,m)){delete this.operations[o];break}}}_nextOp(m,o){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=o,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},bl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ii(m,o){const f=1<<m.z;return!o&&(m.x===0||m.x===f-1)||m.y===0||m.y===f-1}const wl=m=>({u_matrix:m});function Oa(m,o,f,_,w){if(w>0){const S=h.exported.now(),L=(S-m.timeAdded)/w,N=o?(S-o.timeAdded)/w:-1,P=f.getSource(),Z=_.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),Y=!o||Math.abs(o.tileID.overscaledZ-Z)>Math.abs(m.tileID.overscaledZ-Z),nt=Y&&m.refreshedUponExpiration?1:h.clamp(Y?L:1-N,0,1);return m.refreshedUponExpiration&&L>=1&&(m.refreshedUponExpiration=!1),o?{opacity:1,mix:1-nt}:{opacity:nt,mix:0}}return{opacity:1,mix:0}}class Hl extends h.SourceCache{constructor(o){const f={type:"raster-dem",maxzoom:o.transform.maxZoom},_=new Be(Qn(),null),w=se("mock-dem",f,_,o.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,f){o.state="loaded",f(null)}}class Lo extends h.SourceCache{constructor(o){const f=se("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new Be(Qn(),null),o.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,f,_){if(o.freezeTileCoverage)return;this.transform=o;const w=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((S,L)=>{if(S[L.key]="",!this._tiles[L.key]){const N=new h.Tile(L,this._source.tileSize*L.overscaleFactor(),o.tileZoom);N.state="loaded",this._tiles[L.key]=N}return S}),{});for(const S in this._tiles)S in w||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(o){const f=this.proxyCachedFBO[o];if(f!==void 0){const _=Object.values(f);this.renderCachePool.push(..._),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach((o=>o.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class za extends h.OverscaledTileID{constructor(o,f,_){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=f,this.projMatrix=_}}class Bu extends h.Elevation{constructor(o,f){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,w,S]=(function(P){const Z=new h.StructArrayLayout4i8,Y=new h.StructArrayLayout3ui6,nt=131;Z.reserve(17161),Y.reserve(33800);const dt=h.EXTENT/128,Et=h.EXTENT+dt/2,xt=Et+dt;for(let St=-dt;St<xt;St+=dt)for(let vt=-dt;vt<xt;vt+=dt){const Rt=vt<0||vt>Et||St<0||St>Et?24575:0,Tt=h.clamp(Math.round(vt),0,h.EXTENT),Ut=h.clamp(Math.round(St),0,h.EXTENT);Z.emplaceBack(Tt+Rt,Ut,Tt,Ut)}const Mt=(St,vt)=>{const Rt=vt*nt+St;Y.emplaceBack(Rt+1,Rt,Rt+nt),Y.emplaceBack(Rt+nt,Rt+nt+1,Rt+1)};for(let St=1;St<129;St++)for(let vt=1;vt<129;vt++)Mt(vt,St);return[0,129].forEach((St=>{for(let vt=0;vt<130;vt++)Mt(vt,St),Mt(St,vt)})),[Z,Y,32768]})(),L=o.context;this.gridBuffer=L.createVertexBuffer(_,h.boundsAttributes.members),this.gridIndexBuffer=L.createIndexBuffer(w),this.gridSegments=h.SegmentVector.simpleSegment(0,0,_.length,w.length),this.gridNoSkirtSegments=h.SegmentVector.simpleSegment(0,0,_.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Lo(f.map),this.orthoMatrix=h.create(),h.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,h.EXTENT,0,h.EXTENT,0,1);const N=L.gl;this._overlapStencilMode=new h.StencilMode({func:N.GEQUAL,mask:255},0,255,N.KEEP,N.KEEP,N.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Hl(f.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency()}update(o,f,_){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const w=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const S=()=>{this.sourceCache.used&&h.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const L=this.getScaledDemTileSize();this.sourceCache.update(f,L,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,S(),this._initializing=!0),S(),f.updateElevation(!_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&h.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((o=>o.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(h.MercatorCoordinate.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=f.getIds().map((P=>{const Z=f.getTileByID(P).tileID;return Z.projMatrix=_.calculateProjMatrix(Z.toUnwrapped()),Z}));(function(P,Z){const Y=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),nt=new h.pointGeometry(Y.x,Y.y);P.sort(((dt,Et)=>{if(Et.overscaledZ-dt.overscaledZ)return Et.overscaledZ-dt.overscaledZ;const xt=new h.pointGeometry(dt.canonical.x+(1<<dt.canonical.z)*dt.wrap,dt.canonical.y),Mt=new h.pointGeometry(Et.canonical.x+(1<<Et.canonical.z)*Et.wrap,Et.canonical.y),St=nt.mult(1<<dt.canonical.z);return St.x-=.5,St.y-=.5,St.distSqr(xt)-St.distSqr(Mt)}))})(w,this.painter),this._previousZoom=_.zoom;const S=this.proxyToSource||{};this.proxyToSource={},w.forEach((P=>{this.proxyToSource[P.key]={}})),this.terrainTileForTile={};const L=this._style._sourceCaches;for(const P in L){const Z=L[P];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,o[P],S),Z.usedForTerrain))continue;const Y=o[P];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[f.id]=w.map((P=>new za(P,P.key,this.orthoMatrix))),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1,this._updateTimestamp=h.exported.now();const N={};this._visibleDemTiles=[];for(const P of this.proxyCoords){const Z=this.terrainTileForTile[P.key];if(!Z)continue;const Y=Z.tileID.key;Y in N||(this._visibleDemTiles.push(Z),N[Y]=Y)}}_assignTerrainTiles(o){this._initializing||o.forEach((f=>{if(this.terrainTileForTile[f.key])return;const _=this._findTileCoveringTileID(f,this.sourceCache);_&&(this.terrainTileForTile[f.key]=_)}))}_prepareDEMTextures(){const o=this.painter.context,f=o.gl;for(const _ in this.terrainTileForTile){const w=this.terrainTileForTile[_],S=w.dem;!S||w.demTexture&&!w.needsDEMTextureUpload||(o.activeTexture.set(f.TEXTURE1),va(this.painter,w,S))}}_prepareDemTileUniforms(o,f,_,w){if(!f||f.demTexture==null)return!1;const S=o.tileID.canonical,L=Math.pow(2,f.tileID.canonical.z-S.z),N=w||"";return _[`u_dem_tl${N}`]=[S.x*L%1,S.y*L%1],_[`u_dem_scale${N}`]=L,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,f=o.gl;if(!this._emptyDepthBufferTexture){const _=new h.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new h.Texture(o,_,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const f=this._visibleDemTiles.reduce(((_,w)=>{if(!w.dem)return _;const S=w.dem.tree.minimums[0];return S>0&&o++,_+S}),0);return o?f/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,f=o.gl;o.activeTexture.set(f.TEXTURE2);const _=this._getLoadedAreaMinimum(),w=new h.RGBAImage({width:1,height:1},new Uint8Array(h.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(w,{premultiply:!1}):S=this._emptyDEMTexture=new h.Texture(o,w,f.RGBA,{premultiply:!1}),S}setupElevationDraw(o,f,_){const w=this.painter.context,S=w.gl,L=(N=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:h.DEMData.getUnpackVector(N),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var N;L.u_dem_size=this.sourceCache.getSource().tileSize,L.u_exaggeration=this.exaggeration();let P=null,Z=null,Y=1;if(_&&_.morphing&&this._useVertexMorphing){const nt=_.morphing.srcDemTile,dt=_.morphing.dstDemTile;Y=_.morphing.phase,nt&&dt&&(this._prepareDemTileUniforms(o,nt,L,"_prev")&&(Z=nt),this._prepareDemTileUniforms(o,dt,L)&&(P=dt))}if(Z&&P?(w.activeTexture.set(S.TEXTURE2),P.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),w.activeTexture.set(S.TEXTURE4),Z.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),L.u_dem_lerp=Y):(P=this.terrainTileForTile[o.tileID.key],w.activeTexture.set(S.TEXTURE2),(this._prepareDemTileUniforms(o,P,L)?P.demTexture:this.emptyDEMTexture).bind(S.NEAREST,S.CLAMP_TO_EDGE)),w.activeTexture.set(S.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),this._depthFBO&&(L.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),L.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&P){const nt=(1<<P.tileID.canonical.z)*h.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;L.u_meter_to_dem=nt}if(_&&_.labelPlaneMatrixInv&&(L.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),f.setTerrainUniformValues(w,L),this.painter.transform.projection.name==="globe"){const nt=this.globeUniformValues(this.painter.transform,o.tileID.canonical,_&&_.useDenormalizedUpVectorScale);f.setGlobeUniformValues(w,nt)}}globeUniformValues(o,f,_){const w=o.projection;return{u_tile_tl_up:w.upVector(f,0,0),u_tile_tr_up:w.upVector(f,h.EXTENT,0),u_tile_br_up:w.upVector(f,h.EXTENT,h.EXTENT),u_tile_bl_up:w.upVector(f,0,h.EXTENT),u_tile_up_scale:_?h.GLOBE_METERS_TO_ECEF:w.upVectorScale(f,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const f=this.painter,_=this.painter.context;o.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(w,S,L,N,P){if(w.transform.projection.name==="globe")(function(Z,Y,nt,dt,Et){const xt=Z.context,Mt=xt.gl;let St,vt;const Rt=Z.options.showTerrainWireframe?2:0,Tt=Z.transform,Ut=h.globeUseCustomAntiAliasing(Z,xt,Tt),Gt=(ge,Qt)=>{if(vt===ge)return;const fn=[bl[ge],"PROJECTION_GLOBE_VIEW"];Ut&&fn.push("CUSTOM_ANTIALIASING"),Qt&&fn.push(bl[Rt]),St=Z.useProgram("globeRaster",null,fn),vt=ge},Nt=Z.colorModeForRenderPass(),jt=new h.DepthMode(Mt.LEQUAL,h.DepthMode.ReadWrite,Z.depthRangeFor3D);Ho.update(Et);const fe=h.calculateGlobeMercatorMatrix(Tt),Ee=[h.mercatorXfromLng(Tt.center.lng),h.mercatorYfromLat(Tt.center.lat)],xe=Rt?[!1,!0]:[!1],We=Z.globeSharedBuffers,ce=[Tt.width*h.exported.devicePixelRatio,Tt.height*h.exported.devicePixelRatio],Ve=Float32Array.from(Tt.globeMatrix),Pe={useDenormalizedUpVectorScale:!0};if(xe.forEach((ge=>{vt=-1;const Qt=ge?Mt.LINES:Mt.TRIANGLES;for(const fn of dt){const an=nt.getTile(fn),Fe=h.StencilMode.disabled,Xe=Y.prevTerrainTileForTile[fn.key],pn=Y.terrainTileForTile[fn.key];xa(Xe,pn)&&Ho.newMorphing(fn.key,Xe,pn,Et,250),xt.activeTexture.set(Mt.TEXTURE0),an.texture.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE);const Vn=Ho.getMorphValuesForProxy(fn.key),Gn=Vn?1:0;Vn&&h.extend$1(Pe,{morphing:{srcDemTile:Vn.from,dstDemTile:Vn.to,phase:h.easeCubicInOut(Vn.phase)}});const Un=h.tileCornersToBounds(fn.canonical),tn=h.getLatitudinalLod(Un.getCenter().lat),ii=h.getGridMatrix(fn.canonical,Un,tn,Tt.worldSize/Tt._pixelsPerMercatorPixel),di=h.globeNormalizeECEF(h.globeTileBounds(fn.canonical)),Er=ra(Tt.projMatrix,Ve,fe,di,h.globeToMercatorTransition(Tt.zoom),Ee,Tt.frustumCorners.TL,Tt.frustumCorners.TR,Tt.frustumCorners.BR,Tt.frustumCorners.BL,Tt.globeCenterInViewSpace,Tt.globeRadius,ce,ii);if(Gt(Gn,ge),Y.setupElevationDraw(an,St,Pe),Z.prepareDrawProgram(xt,St,fn.toUnwrapped()),We){const[pi,ar,Xs]=ge?We.getWirefameBuffers(Z.context,tn):We.getGridBuffers(tn);St.draw(xt,Qt,jt,Fe,Nt,h.CullFaceMode.backCCW,Er,"globe_raster",pi,ar,Xs)}}})),We){const ge=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ut&&ge.push("CUSTOM_ANTIALIASING"),St=Z.useProgram("globeRaster",null,ge);for(const Qt of dt){const{x:fn,y:an,z:Fe}=Qt.canonical,Xe=an===0,pn=an===(1<<Fe)-1,[Vn,Gn,Un,tn]=We.getPoleBuffers(Fe);if(tn&&(Xe||pn)){const ii=nt.getTile(Qt);xt.activeTexture.set(Mt.TEXTURE0),ii.texture.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE);let di=h.globePoleMatrixForTile(Fe,fn,Tt);const Er=h.globeNormalizeECEF(h.globeTileBounds(Qt.canonical)),pi=(ar,Xs)=>ar.draw(xt,Mt.TRIANGLES,jt,h.StencilMode.disabled,Nt,h.CullFaceMode.disabled,ra(Tt.projMatrix,di,di,Er,0,Ee,Tt.frustumCorners.TL,Tt.frustumCorners.TR,Tt.frustumCorners.BR,Tt.frustumCorners.BL,Tt.globeCenterInViewSpace,Tt.globeRadius,ce),"globe_pole_raster",Xs,Un,tn);Y.setupElevationDraw(ii,St,Pe),Z.prepareDrawProgram(xt,St,Qt.toUnwrapped()),Xe&&pi(St,Vn),pn&&(di=h.scale(h.create(),di,[1,-1,1]),pi(St,Gn))}}}})(w,S,L,N,P);else{const Z=w.context,Y=Z.gl;let nt,dt;const Et=w.options.showTerrainWireframe?2:0,xt=(Tt,Ut)=>{if(dt===Tt)return;const Gt=[bl[Tt]];Ut&&Gt.push(bl[Et]),nt=w.useProgram("terrainRaster",null,Gt),dt=Tt},Mt=w.colorModeForRenderPass(),St=new h.DepthMode(Y.LEQUAL,h.DepthMode.ReadWrite,w.depthRangeFor3D);Ho.update(P);const vt=w.transform,Rt=6*Math.pow(1.5,22-vt.zoom)*S.exaggeration();(Et?[!1,!0]:[!1]).forEach((Tt=>{dt=-1;const Ut=Tt?Y.LINES:Y.TRIANGLES,[Gt,Nt]=Tt?S.getWirefameBuffer():[S.gridIndexBuffer,S.gridSegments];for(const jt of N){const fe=L.getTile(jt),Ee=h.StencilMode.disabled,xe=S.prevTerrainTileForTile[jt.key],We=S.terrainTileForTile[jt.key];xa(xe,We)&&Ho.newMorphing(jt.key,xe,We,P,250),Z.activeTexture.set(Y.TEXTURE0),fe.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST);const ce=Ho.getMorphValuesForProxy(jt.key),Ve=ce?1:0;let Pe;ce&&(Pe={morphing:{srcDemTile:ce.from,dstDemTile:ce.to,phase:h.easeCubicInOut(ce.phase)}});const ge=po(jt.projMatrix,Ii(jt.canonical,vt.renderWorldCopies)?Rt/10:Rt);xt(Ve,Tt),S.setupElevationDraw(fe,nt,Pe),w.prepareDrawProgram(Z,nt,jt.toUnwrapped()),nt.draw(Z,Ut,St,Ee,Mt,h.CullFaceMode.backCCW,ge,"terrain_raster",S.gridBuffer,Gt,Nt)}}))}})(f,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const f=this.painter,_=this.painter.context,w=this.proxySourceCache,S=this.proxiedCoords[w.id],L=this._drapedRenderBatches.shift(),N=[],P=f.style.order;let Z=0;for(const Y of S){const nt=w.getTileByID(Y.proxyTileKey),dt=w.proxyCachedFBO[Y.key]?w.proxyCachedFBO[Y.key][o]:void 0,Et=dt!==void 0?w.renderCache[dt]:this.pool[Z++],xt=dt!==void 0;if(nt.texture=Et.tex,xt&&!Et.dirty){N.push(nt.tileID);continue}let Mt;_.bindFramebuffer.set(Et.fb.framebuffer),this.renderedToTile=!1,Et.dirty&&(_.clear({color:h.Color.transparent,stencil:0}),Et.dirty=!1);for(let St=L.start;St<=L.end;++St){const vt=f.style._layers[P[St]];if(vt.isHidden(f.transform.zoom))continue;const Rt=f.style._getLayerSourceCache(vt),Tt=Rt?this.proxyToSource[Y.key][Rt.id]:[Y];if(!Tt)continue;const Ut=Tt;_.viewport.set([0,0,Et.fb.width,Et.fb.height]),Mt!==(Rt?Rt.id:null)&&(this._setupStencil(Et,Tt,vt,Rt),Mt=Rt?Rt.id:null),f.renderLayer(f,Rt,vt,Ut)}this.renderedToTile?(Et.dirty=!0,N.push(nt.tileID)):xt||--Z,Z===5&&(Z=0,this.renderToBackBuffer(N))}return this.renderToBackBuffer(N),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,f.width,f.height]),L.end+1}postRender(){}renderCacheEfficiency(o){const f=o.order.length;if(f===0)return{efficiency:100};let _,w=0,S=0,L=!1;for(let N=0;N<f;++N){const P=o._layers[o.order[N]];this._style.isLayerDraped(P)?(L&&++w,++S):L||(L=!0,_=P.id)}return S===0?{efficiency:100}:{efficiency:100*(1-w/S),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter((f=>f.dem)).forEach((f=>{o=Math.min(o,f.dem.tree.minimums[0])})),o===0?o:(o-30)*this._exaggeration}raycast(o,f,_){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter((S=>S.dem)).map((S=>{const L=S.tileID,N=1<<L.overscaledZ,{x:P,y:Z}=L.canonical,Y=P/N,nt=(P+1)/N,dt=Z/N,Et=(Z+1)/N;return{minx:Y,miny:dt,maxx:nt,maxy:Et,t:S.dem.tree.raycastRoot(Y,dt,nt,Et,o,f,_),tile:S}}));w.sort(((S,L)=>(S.t!==null?S.t:Number.MAX_VALUE)-(L.t!==null?L.t:Number.MAX_VALUE)));for(const S of w){if(S.t==null)return null;const L=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,o,f,_);if(L!=null)return L}return null}_createFBO(){const o=this.painter.context,f=o.gl,_=this.drapeBufferSize;o.activeTexture.set(f.TEXTURE0);const w=new h.Texture(o,{width:_[0],height:_[1],data:null},f.RGBA);w.bind(f.LINEAR,f.CLAMP_TO_EDGE);const S=o.createFramebuffer(_[0],_[1],!1);return S.colorAttachment.set(w.texture),S.depthAttachment=new Yi(o,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:S,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some((o=>{const f=this._style._layers[o],_=f.isHidden(this.painter.transform.zoom),w=f.getCrossfadeParameters(),S=!!w&&w.t!==1,L=f.hasTransition();return f.type!=="custom"&&!_&&(S||L)}))}_clearRasterFadeFromRenderCache(){let o=!1;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f]._source instanceof ot){o=!0;break}if(o)for(let f=0;f<this._style.order.length;++f){const _=this._style._layers[this._style.order[f]],w=_.isHidden(this.painter.transform.zoom),S=this._style._getLayerSourceCache(_);if(_.type!=="raster"||w||!S)continue;const L=_.paint.get("raster-fade-duration");for(const N of this.proxyCoords){const P=this.proxyToSource[N.key][S.id];if(P)for(const Z of P){const Y=Oa(S.getTile(Z),S.findLoadedParent(Z,0),S,this.painter.transform,L);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(S.id,Z)}}}}_setupDrapedRenderBatches(){const o=this._style.order,f=o.length;if(f===0)return;const _=[];let w,S=0,L=this._style._layers[o[S]];for(;!this._style.isLayerDraped(L)&&L.isHidden(this.painter.transform.zoom)&&++S<f;)L=this._style._layers[o[S]];for(;S<f;++S){const N=this._style._layers[o[S]];N.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(N)?w===void 0&&(w=S):w!==void 0&&(_.push({start:w,end:S-1}),w=void 0))}w!==void 0&&_.push({start:w,end:S-1}),this._drapedRenderBatches=_}_setupRenderCache(o){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const L=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let N=0;N<L.length;++N){const P=Object.values(L[N]);f.renderCachePool.push(...P)}}return}this._clearRasterFadeFromRenderCache();const _=this.proxyCoords,w=this._tilesDirty;for(let L=_.length-1;L>=0;L--){const N=_[L];if(f.getTileByID(N.key),f.proxyCachedFBO[N.key]!==void 0){const P=o[N.key],Z=this.proxyToSource[N.key];let Y=0;for(const nt in Z){const dt=Z[nt],Et=P[nt];if(!Et||Et.length!==dt.length||dt.some(((xt,Mt)=>xt!==Et[Mt]||w[nt]&&w[nt].hasOwnProperty(xt.key)))){Y=-1;break}++Y}for(const nt in f.proxyCachedFBO[N.key])f.renderCache[f.proxyCachedFBO[N.key][nt]].dirty=Y<0||Y!==Object.values(P).length}}const S=[...this._drapedRenderBatches];S.sort(((L,N)=>N.end-N.start-(L.end-L.start)));for(const L of S)for(const N of _){if(f.proxyCachedFBO[N.key])continue;let P=f.renderCachePool.pop();P===void 0&&f.renderCache.length<50&&(P=f.renderCache.length,f.renderCache.push(this._createFBO())),P!==void 0&&(f.proxyCachedFBO[N.key]={},f.proxyCachedFBO[N.key][L.start]=P,f.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(o,f,_,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,L=S.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let N;if(_.isTileClipped())N=f.length,this._overlapStencilMode.test={func:L.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);N=1,this._overlapStencilMode.test={func:L.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+N>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=N,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):h.StencilMode.disabled}_renderTileClippingMasks(o,f){const _=this.painter,w=this.painter.context,S=w.gl;_._tileClippingMaskIDs={},w.setColorMode(h.ColorMode.disabled),w.setDepthMode(h.DepthMode.disabled);const L=_.useProgram("clippingMask");for(const N of o){const P=_._tileClippingMaskIDs[N.key]=--f;L.draw(w,S.TRIANGLES,h.DepthMode.disabled,new h.StencilMode({func:S.ALWAYS,mask:0},P,255,S.KEEP,S.KEEP,S.REPLACE),h.ColorMode.disabled,h.CullFaceMode.disabled,wl(N.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(o){const f=this.painter.transform;if(o.x<0||o.x>f.width||o.y<0||o.y>f.height)return null;const _=[o.x,o.y,1,1];h.transformMat4$1(_,_,f.pixelMatrixInverse),h.scale$1(_,_,1/_[3]),_[0]/=f.worldSize,_[1]/=f.worldSize;const w=f._camera.position,S=h.mercatorZfromAltitude(1,f.center.lat),L=[w[0],w[1],w[2]/S,0],N=h.subtract([],_.slice(0,3),L);h.normalize(N,N);const P=this.raycast(L,N,this._exaggeration);return P!==null&&P?(h.scaleAndAdd(L,L,N,P),L[3]=L[2],L[2]*=S,L):null}drawDepth(){const o=this.painter,f=o.context,_=this.proxySourceCache,w=Math.ceil(o.width),S=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===S||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const L=f.gl,N=f.createFramebuffer(w,S,!0);f.activeTexture.set(L.TEXTURE0);const P=new h.Texture(f,{width:w,height:S,data:null},L.RGBA);P.bind(L.NEAREST,L.CLAMP_TO_EDGE),N.colorAttachment.set(P.texture);const Z=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,w,S);N.depthAttachment.set(Z),this._depthFBO=N,this._depthTexture=P}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,w,S]),(function(L,N,P,Z){if(L.transform.projection.name==="globe")return;const Y=L.context,nt=Y.gl;Y.clear({depth:1});const dt=L.useProgram("terrainDepth"),Et=new h.DepthMode(nt.LESS,h.DepthMode.ReadWrite,L.depthRangeFor3D);for(const xt of Z){const Mt=P.getTile(xt),St=po(xt.projMatrix,0);N.setupElevationDraw(Mt,dt),dt.draw(Y,nt.TRIANGLES,Et,h.StencilMode.disabled,h.ColorMode.unblended,h.CullFaceMode.backCCW,St,"terrain_depth",N.gridBuffer,N.gridIndexBuffer,N.gridNoSkirtSegments)}})(o,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,f,_){if(o.getSource()instanceof Kt)return this._setupProxiedCoordsForImageSource(o,f,_);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const w=this.proxiedCoords[o.id]=[],S=this.proxyCoords;for(let N=0;N<S.length;N++){const P=S[N],Z=this._findTileCoveringTileID(P,o);if(Z){const Y=this._createProxiedId(P,Z,_[P.key]&&_[P.key][o.id]);w.push(Y),this.proxyToSource[P.key][o.id]=[Y]}}let L=!1;for(let N=0;N<f.length;N++){const P=o.getTile(f[N]);if(!P||!P.hasData())continue;const Z=this._findTileCoveringTileID(P.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==P.tileID.canonical.z){const Y=this.proxyToSource[Z.tileID.key][o.id],nt=this._createProxiedId(Z.tileID,P,_[Z.tileID.key]&&_[Z.tileID.key][o.id]);Y?Y.splice(Y.length-1,0,nt):this.proxyToSource[Z.tileID.key][o.id]=[nt],w.push(nt),L=!0}}this._sourceTilesOverlap[o.id]=L}_setupProxiedCoordsForImageSource(o,f,_){if(!o.getSource().loaded())return;const w=this.proxiedCoords[o.id]=[],S=this.proxyCoords,L=o.getSource(),N=new h.pointGeometry(L.tileID.x,L.tileID.y)._div(1<<L.tileID.z),P=L.coordinates.map(h.MercatorCoordinate.fromLngLat).reduce(((Y,nt)=>(Y.min.x=Math.min(Y.min.x,nt.x-N.x),Y.min.y=Math.min(Y.min.y,nt.y-N.y),Y.max.x=Math.max(Y.max.x,nt.x-N.x),Y.max.y=Math.max(Y.max.y,nt.y-N.y),Y)),{min:new h.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new h.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(Y,nt)=>{const dt=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),Et=Y.canonical.y/(1<<Y.canonical.z),xt=h.EXTENT/(1<<Y.canonical.z),Mt=nt.wrap+nt.canonical.x/(1<<nt.canonical.z),St=nt.canonical.y/(1<<nt.canonical.z);return dt+xt<Mt+P.min.x||dt>Mt+P.max.x||Et+xt<St+P.min.y||Et>St+P.max.y};for(let Y=0;Y<S.length;Y++){const nt=S[Y];for(let dt=0;dt<f.length;dt++){const Et=o.getTile(f[dt]);if(!Et||!Et.hasData()||Z(nt,Et.tileID))continue;const xt=this._createProxiedId(nt,Et,_[nt.key]&&_[nt.key][o.id]),Mt=this.proxyToSource[nt.key][o.id];Mt?Mt.push(xt):this.proxyToSource[nt.key][o.id]=[xt],w.push(xt)}}}_createProxiedId(o,f,_){let w=this.orthoMatrix;if(_){const S=_.find((L=>L.key===f.tileID.key));if(S)return S}if(f.tileID.key!==o.key){const S=o.canonical.z-f.tileID.canonical.z;let L,N,P;w=h.create();const Z=f.tileID.wrap-o.wrap<<o.overscaledZ;S>0?(L=h.EXTENT>>S,N=L*((f.tileID.canonical.x<<S)-o.canonical.x+Z),P=L*((f.tileID.canonical.y<<S)-o.canonical.y)):(L=h.EXTENT<<-S,N=h.EXTENT*(f.tileID.canonical.x-(o.canonical.x+Z<<-S)),P=h.EXTENT*(f.tileID.canonical.y-(o.canonical.y<<-S))),h.ortho(w,0,L,0,L,0,1),h.translate(w,w,[N,P,0])}return new za(f.tileID,o.key,w)}_findTileCoveringTileID(o,f){let _=f.getTile(o);if(_&&_.hasData())return _;const w=this._findCoveringTileCache[f.id],S=w[o.key];if(_=S?f.getTileByID(S):null,_&&_.hasData()||S===null)return _;let L=_?_.tileID:o,N=L.overscaledZ;const P=f.getSource().minzoom,Z=[];if(!S){const nt=f.getSource().maxzoom;if(o.canonical.z>=nt){const dt=o.canonical.z-nt;f.getSource().reparseOverscaled?(N=Math.max(o.canonical.z+2,f.transform.tileZoom),L=new h.OverscaledTileID(N,o.wrap,nt,o.canonical.x>>dt,o.canonical.y>>dt)):dt!==0&&(N=nt,L=new h.OverscaledTileID(N,o.wrap,nt,o.canonical.x>>dt,o.canonical.y>>dt))}L.key!==o.key&&(Z.push(L.key),_=f.getTile(L))}const Y=nt=>{Z.forEach((dt=>{w[dt]=nt})),Z.length=0};for(N-=1;N>=P&&(!_||!_.hasData());N--){_&&Y(_.tileID.key);const nt=L.calculateScaledKey(N);if(_=f.getTileByID(nt),_&&_.hasData())break;const dt=w[nt];if(dt===null)break;dt===void 0?Z.push(nt):_=f.getTileByID(dt)}return Y(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,f){let _=this._tilesDirty[o];_||(_=this._tilesDirty[o]={}),_[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=(function(f){let _=0;const w=new h.StructArrayLayout2ui4,S=131;for(let L=1;L<129;L++){for(let N=1;N<129;N++)_=L*S+N,w.emplaceBack(_,_+1),w.emplaceBack(_,_+S),w.emplaceBack(_+1,_+S),L===128&&w.emplaceBack(_+S,_+S+1);w.emplaceBack(_+1,_+1+S)}return w})();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=h.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class sa{static cacheKey(o,f,_,w){let S=`${f}${w?w.cacheKey:""}`;for(const L of _)o.usedDefines.includes(L)&&(S+=`/${L}`);return S}constructor(o,f,_,w,S,L){const N=o.gl;this.program=N.createProgram();const P=(function(St){const vt=[];for(let Rt=0;Rt<St.length;Rt++){if(St[Rt]===null)continue;const Tt=St[Rt].split(" ");vt.push(Tt.pop())}return vt})(_.staticAttributes),Z=w?w.getBinderAttributes():[],Y=P.concat(Z);let nt=w?w.defines():[];nt=nt.concat(L.map((St=>`#define ${St}`)));const dt=nt.concat(o.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(ia):ia,ia,Na,du.fragmentSource,tl.fragmentSource,_.fragmentSource).join(`
`),Et=nt.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Na,du.vertexSource,tl.vertexSource,wr.vertexSource,_.vertexSource).join(`
`),xt=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);N.shaderSource(xt,dt),N.compileShader(xt),N.attachShader(this.program,xt);const Mt=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())this.failedToCreate=!0;else{N.shaderSource(Mt,Et),N.compileShader(Mt),N.attachShader(this.program,Mt),this.attributes={},this.numAttributes=Y.length;for(let St=0;St<this.numAttributes;St++)Y[St]&&(N.bindAttribLocation(this.program,St,Y[St]),this.attributes[Y[St]]=St);N.linkProgram(this.program),N.deleteShader(Mt),N.deleteShader(xt),this.fixedUniforms=S(o),this.binderUniforms=w?w.getUniforms(o):[],L.includes("TERRAIN")&&(this.terrainUniforms=(St=>({u_dem:new h.Uniform1i(St),u_dem_prev:new h.Uniform1i(St),u_dem_unpack:new h.Uniform4f(St),u_dem_tl:new h.Uniform2f(St),u_dem_scale:new h.Uniform1f(St),u_dem_tl_prev:new h.Uniform2f(St),u_dem_scale_prev:new h.Uniform1f(St),u_dem_size:new h.Uniform1f(St),u_dem_lerp:new h.Uniform1f(St),u_exaggeration:new h.Uniform1f(St),u_depth:new h.Uniform1i(St),u_depth_size_inv:new h.Uniform2f(St),u_meter_to_dem:new h.Uniform1f(St),u_label_plane_matrix_inv:new h.UniformMatrix4f(St)}))(o)),L.includes("GLOBE")&&(this.globeUniforms=(St=>({u_tile_tl_up:new h.Uniform3f(St),u_tile_tr_up:new h.Uniform3f(St),u_tile_br_up:new h.Uniform3f(St),u_tile_bl_up:new h.Uniform3f(St),u_tile_up_scale:new h.Uniform1f(St)}))(o)),L.includes("FOG")&&(this.fogUniforms=(St=>({u_fog_matrix:new h.UniformMatrix4f(St),u_fog_range:new h.Uniform2f(St),u_fog_color:new h.Uniform4f(St),u_fog_horizon_blend:new h.Uniform1f(St),u_fog_temporal_offset:new h.Uniform1f(St),u_frustum_tl:new h.Uniform3f(St),u_frustum_tr:new h.Uniform3f(St),u_frustum_br:new h.Uniform3f(St),u_frustum_bl:new h.Uniform3f(St),u_globe_pos:new h.Uniform3f(St),u_globe_radius:new h.Uniform1f(St),u_globe_transition:new h.Uniform1f(St),u_is_globe:new h.Uniform1i(St),u_viewport:new h.Uniform2f(St)}))(o))}}setTerrainUniformValues(o,f){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)_[w]&&_[w].set(this.program,w,f[w])}}setGlobeUniformValues(o,f){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)_[w]&&_[w].set(this.program,w,f[w])}}setFogUniformValues(o,f){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)_[w].set(this.program,w,f[w])}}draw(o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt){const St=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(_),o.setStencilMode(w),o.setColorMode(S),o.setCullFace(L);for(const Rt of Object.keys(this.fixedUniforms))this.fixedUniforms[Rt].set(this.program,Rt,N[Rt]);xt&&xt.setUniforms(this.program,o,this.binderUniforms,dt,{zoom:Et});const vt={[St.LINES]:2,[St.TRIANGLES]:3,[St.LINE_STRIP]:1}[f];for(const Rt of nt.get()){const Tt=Rt.vaos||(Rt.vaos={});(Tt[P]||(Tt[P]=new Mo)).bind(o,this,Z,xt?xt.getPaintVertexBuffers():[],Y,Rt.vertexOffset,Mt||[]),St.drawElements(f,Rt.primitiveLength*vt,St.UNSIGNED_SHORT,Rt.primitiveOffset*vt*2)}}}function Ju(m,o,f){const _=1/de(f,1,o.transform.tileZoom),w=Math.pow(2,f.tileID.overscaledZ),S=f.tileSize*Math.pow(2,o.transform.tileZoom)/w,L=S*(f.tileID.canonical.x+f.tileID.wrap*w),N=S*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[_,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[L>>16,N>>16],u_pixel_coord_lower:[65535&L,65535&N]}}const Nr=h.create(),El=(m,o,f,_,w,S,L,N,P,Z,Y)=>{const nt=o.style.light,dt=nt.properties.get("position"),Et=[dt.x,dt.y,dt.z],xt=h.create$1();nt.properties.get("anchor")==="viewport"&&(h.fromRotation(xt,-o.transform.angle),h.transformMat3(Et,Et,xt));const Mt=nt.properties.get("color"),St=o.transform,vt={u_matrix:m,u_lightpos:Et,u_lightintensity:nt.properties.get("intensity"),u_lightcolor:[Mt.r,Mt.g,Mt.b],u_vertical_gradient:+f,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Nr,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:S};return St.projection.name==="globe"&&(vt.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],vt.u_zoom_transition=P,vt.u_inv_rot_matrix=Y,vt.u_merc_center=Z,vt.u_up_dir=St.projection.upVector(new h.CanonicalTileID(0,0,0),Z[0]*h.EXTENT,Z[1]*h.EXTENT),vt.u_height_lift=N),vt},ba=(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt)=>{const Et=El(m,o,f,_,w,S,L,Z,Y,nt,dt),xt={u_height_factor:-Math.pow(2,L.overscaledZ)/P.tileSize/8};return h.extend(Et,Ju(N,o,P),xt)},el=m=>({u_matrix:m}),Yl=(m,o,f,_)=>h.extend(el(m),Ju(f,o,_)),Ku=(m,o)=>({u_matrix:m,u_world:o}),Qu=(m,o,f,_,w)=>h.extend(Yl(m,o,f,_),{u_world:w}),Pa=h.create(),Ro=(m,o,f,_,w,S)=>{const L=m.transform,N=L.projection.name==="globe";let P;if(S.paint.get("circle-pitch-alignment")==="map")if(N){const Y=h.globePixelsToTileUnits(L.zoom,o.canonical)*L._pixelsPerMercatorPixel;P=Float32Array.from([Y,0,0,Y])}else P=L.calculatePixelsToTileUnitsMatrix(f);else P=new Float32Array([L.pixelsToGLUnits[0],0,0,L.pixelsToGLUnits[1]]);const Z={u_camera_to_center_distance:L.cameraToCenterDistance,u_matrix:m.translatePosMatrix(o.projMatrix,f,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_device_pixel_ratio:h.exported.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:Pa,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){Z.u_inv_rot_matrix=_,Z.u_merc_center=w,Z.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],Z.u_zoom_transition=h.globeToMercatorTransition(L.zoom);const Y=w[0]*h.EXTENT,nt=w[1]*h.EXTENT;Z.u_up_dir=L.projection.upVector(new h.CanonicalTileID(0,0,0),Y,nt)}return Z},Ys=m=>{const o=[];return m.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},go=(m,o,f,_)=>{const w=h.EXTENT/f.tileSize;return{u_matrix:m,u_camera_to_center_distance:o.getCameraToCenterDistance(_),u_extrude_scale:[o.pixelsToGLUnits[0]/w,o.pixelsToGLUnits[1]/w]}},oe=(m,o,f=1)=>({u_matrix:m,u_color:o,u_overlay:0,u_overlay_scale:f}),De=h.create(),vn=(m,o,f,_,w,S,L)=>{const N=m.transform,P=N.projection.name==="globe",Z=P?h.globePixelsToTileUnits(N.zoom,o.canonical)*N._pixelsPerMercatorPixel:de(f,1,S),Y={u_matrix:o.projMatrix,u_extrude_scale:Z,u_intensity:L,u_inv_rot_matrix:De,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){Y.u_inv_rot_matrix=_,Y.u_merc_center=w,Y.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],Y.u_zoom_transition=h.globeToMercatorTransition(N.zoom);const nt=w[0]*h.EXTENT,dt=w[1]*h.EXTENT;Y.u_up_dir=N.projection.upVector(new h.CanonicalTileID(0,0,0),nt,dt)}return Y},Wn=(m,o,f,_,w,S,L,N)=>{const P=m.transform,Z=P.calculatePixelsToTileUnitsMatrix(o),Y={u_matrix:wi(m,o,f,w),u_pixels_to_tile_units:Z,u_device_pixel_ratio:L,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:N};if(sr(f)){const nt=hi(o,m.transform);Y.u_texsize=o.lineAtlasTexture.size,Y.u_scale=[nt,_.fromScale,_.toScale],Y.u_mix=_.t}return Y},mn=(m,o,f,_,w,S)=>{const L=m.transform,N=hi(o,L);return{u_matrix:wi(m,o,f,w),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:L.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:S,u_image:0,u_scale:[N,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function hi(m,o){return 1/de(m,1,o.tileZoom)}function wi(m,o,f,_){return m.translatePosMatrix(_||o.tileID.projMatrix,o,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function sr(m){const o=m.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const Ws=(m,o,f,_,w,S)=>{return{u_matrix:m,u_tl_parent:o,u_scale_parent:f,u_fade_t:_.mix,u_opacity:_.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(N=w.paint.get("raster-saturation"),N>0?1-1/(1.001-N):-N),u_contrast_factor:(L=w.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:ds(w.paint.get("raster-hue-rotate")),u_perspective_transform:S};var L,N};function ds(m){m*=Math.PI/180;const o=Math.sin(m),f=Math.cos(m);return[(2*f+1)/3,(-Math.sqrt(3)*o-f+1)/3,(Math.sqrt(3)*o-f+1)/3]}const Gr=h.create(),Jn=(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt)=>{const St=w.transform,vt={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:St.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:St.width/St.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:L,u_coord_matrix:N,u_is_text:+P,u_pitch_with_map:+_,u_texsize:Z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Gr,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Gr,u_up_vector:[0,-1,0]};return Mt.name==="globe"&&(vt.u_tile_id=[Y.canonical.x,Y.canonical.y,1<<Y.canonical.z],vt.u_zoom_transition=nt,vt.u_inv_rot_matrix=Et,vt.u_merc_center=dt,vt.u_camera_forward=St._camera.forward(),vt.u_ecef_origin=h.globeECEFOrigin(St.globeMatrix,Y.toUnwrapped()),vt.u_tile_matrix=Float32Array.from(St.globeMatrix),vt.u_up_vector=xt),vt},zi=(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt,St)=>h.extend(Jn(m,o,f,_,w,S,L,N,P,Z,nt,dt,Et,xt,Mt,St),{u_gamma_scale:_?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:h.exported.devicePixelRatio,u_is_halo:1}),tr=(m,o,f,_,w,S,L,N,P,Z,Y,nt,dt,Et,xt,Mt)=>h.extend(zi(m,o,f,_,w,S,L,N,!0,P,!0,Y,nt,dt,Et,xt,Mt),{u_texsize_icon:Z,u_texture_icon:1}),cr=(m,o,f)=>({u_matrix:m,u_opacity:o,u_color:f}),Yo=(m,o,f,_,w,S)=>h.extend((function(L,N,P,Z){const Y=P.imageManager.getPattern(L.from.toString()),nt=P.imageManager.getPattern(L.to.toString()),{width:dt,height:Et}=P.imageManager.getPixelSize(),xt=Math.pow(2,Z.tileID.overscaledZ),Mt=Z.tileSize*Math.pow(2,P.transform.tileZoom)/xt,St=Mt*(Z.tileID.canonical.x+Z.tileID.wrap*xt),vt=Mt*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Y.tl,u_pattern_br_a:Y.br,u_pattern_tl_b:nt.tl,u_pattern_br_b:nt.br,u_texsize:[dt,Et],u_mix:N.t,u_pattern_size_a:Y.displaySize,u_pattern_size_b:nt.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/de(Z,1,P.transform.tileZoom),u_pixel_coord_upper:[St>>16,vt>>16],u_pixel_coord_lower:[65535&St,65535&vt]}})(_,S,f,w),{u_matrix:m,u_opacity:o}),wa={fillExtrusion:m=>({u_matrix:new h.UniformMatrix4f(m),u_lightpos:new h.Uniform3f(m),u_lightintensity:new h.Uniform1f(m),u_lightcolor:new h.Uniform3f(m),u_vertical_gradient:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m),u_edge_radius:new h.Uniform1f(m),u_ao:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_up_dir:new h.Uniform3f(m),u_height_lift:new h.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_lightpos:new h.Uniform3f(m),u_lightintensity:new h.Uniform1f(m),u_lightcolor:new h.Uniform3f(m),u_vertical_gradient:new h.Uniform1f(m),u_height_factor:new h.Uniform1f(m),u_edge_radius:new h.Uniform1f(m),u_ao:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_up_dir:new h.Uniform3f(m),u_height_lift:new h.Uniform1f(m),u_image:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_scale:new h.Uniform3f(m),u_fade:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m)}),fill:m=>({u_matrix:new h.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_image:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_scale:new h.Uniform3f(m),u_fade:new h.Uniform1f(m)}),fillOutline:m=>({u_matrix:new h.UniformMatrix4f(m),u_world:new h.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_world:new h.Uniform2f(m),u_image:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_scale:new h.Uniform3f(m),u_fade:new h.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new h.Uniform1f(m),u_extrude_scale:new h.UniformMatrix2f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_up_dir:new h.Uniform3f(m)}),collisionBox:m=>({u_matrix:new h.UniformMatrix4f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_extrude_scale:new h.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new h.UniformMatrix4f(m),u_inv_matrix:new h.UniformMatrix4f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_viewport_size:new h.Uniform2f(m)}),debug:m=>({u_color:new h.UniformColor(m),u_matrix:new h.UniformMatrix4f(m),u_overlay:new h.Uniform1i(m),u_overlay_scale:new h.Uniform1f(m)}),clippingMask:m=>({u_matrix:new h.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new h.Uniform1f(m),u_intensity:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_up_dir:new h.Uniform3f(m)}),heatmapTexture:m=>({u_image:new h.Uniform1i(m),u_color_ramp:new h.Uniform1i(m),u_opacity:new h.Uniform1f(m)}),hillshade:m=>({u_matrix:new h.UniformMatrix4f(m),u_image:new h.Uniform1i(m),u_latrange:new h.Uniform2f(m),u_light:new h.Uniform2f(m),u_shadow:new h.UniformColor(m),u_highlight:new h.UniformColor(m),u_accent:new h.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new h.UniformMatrix4f(m),u_image:new h.Uniform1i(m),u_dimension:new h.Uniform2f(m),u_zoom:new h.Uniform1f(m),u_unpack:new h.Uniform4f(m)}),line:m=>({u_matrix:new h.UniformMatrix4f(m),u_pixels_to_tile_units:new h.UniformMatrix2f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_units_to_pixels:new h.Uniform2f(m),u_dash_image:new h.Uniform1i(m),u_gradient_image:new h.Uniform1i(m),u_image_height:new h.Uniform1f(m),u_texsize:new h.Uniform2f(m),u_scale:new h.Uniform3f(m),u_mix:new h.Uniform1f(m),u_alpha_discard_threshold:new h.Uniform1f(m),u_trim_offset:new h.Uniform2f(m)}),linePattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_texsize:new h.Uniform2f(m),u_pixels_to_tile_units:new h.UniformMatrix2f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_image:new h.Uniform1i(m),u_units_to_pixels:new h.Uniform2f(m),u_scale:new h.Uniform3f(m),u_fade:new h.Uniform1f(m),u_alpha_discard_threshold:new h.Uniform1f(m)}),raster:m=>({u_matrix:new h.UniformMatrix4f(m),u_tl_parent:new h.Uniform2f(m),u_scale_parent:new h.Uniform1f(m),u_fade_t:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m),u_image0:new h.Uniform1i(m),u_image1:new h.Uniform1i(m),u_brightness_low:new h.Uniform1f(m),u_brightness_high:new h.Uniform1f(m),u_saturation_factor:new h.Uniform1f(m),u_contrast_factor:new h.Uniform1f(m),u_spin_weights:new h.Uniform3f(m),u_perspective_transform:new h.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new h.Uniform1i(m),u_is_size_feature_constant:new h.Uniform1i(m),u_size_t:new h.Uniform1f(m),u_size:new h.Uniform1f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_rotate_symbol:new h.Uniform1i(m),u_aspect_ratio:new h.Uniform1f(m),u_fade_change:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_label_plane_matrix:new h.UniformMatrix4f(m),u_coord_matrix:new h.UniformMatrix4f(m),u_is_text:new h.Uniform1i(m),u_pitch_with_map:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_camera_forward:new h.Uniform3f(m),u_tile_matrix:new h.UniformMatrix4f(m),u_up_vector:new h.Uniform3f(m),u_ecef_origin:new h.Uniform3f(m),u_texture:new h.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new h.Uniform1i(m),u_is_size_feature_constant:new h.Uniform1i(m),u_size_t:new h.Uniform1f(m),u_size:new h.Uniform1f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_rotate_symbol:new h.Uniform1i(m),u_aspect_ratio:new h.Uniform1f(m),u_fade_change:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_label_plane_matrix:new h.UniformMatrix4f(m),u_coord_matrix:new h.UniformMatrix4f(m),u_is_text:new h.Uniform1i(m),u_pitch_with_map:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_texture:new h.Uniform1i(m),u_gamma_scale:new h.Uniform1f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_camera_forward:new h.Uniform3f(m),u_tile_matrix:new h.UniformMatrix4f(m),u_up_vector:new h.Uniform3f(m),u_ecef_origin:new h.Uniform3f(m),u_is_halo:new h.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new h.Uniform1i(m),u_is_size_feature_constant:new h.Uniform1i(m),u_size_t:new h.Uniform1f(m),u_size:new h.Uniform1f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_rotate_symbol:new h.Uniform1i(m),u_aspect_ratio:new h.Uniform1f(m),u_fade_change:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_label_plane_matrix:new h.UniformMatrix4f(m),u_coord_matrix:new h.UniformMatrix4f(m),u_is_text:new h.Uniform1i(m),u_pitch_with_map:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_texsize_icon:new h.Uniform2f(m),u_texture:new h.Uniform1i(m),u_texture_icon:new h.Uniform1i(m),u_gamma_scale:new h.Uniform1f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_is_halo:new h.Uniform1i(m)}),background:m=>({u_matrix:new h.UniformMatrix4f(m),u_opacity:new h.Uniform1f(m),u_color:new h.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_opacity:new h.Uniform1f(m),u_image:new h.Uniform1i(m),u_pattern_tl_a:new h.Uniform2f(m),u_pattern_br_a:new h.Uniform2f(m),u_pattern_tl_b:new h.Uniform2f(m),u_pattern_br_b:new h.Uniform2f(m),u_texsize:new h.Uniform2f(m),u_mix:new h.Uniform1f(m),u_pattern_size_a:new h.Uniform2f(m),u_pattern_size_b:new h.Uniform2f(m),u_scale_a:new h.Uniform1f(m),u_scale_b:new h.Uniform1f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_tile_units_to_pixels:new h.Uniform1f(m)}),terrainRaster:Zo,terrainDepth:Zo,skybox:m=>({u_matrix:new h.UniformMatrix4f(m),u_sun_direction:new h.Uniform3f(m),u_cubemap:new h.Uniform1i(m),u_opacity:new h.Uniform1f(m),u_temporal_offset:new h.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new h.UniformMatrix4f(m),u_color_ramp:new h.Uniform1i(m),u_center_direction:new h.Uniform3f(m),u_radius:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m),u_temporal_offset:new h.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new h.UniformMatrix3f(m),u_sun_direction:new h.Uniform3f(m),u_sun_intensity:new h.Uniform1f(m),u_color_tint_r:new h.Uniform4f(m),u_color_tint_m:new h.Uniform4f(m),u_luminance:new h.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new h.UniformMatrix4f(m),u_globe_matrix:new h.UniformMatrix4f(m),u_normalize_matrix:new h.UniformMatrix4f(m),u_merc_matrix:new h.UniformMatrix4f(m),u_zoom_transition:new h.Uniform1f(m),u_merc_center:new h.Uniform2f(m),u_image0:new h.Uniform1i(m),u_grid_matrix:new h.UniformMatrix3f(m),u_frustum_tl:new h.Uniform3f(m),u_frustum_tr:new h.Uniform3f(m),u_frustum_br:new h.Uniform3f(m),u_frustum_bl:new h.Uniform3f(m),u_globe_pos:new h.Uniform3f(m),u_globe_radius:new h.Uniform1f(m),u_viewport:new h.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new h.Uniform3f(m),u_frustum_tr:new h.Uniform3f(m),u_frustum_br:new h.Uniform3f(m),u_frustum_bl:new h.Uniform3f(m),u_horizon:new h.Uniform1f(m),u_transition:new h.Uniform1f(m),u_fadeout_range:new h.Uniform1f(m),u_color:new h.Uniform4f(m),u_high_color:new h.Uniform4f(m),u_space_color:new h.Uniform4f(m),u_star_intensity:new h.Uniform1f(m),u_star_density:new h.Uniform1f(m),u_star_size:new h.Uniform1f(m),u_temporal_offset:new h.Uniform1f(m),u_horizon_angle:new h.Uniform1f(m),u_rotation_matrix:new h.UniformMatrix4f(m)})};let Gs;function ps(m,o,f,_,w,S,L){const N=m.context,P=N.gl,Z=m.transform,Y=m.useProgram("collisionBox"),nt=[];let dt=0,Et=0;for(let Ut=0;Ut<_.length;Ut++){const Gt=_[Ut],Nt=o.getTile(Gt),jt=Nt.getBucket(f);if(!jt)continue;const fe=be(Gt,jt,Z);let Ee=fe;w[0]===0&&w[1]===0||(Ee=m.translatePosMatrix(fe,Nt,w,S));const xe=L?jt.textCollisionBox:jt.iconCollisionBox,We=jt.collisionCircleArray;if(We.length>0){const ce=h.create(),Ve=Ee;h.mul(ce,jt.placementInvProjMatrix,Z.glCoordMatrix),h.mul(ce,ce,jt.placementViewportMatrix),nt.push({circleArray:We,circleOffset:Et,transform:Ve,invTransform:ce,projection:jt.getProjection()}),dt+=We.length/4,Et=dt}xe&&(m.terrain&&m.terrain.setupElevationDraw(Nt,Y),Y.draw(N,P.LINES,h.DepthMode.disabled,h.StencilMode.disabled,m.colorModeForRenderPass(),h.CullFaceMode.disabled,go(Ee,Z,Nt,jt.getProjection()),f.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,null,Z.zoom,null,[xe.collisionVertexBuffer,xe.collisionVertexBufferExt]))}if(!L||!nt.length)return;const xt=m.useProgram("collisionCircle"),Mt=new h.StructArrayLayout2f1f2i16;Mt.resize(4*dt),Mt._trim();let St=0;for(const Ut of nt)for(let Gt=0;Gt<Ut.circleArray.length/4;Gt++){const Nt=4*Gt,jt=Ut.circleArray[Nt+0],fe=Ut.circleArray[Nt+1],Ee=Ut.circleArray[Nt+2],xe=Ut.circleArray[Nt+3];Mt.emplace(St++,jt,fe,Ee,xe,0),Mt.emplace(St++,jt,fe,Ee,xe,1),Mt.emplace(St++,jt,fe,Ee,xe,2),Mt.emplace(St++,jt,fe,Ee,xe,3)}(!Gs||Gs.length<2*dt)&&(Gs=(function(Ut){const Gt=2*Ut,Nt=new h.StructArrayLayout3ui6;Nt.resize(Gt),Nt._trim();for(let jt=0;jt<Gt;jt++){const fe=6*jt;Nt.uint16[fe+0]=4*jt+0,Nt.uint16[fe+1]=4*jt+1,Nt.uint16[fe+2]=4*jt+2,Nt.uint16[fe+3]=4*jt+2,Nt.uint16[fe+4]=4*jt+3,Nt.uint16[fe+5]=4*jt+0}return Nt})(dt));const vt=N.createIndexBuffer(Gs,!0),Rt=N.createVertexBuffer(Mt,h.collisionCircleLayout.members,!0);for(const Ut of nt){const Gt={u_matrix:Ut.transform,u_inv_matrix:Ut.invTransform,u_camera_to_center_distance:(Tt=Z).getCameraToCenterDistance(Ut.projection),u_viewport_size:[Tt.width,Tt.height]};xt.draw(N,P.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,m.colorModeForRenderPass(),h.CullFaceMode.disabled,Gt,f.id,Rt,vt,h.SegmentVector.simpleSegment(0,2*Ut.circleOffset,Ut.circleArray.length,Ut.circleArray.length/2),null,Z.zoom)}var Tt;Rt.destroy(),vt.destroy()}const Ba=h.create();function Sl(m,o,f,_,w,S){const{horizontalAlign:L,verticalAlign:N}=h.getAnchorAlignment(m),P=-(L-.5)*o,Z=-(N-.5)*f,Y=h.evaluateVariableOffset(m,_);return new h.pointGeometry((P/w+Y[0])*S,(Z/w+Y[1])*S)}function Tl(m,o,f,_,w,S,L,N,P,Z,Y){const nt=m.text.placedSymbolArray,dt=m.text.dynamicLayoutVertexArray,Et=m.icon.dynamicLayoutVertexArray,xt={},Mt=en(N,m.getProjection(),S),St=S.elevation,vt=m.getProjection().upVectorScale(N.canonical,S.center.lat,S.worldSize);dt.clear();for(let Rt=0;Rt<nt.length;Rt++){const Tt=nt.get(Rt),Ut=m.allowVerticalPlacement&&!Tt.placedOrientation,Gt=Tt.hidden||!Tt.crossTileID||Ut?null:_[Tt.crossTileID];if(Gt){const Nt=new h.pointGeometry(Tt.tileAnchorX,Tt.tileAnchorY),jt=m.getProjection().upVector(N.canonical,Nt.x,Nt.y),fe=St?St.getAtTileOffset(N,Nt.x,Nt.y):0,Ee=gn([Tt.projectedAnchorX+fe*jt[0]*vt.metersToTile,Tt.projectedAnchorY+fe*jt[1]*vt.metersToTile,Tt.projectedAnchorZ+fe*jt[2]*vt.metersToTile],f?Mt:L),xe=zn(S.getCameraToCenterDistance(m.getProjection()),Ee.signedDistanceFromCamera);let We=w.evaluateSizeForFeature(m.textSizeData,Z,Tt)*xe/h.ONE_EM;f&&(We*=m.tilePixelRatio/P);const{width:ce,height:Ve,anchor:Pe,textOffset:ge,textScale:Qt}=Gt,fn=Sl(Pe,ce,Ve,ge,Qt,We);let an;if(f){const Xe=Nt.add(fn),{x:pn,y:Vn,z:Gn}=m.getProjection().projectTilePoint(Xe.x,Xe.y,N.canonical);an=gn([pn+fe*jt[0]*vt.metersToTile,Vn+fe*jt[1]*vt.metersToTile,Gn+fe*jt[2]*vt.metersToTile],L).point}else{const Xe=o?fn.rotate(-S.angle):fn;an=[Ee.point[0]+Xe.x,Ee.point[1]+Xe.y,0]}const Fe=m.allowVerticalPlacement&&Tt.placedOrientation===h.WritingMode.vertical?Math.PI/2:0;for(let Xe=0;Xe<Tt.numGlyphs;Xe++)h.addDynamicAttributes(dt,an[0],an[1],an[2],Fe);Y&&Tt.associatedIconIndex>=0&&(xt[Tt.associatedIconIndex]={shiftedAnchor:an,angle:Fe})}else H(Tt.numGlyphs,dt)}if(Y){Et.clear();const Rt=m.icon.placedSymbolArray;for(let Tt=0;Tt<Rt.length;Tt++){const Ut=Rt.get(Tt);if(Ut.hidden)H(Ut.numGlyphs,Et);else{const Gt=xt[Tt];if(Gt)for(let Nt=0;Nt<Ut.numGlyphs;Nt++)h.addDynamicAttributes(Et,Gt.shiftedAnchor[0],Gt.shiftedAnchor[1],Gt.shiftedAnchor[2],Gt.angle);else H(Ut.numGlyphs,Et)}}m.icon.dynamicLayoutVertexBuffer.updateData(Et)}m.text.dynamicLayoutVertexBuffer.updateData(dt)}function or(m,o,f){return f.iconsInText&&o?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Ai(m,o,f,_,w,S,L,N,P,Z,Y,nt){const dt=m.context,Et=dt.gl,xt=m.transform,Mt=N==="map",St=P==="map",vt=Mt&&f.layout.get("symbol-placement")!=="point",Rt=Mt&&!St&&!vt,Tt=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ut=!1;const Gt=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),Nt=[h.mercatorXfromLng(xt.center.lng),h.mercatorYfromLat(xt.center.lat)],jt=f.layout.get("text-variable-anchor"),fe=xt.projection.name==="globe",Ee=[],xe=[0,-1,0];let We=xe;!fe&&!xt.mercatorFromTransition||Mt||(We=(function(ce){const Ve=ce._camera.getWorldToCamera(ce.worldSize,1),Pe=h.multiply([],Ve,ce.globeMatrix);h.invert(Pe,Pe);const ge=[0,0,0],Qt=[0,1,0,0];return h.transformMat4$1(Qt,Qt,Pe),ge[0]=Qt[0],ge[1]=Qt[1],ge[2]=Qt[2],h.normalize(ge,ge),ge})(xt));for(const ce of _){const Ve=o.getTile(ce),Pe=Ve.getBucket(f);if(!Pe||Pe.projection.name==="mercator"&&fe)continue;const ge=w?Pe.text:Pe.icon;if(!ge||Pe.fullyClipped||!ge.segments.get().length)continue;const Qt=ge.programConfigurations.get(f.id),fn=w||Pe.sdfIcons,an=w?Pe.textSizeData:Pe.iconSizeData,Fe=St||xt.pitch!==0,Xe=h.evaluateSizeForZoom(an,xt.zoom);let pn,Vn,Gn,Un,tn=[0,0],ii=null;if(w){if(Vn=Ve.glyphAtlasTexture,Gn=Et.LINEAR,pn=Ve.glyphAtlasTexture.size,Pe.iconsInText){tn=Ve.imageAtlasTexture.size,ii=Ve.imageAtlasTexture;const uo=an.kind==="composite"||an.kind==="camera";Un=Fe||m.options.rotating||m.options.zooming||uo?Et.LINEAR:Et.NEAREST}}else{const uo=f.layout.get("icon-size").constantOr(0)!==1||Pe.iconsNeedLinear;Vn=Ve.imageAtlasTexture,Gn=fn||m.options.rotating||m.options.zooming||uo||Fe?Et.LINEAR:Et.NEAREST,pn=Ve.imageAtlasTexture.size}const di=Pe.projection.name==="globe",Er=di?We:xe,pi=di?h.globeToMercatorTransition(xt.zoom):0,ar=en(ce,Pe.getProjection(),xt),Xs=xt.calculatePixelsToTileUnitsMatrix(Ve),Ko=ji(ar,Ve.tileID.canonical,St,Mt,xt,Pe.getProjection(),Xs),ks=m.terrain&&St&&vt?h.invert(h.create(),Ko):Ba,er=kr(ar,Ve.tileID.canonical,St,Mt,xt,Pe.getProjection(),Xs),Wr=jt&&Pe.hasTextData(),nr=f.layout.get("icon-text-fit")!=="none"&&Wr&&Pe.hasIconData();if(vt){const uo=xt.elevation,pl=uo?uo.getAtTileOffsetFunc(ce,xt.center.lat,xt.worldSize,Pe.getProjection()):gl=>[0,0,0],Su=ea(ar,Ve.tileID.canonical,St,Mt,xt,Pe.getProjection(),Xs);Ja(Pe,ar,m,w,Su,er,St,Z,pl,ce)}const Is=vt||w&&jt||nr,Ir=m.translatePosMatrix(ar,Ve,S,L),xi=Is?Ba:Ko,Po=m.translatePosMatrix(er,Ve,S,L,!0),Ol=Pe.getProjection().createInversionMatrix(xt,ce.canonical),Ia=[];m.terrainRenderModeElevated()&&St&&Ia.push("PITCH_WITH_MAP_TERRAIN"),di&&Ia.push("PROJECTION_GLOBE_VIEW"),Is&&Ia.push("PROJECTED_POS_ON_VIEWPORT");const Bo=fn&&f.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ma;Ma=fn?Pe.iconsInText?tr(an.kind,Xe,Rt,St,m,Ir,xi,Po,pn,tn,ce,pi,Nt,Ol,Er,Pe.getProjection()):zi(an.kind,Xe,Rt,St,m,Ir,xi,Po,w,pn,!0,ce,pi,Nt,Ol,Er,Pe.getProjection()):Jn(an.kind,Xe,Rt,St,m,Ir,xi,Po,w,pn,ce,pi,Nt,Ol,Er,Pe.getProjection());const zl={program:m.useProgram(or(fn,w,Pe),Qt,Ia),buffers:ge,uniformValues:Ma,atlasTexture:Vn,atlasTextureIcon:ii,atlasInterpolation:Gn,atlasInterpolationIcon:Un,isSDF:fn,hasHalo:Bo,tile:Ve,labelPlaneMatrixInv:ks};if(Tt&&Pe.canOverlap){Ut=!0;const uo=ge.segments.get();for(const pl of uo)Ee.push({segments:new h.SegmentVector([pl]),sortKey:pl.sortKey,state:zl})}else Ee.push({segments:ge.segments,sortKey:0,state:zl})}Ut&&Ee.sort(((ce,Ve)=>ce.sortKey-Ve.sortKey));for(const ce of Ee){const Ve=ce.state;if(m.terrain&&m.terrain.setupElevationDraw(Ve.tile,Ve.program,{useDepthForOcclusion:!fe,labelPlaneMatrixInv:Ve.labelPlaneMatrixInv}),dt.activeTexture.set(Et.TEXTURE0),Ve.atlasTexture.bind(Ve.atlasInterpolation,Et.CLAMP_TO_EDGE),Ve.atlasTextureIcon&&(dt.activeTexture.set(Et.TEXTURE1),Ve.atlasTextureIcon&&Ve.atlasTextureIcon.bind(Ve.atlasInterpolationIcon,Et.CLAMP_TO_EDGE)),Ve.isSDF){const Pe=Ve.uniformValues;Ve.hasHalo&&(Pe.u_is_halo=1,oa(Ve.buffers,ce.segments,f,m,Ve.program,Gt,Y,nt,Pe)),Pe.u_is_halo=0}oa(Ve.buffers,ce.segments,f,m,Ve.program,Gt,Y,nt,Ve.uniformValues)}}function oa(m,o,f,_,w,S,L,N,P){const Z=_.context,Y=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];w.draw(Z,Z.gl.TRIANGLES,S,L,N,h.CullFaceMode.disabled,P,f.id,m.layoutVertexBuffer,m.indexBuffer,o,f.paint,_.transform.zoom,m.programConfigurations.get(f.id),Y)}function nl(m,o,f,_,w,S,L){const N=m.context.gl,P=f.paint.get("fill-pattern"),Z=P&&P.constantOr(1),Y=f.getCrossfadeParameters();let nt,dt,Et,xt,Mt;L?(dt=Z&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",nt=N.LINES):(dt=Z?"fillPattern":"fill",nt=N.TRIANGLES);for(const St of _){const vt=o.getTile(St);if(Z&&!vt.patternsLoaded())continue;const Rt=vt.getBucket(f);if(!Rt)continue;m.prepareDrawTile();const Tt=Rt.programConfigurations.get(f.id),Ut=m.useProgram(dt,Tt);Z&&(m.context.activeTexture.set(N.TEXTURE0),vt.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Tt.updatePaintBuffers(Y));const Gt=P.constantOr(null);if(Gt&&vt.imageAtlas){const jt=vt.imageAtlas,fe=jt.patternPositions[Gt.to.toString()],Ee=jt.patternPositions[Gt.from.toString()];fe&&Ee&&Tt.setConstantPatternPositions(fe,Ee)}const Nt=m.translatePosMatrix(St.projMatrix,vt,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(L){xt=Rt.indexBuffer2,Mt=Rt.segments2;const jt=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[N.drawingBufferWidth,N.drawingBufferHeight];Et=dt==="fillOutlinePattern"&&Z?Qu(Nt,m,Y,vt,jt):Ku(Nt,jt)}else xt=Rt.indexBuffer,Mt=Rt.segments,Et=Z?Yl(Nt,m,Y,vt):el(Nt);m.prepareDrawProgram(m.context,Ut,St.toUnwrapped()),Ut.draw(m.context,nt,w,m.stencilModeForClipping(St),S,h.CullFaceMode.disabled,Et,f.id,Rt.layoutVertexBuffer,xt,Mt,f.paint,m.transform.zoom,Tt)}}function Do(m,o,f,_,w,S,L){const N=m.context,P=N.gl,Z=m.transform,Y=f.paint.get("fill-extrusion-pattern"),nt=Y.constantOr(1),dt=f.getCrossfadeParameters(),Et=f.paint.get("fill-extrusion-opacity"),xt=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),f.paint.get("fill-extrusion-ambient-occlusion-radius")],Mt=f.layout.get("fill-extrusion-edge-radius"),St=Z.projection.name==="globe"?h.fillExtrusionHeightLift():0,vt=Z.projection.name==="globe",Rt=vt?h.globeToMercatorTransition(Z.zoom):0,Tt=[h.mercatorXfromLng(Z.center.lng),h.mercatorYfromLat(Z.center.lat)],Ut=[];vt&&(Ut.push("PROJECTION_GLOBE_VIEW"),m.style.terrainSetForDrapingOnly()&&Ut.push("TERRAIN")),xt[0]>0&&Ut.push("FAUX_AO");for(const Gt of _){const Nt=o.getTile(Gt),jt=Nt.getBucket(f);if(!jt||jt.projection.name!==Z.projection.name)continue;const fe=jt.programConfigurations.get(f.id),Ee=m.useProgram(nt?"fillExtrusionPattern":"fillExtrusion",fe,Ut);if(m.terrain){const Qt=m.terrain;if(m.style.terrainSetForDrapingOnly())Qt.setupElevationDraw(Nt,Ee,{useMeterToDem:!0});else{if(!jt.enableTerrain)continue;if(Qt.setupElevationDraw(Nt,Ee,{useMeterToDem:!0}),Or(N,o,Gt,jt,f,Qt),!jt.centroidVertexBuffer){const fn=Ee.attributes.a_centroid_pos;fn!==void 0&&P.vertexAttrib2f(fn,0,0)}}}nt&&(m.context.activeTexture.set(P.TEXTURE0),Nt.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),fe.updatePaintBuffers(dt));const xe=Y.constantOr(null);if(xe&&Nt.imageAtlas){const Qt=Nt.imageAtlas,fn=Qt.patternPositions[xe.to.toString()],an=Qt.patternPositions[xe.from.toString()];fn&&an&&fe.setConstantPatternPositions(fn,an)}const We=m.translatePosMatrix(Gt.projMatrix,Nt,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),ce=Z.projection.createInversionMatrix(Z,Gt.canonical),Ve=f.paint.get("fill-extrusion-vertical-gradient"),Pe=nt?ba(We,m,Ve,Et,xt,Mt,Gt,dt,Nt,St,Rt,Tt,ce):El(We,m,Ve,Et,xt,Mt,Gt,St,Rt,Tt,ce);m.prepareDrawProgram(N,Ee,Gt.toUnwrapped());const ge=[];m.terrain&&ge.push(jt.centroidVertexBuffer),vt&&ge.push(jt.layoutVertexExtBuffer),Ee.draw(N,N.gl.TRIANGLES,w,S,L,h.CullFaceMode.backCCW,Pe,f.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,f.paint,m.transform.zoom,fe,ge)}}function Or(m,o,f,_,w,S){const L=[vt=>{let Rt=vt.canonical.x-1,Tt=vt.wrap;return Rt<0&&(Rt=(1<<vt.canonical.z)-1,Tt--),new h.OverscaledTileID(vt.overscaledZ,Tt,vt.canonical.z,Rt,vt.canonical.y)},vt=>{let Rt=vt.canonical.x+1,Tt=vt.wrap;return Rt===1<<vt.canonical.z&&(Rt=0,Tt++),new h.OverscaledTileID(vt.overscaledZ,Tt,vt.canonical.z,Rt,vt.canonical.y)},vt=>new h.OverscaledTileID(vt.overscaledZ,vt.wrap,vt.canonical.z,vt.canonical.x,(vt.canonical.y===0?1<<vt.canonical.z:vt.canonical.y)-1),vt=>new h.OverscaledTileID(vt.overscaledZ,vt.wrap,vt.canonical.z,vt.canonical.x,vt.canonical.y===(1<<vt.canonical.z)-1?0:vt.canonical.y+1)],N=vt=>{const Rt=o.getSource().minzoom,Tt=Gt=>{const Nt=o.getTileByID(Gt);if(Nt&&Nt.hasData())return Nt.getBucket(w)},Ut=[0,-1,1];for(const Gt of Ut){if(vt.overscaledZ+Gt<Rt)continue;const Nt=Tt(vt.calculateScaledKey(vt.overscaledZ+Gt));if(Nt)return Nt}},P=[0,0,0],Z=(vt,Rt)=>(P[0]=Math.min(vt.min.y,Rt.min.y),P[1]=Math.max(vt.max.y,Rt.max.y),P[2]=h.EXTENT-Rt.min.x>vt.max.x?Rt.min.x-h.EXTENT:vt.max.x,P),Y=(vt,Rt)=>(P[0]=Math.min(vt.min.x,Rt.min.x),P[1]=Math.max(vt.max.x,Rt.max.x),P[2]=h.EXTENT-Rt.min.y>vt.max.y?Rt.min.y-h.EXTENT:vt.max.y,P),nt=[(vt,Rt)=>Z(vt,Rt),(vt,Rt)=>Z(Rt,vt),(vt,Rt)=>Y(vt,Rt),(vt,Rt)=>Y(Rt,vt)],dt=new h.pointGeometry(0,0);let Et,xt,Mt;const St=(vt,Rt,Tt,Ut,Gt)=>{const Nt=[[Ut?Tt:vt,Ut?vt:Tt,0],[Ut?Tt:Rt,Ut?Rt:Tt,0]],jt=Gt<0?h.EXTENT+Gt:Gt,fe=[Ut?jt:(vt+Rt)/2,Ut?(vt+Rt)/2:jt,0];return Tt===0&&Gt<0||Tt!==0&&Gt>0?S.getForTilePoints(Mt,[fe],!0,xt):Nt.push(fe),S.getForTilePoints(f,Nt,!0,Et),Math.max(Nt[0][2],Nt[1][2],fe[2])/S.exaggeration()};for(let vt=0;vt<4;vt++){const Rt=(vt<2?1:5)-vt,Tt=_.borders[vt];if(Tt.length===0)continue;const Ut=Mt=L[vt](f),Gt=N(Ut);if(!(Gt&&Gt instanceof h.FillExtrusionBucket&&Gt.enableTerrain)||_.borderDoneWithNeighborZ[vt]===Gt.canonical.z&&Gt.borderDoneWithNeighborZ[Rt]===_.canonical.z||(xt=S.findDEMTileFor(Ut),!xt||!xt.dem))continue;if(!Et){const Ee=S.findDEMTileFor(f);if(!Ee||!Ee.dem)return;Et=Ee}const Nt=Gt.borders[Rt];let jt=0;const fe=Gt.borderDoneWithNeighborZ[Rt]!==_.canonical.z;if(_.canonical.z===Gt.canonical.z){for(let Ee=0;Ee<Tt.length;Ee++){const xe=_.featuresOnBorder[Tt[Ee]],We=xe.borders[vt];let ce;for(;jt<Nt.length&&(ce=Gt.featuresOnBorder[Nt[jt]],!(ce.borders[Rt][1]>We[0]+3));)fe&&Gt.encodeCentroid(void 0,ce,!1),jt++;if(ce&&jt<Nt.length){const Ve=jt;let Pe=0;for(;!(ce.borders[Rt][0]>We[1]-3)&&(Pe++,++jt!==Nt.length);)ce=Gt.featuresOnBorder[Nt[jt]];if(ce=Gt.featuresOnBorder[Nt[Ve]],xe.intersectsCount()>1||ce.intersectsCount()>1||Pe!==1){Pe!==1&&(jt=Ve),_.encodeCentroid(void 0,xe,!1),fe&&Gt.encodeCentroid(void 0,ce,!1);continue}const ge=nt[vt](xe,ce),Qt=vt%2?h.EXTENT-1:0;dt.x=St(ge[0],Math.min(h.EXTENT-1,ge[1]),Qt,vt<2,ge[2]),dt.y=0,_.encodeCentroid(dt,xe,!1),fe&&Gt.encodeCentroid(dt,ce,!1)}else _.encodeCentroid(void 0,xe,!1)}_.borderDoneWithNeighborZ[vt]=Gt.canonical.z,_.needsCentroidUpdate=!0,fe&&(Gt.borderDoneWithNeighborZ[Rt]=_.canonical.z,Gt.needsCentroidUpdate=!0)}else{for(const Ee of Tt)_.encodeCentroid(void 0,_.featuresOnBorder[Ee],!1);if(fe){for(const Ee of Nt)Gt.encodeCentroid(void 0,Gt.featuresOnBorder[Ee],!1);Gt.borderDoneWithNeighborZ[Rt]=_.canonical.z,Gt.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[vt]=Gt.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(m)}const Bs=new h.Color(1,0,0,1),mo=new h.Color(0,1,0,1),Vs=new h.Color(0,0,1,1),Wl=new h.Color(1,0,1,1),il=new h.Color(0,1,1,1);function yo(m,o,f){const _=m.context,w=m.transform,S=_.gl,L=w.projection.name==="globe",N=L?["PROJECTION_GLOBE_VIEW"]:null;let P=f.projMatrix;if(L&&h.globeToMercatorTransition(w.zoom)>0){const xe=h.transitionTileAABBinECEF(f.canonical,w),We=h.globeDenormalizeECEF(xe);P=h.multiply(new Float32Array(16),w.globeMatrix,We),h.multiply(P,w.projMatrix,P)}const Z=m.useProgram("debug",null,N),Y=o.getTileByID(f.key);m.terrain&&m.terrain.setupElevationDraw(Y,Z);const nt=h.DepthMode.disabled,dt=h.StencilMode.disabled,Et=m.colorModeForRenderPass(),xt="$debug";_.activeTexture.set(S.TEXTURE0),m.emptyTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),L?Y._makeGlobeTileDebugBuffers(m.context,w):Y._makeDebugTileBoundsBuffers(m.context,w.projection);const Mt=Y._tileDebugBuffer||m.debugBuffer,St=Y._tileDebugIndexBuffer||m.debugIndexBuffer,vt=Y._tileDebugSegments||m.debugSegments;Z.draw(_,S.LINE_STRIP,nt,dt,Et,h.CullFaceMode.disabled,oe(P,h.Color.red),xt,Mt,St,vt,null,null,null,[Y._globeTileDebugBorderBuffer]);const Rt=Y.latestRawTileData,Tt=Math.floor((Rt&&Rt.byteLength||0)/1024),Ut=o.getTile(f).tileSize,Gt=512/Math.min(Ut,512)*(f.overscaledZ/w.zoom)*.5;let Nt=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Nt+=` => ${f.overscaledZ}`),Nt+=` ${Tt}kb`,(function(xe,We){xe.initDebugOverlayCanvas();const ce=xe.debugOverlayCanvas,Ve=xe.context.gl,Pe=xe.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,ce.width,ce.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(We,5,5),Pe.strokeText(We,5,5),xe.debugOverlayTexture.update(ce),xe.debugOverlayTexture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)})(m,Nt);const jt=Y._tileDebugTextBuffer||m.debugBuffer,fe=Y._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Ee=Y._tileDebugTextSegments||m.debugSegments;Z.draw(_,S.TRIANGLES,nt,dt,h.ColorMode.alphaBlended,h.CullFaceMode.disabled,oe(P,h.Color.transparent,Gt),xt,jt,fe,Ee,null,null,null,[Y._globeTileDebugTextBuffer])}function $l(m,o,f,_){Ea(m,0,o+f/2,m.transform.width,f,_)}function rl(m,o,f,_){Ea(m,o-f/2,0,f,m.transform.height,_)}function Ea(m,o,f,_,w,S){const L=m.context,N=L.gl;N.enable(N.SCISSOR_TEST),N.scissor(o*h.exported.devicePixelRatio,f*h.exported.devicePixelRatio,_*h.exported.devicePixelRatio,w*h.exported.devicePixelRatio),L.clear({color:S}),N.disable(N.SCISSOR_TEST)}const Wo=h.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:sl}=Wo;function _o(m,o,f,_){m.emplaceBack(o,f,_)}class In{constructor(o){this.vertexArray=new h.StructArrayLayout3f12,this.indices=new h.StructArrayLayout3ui6,_o(this.vertexArray,-1,-1,1),_o(this.vertexArray,1,-1,1),_o(this.vertexArray,-1,1,1),_o(this.vertexArray,1,1,1),_o(this.vertexArray,-1,-1,-1),_o(this.vertexArray,1,-1,-1),_o(this.vertexArray,-1,1,-1),_o(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,sl),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=h.SegmentVector.simpleSegment(0,0,36,12)}}function so(m,o,f,_,w,S){const L=m.gl,N=o.paint.get("sky-atmosphere-color"),P=o.paint.get("sky-atmosphere-halo-color"),Z=o.paint.get("sky-atmosphere-sun-intensity"),Y=((nt,dt,Et,xt,Mt)=>({u_matrix_3f:nt,u_sun_direction:dt,u_sun_intensity:Et,u_color_tint_r:[xt.r,xt.g,xt.b,xt.a],u_color_tint_m:[Mt.r,Mt.g,Mt.b,Mt.a],u_luminance:5e-5}))(h.fromMat4(h.create$1(),_),w,Z,N,P);L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+S,o.skyboxTexture,0),f.draw(m,L.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,h.ColorMode.unblended,h.CullFaceMode.frontCW,Y,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const aa=h.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class pu{constructor(o){const f=new h.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const _=new h.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(f,aa.members),this.indexBuffer=o.createIndexBuffer(_),this.segments=h.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const es={symbol:function(m,o,f,_,w){if(m.renderPass!=="translucent")return;const S=h.StencilMode.disabled,L=m.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&(function(N,P,Z,Y,nt,dt,Et){const xt=P.transform,Mt=nt==="map",St=dt==="map";for(const vt of N){const Rt=Y.getTile(vt),Tt=Rt.getBucket(Z);if(!Tt||!Tt.text||!Tt.text.segments.get().length)continue;const Ut=h.evaluateSizeForZoom(Tt.textSizeData,xt.zoom),Gt=en(vt,Tt.getProjection(),xt),Nt=xt.calculatePixelsToTileUnitsMatrix(Rt),jt=ji(Gt,Rt.tileID.canonical,St,Mt,xt,Tt.getProjection(),Nt),fe=Z.layout.get("icon-text-fit")!=="none"&&Tt.hasIconData();if(Ut){const Ee=Math.pow(2,xt.zoom-Rt.tileID.overscaledZ);Tl(Tt,Mt,St,Et,h.symbolSize,xt,jt,vt,Ee,Ut,fe)}}})(_,m,f,o,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),w),f.paint.get("icon-opacity").constantOr(1)!==0&&Ai(m,o,f,_,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),S,L),f.paint.get("text-opacity").constantOr(1)!==0&&Ai(m,o,f,_,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),S,L),o.map.showCollisionBoxes&&(ps(m,o,f,_,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),ps(m,o,f,_,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(m,o,f,_){if(m.renderPass!=="translucent")return;const w=f.paint.get("circle-opacity"),S=f.paint.get("circle-stroke-width"),L=f.paint.get("circle-stroke-opacity"),N=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)===0&&(S.constantOr(1)===0||L.constantOr(1)===0))return;const P=m.context,Z=P.gl,Y=m.transform,nt=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),dt=h.StencilMode.disabled,Et=m.colorModeForRenderPass(),xt=Y.projection.name==="globe",Mt=[h.mercatorXfromLng(Y.center.lng),h.mercatorYfromLat(Y.center.lat)],St=[];for(let Rt=0;Rt<_.length;Rt++){const Tt=_[Rt],Ut=o.getTile(Tt),Gt=Ut.getBucket(f);if(!Gt||Gt.projection.name!==Y.projection.name)continue;const Nt=Gt.programConfigurations.get(f.id),jt=Ys(f);xt&&jt.push("PROJECTION_GLOBE_VIEW");const fe=m.useProgram("circle",Nt,jt),Ee=Gt.layoutVertexBuffer,xe=Gt.globeExtVertexBuffer,We=Gt.indexBuffer,ce=Y.projection.createInversionMatrix(Y,Tt.canonical),Ve={programConfiguration:Nt,program:fe,layoutVertexBuffer:Ee,globeExtVertexBuffer:xe,indexBuffer:We,uniformValues:Ro(m,Tt,Ut,ce,Mt,f),tile:Ut};if(N){const Pe=Gt.segments.get();for(const ge of Pe)St.push({segments:new h.SegmentVector([ge]),sortKey:ge.sortKey,state:Ve})}else St.push({segments:Gt.segments,sortKey:0,state:Ve})}N&&St.sort(((Rt,Tt)=>Rt.sortKey-Tt.sortKey));const vt={useDepthForOcclusion:!xt};for(const Rt of St){const{programConfiguration:Tt,program:Ut,layoutVertexBuffer:Gt,globeExtVertexBuffer:Nt,indexBuffer:jt,uniformValues:fe,tile:Ee}=Rt.state,xe=Rt.segments;m.terrain&&m.terrain.setupElevationDraw(Ee,Ut,vt),m.prepareDrawProgram(P,Ut,Ee.tileID.toUnwrapped()),Ut.draw(P,Z.TRIANGLES,nt,dt,Et,h.CullFaceMode.disabled,fe,f.id,Gt,jt,xe,f.paint,Y.zoom,Tt,[Nt])}},heatmap:function(m,o,f,_){if(f.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const w=m.context,S=w.gl,L=h.StencilMode.disabled,N=new h.ColorMode([S.ONE,S.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(Et,xt,Mt,St){const vt=Et.gl,Rt=xt.width*St,Tt=xt.height*St;Et.activeTexture.set(vt.TEXTURE1),Et.viewport.set([0,0,Rt,Tt]);let Ut=Mt.heatmapFbo;if(!Ut||Ut&&(Ut.width!==Rt||Ut.height!==Tt)){Ut&&Ut.destroy();const Gt=vt.createTexture();vt.bindTexture(vt.TEXTURE_2D,Gt),vt.texParameteri(vt.TEXTURE_2D,vt.TEXTURE_WRAP_S,vt.CLAMP_TO_EDGE),vt.texParameteri(vt.TEXTURE_2D,vt.TEXTURE_WRAP_T,vt.CLAMP_TO_EDGE),vt.texParameteri(vt.TEXTURE_2D,vt.TEXTURE_MIN_FILTER,vt.LINEAR),vt.texParameteri(vt.TEXTURE_2D,vt.TEXTURE_MAG_FILTER,vt.LINEAR),Ut=Mt.heatmapFbo=Et.createFramebuffer(Rt,Tt,!1),(function(Nt,jt,fe,Ee,xe,We){const ce=Nt.gl;ce.texImage2D(ce.TEXTURE_2D,0,ce.RGBA,xe,We,0,ce.RGBA,Nt.extRenderToTextureHalfFloat?Nt.extTextureHalfFloat.HALF_FLOAT_OES:ce.UNSIGNED_BYTE,null),Ee.colorAttachment.set(fe)})(Et,0,Gt,Ut,Rt,Tt)}else vt.bindTexture(vt.TEXTURE_2D,Ut.colorAttachment.get()),Et.bindFramebuffer.set(Ut.framebuffer)})(w,m,f,m.transform.projection.name==="globe"?.5:.25),w.clear({color:h.Color.transparent});const P=m.transform,Z=P.projection.name==="globe",Y=Z?["PROJECTION_GLOBE_VIEW"]:null,nt=Z?h.CullFaceMode.frontCCW:h.CullFaceMode.disabled,dt=[h.mercatorXfromLng(P.center.lng),h.mercatorYfromLat(P.center.lat)];for(let Et=0;Et<_.length;Et++){const xt=_[Et];if(o.hasRenderableParent(xt))continue;const Mt=o.getTile(xt),St=Mt.getBucket(f);if(!St||St.projection.name!==P.projection.name)continue;const vt=St.programConfigurations.get(f.id),Rt=m.useProgram("heatmap",vt,Y),{zoom:Tt}=m.transform;m.terrain&&m.terrain.setupElevationDraw(Mt,Rt),m.prepareDrawProgram(w,Rt,xt.toUnwrapped());const Ut=P.projection.createInversionMatrix(P,xt.canonical);Rt.draw(w,S.TRIANGLES,h.DepthMode.disabled,L,N,nt,vn(m,xt,Mt,Ut,dt,Tt,f.paint.get("heatmap-intensity")),f.id,St.layoutVertexBuffer,St.indexBuffer,St.segments,f.paint,m.transform.zoom,vt,Z?[St.globeExtVertexBuffer]:null)}w.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),(function(w,S){const L=w.context,N=L.gl,P=S.heatmapFbo;if(!P)return;L.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,P.colorAttachment.get()),L.activeTexture.set(N.TEXTURE1);let Z=S.colorRampTexture;Z||(Z=S.colorRampTexture=new h.Texture(L,S.colorRamp,N.RGBA)),Z.bind(N.LINEAR,N.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(L,N.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,w.colorModeForRenderPass(),h.CullFaceMode.disabled,((Y,nt,dt,Et)=>({u_image:0,u_color_ramp:1,u_opacity:nt.paint.get("heatmap-opacity")}))(0,S),S.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,S.paint,w.transform.zoom)})(m,f))},line:function(m,o,f,_){if(m.renderPass!=="translucent")return;const w=f.paint.get("line-opacity"),S=f.paint.get("line-width");if(w.constantOr(1)===0||S.constantOr(1)===0)return;const L=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),N=m.colorModeForRenderPass(),P=m.terrain&&m.terrain.renderingToTexture?1:h.exported.devicePixelRatio,Z=f.paint.get("line-dasharray"),Y=Z.constantOr(1),nt=f.layout.get("line-cap"),dt=f.paint.get("line-pattern"),Et=dt.constantOr(1),xt=f.paint.get("line-gradient"),Mt=f.getCrossfadeParameters(),St=Et?"linePattern":"line",vt=m.context,Rt=vt.gl,Tt=(Gt=>{const Nt=[];sr(Gt)&&Nt.push("RENDER_LINE_DASH"),Gt.paint.get("line-gradient")&&Nt.push("RENDER_LINE_GRADIENT");const jt=Gt.paint.get("line-trim-offset");jt[0]===0&&jt[1]===0||Nt.push("RENDER_LINE_TRIM_OFFSET");const fe=Gt.paint.get("line-pattern").constantOr(1),Ee=Gt.paint.get("line-opacity").constantOr(1)!==1;return!fe&&Ee&&Nt.push("RENDER_LINE_ALPHA_DISCARD"),Nt})(f);let Ut=Tt.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Ut=!1);for(const Gt of _){const Nt=o.getTile(Gt);if(Et&&!Nt.patternsLoaded())continue;const jt=Nt.getBucket(f);if(!jt)continue;m.prepareDrawTile();const fe=jt.programConfigurations.get(f.id),Ee=m.useProgram(St,fe,Tt),xe=dt.constantOr(null);if(xe&&Nt.imageAtlas){const an=Nt.imageAtlas,Fe=an.patternPositions[xe.to.toString()],Xe=an.patternPositions[xe.from.toString()];Fe&&Xe&&fe.setConstantPatternPositions(Fe,Xe)}const We=Z.constantOr(null),ce=nt.constantOr(null);if(!Et&&We&&ce&&Nt.lineAtlas){const an=Nt.lineAtlas,Fe=an.getDash(We.to,ce),Xe=an.getDash(We.from,ce);Fe&&Xe&&fe.setConstantPatternPositions(Fe,Xe)}let[Ve,Pe]=f.paint.get("line-trim-offset");(ce==="round"||ce==="square")&&Ve!==Pe&&(Ve===0&&(Ve-=1),Pe===1&&(Pe+=1));const ge=m.terrain?Gt.projMatrix:null,Qt=Et?mn(m,Nt,f,Mt,ge,P):Wn(m,Nt,f,Mt,ge,jt.lineClipsArray.length,P,[Ve,Pe]);if(xt){const an=jt.gradients[f.id];let Fe=an.texture;if(f.gradientVersion!==an.version){let Xe=256;if(f.stepInterpolant){const pn=o.getSource().maxzoom,Vn=Gt.canonical.z===pn?Math.ceil(1<<m.transform.maxZoom-Gt.canonical.z):1;Xe=h.clamp(h.nextPowerOfTwo(jt.maxLineLength/h.EXTENT*1024*Vn),256,vt.maxTextureSize)}an.gradient=h.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:Xe,image:an.gradient||void 0,clips:jt.lineClipsArray}),an.texture?an.texture.update(an.gradient):an.texture=new h.Texture(vt,an.gradient,Rt.RGBA),an.version=f.gradientVersion,Fe=an.texture}vt.activeTexture.set(Rt.TEXTURE1),Fe.bind(f.stepInterpolant?Rt.NEAREST:Rt.LINEAR,Rt.CLAMP_TO_EDGE)}Y&&(vt.activeTexture.set(Rt.TEXTURE0),Nt.lineAtlasTexture.bind(Rt.LINEAR,Rt.REPEAT),fe.updatePaintBuffers(Mt)),Et&&(vt.activeTexture.set(Rt.TEXTURE0),Nt.imageAtlasTexture.bind(Rt.LINEAR,Rt.CLAMP_TO_EDGE),fe.updatePaintBuffers(Mt)),m.prepareDrawProgram(vt,Ee,Gt.toUnwrapped());const fn=an=>{Ee.draw(vt,Rt.TRIANGLES,L,an,N,h.CullFaceMode.disabled,Qt,f.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,f.paint,m.transform.zoom,fe,[jt.layoutVertexBuffer2])};if(Ut){const an=m.stencilModeForClipping(Gt).ref;an===0&&m.terrain&&vt.clear({stencil:0});const Fe={func:Rt.EQUAL,mask:255};Qt.u_alpha_discard_threshold=.8,fn(new h.StencilMode(Fe,an,255,Rt.KEEP,Rt.KEEP,Rt.INVERT)),Qt.u_alpha_discard_threshold=0,fn(new h.StencilMode(Fe,an,255,Rt.KEEP,Rt.KEEP,Rt.KEEP))}else fn(m.stencilModeForClipping(Gt))}Ut&&(m.resetStencilClippingMasks(),m.terrain&&vt.clear({stencil:0}))},fill:function(m,o,f,_){const w=f.paint.get("fill-color"),S=f.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const L=m.colorModeForRenderPass(),N=f.paint.get("fill-pattern"),P=m.opaquePassEnabledForLayer()&&!N.constantOr(1)&&w.constantOr(h.Color.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===P){const Z=m.depthModeForSublayer(1,m.renderPass==="opaque"?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly);nl(m,o,f,_,Z,L,!1)}if(m.renderPass==="translucent"&&f.paint.get("fill-antialias")){const Z=m.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,h.DepthMode.ReadOnly);nl(m,o,f,_,Z,L,!0)}},"fill-extrusion":function(m,o,f,_){const w=f.paint.get("fill-extrusion-opacity");if(w!==0&&m.renderPass==="translucent"){const S=new h.DepthMode(m.context.gl.LEQUAL,h.DepthMode.ReadWrite,m.depthRangeFor3D);if(w!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))Do(m,o,f,_,S,h.StencilMode.disabled,h.ColorMode.disabled),Do(m,o,f,_,S,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const L=m.colorModeForRenderPass();Do(m,o,f,_,S,h.StencilMode.disabled,L)}}},hillshade:function(m,o,f,_){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const w=m.context,S=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),L=m.colorModeForRenderPass(),N=m.terrain&&m.terrain.renderingToTexture,[P,Z]=m.renderPass!=="translucent"||N?[{},_]:m.stencilConfigForOverlap(_);for(const Y of Z){const nt=o.getTile(Y);if(nt.needsHillshadePrepare&&m.renderPass==="offscreen")Zl(m,nt,f,S,h.StencilMode.disabled,L);else if(m.renderPass==="translucent"){const dt=N&&m.terrain?m.terrain.stencilModeForRTTOverlap(Y):P[Y.overscaledZ];Ao(m,Y,nt,f,S,dt,L)}}w.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,o,f,_,w,S){if(m.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!_.length)return;const L=m.context,N=L.gl,P=o.getSource(),Z=m.useProgram("raster"),Y=m.colorModeForRenderPass(),nt=m.terrain&&m.terrain.renderingToTexture,[dt,Et]=P instanceof Kt||nt?[{},_]:m.stencilConfigForOverlap(_),xt=Et[Et.length-1].overscaledZ,Mt=!m.options.moving;for(const St of Et){const vt=nt?h.DepthMode.disabled:m.depthModeForSublayer(St.overscaledZ-xt,f.paint.get("raster-opacity")===1?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly,N.LESS),Rt=St.toUnwrapped(),Tt=o.getTile(St);if(nt&&(!Tt||!Tt.hasData()))continue;const Ut=nt?St.projMatrix:m.transform.calculateProjMatrix(Rt,Mt),Gt=m.terrain&&nt?m.terrain.stencilModeForRTTOverlap(St):dt[St.overscaledZ],Nt=S?0:f.paint.get("raster-fade-duration");Tt.registerFadeDuration(Nt);const jt=o.findLoadedParent(St,0),fe=Oa(Tt,jt,o,m.transform,Nt);let Ee,xe;m.terrain&&m.terrain.prepareDrawTile();const We=f.paint.get("raster-resampling")==="nearest"?N.NEAREST:N.LINEAR;L.activeTexture.set(N.TEXTURE0),Tt.texture.bind(We,N.CLAMP_TO_EDGE),L.activeTexture.set(N.TEXTURE1),jt?(jt.texture.bind(We,N.CLAMP_TO_EDGE),Ee=Math.pow(2,jt.tileID.overscaledZ-Tt.tileID.overscaledZ),xe=[Tt.tileID.canonical.x*Ee%1,Tt.tileID.canonical.y*Ee%1]):Tt.texture.bind(We,N.CLAMP_TO_EDGE);const ce=Ws(Ut,xe||[0,0],Ee||1,fe,f,P instanceof Kt?P.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(L,Z,Rt),P instanceof Kt)P.boundsBuffer&&P.boundsSegments&&Z.draw(L,N.TRIANGLES,vt,h.StencilMode.disabled,Y,h.CullFaceMode.disabled,ce,f.id,P.boundsBuffer,m.quadTriangleIndexBuffer,P.boundsSegments);else{const{tileBoundsBuffer:Ve,tileBoundsIndexBuffer:Pe,tileBoundsSegments:ge}=m.getTileBoundsBuffers(Tt);Z.draw(L,N.TRIANGLES,vt,Gt,Y,h.CullFaceMode.disabled,ce,f.id,Ve,Pe,ge)}}m.resetStencilClippingMasks()},background:function(m,o,f,_){const w=f.paint.get("background-color"),S=f.paint.get("background-opacity");if(S===0)return;const L=m.context,N=L.gl,P=m.transform,Z=P.tileSize,Y=f.paint.get("background-pattern");if(m.isPatternMissing(Y))return;const nt=!Y&&w.a===1&&S===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==nt)return;const dt=h.StencilMode.disabled,Et=m.depthModeForSublayer(0,nt==="opaque"?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly),xt=m.colorModeForRenderPass(),Mt=m.useProgram(Y?"backgroundPattern":"background");let St,vt=_;vt||(St=m.getBackgroundTiles(),vt=Object.values(St).map((Tt=>Tt.tileID))),Y&&(L.activeTexture.set(N.TEXTURE0),m.imageManager.bind(m.context));const Rt=f.getCrossfadeParameters();for(const Tt of vt){const Ut=Tt.toUnwrapped(),Gt=_?Tt.projMatrix:m.transform.calculateProjMatrix(Ut);m.prepareDrawTile();const Nt=o?o.getTile(Tt):St?St[Tt.key]:new h.Tile(Tt,Z,P.zoom,m),jt=Y?Yo(Gt,S,m,Y,{tileID:Tt,tileSize:Z},Rt):cr(Gt,S,w);m.prepareDrawProgram(L,Mt,Ut);const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:Ee,tileBoundsSegments:xe}=m.getTileBoundsBuffers(Nt);Mt.draw(L,N.TRIANGLES,Et,dt,xt,h.CullFaceMode.disabled,jt,f.id,fe,Ee,xe)}},sky:function(m,o,f){const _=m.transform,w=_.projection.name==="mercator"||_.projection.name==="globe"?1:h.smoothstep(7,8,_.zoom),S=f.paint.get("sky-opacity")*w;if(S===0)return;const L=m.context,N=f.paint.get("sky-type"),P=new h.DepthMode(L.gl.LEQUAL,h.DepthMode.ReadOnly,[0,1]),Z=m.frameCounter/1e3%1;N==="atmosphere"?m.renderPass==="offscreen"?f.needsSkyboxCapture(m)&&((function(Y,nt,dt,Et){const xt=Y.context,Mt=xt.gl;let St=nt.skyboxFbo;if(!St){St=nt.skyboxFbo=xt.createFramebuffer(32,32,!1),nt.skyboxGeometry=new In(xt),nt.skyboxTexture=xt.gl.createTexture(),Mt.bindTexture(Mt.TEXTURE_CUBE_MAP,nt.skyboxTexture),Mt.texParameteri(Mt.TEXTURE_CUBE_MAP,Mt.TEXTURE_WRAP_S,Mt.CLAMP_TO_EDGE),Mt.texParameteri(Mt.TEXTURE_CUBE_MAP,Mt.TEXTURE_WRAP_T,Mt.CLAMP_TO_EDGE),Mt.texParameteri(Mt.TEXTURE_CUBE_MAP,Mt.TEXTURE_MIN_FILTER,Mt.LINEAR),Mt.texParameteri(Mt.TEXTURE_CUBE_MAP,Mt.TEXTURE_MAG_FILTER,Mt.LINEAR);for(let Ut=0;Ut<6;++Ut)Mt.texImage2D(Mt.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,0,Mt.RGBA,32,32,0,Mt.RGBA,Mt.UNSIGNED_BYTE,null)}xt.bindFramebuffer.set(St.framebuffer),xt.viewport.set([0,0,32,32]);const vt=nt.getCenter(Y,!0),Rt=Y.useProgram("skyboxCapture"),Tt=new Float64Array(16);h.identity(Tt),h.rotateY(Tt,Tt,.5*-Math.PI),so(xt,nt,Rt,Tt,vt,0),h.identity(Tt),h.rotateY(Tt,Tt,.5*Math.PI),so(xt,nt,Rt,Tt,vt,1),h.identity(Tt),h.rotateX(Tt,Tt,.5*-Math.PI),so(xt,nt,Rt,Tt,vt,2),h.identity(Tt),h.rotateX(Tt,Tt,.5*Math.PI),so(xt,nt,Rt,Tt,vt,3),h.identity(Tt),so(xt,nt,Rt,Tt,vt,4),h.identity(Tt),h.rotateY(Tt,Tt,Math.PI),so(xt,nt,Rt,Tt,vt,5),xt.viewport.set([0,0,Y.width,Y.height])})(m,f),f.markSkyboxValid(m)):m.renderPass==="sky"&&(function(Y,nt,dt,Et,xt){const Mt=Y.context,St=Mt.gl,vt=Y.transform,Rt=Y.useProgram("skybox");Mt.activeTexture.set(St.TEXTURE0),St.bindTexture(St.TEXTURE_CUBE_MAP,nt.skyboxTexture);const Tt=((Ut,Gt,Nt,jt,fe)=>({u_matrix:Ut,u_sun_direction:Gt,u_cubemap:0,u_opacity:jt,u_temporal_offset:fe}))(vt.skyboxMatrix,nt.getCenter(Y,!1),0,Et,xt);Y.prepareDrawProgram(Mt,Rt),Rt.draw(Mt,St.TRIANGLES,dt,h.StencilMode.disabled,Y.colorModeForRenderPass(),h.CullFaceMode.backCW,Tt,"skybox",nt.skyboxGeometry.vertexBuffer,nt.skyboxGeometry.indexBuffer,nt.skyboxGeometry.segment)})(m,f,P,S,Z):N==="gradient"&&m.renderPass==="sky"&&(function(Y,nt,dt,Et,xt){const Mt=Y.context,St=Mt.gl,vt=Y.transform,Rt=Y.useProgram("skyboxGradient");nt.skyboxGeometry||(nt.skyboxGeometry=new In(Mt)),Mt.activeTexture.set(St.TEXTURE0);let Tt=nt.colorRampTexture;Tt||(Tt=nt.colorRampTexture=new h.Texture(Mt,nt.colorRamp,St.RGBA)),Tt.bind(St.LINEAR,St.CLAMP_TO_EDGE);const Ut=((Gt,Nt,jt,fe,Ee)=>({u_matrix:Gt,u_color_ramp:0,u_center_direction:Nt,u_radius:h.degToRad(jt),u_opacity:fe,u_temporal_offset:Ee}))(vt.skyboxMatrix,nt.getCenter(Y,!1),nt.paint.get("sky-gradient-radius"),Et,xt);Y.prepareDrawProgram(Mt,Rt),Rt.draw(Mt,St.TRIANGLES,dt,h.StencilMode.disabled,Y.colorModeForRenderPass(),h.CullFaceMode.backCW,Ut,"skyboxGradient",nt.skyboxGeometry.vertexBuffer,nt.skyboxGeometry.indexBuffer,nt.skyboxGeometry.segment)})(m,f,P,S,Z)},debug:function(m,o,f){for(let _=0;_<f.length;_++)yo(m,o,f[_])},custom:function(m,o,f){const _=m.context,w=f.implementation;if(m.transform.projection.unsupportedLayers&&m.transform.projection.unsupportedLayers.includes("custom"))h.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(m.renderPass==="offscreen"){const S=w.prerender;S&&(m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),S.call(w,_.gl,m.transform.customLayerMatrix()),_.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),_.setStencilMode(h.StencilMode.disabled);const S=w.renderingMode==="3d"?new h.DepthMode(m.context.gl.LEQUAL,h.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,h.DepthMode.ReadOnly);_.setDepthMode(S),w.render(_.gl,m.transform.customLayerMatrix()),_.setDirty(),m.setBaseState(),_.bindFramebuffer.set(null)}}};class Fu{constructor(o,f){this.context=new et(o),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=h.SourceCache.maxUnderzooming+h.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fo,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,f){const _=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Bu(this,o));const w=this._terrain;this.transform.elevation=_?w:null,w.update(o,this.transform,f)}_updateFog(o){const f=o.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,w]=f.getFovAdjustedRange(this.transform._fov);if(_>w)return void(this.transform.fogCullDistSq=null);const S=_+.78*(w-_);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,f){if(this.width=o*h.exported.devicePixelRatio,this.height=f*h.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const o=this.context,f=new h.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(h.EXTENT,0),f.emplaceBack(0,h.EXTENT),f.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(f,h.posAttributes.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);const _=new h.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(h.EXTENT,0),_.emplaceBack(0,h.EXTENT),_.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=o.createVertexBuffer(_,h.posAttributes.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);const w=new h.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(w,h.posAttributes.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);const S=new h.StructArrayLayout4i8;S.emplaceBack(0,0,0,0),S.emplaceBack(h.EXTENT,0,h.EXTENT,0),S.emplaceBack(0,h.EXTENT,0,h.EXTENT),S.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(S,h.boundsAttributes.members),this.mercatorBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);const L=new h.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(L);const N=new h.StructArrayLayout1ui2;for(const Z of[0,1,3,2,0])N.emplaceBack(Z);this.debugIndexBuffer=o.createIndexBuffer(N),this.emptyTexture=new h.Texture(o,new h.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=h.create();const P=this.context.gl;this.stencilClearMode=new h.StencilMode({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(h.window.performance.now()),this.atmosphereBuffer=new pu(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,f=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,f.TRIANGLES,h.DepthMode.disabled,this.stencilClearMode,h.ColorMode.disabled,h.CullFaceMode.disabled,wl(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,f,_){if(!f||this.currentStencilSource===f.id||!o.isTileClipped()||!_||_.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let N=!1;for(const P of _)if(this._tileClippingMaskIDs[P.key]===void 0){N=!0;break}if(!N)return}this.currentStencilSource=f.id;const w=this.context,S=w.gl;this.nextStencilID+_.length>256&&this.clearStencil(),w.setColorMode(h.ColorMode.disabled),w.setDepthMode(h.DepthMode.disabled);const L=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const N of _){const P=f.getTile(N),Z=this._tileClippingMaskIDs[N.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:nt,tileBoundsSegments:dt}=this.getTileBoundsBuffers(P);L.draw(w,S.TRIANGLES,h.DepthMode.disabled,new h.StencilMode({func:S.ALWAYS,mask:0},Z,255,S.KEEP,S.KEEP,S.REPLACE),h.ColorMode.disabled,h.CullFaceMode.disabled,wl(N.projMatrix),"$clipping",Y,nt,dt)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,f=this.context.gl;return new h.StencilMode({func:f.NOTEQUAL,mask:255},o,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const f=this.context.gl;return new h.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(o){const f=this.context.gl,_=o.sort(((L,N)=>N.overscaledZ-L.overscaledZ)),w=_[_.length-1].overscaledZ,S=_[0].overscaledZ-w+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const L={};for(let N=0;N<S;N++)L[N+w]=new h.StencilMode({func:f.GEQUAL,mask:255},N+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=S,[L,_]}return[{[w]:h.StencilMode.disabled},_]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new h.ColorMode([o.CONSTANT_COLOR,o.ONE],new h.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?h.ColorMode.unblended:h.ColorMode.alphaBlended}depthModeForSublayer(o,f,_){if(!this.opaquePassEnabledForLayer())return h.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new h.DepthMode(_||this.context.gl.LEQUAL,f,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,f){this.style=o,this.options=f,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(h.exported.now()),this.imageManager.beginFrame();const _=this.style.order,w=this.style._sourceCaches;for(const P in w){const Z=w[P];Z.used&&Z.prepare(this.context)}const S={},L={},N={};for(const P in w){const Z=w[P];S[P]=Z.getVisibleCoordinates(),L[P]=S[P].slice().reverse(),N[P]=Z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let P=0;P<_.length;P++)if(this.style._layers[_[P]].is3D()){this.opaquePassCutoff=P;break}if(this.terrain&&(this.terrain.updateTileBinding(N),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new h.GlobeSharedBuffers(this.context)),h.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const P of _){const Z=this.style._layers[P],Y=o._getLayerSourceCache(Z);if(!Z.hasOffscreenPass()||Z.isHidden(this.transform.zoom))continue;const nt=Y?L[Y.id]:void 0;(Z.type==="custom"||Z.isSky()||nt&&nt.length)&&this.renderLayer(this,Y,Z,nt)}if(this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const P=this.style._layers[_[this.currentLayer]],Z=o._getLayerSourceCache(P);if(P.isSky())continue;const Y=Z?L[Z.id]:void 0;this._renderTileClippingMasks(P,Z,Y),this.renderLayer(this,Z,P,Y)}if(this.style.fog&&this.transform.projection.supportsFog&&(function(P,Z){const Y=P.context,nt=Y.gl,dt=P.transform,Et=new h.DepthMode(nt.LEQUAL,h.DepthMode.ReadOnly,[0,1]),xt=P.useProgram("globeAtmosphere",null,dt.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Mt=h.globeToMercatorTransition(dt.zoom),St=Z.properties.get("color").toArray01(),vt=Z.properties.get("high-color").toArray01(),Rt=Z.properties.get("space-color").toArray01PremultipliedAlpha(),Tt=h.identity$1([]);h.rotateY$1(Tt,Tt,-h.degToRad(dt._center.lng)),h.rotateX$1(Tt,Tt,h.degToRad(dt._center.lat)),h.rotateZ$1(Tt,Tt,dt.angle),h.rotateX$1(Tt,Tt,-dt._pitch);const Ut=h.fromQuat(new Float32Array(16),Tt),Gt=h.mapValue(Z.properties.get("star-intensity"),0,1,0,.25),Nt=5e-4,jt=h.mapValue(Z.properties.get("horizon-blend"),0,1,Nt,.25),fe=h.globeUseCustomAntiAliasing(P,Y,dt)&&jt===Nt?dt.worldSize/(2*Math.PI*1.025)-1:dt.globeRadius,Ee=P.frameCounter/1e3%1,xe=h.length(dt.globeCenterInViewSpace),We=Math.sqrt(Math.pow(xe,2)-Math.pow(fe,2)),ce=Math.acos(We/xe),Ve=((ge,Qt,fn,an,Fe,Xe,pn,Vn,Gn,Un,tn,ii,di,Er)=>({u_frustum_tl:ge,u_frustum_tr:Qt,u_frustum_br:fn,u_frustum_bl:an,u_horizon:Fe,u_transition:Xe,u_fadeout_range:pn,u_color:Vn,u_high_color:Gn,u_space_color:Un,u_star_intensity:tn,u_star_size:5*h.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:ii,u_horizon_angle:di,u_rotation_matrix:Er}))(dt.frustumCorners.TL,dt.frustumCorners.TR,dt.frustumCorners.BR,dt.frustumCorners.BL,dt.frustumCorners.horizon,Mt,jt,St,vt,Rt,Gt,Ee,ce,Ut);P.prepareDrawProgram(Y,xt);const Pe=P.atmosphereBuffer;Pe&&xt.draw(Y,nt.TRIANGLES,Et,h.StencilMode.disabled,h.ColorMode.alphaBlended,h.CullFaceMode.backCW,Ve,"skybox",Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)})(this,this.style.fog),this.renderPass="sky",(h.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const P=this.style._layers[_[this.currentLayer]],Z=o._getLayerSourceCache(P);P.isSky()&&this.renderLayer(this,Z,P,Z?L[Z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const P=this.style._layers[_[this.currentLayer]],Z=o._getLayerSourceCache(P);if(P.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(P)){if(P.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Y=Z?(P.type==="symbol"?N:L)[Z.id]:void 0;this._renderTileClippingMasks(P,Z,Z?S[Z.id]:void 0),this.renderLayer(this,Z,P,Y),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let P=null;h.values(this.style._layers).forEach((Z=>{const Y=o._getLayerSourceCache(Z);Y&&!Z.isHidden(this.transform.zoom)&&(!P||P.getSource().maxzoom<Y.getSource().maxzoom)&&(P=Y)})),P&&this.options.showTileBoundaries&&es.debug(this,P,P.getVisibleCoordinates())}this.options.showPadding&&(function(P){const Z=P.transform.padding;$l(P,P.transform.height-(Z.top||0),3,Bs),$l(P,Z.bottom||0,3,mo),rl(P,Z.left||0,3,Vs),rl(P,P.transform.width-(Z.right||0),3,Wl);const Y=P.transform.centerPoint;(function(nt,dt,Et,xt){Ea(nt,dt-1,Et-10,2,20,xt),Ea(nt,dt-10,Et-1,20,2,xt)})(P,Y.x,P.transform.height-Y.y,il)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(h.window.performance.now()),this.saveCanvasCopy())}}renderLayer(o,f,_,w){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||w&&w.length)&&(this.id=_.id,this.gpuTimingStart(_),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(_.type)||es[_.type](o,f,_,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let _=this.gpuTimers[o.id];_||(_=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),_.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,f=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),o.beginQueryEXT(o.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const f={};for(const _ in o){const w=o[_],S=this.context.extTimerQuery,L=S.getQueryObjectEXT(w.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(w.query),f[_]=L}return f}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let _=0;for(const w of o)_+=f.getQueryObjectEXT(w,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(w);return _}translatePosMatrix(o,f,_,w,S){if(!_[0]&&!_[1])return o;const L=S?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(L){const Z=Math.sin(L),Y=Math.cos(L);_=[_[0]*Y-_[1]*Z,_[0]*Z+_[1]*Y]}const N=[S?_[0]:de(f,_[0],this.transform.zoom),S?_[1]:de(f,_[1],this.transform.zoom),0],P=new Float32Array(16);return h.translate(P,o,N),P}saveTileTexture(o){const f=this._tileTextures[o.size[0]];f?f.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const f=this._tileTextures[o];return f&&f.length>0?f.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const f=this.imageManager.getPattern(o.from.toString()),_=this.imageManager.getPattern(o.to.toString());return!f||!_}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,f=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),this.transform.projection.name==="globe"&&_.push("GLOBE"),f&&!o&&f.getOpacity(this.transform.pitch)!==0&&_.push("FOG"),o&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(o,f,_){this.cache=this.cache||{};const w=_||[],S=this.currentGlobalDefines().concat(w),L=sa.cacheKey(Xl[o],o,S,f);return this.cache[L]||(this.cache[L]=new sa(this.context,o,Xl[o],f,wa[o],S)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,f,_){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const S=w.getOpacity(this.transform.pitch),L=((N,P,Z,Y,nt,dt,Et,xt,Mt,St,vt)=>{const Rt=N.transform,Tt=P.properties.get("color").toArray01();Tt[3]=Y;const Ut=N.frameCounter/1e3%1;return{u_fog_matrix:Z?Rt.calculateFogTileMatrix(Z):N.identityMat,u_fog_range:P.getFovAdjustedRange(Rt._fov),u_fog_color:Tt,u_fog_horizon_blend:P.properties.get("horizon-blend"),u_fog_temporal_offset:Ut,u_frustum_tl:nt,u_frustum_tr:dt,u_frustum_br:Et,u_frustum_bl:xt,u_globe_pos:Mt,u_globe_radius:St,u_viewport:vt,u_globe_transition:h.globeToMercatorTransition(Rt.zoom),u_is_globe:+(Rt.projection.name==="globe")}})(this,w,_,S,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*h.exported.devicePixelRatio,this.transform.height*h.exported.devicePixelRatio]);f.setFogUniformValues(o,L)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const o=this.context.gl,f=o.createTexture();return o.bindTexture(o.TEXTURE_2D,f),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,f=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const w of _)f[w.key]=o[w.key]||new h.Tile(w,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class $o{constructor(o=0,f=0,_=0,w=0){if(isNaN(o)||o<0||isNaN(f)||f<0||isNaN(_)||_<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=f,this.left=_,this.right=w}interpolate(o,f,_){return f.top!=null&&o.top!=null&&(this.top=h.number(o.top,f.top,_)),f.bottom!=null&&o.bottom!=null&&(this.bottom=h.number(o.bottom,f.bottom,_)),f.left!=null&&o.left!=null&&(this.left=h.number(o.left,f.left,_)),f.right!=null&&o.right!=null&&(this.right=h.number(o.right,f.right,_)),this}getCenter(o,f){const _=h.clamp((this.left+o-this.right)/2,0,o),w=h.clamp((this.top+f-this.bottom)/2,0,f);return new h.pointGeometry(_,w)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new $o(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gu(m,o){const f=h.getColumn(m,3);h.fromQuat(m,o),h.setColumn(m,3,f)}function al(m,o){const f=h.identity$1([]);return h.rotateZ$1(f,f,-o),h.rotateX$1(f,f,-m),f}function mu(m,o){const f=[m[0],m[1],0],_=[o[0],o[1],0];if(h.length(f)>=1e-15){const L=h.normalize([],f);h.scale$2(_,L,h.dot(_,L)),o[0]=_[0],o[1]=_[1]}const w=h.cross([],o,m);if(h.len(w)<1e-15)return null;const S=Math.atan2(-w[1],w[0]);return al(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),S)}class Jl{constructor(o,f){this.position=o,this.orientation=f}get position(){return this._position}set position(o){if(o){const f=o instanceof h.MercatorCoordinate?o:new h.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(f.x=h.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(o,f){if(this.orientation=null,!this.position)return;const _=this._elevation?this._elevation.getAtPointOrZero(h.MercatorCoordinate.fromLngLat(o)):0,w=this.position,S=h.MercatorCoordinate.fromLngLat(o,_),L=[S.x-w.x,S.y-w.y,S.z-w.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=mu(L,f)}setPitchBearing(o,f){this.orientation=al(h.degToRad(o),h.degToRad(-f))}}class Jo{constructor(o,f){this._transform=h.identity([]),this.orientation=f,this.position=o}get mercatorPosition(){const o=this.position;return new h.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=h.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var f;o&&h.setColumn(this._transform,3,[(f=o)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||h.identity$1([]),o&&gu(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,f){this._orientation=al(o,f),gu(this._transform,this._orientation)}forward(){const o=h.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=h.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=h.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,f){const _=new Float64Array(16);return h.invert(_,this.getWorldToCamera(o,f)),_}getWorldToCameraPosition(o,f,_){const w=this.position;h.scale$2(w,w,-o);const S=new Float64Array(16);return h.fromScaling(S,[_,_,_]),h.translate(S,S,w),S[10]*=f,S}getWorldToCamera(o,f){const _=new Float64Array(16),w=new Float64Array(4),S=this.position;return h.conjugate(w,this._orientation),h.scale$2(S,S,-o),h.fromQuat(_,w),h.translate(_,_,S),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=f,_[9]*=f,_[10]*=f,_[11]*=f,_}getCameraToClipPerspective(o,f,_,w){const S=new Float64Array(16);return h.perspective(S,o,f,_,w),S}getDistanceToElevation(o){const f=o===0?0:h.mercatorZfromAltitude(o,this.position[1]),_=this.forward();return(f-this.position[2])/_[2]}clone(){return new Jo([...this.position],[...this.orientation])}}function Cl(m,o){const f=ll(m.projection,m.zoom,m.width,m.height),_=(function(S,L,N,P,Z){const Y=new h.LngLat(N.lng-180*gs,N.lat),nt=new h.LngLat(N.lng+180*gs,N.lat),dt=S.project(Y.lng,Y.lat),Et=S.project(nt.lng,nt.lat),xt=-Math.atan2(Et.y-dt.y,Et.x-dt.x),Mt=h.MercatorCoordinate.fromLngLat(N);Mt.y=h.clamp(Mt.y,-.999975,.999975);const St=Mt.toLngLat(),vt=S.project(St.lng,St.lat),Rt=h.MercatorCoordinate.fromLngLat(St);Rt.x+=gs;const Tt=Rt.toLngLat(),Ut=S.project(Tt.lng,Tt.lat),Gt=bn(Ut.x-vt.x,Ut.y-vt.y,xt),Nt=h.MercatorCoordinate.fromLngLat(St);Nt.y+=gs;const jt=Nt.toLngLat(),fe=S.project(jt.lng,jt.lat),Ee=bn(fe.x-vt.x,fe.y-vt.y,xt),xe=Math.abs(Gt.x)/Math.abs(Ee.y),We=h.identity([]);h.rotateZ(We,We,-xt*(1-(Z?0:P)));const ce=h.identity([]);return h.scale(ce,ce,[1,1-(1-xe)*P,1]),ce[4]=-Ee.x/Ee.y*P,h.rotateZ(ce,ce,xt),h.multiply(ce,We,ce),ce})(m.projection,0,m.center,f,o),w=$s(m);return h.scale(_,_,[w,w,1]),_}function $s(m){const o=m.projection,f=ll(m.projection,m.zoom,m.width,m.height),_=yu(o,m.center),w=yu(o,h.LngLat.convert(o.center));return Math.pow(2,_*f+(1-f)*w)}function ll(m,o,f,_,w=1/0){const S=m.range;if(!S)return 0;const L=Math.min(w,Math.max(f,_)),N=Math.log(L/1024)/Math.LN2;return h.smoothstep(S[0]+N,S[1]+N,o)}const gs=1/4e4;function yu(m,o){const f=h.clamp(o.lat,-h.MAX_MERCATOR_LATITUDE,h.MAX_MERCATOR_LATITUDE),_=new h.LngLat(o.lng-180*gs,f),w=new h.LngLat(o.lng+180*gs,f),S=m.project(_.lng,f),L=m.project(w.lng,f),N=h.MercatorCoordinate.fromLngLat(_),P=h.MercatorCoordinate.fromLngLat(w),Z=L.x-S.x,Y=L.y-S.y,nt=P.x-N.x,dt=P.y-N.y,Et=Math.sqrt((nt*nt+dt*dt)/(Z*Z+Y*Y));return Math.log(Et)/Math.LN2}function bn(m,o,f){const _=Math.cos(f),w=Math.sin(f);return{x:m*_-o*w,y:m*w+o*_}}class qs{constructor(o,f,_,w,S,L,N){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=o||0,this._maxZoom=f||22,this._minPitch=_??0,this._maxPitch=w??60,this.setProjection(L),this.setMaxBounds(N),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new $o,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Jo,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new qs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o){const f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(o||f)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return h.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=h.getProjection(this.projectionOptions);const _=!X(f,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=h.getProjection({name:"mercator"});const f=o!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return h.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.pointGeometry(this.width,this.height)}get bearing(){return h.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const f=-o*Math.PI/180;var _;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(_=new h.ARRAY_TYPE(4),h.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),(function(w,S,L){var N=S[0],P=S[1],Z=S[2],Y=S[3],nt=Math.sin(L),dt=Math.cos(L);w[0]=N*dt+Z*nt,w[1]=P*dt+Y*nt,w[2]=N*-nt+Z*dt,w[3]=P*-nt+Y*dt})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const f=h.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=h.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const f=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let w=0,S=0;for(let L=0;L<f.length;L++){const N=new h.pointGeometry(f[L][0]*this.width,_+f[L][1]*(this.height-_)),P=o.pointCoordinate(N);if(!P)continue;const Z=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);w+=P[3]*Z,S+=Z}return S===0?NaN:w/S}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*f,w=this._mercatorZfromZoom(o),S=this._mercatorZfromZoom(this._maxZoom),L=Math.max(w-_,S);this._setZoom(this._zoomFromMercatorZ(L))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let _;_=o.z<this._camera.position[2]?[f.x,f.y,f.z]:[o.x,o.y,o.z];const w=h.length(h.sub([],this._camera.position,_));return h.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let f=!1;if(o.orientation&&!h.exactEquals(o.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(o.orientation)),o.position){const _=[o.position.x,o.position.y,o.position.z];h.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,f=new Jl;return f.position=new h.MercatorCoordinate(o[0],o[1],o[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(o){if(!h.length$1(o))return!1;h.normalize$1(o,o);const f=h.transformQuat([],[0,0,-1],o),_=h.transformQuat([],[0,-1,0],o);if(_[2]<0)return!1;const w=mu(f,_);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(o){const f=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;o[2]=h.clamp(o[2],w/_,w/f),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,f,_){this._unmodified=!1,this._edgeInsets.interpolate(o,f,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const f=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(o){const f=[new h.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const _=this.pointCoordinate(new h.pointGeometry(0,0)),w=this.pointCoordinate(new h.pointGeometry(this.width,0)),S=this.pointCoordinate(new h.pointGeometry(this.width,this.height)),L=this.pointCoordinate(new h.pointGeometry(0,this.height)),N=Math.floor(Math.min(_.x,w.x,S.x,L.x)),P=Math.floor(Math.max(_.x,w.x,S.x,L.x)),Z=1;for(let Y=N-Z;Y<=P+Z;Y++)Y!==0&&f.push(new h.UnwrappedTileID(Y,o))}return f}coveringTiles(o){let f=this.coveringZoomLevel(o);const _=f,w=this.elevation&&!o.isTerrainDEM,S=this.projection.name==="mercator";if(o.minzoom!==void 0&&f<o.minzoom)return[];o.maxzoom!==void 0&&f>o.maxzoom&&(f=o.maxzoom);const L=this.locationCoordinate(this.center),N=this.center.lat,P=1<<f,Z=[P*L.x,P*L.y,0],Y=this.projection.name==="globe",nt=!Y,dt=h.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,nt),Et=Y?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),xt=P*h.mercatorZfromAltitude(1,this.center.lat),Mt=this._camera.position[2]/h.mercatorZfromAltitude(1,this.center.lat),St=[P*Et.x,P*Et.y,Mt*(nt?1:xt)],vt=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Rt=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,Tt=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ut=o.isTerrainDEM?-Tt:this._elevation?this._elevation.getMinElevationBelowMSL():0,Gt=this.projection.isReprojectedInTileSpace?$s(this):1,Nt=Qt=>{const an=new h.MercatorCoordinate(Qt.x+25e-6,Qt.y,Qt.z),Fe=new h.MercatorCoordinate(Qt.x,Qt.y+25e-6,Qt.z),Xe=Qt.toLngLat(),pn=an.toLngLat(),Vn=Fe.toLngLat(),Gn=this.locationCoordinate(Xe),Un=this.locationCoordinate(pn),tn=this.locationCoordinate(Vn),ii=Math.hypot(Un.x-Gn.x,Un.y-Gn.y),di=Math.hypot(tn.x-Gn.x,tn.y-Gn.y);return Math.sqrt(ii*di)*Gt/25e-6},jt=Qt=>{const fn=Tt,an=Ut;return{aabb:h.tileAABB(this,P,0,0,0,Qt,an,fn,this.projection),zoom:0,x:0,y:0,minZ:an,maxZ:fn,wrap:Qt,fullyVisible:!1}},fe=[];let Ee=[];const xe=f,We=o.reparseOverscaled?_:f,ce=Qt=>Qt*Qt,Ve=ce((Mt-this._centerAltitude)*xt),Pe=Qt=>{if(!this._elevation||!Qt.tileID||!S)return;const fn=this._elevation.getMinMaxForTile(Qt.tileID),an=Qt.aabb;fn?(an.min[2]=fn.min,an.max[2]=fn.max,an.center[2]=(an.min[2]+an.max[2])/2):(Qt.shouldSplit=ge(Qt),Qt.shouldSplit||(an.min[2]=an.max[2]=an.center[2]=this._centerAltitude))},ge=Qt=>{if(Qt.zoom<Rt)return!0;if(Qt.zoom===xe)return!1;if(Qt.shouldSplit!=null)return Qt.shouldSplit;const fn=Qt.aabb.distanceX(St),an=Qt.aabb.distanceY(St);let Fe=Ve,Xe=1;if(Y){Fe=ce(Qt.aabb.distanceZ(St));const Gn=Math.pow(2,Qt.zoom),Un=h.latFromMercatorY((Qt.y+1)/Gn),tn=h.latFromMercatorY(Qt.y/Gn),ii=Math.min(Math.max(N,Un),tn),di=h.circumferenceAtLatitude(ii)/h.circumferenceAtLatitude(N);if(Xe=ii===N?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,di/this._mercatorScaleRatio),this.zoom<=h.GLOBE_ZOOM_THRESHOLD_MIN&&Qt.zoom===xe-1&&di>=.9)return!0}else if(w&&(Fe=ce(Qt.aabb.distanceZ(St)*xt)),this.projection.isReprojectedInTileSpace&&_<=5){const Gn=Math.pow(2,Qt.zoom),Un=Nt(new h.MercatorCoordinate((Qt.x+.5)/Gn,(Qt.y+.5)/Gn));Xe=Un>.85?1:Un}const pn=fn*fn+an*an+Fe,Vn=ce((1<<xe-Qt.zoom)*vt*Xe*((Gn,Un)=>{if(Un*ce(.707)<Gn)return 1;const tn=Math.sqrt(Un/Gn);return tn/(1.4144271570014144+(Math.pow(1.1,tn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Fe,Ve),pn));return pn<Vn};if(this.renderWorldCopies)for(let Qt=1;Qt<=3;Qt++)fe.push(jt(-Qt)),fe.push(jt(Qt));for(fe.push(jt(0));fe.length>0;){const Qt=fe.pop(),fn=Qt.x,an=Qt.y;let Fe=Qt.fullyVisible;if(!Fe){const Xe=Qt.aabb.intersects(dt);if(Xe===0)continue;Fe=Xe===2}if(Qt.zoom!==xe&&ge(Qt))for(let Xe=0;Xe<4;Xe++){const pn=(fn<<1)+Xe%2,Vn=(an<<1)+(Xe>>1),Gn={aabb:S?Qt.aabb.quadrant(Xe):h.tileAABB(this,P,Qt.zoom+1,pn,Vn,Qt.wrap,Qt.minZ,Qt.maxZ,this.projection),zoom:Qt.zoom+1,x:pn,y:Vn,wrap:Qt.wrap,fullyVisible:Fe,tileID:void 0,shouldSplit:void 0,minZ:Qt.minZ,maxZ:Qt.maxZ};w&&!Y&&(Gn.tileID=new h.OverscaledTileID(Qt.zoom+1===xe?We:Qt.zoom+1,Qt.wrap,Qt.zoom+1,pn,Vn),Pe(Gn)),fe.push(Gn)}else{const Xe=Qt.zoom===xe?We:Qt.zoom;if(o.minzoom&&o.minzoom>Xe)continue;const pn=Z[0]-(.5+fn+(Qt.wrap<<Qt.zoom))*(1<<f-Qt.zoom),Vn=Z[1]-.5-an,Gn=Qt.tileID?Qt.tileID:new h.OverscaledTileID(Xe,Qt.wrap,Qt.zoom,fn,an);Ee.push({tileID:Gn,distanceSq:pn*pn+Vn*Vn})}}if(this.fogCullDistSq){const Qt=this.fogCullDistSq,fn=this.horizonLineFromTop();Ee=Ee.filter((an=>{const Fe=[0,0,0,1],Xe=[h.EXTENT,h.EXTENT,0,1],pn=this.calculateFogTileMatrix(an.tileID.toUnwrapped());h.transformMat4$1(Fe,Fe,pn),h.transformMat4$1(Xe,Xe,pn);const Vn=h.getAABBPointSquareDist(Fe,Xe);if(Vn===0)return!0;let Gn=!1;const Un=this._elevation;if(Un&&Vn>Qt&&fn!==0){const tn=this.calculateProjMatrix(an.tileID.toUnwrapped());let ii;o.isTerrainDEM||(ii=Un.getMinMaxForTile(an.tileID)),ii||(ii={min:Ut,max:Tt});const di=h.furthestTileCorner(this.rotation),Er=[di[0]*h.EXTENT,di[1]*h.EXTENT,ii.max];h.transformMat4(Er,Er,tn),Gn=(1-Er[1])*this.height*.5<fn}return Vn<Qt||Gn}))}return Ee.sort(((Qt,fn)=>Qt.distanceSq-fn.distanceSq)).map((Qt=>Qt.tileID))}resize(o,f){this.width=o,this.height=f,this.pixelsToGLUnits=[2/o,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const f=h.clamp(o.lat,-h.MAX_MERCATOR_LATITUDE,h.MAX_MERCATOR_LATITUDE),_=this.projection.project(o.lng,f);return new h.pointGeometry(_.x*this.worldSize,_.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(o,f){let _,w;const S=this.centerPoint;if(this.projection.name==="globe"){const N=this.worldSize;_=(f.x-S.x)/N,w=(f.y-S.y)/N}else{const N=this.pointCoordinate(f),P=this.pointCoordinate(S);_=N.x-P.x,w=N.y-P.y}const L=this.locationCoordinate(o);this.setLocation(new h.MercatorCoordinate(L.x-_,L.y-w))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,f){const _=f?h.mercatorZfromAltitude(f,o.lat):void 0,w=this.projection.project(o.lng,o.lat);return new h.MercatorCoordinate(w.x,w.y,_)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,f){const _=f??this._centerAltitude,w=[o.x,o.y,0,1],S=[o.x,o.y,1,1];h.transformMat4$1(w,w,this.pixelMatrixInverse),h.transformMat4$1(S,S,this.pixelMatrixInverse);const L=S[3];h.scale$1(w,w,1/w[3]),h.scale$1(S,S,1/L);const N=w[2],P=S[2];return{p0:w,p1:S,t:N===P?0:(_-N)/(P-N)}}screenPointToMercatorRay(o){const f=[o.x,o.y,0,1],_=[o.x,o.y,1,1];return h.transformMat4$1(f,f,this.pixelMatrixInverse),h.transformMat4$1(_,_,this.pixelMatrixInverse),h.scale$1(f,f,1/f[3]),h.scale$1(_,_,1/_[3]),f[2]=h.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,_[2]=h.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,h.scale$1(f,f,1/this.worldSize),h.scale$1(_,_,1/this.worldSize),new h.Ray([f[0],f[1],f[2]],h.normalize([],h.sub([],_,f)))}rayIntersectionCoordinate(o){const{p0:f,p1:_,t:w}=o,S=h.mercatorZfromAltitude(f[2],this._center.lat),L=h.mercatorZfromAltitude(_[2],this._center.lat);return new h.MercatorCoordinate(h.number(f[0],_[0],w)/this.worldSize,h.number(f[1],_[1],w)/this.worldSize,h.number(S,L,w))}pointCoordinate(o,f=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,f)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let f=this.projection.pointCoordinate3D(this,o.x,o.y);if(f)return new h.MercatorCoordinate(f[0],f[1],f[2]);let _=0,w=this.horizonLineFromTop();if(o.y>w)return this.pointCoordinate(o);const S=.02*w,L=o.clone();for(let N=0;N<10&&w-_>S;N++){L.y=h.number(_,w,.66);const P=this.projection.pointCoordinate3D(this,L.x,L.y);P?(w=L.y,f=P):_=L.y}return f?new h.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}_coordinatePoint(o,f){const _=f&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,w=[o.x*this.worldSize,o.y*this.worldSize,_+o.toAltitude(),1];return h.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new h.pointGeometry(w[0]/w[3],w[1]/w[3]):new h.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:o,left:f}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,S=this.pointCoordinate3D(new h.pointGeometry(f,o)),L=this.pointCoordinate3D(new h.pointGeometry(w,o)),N=this.pointCoordinate3D(new h.pointGeometry(w,_)),P=this.pointCoordinate3D(new h.pointGeometry(f,_));let Z=Math.min(S.x,P.x),Y=Math.max(L.x,N.x),nt=Math.min(S.y,L.y),dt=Math.max(P.y,N.y);const Et=Math.pow(2,-this.zoom)/16,xt=(vt,Rt,Tt,Ut)=>{const Gt=(vt+Tt)/2,Nt=(Rt+Ut)/2,jt=new h.pointGeometry(Gt,Nt),fe=this.pointCoordinate3D(jt),Ee=Math.max(0,Z-fe.x,nt-fe.y,fe.x-Y,fe.y-dt);Z=Math.min(Z,fe.x),Y=Math.max(Y,fe.x),nt=Math.min(nt,fe.y),dt=Math.max(dt,fe.y),Ee>Et&&(xt(vt,Rt,Gt,Nt),xt(Gt,Nt,Tt,Ut))};xt(f,o,w,o),xt(w,o,w,_),xt(w,_,f,_),xt(f,_,f,o);const Mt=new h.LngLat(h.lngFromMercatorX(Y),h.latFromMercatorY(nt)),St=new h.LngLat(h.lngFromMercatorX(Z),h.latFromMercatorY(dt));return new h.LngLatBounds(St,Mt)}_getBounds(o,f){if(this.projection.name==="globe")return this._getGlobeBounds();const _=new h.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),w=new h.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),S=new h.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),L=new h.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let N=this.pointCoordinate(_,o),P=this.pointCoordinate(w,o);const Z=this.pointCoordinate(S,f),Y=this.pointCoordinate(L,f),nt=(dt,Et)=>(Et.y-dt.y)/(Et.x-dt.x);return N.y>1&&P.y>=0?N=new h.MercatorCoordinate((1-Y.y)/nt(Y,N)+Y.x,1):N.y<0&&P.y<=1&&(N=new h.MercatorCoordinate(-Y.y/nt(Y,N)+Y.x,0)),P.y>1&&N.y>=0?P=new h.MercatorCoordinate((1-Z.y)/nt(Z,P)+Z.x,1):P.y<0&&N.y<=1&&(P=new h.MercatorCoordinate(-Z.y/nt(Z,P)+Z.x,0)),new h.LngLatBounds().extend(this.coordinateLocation(N)).extend(this.coordinateLocation(P)).extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(Z))}_getBounds3D(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBounds(0,0);const f=o.visibleDemTiles.reduce(((_,w)=>{if(w.dem){const S=w.dem.tree;_.min=Math.min(_.min,S.minimums[0]),_.max=Math.max(_.max,S.maximums[0])}return _}),{min:Number.MAX_VALUE,max:0});return this._getBounds(f.min*o.exaggeration(),f.max*o.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(o=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-f*(1-this._horizonShift);return o?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-h.MAX_MERCATOR_LATITUDE,this.maxLat=h.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=h.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=h.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=h.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=h.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,f){return this.projection.createTileMatrix(this,f,o)}calculateDistanceTileData(o){const f=o.key,_=this._distanceTileDataCache;if(_[f])return _[f];const w=o.canonical,S=1/this.height,L=this.cameraWorldSize/this.zoomScale(w.z),N=(w.x+Math.pow(2,w.z)*o.wrap)*L,P=w.y*L,Z=this.point,Y=this.angle,nt=Math.sin(-Y),dt=-Math.cos(-Y);return _[f]={bearing:[nt,dt],center:[(Z.x-N)*S,(Z.y-P)*S],scale:L/h.EXTENT*S},_[f]}calculateFogTileMatrix(o){const f=o.key,_=this._fogTileMatrixCache;if(_[f])return _[f];const w=this.projection.createTileMatrix(this,this.cameraWorldSize,o);return h.multiply(w,this.worldToFogMatrix,w),_[f]=new Float32Array(w),_[f]}calculateProjMatrix(o,f=!1){const _=o.key,w=f?this._alignedProjMatrixCache:this._projMatrixCache;if(w[_])return w[_];const S=this.calculatePosMatrix(o,this.worldSize);return h.multiply(S,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,S),w[_]=new Float32Array(S),w[_]}calculatePixelsToTileUnitsMatrix(o){const f=o.tileID.key,_=this._pixelsToTileUnitsCache;if(_[f])return _[f];const w=(function(S,L){const{scale:N}=S.tileTransform,P=N*h.EXTENT/(S.tileSize*Math.pow(2,L.zoom-S.tileID.overscaledZ+S.tileID.canonical.z));return Z=new Float32Array(4),dt=(Y=L.inverseAdjustmentMatrix)[1],Et=Y[2],xt=Y[3],St=(nt=[P,P])[1],Z[0]=Y[0]*(Mt=nt[0]),Z[1]=dt*Mt,Z[2]=Et*St,Z[3]=xt*St,Z;var Z,Y,nt,dt,Et,xt,Mt,St})(o,this);return _[f]=w,_[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const f=h.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(f),w=this._camera.forward(),S=h.mercatorZfromAltitude(1,this._center.lat);_[2]/=S,w[2]/=S,h.normalize(w,w);const L=o.raycast(_,w,o.exaggeration());if(L){const N=h.scaleAndAdd([],_,w,L),P=new h.MercatorCoordinate(N[0],N[1],h.mercatorZfromAltitude(N[2],h.latFromMercatorY(N[1]))),Z=(P.z+h.length([P.x-_[0],P.y-_[1],P.z-_[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const f=h.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(f),w=o.getAtPointOrZero(new h.MercatorCoordinate(..._)),S=this._minimumHeightOverTerrain()*Math.cos(h.degToRad(this._maxPitch)),L=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*w;if(L<S){const N=this.locationCoordinate(this._center,this._centerAltitude),P=[N.x-_[0],N.y-_[1],N.z-_[2]],Z=h.length(P);P[2]-=(S-L)/this._pixelsPerMercatorPixel;const Y=h.length(P);if(Y===0)return;h.scale$2(P,P,Z/Y*this._pixelsPerMercatorPixel),this._camera.position=[N.x-P[0],N.y-P[1],N.z*this._pixelsPerMercatorPixel-P[2]],this._camera.orientation=mu(P,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const dt=this.center;return dt.lat=h.clamp(dt.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(dt.lng=h.clamp(dt.lng,this.minLng,this.maxLng)),this.center=dt,void(this._constraining=!1)}const f=this._unmodified,{x:_,y:w}=this.point;let S=0,L=_,N=w;const P=this.width/2,Z=this.height/2,Y=this.worldMinY*this.scale,nt=this.worldMaxY*this.scale;if(w-Z<Y&&(N=Y+Z),w+Z>nt&&(N=nt-Z),nt-Y<this.height&&(S=Math.max(S,this.height/(nt-Y)),N=(nt+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const dt=this.worldMinX*this.scale,Et=this.worldMaxX*this.scale,xt=this.worldSize/2-(dt+Et)/2;L=(_+xt+this.worldSize)%this.worldSize-xt,L-P<dt&&(L=dt+P),L+P>Et&&(L=Et-P),Et-dt<this.width&&(S=Math.max(S,this.width/(Et-dt)),L=(Et+dt)/2)}L===_&&N===w||(this.center=this.unproject(new h.pointGeometry(L,N))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCameraAltitude(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=h.mercatorZfromAltitude(1,this.center.lat)/h.mercatorZfromAltitude(1,h.GLOBE_SCALE_MATCH_LATITUDE));const _=ll(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?f:1),S=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);S[8]=2*-o.x/this.width,S[9]=2*o.y/this.height;let L=h.mul([],S,w);if(this.projection.isReprojectedInTileSpace){const Gt=this.locationCoordinate(this.center),Nt=h.identity([]);h.translate(Nt,Nt,[Gt.x*this.worldSize,Gt.y*this.worldSize,0]),h.multiply(Nt,Nt,Cl(this)),h.translate(Nt,Nt,[-Gt.x*this.worldSize,-Gt.y*this.worldSize,0]),h.multiply(L,L,Nt),this.inverseAdjustmentMatrix=(function(jt){const fe=Cl(jt,!0);return ie([],[fe[0],fe[1],fe[4],fe[5]])})(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=h.scale([],L,[this.worldSize,this.worldSize,this.worldSize/f,1]),this.projMatrix=L,this.invProjMatrix=h.invert(new Float64Array(16),this.projMatrix);const N=h.invert([],S);this.frustumCorners=h.FrustumCorners.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height);const P=new Float32Array(16);h.identity(P),h.scale(P,P,[1,-1,1]),h.rotateX(P,P,this._pitch),h.rotateZ(P,P,this.angle);const Z=h.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Y=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Z[8]=2*-o.x/this.width,Z[9]=2*(o.y+Y)/this.height,this.skyboxMatrix=h.multiply(P,Z,P);const nt=this.point,dt=nt.x,Et=nt.y,xt=this.width%2/2,Mt=this.height%2/2,St=Math.cos(this.angle),vt=Math.sin(this.angle),Rt=dt-Math.round(dt)+St*xt+vt*Mt,Tt=Et-Math.round(Et)+St*Mt+vt*xt,Ut=new Float64Array(L);if(h.translate(Ut,Ut,[Rt>.5?Rt-1:Rt,Tt>.5?Tt-1:Tt,0]),this.alignedProjMatrix=Ut,L=h.create(),h.scale(L,L,[this.width/2,-this.height/2,1]),h.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=h.create(),h.scale(L,L,[1,-1,1]),h.translate(L,L,[-1,-1,0]),h.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},L=h.invert(new Float64Array(16),this.pixelMatrix),!L)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=L,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=h.calculateGlobeMatrix(this);const Gt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=h.transformMat4(Gt,Gt,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=L;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSize,f=this.cameraPixelsPerMeter,_=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,S=[o,o,f];h.scale$2(S,S,w),h.scale$2(_,_,-1),h.multiply$2(_,_,S);const L=h.create();h.translate(L,L,_),h.scale(L,L,S),this.mercatorFogMatrix=L,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,f,w)}_computeCameraPosition(o){const f=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),w=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-o/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-_[0]*S,w.y/this.worldSize-_[1]*S,o/this.worldSize*this._centerAltitude-_[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],w=o[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(S=Math.min((f-_)/w,1)),this._camera.position=h.scaleAndAdd([],this._camera.position,o,S),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,f=this._camera.forward(),{pitch:_,bearing:w}=this._camera.getPitchBearing(),S=h.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,L=this._mercatorZfromZoom(this._maxZoom)*Math.cos(h.degToRad(this._maxPitch)),N=Math.max((o[2]-S)/Math.cos(_),L),P=this._zoomFromMercatorZ(N);h.scaleAndAdd(o,o,f,N),this._pitch=h.clamp(_,h.degToRad(this.minPitch),h.degToRad(this.maxPitch)),this.angle=h.wrap(w,-Math.PI,Math.PI),this._setZoom(h.clamp(P,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new h.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){const f=L=>{const N=this.getCameraToCenterDistance(this.projection,L);return this.scaleZoom(N/(o*this.tileSize))};let _,w=f(this.zoom),S=Math.abs(w-f(w));for(;_!==S;)w=f(w),_=S,S=Math.abs(w-f(w));return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(h.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,f){const _=Math.min(o.x,f.x),w=Math.max(o.x,f.x),S=Math.min(o.y,f.y),L=Math.max(o.y,f.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const N=[new h.pointGeometry(_,S),new h.pointGeometry(w,L),new h.pointGeometry(_,L),new h.pointGeometry(w,S)],P=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const Y of N){const nt=this.pointRayIntersection(Y);if(nt.t<0)return!0;const dt=this.rayIntersectionCoordinate(nt);if(dt.x<P||dt.y<0||dt.x>Z||dt.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+h.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new h.pointGeometry(0,0),new h.pointGeometry(this.width,this.height))}zoomDeltaToMovement(o,f){const _=h.length(h.sub([],this._camera.position,o)),w=this._zoomFromMercatorZ(_)+f;return _-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const o=(function(f,_){const w=[f[0],f[1],f[2],1];h.transformMat4$1(w,w,_);const S=Math.max(w[3],1e-6);return[w[0]/S,w[1]/S,w[2]/S,S]})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new h.pointGeometry(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.pointGeometry(0,o))}}getCameraToCenterDistance(o,f=this.zoom){const _=ll(o,f,this.width,this.height,1024),w=o.pixelSpaceConversion(this.center.lat,this.worldSize,_);return .5/Math.tan(.5*this._fov)*this.height*w}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&h.multiply(o,o,this.globeMatrix),o}}function tc(m,o){let f=!1,_=null;const w=()=>{_=null,f&&(m(),_=setTimeout(w,o),f=!1)};return()=>(f=!0,_||w(),_)}class js{constructor(o){this._hashName=o&&encodeURIComponent(o),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=tc(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,h.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),h.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const f=Il(o);if(this._hashName){const _=this._hashName;let w=!1;const S=h.window.location.hash.slice(1).split("&").map((L=>{const N=L.split("=")[0];return N===_?(w=!0,`${N}=${f}`):L})).filter((L=>L));return w||S.push(`${_}=${f}`),`#${S.join("&")}`}return`#${f}`}_getCurrentHash(){const o=h.window.location.hash.replace("#","");if(this._hashName){let f;return o.split("&").map((_=>_.split("="))).forEach((_=>{_[0]===this._hashName&&(f=_)})),(f&&f[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some((_=>isNaN(_)))){const _=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(f[3]||0):o.getBearing();return o.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:_,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=h.window.location.href.replace(/(#.+)?$/,this.getHashString());h.window.history.replaceState(h.window.history.state,null,o)}}function Il(m,o){const f=m.getCenter(),_=Math.round(100*m.getZoom())/100,w=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,w),L=Math.round(f.lng*S)/S,N=Math.round(f.lat*S)/S,P=m.getBearing(),Z=m.getPitch();let Y=o?`/${L}/${N}/${_}`:`${_}/${N}/${L}`;return(P||Z)&&(Y+="/"+Math.round(10*P)/10),Z&&(Y+=`/${Math.round(Z)}`),Y}const ms={linearity:.3,easing:h.bezier(0,0,.3,1)},oo=h.extend({deceleration:2500,maxSpeed:1400},ms),Fa=h.extend({deceleration:20,maxSpeed:1400},ms),ao=h.extend({deceleration:1e3,maxSpeed:360},ms),_u=h.extend({deceleration:1e3,maxSpeed:90},ms);class vo{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,f=h.exported.now();for(;o.length>0&&f-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new h.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)f.zoom+=S.zoomDelta||0,f.bearing+=S.bearingDelta||0,f.pitch+=S.pitchDelta||0,S.panDelta&&f.pan._add(S.panDelta),S.around&&(f.around=S.around),S.pinchAround&&(f.pinchAround=S.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(f.pan.mag()){const S=ys(f.pan.mag(),_,h.extend({},oo,o||{}));w.offset=f.pan.mult(S.amount/f.pan.mag()),w.center=this._map.transform.center,zr(w,S)}if(f.zoom){const S=ys(f.zoom,_,Fa);w.zoom=this._map.transform.zoom+S.amount,zr(w,S)}if(f.bearing){const S=ys(f.bearing,_,ao);w.bearing=this._map.transform.bearing+h.clamp(S.amount,-179,179),zr(w,S)}if(f.pitch){const S=ys(f.pitch,_,_u);w.pitch=this._map.transform.pitch+S.amount,zr(w,S)}if(w.zoom||w.bearing){const S=f.pinchAround===void 0?f.around:f.pinchAround;w.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function zr(m,o){(!m.duration||m.duration<o.duration)&&(m.duration=o.duration,m.easing=o.easing)}function ys(m,o,f){const{maxSpeed:_,linearity:w,deceleration:S}=f,L=h.clamp(m*w/(o/1e3),-_,_),N=Math.abs(L)/(S*w);return{easing:f.easing,duration:1e3*N,amount:L*(N/2)}}class Cr extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,_,w={}){const S=Dt(f.getCanvasContainer(),_),L=f.unproject(S);super(o,h.extend({point:S,lngLat:L,originalEvent:_},w)),this._defaultPrevented=!1,this.target=f}}class la extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,_){const w=o==="touchend"?_.changedTouches:_.touches,S=_t(f.getCanvasContainer(),w),L=S.map((P=>f.unproject(P))),N=S.reduce(((P,Z,Y,nt)=>P.add(Z.div(nt.length))),new h.pointGeometry(0,0));super(o,{points:S,point:N,lngLats:L,lngLat:f.unproject(N),originalEvent:_}),this._defaultPrevented=!1}}class Js extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,_){super(o,{originalEvent:_}),this._defaultPrevented=!1}}class ua{constructor(o,f){this._map=o,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Js(o.type,this._map,o))}mousedown(o,f){return this._mousedownPos=f,this._firePreventable(new Cr(o.type,this._map,o))}mouseup(o){this._map.fire(new Cr(o.type,this._map,o))}preclick(o){const f=h.extend({},o);f.type="preclick",this._map.fire(new Cr(f.type,this._map,f))}click(o,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Cr(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Cr(o.type,this._map,o))}mouseover(o){this._map.fire(new Cr(o.type,this._map,o))}mouseout(o){this._map.fire(new Cr(o.type,this._map,o))}touchstart(o){return this._firePreventable(new la(o.type,this._map,o))}touchmove(o){this._map.fire(new la(o.type,this._map,o))}touchend(o){this._map.fire(new la(o.type,this._map,o))}touchcancel(o){this._map.fire(new la(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Cr(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Cr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Cr(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vu{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,f){this.isEnabled()&&o.shiftKey&&o.button===0&&(Ft(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(o,f){if(!this._active)return;const _=f,w=this._startPos,S=this._lastPos;if(!w||!S||S.equals(_)||!this._box&&_.dist(w)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=At("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const L=Math.min(w.x,_.x),N=Math.max(w.x,_.x),P=Math.min(w.y,_.y),Z=Math.max(w.y,_.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${L}px,${P}px)`,this._box.style.width=N-L+"px",this._box.style.height=Z-P+"px")}))}mouseupWindow(o,f){if(!this._active)return;const _=this._startPos,w=f;if(_&&o.button===0){if(this.reset(),It(),_.x!==w.x||_.y!==w.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:S=>S.fitScreenCoordinates(_,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),lt(),delete this._startPos,delete this._lastPos}_fireEvent(o,f){return this._map.fire(new h.Event(o,{originalEvent:f}))}}function xu(m,o){const f={};for(let _=0;_<m.length;_++)f[m[_].identifier]=o[_];return f}class ec{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,f,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),_.length===this.numTouches&&(this.centroid=(function(w){const S=new h.pointGeometry(0,0);for(const L of w)S._add(L);return S.div(w.length)})(f),this.touches=xu(_,f)))}touchmove(o,f,_){if(this.aborted||!this.centroid)return;const w=xu(_,f);for(const S in this.touches){const L=this.touches[S],N=w[S];(!N||N.dist(L)>30)&&(this.aborted=!0)}}touchend(o,f,_){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class os{constructor(o){this.singleTap=new ec(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,f,_){this.singleTap.touchstart(o,f,_)}touchmove(o,f,_){this.singleTap.touchmove(o,f,_)}touchend(o,f,_){const w=this.singleTap.touchend(o,f,_);if(w){const S=o.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(w)<30;if(S&&L||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Pr{constructor(){this._zoomIn=new os({numTouches:1,numTaps:2}),this._zoomOut=new os({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,f,_){this._zoomIn.touchstart(o,f,_),this._zoomOut.touchstart(o,f,_)}touchmove(o,f,_){this._zoomIn.touchmove(o,f,_),this._zoomOut.touchmove(o,f,_)}touchend(o,f,_){const w=this._zoomIn.touchend(o,f,_),S=this._zoomOut.touchend(o,f,_);return w?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(w)},{originalEvent:o})}):S?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(S)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Mi={0:1,2:2};class ka{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,f){return!1}_move(o,f){return{}}mousedown(o,f){if(this._lastPoint)return;const _=Jt(o);this._correctButton(o,_)&&(this._lastPoint=f,this._eventButton=_)}mousemoveWindow(o,f){const _=this._lastPoint;if(_){if(o.preventDefault(),this._eventButton!=null&&(function(w,S){const L=Mi[S];return w.buttons===void 0||(w.buttons&L)!==L})(o,this._eventButton))this.reset();else if(this._moved||!(f.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(_,f)}}mouseupWindow(o){this._lastPoint&&Jt(o)===this._eventButton&&(this._moved&&It(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hr extends ka{mousedown(o,f){super.mousedown(o,f),this._lastPoint&&(this._active=!0)}_correctButton(o,f){return f===0&&!o.ctrlKey}_move(o,f){return{around:f,panDelta:f.sub(o)}}}class lo extends ka{_correctButton(o,f){return f===0&&o.ctrlKey||f===2}_move(o,f){const _=.8*(f.x-o.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(o){o.preventDefault()}}class No extends ka{_correctButton(o,f){return f===0&&o.ctrlKey||f===2}_move(o,f){const _=-.5*(f.y-o.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(o){o.preventDefault()}}class fc{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),h.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new h.pointGeometry(0,0)}touchstart(o,f,_){return this._calculateTransform(o,f,_)}touchmove(o,f,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1&&!h.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,f,_)}}touchend(o,f,_){this._calculateTransform(o,f,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,f,_){_.length>0&&(this._active=!0);const w=xu(_,f),S=new h.pointGeometry(0,0),L=new h.pointGeometry(0,0);let N=0;for(const Z in w){const Y=w[Z],nt=this._touches[Z];nt&&(S._add(Y),L._add(Y.sub(nt)),N++,w[Z]=Y)}if(this._touches=w,N<this._minTouches||!L.mag())return;const P=L.div(N);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(N),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=At("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class bu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,f,_){return{}}touchstart(o,f,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([f[0],f[1]]))}touchmove(o,f,_){const w=this._firstTwoTouches;if(!w)return;o.preventDefault();const[S,L]=w,N=Ua(_,f,S),P=Ua(_,f,L);if(!N||!P)return;const Z=this._aroundCenter?null:N.add(P).div(2);return this._move([N,P],Z,o)}touchend(o,f,_){if(!this._firstTwoTouches)return;const[w,S]=this._firstTwoTouches,L=Ua(_,f,w),N=Ua(_,f,S);L&&N||(this._active&&It(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ua(m,o,f){for(let _=0;_<m.length;_++)if(m[_].identifier===f)return o[_]}function ul(m,o){return Math.log(m/o)/Math.LN2}class ku extends bu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,f){const _=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ul(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ul(this._distance,_),pinchAround:f}}}function Kl(m,o){return 180*m.angleWith(o)/Math.PI}class Fs extends bu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,f){const _=this._vector;if(this._vector=o[0].sub(o[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Kl(this._vector,_),pinchAround:f}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const f=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const w=Kl(o,_);return Math.abs(w)<f}}function Ml(m){return Math.abs(m.y)>Math.abs(m.x)}class Oo extends bu{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,Ml(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,f,_){const w=this._lastPoints;if(!w)return;const S=o[0].sub(w[0]),L=o[1].sub(w[1]);return this._map._cooperativeGestures&&!h.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(S,L,_.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(S.y+L.y)/2*-.5})}gestureBeginsVertically(o,f,_){if(this._valid!==void 0)return this._valid;const w=o.mag()>=2,S=f.mag()>=2;if(!w&&!S)return;if(!w||!S)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;const L=o.y>0==f.y>0;return Ml(o)&&Ml(f)&&L}}const Ga={panStep:100,bearingStep:15,pitchStep:10};class cl{constructor(){const o=Ga;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let f=0,_=0,w=0,S=0,L=0;switch(o.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:o.shiftKey?_=-1:(o.preventDefault(),S=-1);break;case 39:o.shiftKey?_=1:(o.preventDefault(),S=1);break;case 38:o.shiftKey?w=1:(o.preventDefault(),L=-1);break;case 40:o.shiftKey?w=-1:(o.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(_=0,w=0),{cameraAnimation:N=>{const P=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:Sa,zoom:f?Math.round(P)+f*(o.shiftKey?2:1):P,bearing:N.getBearing()+_*this._bearingStep,pitch:N.getPitch()+w*this._pitchStep,offset:[-S*this._panStep,-L*this._panStep],center:N.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Sa(m){return m*(2-m)}const Uu=4.000244140625;class Ei{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,h.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||h.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=o.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const _=h.exported.now(),w=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,f!==0&&f%Uu==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(w*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),o.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=o,this._delta-=f,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=Dt(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>Uu?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&Z!==0&&(Z=1/Z);const Y=f(),nt=Math.pow(2,Y),dt=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):nt;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(dt*Z))),this._type==="wheel"&&(this._startZoom=Y,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:f(),w=this._startZoom,S=this._easing;let L,N=!1;if(this._type==="wheel"&&w&&S){const P=Math.min((h.exported.now()-this._lastWheelEventTime)/200,1),Z=S(P);L=h.number(w,_,Z),P<1?this._frameId||(this._frameId=!0):N=!0}else L=_,N=!0;return this._active=!0,N&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!N,zoomDelta:L-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let f=h.ease;if(this._prevEase){const _=this._prevEase,w=(h.exported.now()-_.start)/_.duration,S=_.easing(w+.01)-_.easing(w),L=.27/Math.sqrt(S*S+1e-4)*.01,N=Math.sqrt(.0729-L*L);f=h.bezier(L,N,.25,1)}return this._prevEase={start:h.exported.now(),duration:o,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=At("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(h.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class ns{constructor(o,f){this._clickZoom=o,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ta{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,f){return o.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(o.shiftKey?-1:1),around:_.unproject(f)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dn{constructor(){this._tap=new os({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,f,_){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=f[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(o,f,_))}touchmove(o,f,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const w=f[0],S=w.y-this._swipePoint.y;return this._swipePoint=w,o.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(o,f,_)}touchend(o,f,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(o,f,_)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zo{constructor(o,f,_){this._el=o,this._mousePan=f,this._touchPan=_}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ql{constructor(o,f,_){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=f,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class wu{constructor(o,f,_,w){this._el=o,this._touchZoom=f,this._touchRotate=_,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const xo=m=>m.zoom||m.drag||m.pitch||m.rotate;class Al extends h.Event{}class as{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,f){const _=h.sub([],f,o);this.radius=h.length(_[2]<0?h.div([],_,this.constants):[_[0],_[1],0])}projectRay(o){h.div(o,o,this.constants),h.normalize(o,o),h.mul$1(o,o,this.constants);const f=h.scale$2([],o,this.radius);if(f[2]>0){const _=h.scale$2([],[0,0,1],h.dot(f,[0,0,1])),w=h.scale$2([],h.normalize([],[f[0],f[1],0]),this.radius),S=h.add([],f,h.scale$2([],h.sub([],h.add([],w,_),f),2));f[0]=S[0],f[1]=S[1]}return f}}function ca(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Ll{constructor(o,f){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vo(o),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new as,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),h.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[h.window,"blur",void 0]];for(const[w,S,L]of this._listeners)w.addEventListener(S,w===h.window.document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[o,f,_]of this._listeners)o.removeEventListener(f,o===h.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(o){const f=this._map,_=f.getCanvasContainer();this._add("mapEvent",new ua(f,o));const w=f.boxZoom=new vu(f,o);this._add("boxZoom",w);const S=new Pr,L=new Ta;f.doubleClickZoom=new ns(L,S),this._add("tapZoom",S),this._add("clickZoom",L);const N=new dn;this._add("tapDragZoom",N);const P=f.touchPitch=new Oo(f);this._add("touchPitch",P);const Z=new lo(o),Y=new No(o);f.dragRotate=new Ql(o,Z,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const nt=new hr(o),dt=new fc(f,o);f.dragPan=new zo(_,nt,dt),this._add("mousePan",nt),this._add("touchPan",dt,["touchZoom","touchRotate"]);const Et=new Fs,xt=new ku;f.touchZoomRotate=new wu(_,xt,Et,N),this._add("touchRotate",Et,["touchPan","touchZoom"]),this._add("touchZoom",xt,["touchPan","touchRotate"]),this._add("blockableMapEvent",new hc(f));const Mt=f.scrollZoom=new Ei(f,this);this._add("scrollZoom",Mt,["mousePan"]);const St=f.keyboard=new cl;this._add("keyboard",St);for(const vt of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[vt]&&f[vt].enable(o[vt])}_add(o,f,_){this._handlers.push({handlerName:o,handler:f,allowed:_}),this._handlersById[o]=f}stop(o){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!xo(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,f,_){for(const w in o)if(w!==_&&(!f||f.indexOf(w)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const f=[];for(const _ of o)this._el.contains(_.target)&&f.push(_);return f}handleEvent(o,f){this._updatingCamera=!0;const _=o.type==="renderFrame",w=_?void 0:o,S={needsRenderFrame:!1},L={},N={},P=o.touches?this._getMapTouches(o.touches):void 0,Z=P?_t(this._el,P):_?void 0:Dt(this._el,o);for(const{handlerName:dt,handler:Et,allowed:xt}of this._handlers){if(!Et.isEnabled())continue;let Mt;this._blockedByActive(N,xt,dt)?Et.reset():Et[f||o.type]&&(Mt=Et[f||o.type](o,Z,P),this.mergeHandlerResult(S,L,Mt,dt,w),Mt&&Mt.needsRenderFrame&&this._triggerRenderFrame()),(Mt||Et.isActive())&&(N[dt]=Et)}const Y={};for(const dt in this._previousActiveHandlers)N[dt]||(Y[dt]=w);this._previousActiveHandlers=N,(Object.keys(Y).length||ca(S))&&(this._changes.push([S,L,Y]),this._triggerRenderFrame()),(Object.keys(N).length||ca(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:nt}=S;nt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],nt(this._map))}mergeHandlerResult(o,f,_,w,S){if(!_)return;h.extend(o,_);const L={handlerName:w,originalEvent:_.originalEvent||S};_.zoomDelta!==void 0&&(f.zoom=L),_.panDelta!==void 0&&(f.drag=L),_.pitchDelta!==void 0&&(f.pitch=L),_.bearingDelta!==void 0&&(f.rotate=L)}_applyChanges(){const o={},f={},_={};for(const[w,S,L]of this._changes)w.panDelta&&(o.panDelta=(o.panDelta||new h.pointGeometry(0,0))._add(w.panDelta)),w.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(o.around=w.around),w.aroundCoord!==void 0&&(o.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(o.pinchAround=w.pinchAround),w.noInertia&&(o.noInertia=w.noInertia),h.extend(f,S),h.extend(_,L);this._updateMapTransform(o,f,_),this._changes=[]}_updateMapTransform(o,f,_){const w=this._map,S=w.transform,L=Rt=>[Rt.x,Rt.y,Rt.z];if((Rt=>{const Tt=this._eventsInProgress.drag;return Tt&&!this._handlersById[Tt.handlerName].isActive()})()&&!ca(o)){const Rt=S.zoom;S.cameraElevationReference="sea",S.recenterOnTerrain(),S.cameraElevationReference="ground",Rt!==S.zoom&&this._map._update(!0)}if(!ca(o))return void this._fireEvents(f,_,!0);let{panDelta:N,zoomDelta:P,bearingDelta:Z,pitchDelta:Y,around:nt,aroundCoord:dt,pinchAround:Et}=o;Et!==void 0&&(nt=Et),(Rt=>f.drag&&!this._eventsInProgress.drag)()&&nt&&(this._dragOrigin=L(S.pointCoordinate3D(nt)),this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",w._stop(!0),nt=nt||w.transform.centerPoint,Z&&(S.bearing+=Z),Y&&(S.pitch+=Y),S._updateCameraState();const xt=[0,0,0];if(N)if(S.projection.name==="mercator"){const Rt=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(nt).dir),Tt=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(nt.sub(N)).dir);xt[0]=Tt[0]-Rt[0],xt[1]=Tt[1]-Rt[1]}else{const Rt=S.pointCoordinate(nt);if(S.projection.name==="globe"){N=N.rotate(-S.angle);const Tt=S._pixelsPerMercatorPixel/S.worldSize;xt[0]=-N.x*h.mercatorScale(h.latFromMercatorY(Rt.y))*Tt,xt[1]=-N.y*h.mercatorScale(S.center.lat)*Tt}else{const Tt=S.pointCoordinate(nt.sub(N));Rt&&Tt&&(xt[0]=Tt.x-Rt.x,xt[1]=Tt.y-Rt.y)}}const Mt=S.zoom,St=[0,0,0];if(P){const Rt=L(dt||S.pointCoordinate3D(nt)),Tt={dir:h.normalize([],h.sub([],Rt,S._camera.position))};if(Tt.dir[2]<0){const Ut=S.zoomDeltaToMovement(Rt,P);h.scale$2(St,Tt.dir,Ut)}}const vt=h.add(xt,xt,St);S._translateCameraConstrained(vt),P&&Math.abs(S.zoom-Mt)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(f,_,!0)}_fireEvents(o,f,_){const w=xo(this._eventsInProgress),S=xo(o),L={};for(const Y in o){const{originalEvent:nt}=o[Y];this._eventsInProgress[Y]||(L[`${Y}start`]=nt),this._eventsInProgress[Y]=o[Y]}!w&&S&&this._fireEvent("movestart",S.originalEvent);for(const Y in L)this._fireEvent(Y,L[Y]);S&&this._fireEvent("move",S.originalEvent);for(const Y in o){const{originalEvent:nt}=o[Y];this._fireEvent(Y,nt)}const N={};let P;for(const Y in this._eventsInProgress){const{handlerName:nt,originalEvent:dt}=this._eventsInProgress[Y];this._handlersById[nt].isActive()||(delete this._eventsInProgress[Y],P=f[nt]||dt,N[`${Y}end`]=P)}for(const Y in N)this._fireEvent(Y,N[Y]);const Z=xo(this._eventsInProgress);if(_&&(w||S)&&!Z){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),nt=dt=>dt!==0&&-this._bearingSnap<dt&&dt<this._bearingSnap;Y?(nt(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:P})):(this._map.fire(new h.Event("moveend",{originalEvent:P})),nt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,f){this._map.fire(new h.Event(o,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((o=>{this._frameId=void 0,this.handleEvent(new Al("renderFrame",{timeStamp:o})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const hl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class dc extends h.Evented{constructor(o,f){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=f.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}getCenter(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,f){return this.jumpTo({center:o},f)}panBy(o,f,_){return o=h.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,h.extend({offset:o},f),_)}panTo(o,f,_){return this.easeTo(h.extend({center:o},f),_)}getZoom(){return this.transform.zoom}setZoom(o,f){return this.jumpTo({zoom:o},f),this}zoomTo(o,f,_){return this.easeTo(h.extend({zoom:o},f),_)}zoomIn(o,f){return this.zoomTo(this.getZoom()+1,o,f),this}zoomOut(o,f){return this.zoomTo(this.getZoom()-1,o,f),this}getBearing(){return this.transform.bearing}setBearing(o,f){return this.jumpTo({bearing:o},f),this}getPadding(){return this.transform.padding}setPadding(o,f){return this.jumpTo({padding:o},f),this}rotateTo(o,f,_){return this.easeTo(h.extend({bearing:o},f),_)}resetNorth(o,f){return this.rotateTo(0,h.extend({duration:1e3},o),f),this}resetNorthPitch(o,f){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},o),f),this}snapToNorth(o,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,f):this}getPitch(){return this.transform.pitch}setPitch(o,f){return this.jumpTo({pitch:o},f),this}cameraForBounds(o,f){o=h.LngLatBounds.convert(o);const _=f&&f.bearing||0,w=o.getNorthWest(),S=o.getSouthEast();return this._cameraForBounds(this.transform,w,S,_,f)}_extendCameraOptions(o){const f={top:0,bottom:0,right:0,left:0};if(typeof(o=h.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const _=o.padding;o.padding={top:_,bottom:_,right:_,left:_}}return o.padding=h.extend(f,o.padding),o}_minimumAABBFrustumDistance(o,f){const _=f.max[0]-f.min[0],w=f.max[1]-f.min[1];return _/w>o.aspect?_/(2*Math.tan(.5*o.fovX)*o.aspect):w/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,f,_,w,S){const L=o.clone(),N=this._extendCameraOptions(S);L.bearing=w;const P=h.LngLat.convert(f),Z=h.LngLat.convert(_),Y=.5*(P.lat+Z.lat),nt=.5*(P.lng+Z.lng),dt=h.latLngToECEF(Y,nt),Et=h.normalize([],dt),xt=h.normalize([],h.cross([],Et,[0,1,0])),Mt=h.cross([],xt,Et),St=[xt[0],xt[1],xt[2],0,Mt[0],Mt[1],Mt[2],0,Et[0],Et[1],Et[2],0,0,0,0,1],vt=[dt,h.latLngToECEF(P.lat,P.lng),h.latLngToECEF(Z.lat,P.lng),h.latLngToECEF(Z.lat,Z.lng),h.latLngToECEF(P.lat,Z.lng),h.latLngToECEF(Y,P.lng),h.latLngToECEF(Y,Z.lng),h.latLngToECEF(P.lat,nt),h.latLngToECEF(Z.lat,nt)];let Rt=h.Aabb.fromPoints(vt.map((an=>[h.dot(xt,an),h.dot(Mt,an),h.dot(Et,an)])));const Tt=h.transformMat4([],Rt.center,St);h.squaredLength(Tt)===0&&h.set(Tt,0,0,1),h.normalize(Tt,Tt),h.scale$2(Tt,Tt,h.GLOBE_RADIUS),L.center=h.ecefToLatLng(Tt);const Ut=L.getWorldToCameraMatrix(),Gt=h.invert(new Float64Array(16),Ut);Rt=h.Aabb.applyTransform(Rt,h.multiply([],Ut,St)),h.transformMat4(Tt,Tt,Ut);const Nt=.5*(Rt.max[2]-Rt.min[2]),jt=this._minimumAABBFrustumDistance(L,Rt),fe=h.scale$2([],[0,0,1],Nt),Ee=h.add(fe,Tt,fe),xe=jt+(L.pitch===0?0:h.distance(Tt,Ee)),We=L.globeCenterInViewSpace,ce=h.sub([],Tt,[We[0],We[1],We[2]]);h.normalize(ce,ce),h.scale$2(ce,ce,xe);const Ve=h.add([],Tt,ce);h.transformMat4(Ve,Ve,Gt);const Pe=h.earthRadius/h.GLOBE_RADIUS,ge=h.length(Ve),Qt=h.mercatorZfromAltitude(ge*Pe-h.earthRadius,0),fn=Math.min(L.zoomFromMercatorZAdjusted(Qt),N.maxZoom);return fn>.5*(h.GLOBE_ZOOM_THRESHOLD_MIN+h.GLOBE_ZOOM_THRESHOLD_MAX)?(L.setProjection({name:"mercator"}),L.zoom=fn,this._cameraForBounds(L,f,_,w,S)):{center:L.center,zoom:fn,bearing:w}}queryTerrainElevation(o,f){const _=this.transform.elevation;return _?(f=h.extend({},{exaggerated:!0},f),_.getAtPoint(h.MercatorCoordinate.fromLngLat(o),null,f.exaggerated)):null}_cameraForBounds(o,f,_,w,S){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,f,_,w,S);const L=o.clone(),N=this._extendCameraOptions(S),P=L.padding;L.bearing=w;const Z=h.LngLat.convert(f),Y=h.LngLat.convert(_),nt=new h.LngLat(Z.lng,Y.lat),dt=new h.LngLat(Y.lng,Z.lat),Et=L.project(Z),xt=L.project(Y),Mt=this.queryTerrainElevation(Z),St=this.queryTerrainElevation(Y),vt=this.queryTerrainElevation(nt),Rt=this.queryTerrainElevation(dt),Tt=[[Et.x,Et.y,Math.min(Mt||0,St||0,vt||0,Rt||0)],[xt.x,xt.y,Math.max(Mt||0,St||0,vt||0,Rt||0)]];let Ut=h.Aabb.fromPoints(Tt);const Gt=L.getWorldToCameraMatrix(),Nt=h.invert(new Float64Array(16),Gt);Ut=h.Aabb.applyTransform(Ut,Gt);const jt=h.sub([],Ut.max,Ut.min),fe=P.left||0,Ee=P.right||0,xe=P.bottom||0,We=P.top||0,{left:ce,right:Ve,top:Pe,bottom:ge}=N.padding,Qt=.5*(fe+Ee),fn=.5*(We+xe),an=Math.min(L.scaleZoom(L.scale*Math.min((L.width-(fe+Ee+ce+Ve))/jt[0],(L.height-(xe+We+ge+Pe))/jt[1])),N.maxZoom),Fe=L.scale/L.zoomScale(an);Ut=new h.Aabb([Ut.min[0]-(ce+Qt)*Fe,Ut.min[1]-(ge+fn)*Fe,Ut.min[2]],[Ut.max[0]+(Ve+Qt)*Fe,Ut.max[1]+(Pe+fn)*Fe,Ut.max[2]]);const Xe=.5*jt[2],pn=this._minimumAABBFrustumDistance(L,Ut),Vn=[0,0,1,0];h.transformMat4$1(Vn,Vn,Gt),h.normalize$2(Vn,Vn);const Gn=h.scale$2([],Vn,pn+Xe),Un=h.add([],Ut.center,Gn),tn=(typeof N.offset.x=="number"&&typeof N.offset.y=="number"?new h.pointGeometry(N.offset.x,N.offset.y):h.pointGeometry.convert(N.offset)).rotate(-h.degToRad(w));Ut.center[0]-=tn.x*Fe,Ut.center[1]+=tn.y*Fe,h.transformMat4(Ut.center,Ut.center,Nt),h.transformMat4(Un,Un,Nt);const ii=[Ut.center[0],Ut.center[1],Un[2]*L.pixelsPerMeter];h.scale$2(ii,ii,1/L.worldSize);const di=h.lngFromMercatorX(ii[0]),Er=h.latFromMercatorY(ii[1]),pi=Math.min(L._zoomFromMercatorZ(ii[2]),N.maxZoom),ar=new h.LngLat(di,Er);return L.mercatorFromTransition&&pi<.5*(h.GLOBE_ZOOM_THRESHOLD_MIN+h.GLOBE_ZOOM_THRESHOLD_MAX)?(L.setProjection({name:"globe"}),L.zoom=pi,this._cameraForBounds(L,f,_,w,S)):{center:ar,zoom:pi,bearing:w}}fitBounds(o,f,_){const w=this.cameraForBounds(o,f);return this._fitInternal(w,f,_)}fitScreenCoordinates(o,f,_,w,S){const L=h.pointGeometry.convert(o),N=h.pointGeometry.convert(f),P=new h.pointGeometry(Math.min(L.x,N.x),Math.min(L.y,N.y)),Z=new h.pointGeometry(Math.max(L.x,N.x),Math.max(L.y,N.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(L,N))return this;const Y=this.transform.pointLocation3D(P),nt=this.transform.pointLocation3D(Z),dt=this.transform.pointLocation3D(new h.pointGeometry(P.x,Z.y)),Et=this.transform.pointLocation3D(new h.pointGeometry(Z.x,P.y)),xt=[Math.min(Y.lng,nt.lng,dt.lng,Et.lng),Math.min(Y.lat,nt.lat,dt.lat,Et.lat)],Mt=[Math.max(Y.lng,nt.lng,dt.lng,Et.lng),Math.max(Y.lat,nt.lat,dt.lat,Et.lat)],St=this._cameraForBounds(this.transform,xt,Mt,_,w);return this._fitInternal(St,w,S)}_fitInternal(o,f,_){return o?(delete(f=h.extend(o,f)).padding,f.linear?this.easeTo(f,_):this.flyTo(f,_)):this}jumpTo(o,f){this.stop();const _=o.preloadOnly?this.transform.clone():this.transform;let w=!1,S=!1,L=!1;return"zoom"in o&&_.zoom!==+o.zoom&&(w=!0,_.zoom=+o.zoom),o.center!==void 0&&(_.center=h.LngLat.convert(o.center)),"bearing"in o&&_.bearing!==+o.bearing&&(S=!0,_.bearing=+o.bearing),"pitch"in o&&_.pitch!==+o.pitch&&(L=!0,_.pitch=+o.pitch),o.padding==null||_.isPaddingEqual(o.padding)||(_.padding=o.padding),o.preloadOnly?(this._preloadTiles(_),this):(this.fire(new h.Event("movestart",f)).fire(new h.Event("move",f)),w&&this.fire(new h.Event("zoomstart",f)).fire(new h.Event("zoom",f)).fire(new h.Event("zoomend",f)),S&&this.fire(new h.Event("rotatestart",f)).fire(new h.Event("rotate",f)).fire(new h.Event("rotateend",f)),L&&this.fire(new h.Event("pitchstart",f)).fire(new h.Event("pitch",f)).fire(new h.Event("pitchend",f)),this.fire(new h.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||h.warnOnce(hl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,f){const _=this.transform;if(!_.projection.supportsFreeCamera)return h.warnOnce(hl),this;this.stop();const w=_.zoom,S=_.pitch,L=_.bearing;_.setFreeCameraOptions(o);const N=w!==_.zoom,P=S!==_.pitch,Z=L!==_.bearing;return this.fire(new h.Event("movestart",f)).fire(new h.Event("move",f)),N&&this.fire(new h.Event("zoomstart",f)).fire(new h.Event("zoom",f)).fire(new h.Event("zoomend",f)),Z&&this.fire(new h.Event("rotatestart",f)).fire(new h.Event("rotate",f)).fire(new h.Event("rotateend",f)),P&&this.fire(new h.Event("pitchstart",f)).fire(new h.Event("pitch",f)).fire(new h.Event("pitchend",f)),this.fire(new h.Event("moveend",f)),this}easeTo(o,f){this._stop(!1,o.easeId),((o=h.extend({offset:[0,0],duration:500,easing:h.ease},o)).animate===!1||!o.essential&&h.exported.prefersReducedMotion)&&(o.duration=0);const _=this.transform,w=this.getZoom(),S=this.getBearing(),L=this.getPitch(),N=this.getPadding(),P="zoom"in o?+o.zoom:w,Z="bearing"in o?this._normalizeBearing(o.bearing,S):S,Y="pitch"in o?+o.pitch:L,nt="padding"in o?o.padding:_.padding,dt=h.pointGeometry.convert(o.offset);let Et,xt,Mt;if(_.projection.name==="globe"){const Ee=h.MercatorCoordinate.fromLngLat(_.center),xe=dt.rotate(-_.angle);Ee.x+=xe.x/_.worldSize,Ee.y+=xe.y/_.worldSize;const We=Ee.toLngLat(),ce=h.LngLat.convert(o.center||We);this._normalizeCenter(ce),Et=_.centerPoint.add(xe),xt=new h.pointGeometry(Ee.x,Ee.y).mult(_.worldSize),Mt=new h.pointGeometry(h.mercatorXfromLng(ce.lng),h.mercatorYfromLat(ce.lat)).mult(_.worldSize).sub(xt)}else{Et=_.centerPoint.add(dt);const Ee=_.pointLocation(Et),xe=h.LngLat.convert(o.center||Ee);this._normalizeCenter(xe),xt=_.project(Ee),Mt=_.project(xe).sub(xt)}const St=_.zoomScale(P-w);let vt,Rt;o.around&&(vt=h.LngLat.convert(o.around),Rt=_.locationPoint(vt));const Tt=this._zooming||P!==w,Ut=this._rotating||S!==Z,Gt=this._pitching||Y!==L,Nt=!_.isPaddingEqual(nt),jt=Ee=>xe=>{if(Tt&&(Ee.zoom=h.number(w,P,xe)),Ut&&(Ee.bearing=h.number(S,Z,xe)),Gt&&(Ee.pitch=h.number(L,Y,xe)),Nt&&(Ee.interpolatePadding(N,nt,xe),Et=Ee.centerPoint.add(dt)),vt)Ee.setLocationAtPoint(vt,Rt);else{const We=Ee.zoomScale(Ee.zoom-w),ce=P>w?Math.min(2,St):Math.max(.5,St),Ve=Math.pow(ce,1-xe),Pe=Ee.unproject(xt.add(Mt.mult(xe*Ve)).mult(We));Ee.setLocationAtPoint(Ee.renderWorldCopies?Pe.wrap():Pe,Et)}return o.preloadOnly||this._fireMoveEvents(f),Ee};if(o.preloadOnly){const Ee=this._emulate(jt,o.duration,_);return this._preloadTiles(Ee),this}const fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Tt,this._rotating=Ut,this._pitching=Gt,this._padding=Nt,this._easeId=o.easeId,this._prepareEase(f,o.noMoveStart,fe),this._ease(jt(_),(Ee=>{_.recenterOnTerrain(),this._afterEase(f,Ee)}),o),this}_prepareEase(o,f,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||_.moving||this.fire(new h.Event("movestart",o)),this._zooming&&!_.zooming&&this.fire(new h.Event("zoomstart",o)),this._rotating&&!_.rotating&&this.fire(new h.Event("rotatestart",o)),this._pitching&&!_.pitching&&this.fire(new h.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new h.Event("move",o)),this._zooming&&this.fire(new h.Event("zoom",o)),this._rotating&&this.fire(new h.Event("rotate",o)),this._pitching&&this.fire(new h.Event("pitch",o))}_afterEase(o,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new h.Event("zoomend",o)),w&&this.fire(new h.Event("rotateend",o)),S&&this.fire(new h.Event("pitchend",o)),this.fire(new h.Event("moveend",o))}flyTo(o,f){if(!o.essential&&h.exported.prefersReducedMotion){const Fe=h.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Fe,f)}this.stop(),o=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},o);const _=this.transform,w=this.getZoom(),S=this.getBearing(),L=this.getPitch(),N=this.getPadding(),P="zoom"in o?h.clamp(+o.zoom,_.minZoom,_.maxZoom):w,Z="bearing"in o?this._normalizeBearing(o.bearing,S):S,Y="pitch"in o?+o.pitch:L,nt="padding"in o?o.padding:_.padding,dt=_.zoomScale(P-w),Et=h.pointGeometry.convert(o.offset);let xt=_.centerPoint.add(Et);const Mt=_.pointLocation(xt),St=h.LngLat.convert(o.center||Mt);this._normalizeCenter(St);const vt=_.project(Mt),Rt=_.project(St).sub(vt);let Tt=o.curve;const Ut=Math.max(_.width,_.height),Gt=Ut/dt,Nt=Rt.mag();if("minZoom"in o){const Fe=h.clamp(Math.min(o.minZoom,w,P),_.minZoom,_.maxZoom),Xe=Ut/_.zoomScale(Fe-w);Tt=Math.sqrt(Xe/Nt*2)}const jt=Tt*Tt;function fe(Fe){const Xe=(Gt*Gt-Ut*Ut+(Fe?-1:1)*jt*jt*Nt*Nt)/(2*(Fe?Gt:Ut)*jt*Nt);return Math.log(Math.sqrt(Xe*Xe+1)-Xe)}function Ee(Fe){return(Math.exp(Fe)-Math.exp(-Fe))/2}function xe(Fe){return(Math.exp(Fe)+Math.exp(-Fe))/2}const We=fe(0);let ce=function(Fe){return xe(We)/xe(We+Tt*Fe)},Ve=function(Fe){return Ut*((xe(We)*(Ee(Xe=We+Tt*Fe)/xe(Xe))-Ee(We))/jt)/Nt;var Xe},Pe=(fe(1)-We)/Tt;if(Math.abs(Nt)<1e-6||!isFinite(Pe)){if(Math.abs(Ut-Gt)<1e-6)return this.easeTo(o,f);const Fe=Gt<Ut?-1:1;Pe=Math.abs(Math.log(Gt/Ut))/Tt,Ve=function(){return 0},ce=function(Xe){return Math.exp(Fe*Tt*Xe)}}o.duration="duration"in o?+o.duration:1e3*Pe/("screenSpeed"in o?+o.screenSpeed/Tt:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const ge=S!==Z,Qt=Y!==L,fn=!_.isPaddingEqual(nt),an=Fe=>Xe=>{const pn=Xe*Pe,Vn=1/ce(pn);Fe.zoom=Xe===1?P:w+Fe.scaleZoom(Vn),ge&&(Fe.bearing=h.number(S,Z,Xe)),Qt&&(Fe.pitch=h.number(L,Y,Xe)),fn&&(Fe.interpolatePadding(N,nt,Xe),xt=Fe.centerPoint.add(Et));const Gn=Xe===1?St:Fe.unproject(vt.add(Rt.mult(Ve(pn))).mult(Vn));return Fe.setLocationAtPoint(Fe.renderWorldCopies?Gn.wrap():Gn,xt),Fe._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(f),Fe};if(o.preloadOnly){const Fe=this._emulate(an,o.duration,_);return this._preloadTiles(Fe),this}return this._zooming=!0,this._rotating=ge,this._pitching=Qt,this._padding=fn,this._prepareEase(f,!1),this._ease(an(_),(()=>this._afterEase(f)),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,f)}if(!o){const _=this.handlers;_&&_.stop(!1)}return this}_ease(o,f,_){_.animate===!1||_.duration===0?(o(1),f()):(this._easeStart=h.exported.now(),this._easeOptions=_,this._onEaseFrame=o,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((h.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,f){o=h.wrap(o,-180,180);const _=Math.abs(o-f);return Math.abs(o-360-f)<_&&(o-=360),Math.abs(o+360-f)<_&&(o+=360),o}_normalizeCenter(o){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const _=o.lng-f.center.lng;o.lng+=_>180?-360:_<-180?360:0}_emulate(o,f,_){const w=Math.ceil(15*f/1e3),S=[],L=o(_.clone());for(let N=0;N<=w;N++){const P=L(N/w);S.push(P.clone())}return S}}class Rl{constructor(o={}){this.options=o,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const f=this.options&&this.options.compact;return this._map=o,this._container=At("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=At("button","mapboxgl-ctrl-attrib-button",this._container),At("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=At("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,f){const _=this._map._getUIString(`AttributionControl.${f}`);o.setAttribute("aria-label",_),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(o){const _=f.reduce(((w,S,L)=>(S.value&&(w+=`${S.key}=${S.value}${L<f.length-1?"&":""}`),w)),"?");o.href=`${h.config.FEEDBACK_URL}/${_}#${Il(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const f=this._map.style._sourceCaches;for(const w in f){const S=f[w];if(S.used){const L=S.getSource();L.attribution&&o.indexOf(L.attribution)<0&&o.push(L.attribution)}}o.sort(((w,S)=>w.length-S.length)),o=o.filter(((w,S)=>{for(let L=S+1;L<o.length;L++)if(o[L].indexOf(w)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const _=o.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,o.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ca{constructor(){h.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=At("div","mapboxgl-ctrl");const f=At("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const f in o){const _=o[f].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const f=o[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class pc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const f=++this._id;return this._queue.push({callback:o,id:f,cancelled:!1}),f}remove(o){const f=this._currentlyRunning,_=f?this._queue.concat(f):this._queue;for(const w of _)if(w.id===o)return void(w.cancelled=!0)}run(o=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const _ of f)if(!_.cancelled&&(_.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Gu(m,o,f){if(m=new h.LngLat(m.lng,m.lat),o){const _=new h.LngLat(m.lng-360,m.lat),w=new h.LngLat(m.lng+360,m.lat),S=360*Math.ceil(Math.abs(m.lng-f.center.lng)/360),L=f.locationPoint(m).distSqr(o),N=o.x<0||o.y<0||o.x>f.width||o.y>f.height;f.locationPoint(_).distSqr(o)<L&&(N||Math.abs(_.lng-f.center.lng)<S)?m=_:f.locationPoint(w).distSqr(o)<L&&(N||Math.abs(w.lng-f.center.lng)<S)&&(m=w)}for(;Math.abs(m.lng-f.center.lng)>180;){const _=f.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=f.width&&_.y<=f.height)break;m.lng>f.center.lng?m.lng-=360:m.lng+=360}return m}const gc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Bi extends h.Evented{constructor(o,f){if(super(),(o instanceof h.window.HTMLElement||f)&&(o=h.extend({element:o},f)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=h.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=At("div");const w=41,S=27,L=yt("svg",{display:"block",height:w*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${w}`},this._element),N=yt("radialGradient",{id:"shadowGradient"},yt("defs",{},L));yt("stop",{offset:"10%","stop-opacity":.4},N),yt("stop",{offset:"100%","stop-opacity":.05},N),yt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},L),yt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},L),yt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},L),yt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},L),this._offset=h.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(w=>{w.preventDefault()})),this._element.addEventListener("mousedown",(w=>{w.preventDefault()}));const _=this._element.classList;for(const w in gc)_.remove(`mapboxgl-marker-anchor-${w}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=h.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const f=o.code,_=o.charCode||o.keyCode;f!=="Space"&&f!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(o){const f=o.originalEvent.target,_=this._element;this._popup&&(f===_||_.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,f=this._pos;if(!o||!f)return!1;const _=o.unproject(f),w=o.getFreeCameraOptions();if(!w.position)return!1;const S=w.position.toLngLat();return S.distanceTo(_)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const f=this._pos;if(!f||f.x<0||f.x>o.transform.width||f.y<0||f.y>o.transform.height)return void this._clearFadeTimer();const _=o.unproject(f);let w;o._showingGlobe()&&h.isLngLatBehindGlobe(o.transform,this._lngLat)?w=0:(w=1-o._queryFogOpacity(_),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${gc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const o=this._pos,f=this._map,_=this.getPitchAlignment();if(!f||!o||_!=="map")return"";if(!f._showingGlobe()){const P=f.getPitch();return P?`rotateX(${P}deg)`:""}const w=h.radToDeg(h.globeTiltAtLngLat(f.transform,this._lngLat)),S=o.sub(h.globeCenterToScreenPoint(f.transform)),L=Math.abs(S.x)+Math.abs(S.y);if(L===0)return"";const N=w/L;return`rotateX(${-S.y*N}deg) rotateY(${S.x*N}deg)`}_calculateZTransform(){const o=this._pos,f=this._map;if(!f||!o)return"";let _=0;const w=this.getRotationAlignment();if(w==="map")if(f._showingGlobe()){const S=f.project(new h.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),L=f.project(new h.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);_=h.radToDeg(Math.atan2(L.y,L.x))-90}else _=-f.getBearing();else if(w==="horizon"){const S=h.smoothstep(4,6,f.getZoom()),L=h.globeCenterToScreenPoint(f.transform);L.y+=S*f.transform.height;const N=o.sub(L),P=h.radToDeg(Math.atan2(N.y,N.x));_=(P>90?P-270:P+90)*(1-S)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(o){h.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=Gu(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),o===!0?this._updateFrameId=h.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),f._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(o){return this._offset=h.pointGeometry.convert(o),this._update(),this}_onMove(o){const f=this._map;if(!f)return;const _=this._pointerdownPos,w=this._positionDelta;if(_&&w){if(!this._isDragging){const S=this._clickTolerance||f._clickTolerance;if(o.point.dist(_)<S)return;this._isDragging=!0}this._pos=o.point.sub(w),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"}_addDragHandler(o){const f=this._map,_=this._pos;f&&_&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(_),this._pointerdownPos=o.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const f=this._map;return f&&(o?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ks={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},nc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function fl(m=new h.pointGeometry(0,0),o="bottom"){if(typeof m=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(o){case"top":return new h.pointGeometry(0,m);case"top-left":return new h.pointGeometry(f,f);case"top-right":return new h.pointGeometry(-f,f);case"bottom":return new h.pointGeometry(0,-m);case"bottom-left":return new h.pointGeometry(f,-f);case"bottom-right":return new h.pointGeometry(-f,-f);case"left":return new h.pointGeometry(m,0);case"right":return new h.pointGeometry(-m,0)}return new h.pointGeometry(0,0)}return m instanceof h.pointGeometry||Array.isArray(m)?h.pointGeometry.convert(m):h.pointGeometry.convert(m[o]||[0,0])}class ic{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const f=h.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,f,_){this._start=this.getValue(f),this._end=o,this._startTime=f,this._endTime=f+_}}const dl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Eu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Dl(m){m.parentNode&&m.parentNode.removeChild(m)}const Va={showCompass:!0,showZoom:!0,visualizePitch:!1};class Vu{constructor(o,f,_=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new lo({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,_&&(this.mousePitch=new No({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(o,f){this.mouseRotate.mousedown(o,f),this.mousePitch&&this.mousePitch.mousedown(o,f),Ft()}move(o,f){const _=this.map,w=this.mouseRotate.mousemoveWindow(o,f),S=w&&w.bearingDelta;if(S&&_.setBearing(_.getBearing()+S),this.mousePitch){const L=this.mousePitch.mousemoveWindow(o,f),N=L&&L.pitchDelta;N&&_.setPitch(_.getPitch()+N)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){lt(),h.window.removeEventListener("mousemove",this.mousemove),h.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(h.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Dt(this.element,o)),h.window.addEventListener("mousemove",this.mousemove),h.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,Dt(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_t(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=_t(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Pc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},qa={maxWidth:100,unit:"metric"};function tu(m,o,f){const _=Nl(o),w=_/o,S={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[f];this._map._requestDomTask((()=>{this._container.style.width=m*w+"px",this._container.innerHTML=`${_}&nbsp;${S}`}))}function Nl(m){const o=Math.pow(10,`${Math.floor(m)}`.length-1);let f=m/o;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:f>=1?1:(function(_){const w=Math.pow(10,Math.ceil(-Math.log(_)/Math.LN10));return Math.round(_*w)/w})(f),o*f}const eu={version:h.version,supported:tt,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:class extends dc{constructor(m){if(h.LivePerformanceUtils.mark(h.PerformanceMarkers.create),(m=h.extend({},Eu,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&h.isSafariWithAntialiasingBug(h.window)&&(m.antialias=!1,h.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new qs(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new pc,this._domRenderTaskQueue=new pc,this._controls=[],this._markers=[],this._popups=[],this._mapId=h.uniqueId(),this._locale=h.extend({},dl,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ic(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new h.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=h.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof h.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&h.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),h.window!==void 0&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1),h.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),h.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ll(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new js(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,h.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new Rl({customAttribution:m.customAttribution})),this._logoControl=new Ca,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(o=>{this._update(o.dataType==="style"),this.fire(new h.Event(`${o.dataType}data`,o))})),this.on("dataloading",(o=>{this.fire(new h.Event(`${o.dataType}dataloading`,o))}))}_getMapId(){return this._mapId}addControl(m,o){if(o===void 0&&(o=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=m.onAdd(this);this._controls.push(m);const _=this._controlPositions[o];return o.indexOf("bottom")!==-1?_.insertBefore(f,_.firstChild):_.appendChild(f),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(m);return o>-1&&this._controls.splice(o,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),this.fire(new h.Event("resize",m)),o&&this.fire(new h.Event("moveend",m)),this}getBounds(){return this.transform.projection.name==="globe"&&h.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly when viewing the poles."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(h.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new h.Event("zoomstart")).fire(new h.Event("zoom")).fire(new h.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new h.Event("zoomstart")).fire(new h.Event("zoom")).fire(new h.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new h.Event("pitchstart")).fire(new h.Event("pitch")).fire(new h.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new h.Event("pitchstart")).fire(new h.Event("pitch")).fire(new h.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?h.window.navigator.language:Array.isArray(m)?m.length===0?void 0:m.map((o=>o==="auto"?h.window.navigator.language:o)):m}setLanguage(m){const o=this._parseLanguage(m);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,o=m.projection.name;let f;o==="globe"&&m.zoom>=h.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),f=!0):o==="mercator"&&m.zoom<h.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,o){return this._updateProjection(m||o||{name:"mercator"})}_updateProjection(m){let o;if(o=m.name==="globe"&&this.transform.zoom>=h.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const f in this.style._sourceCaches)this.style._sourceCaches[f].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(h.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(h.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(m,o,f){if(m==="mouseenter"||m==="mouseover"){let _=!1;const w=L=>{const N=o.filter((Z=>this.getLayer(Z))),P=N.length?this.queryRenderedFeatures(L.point,{layers:N}):[];P.length?_||(_=!0,f.call(this,new Cr(m,this,L.originalEvent,{features:P}))):_=!1},S=()=>{_=!1};return{layers:new Set(o),listener:f,delegates:{mousemove:w,mouseout:S}}}if(m==="mouseleave"||m==="mouseout"){let _=!1;const w=L=>{const N=o.filter((P=>this.getLayer(P)));(N.length?this.queryRenderedFeatures(L.point,{layers:N}):[]).length?_=!0:_&&(_=!1,f.call(this,new Cr(m,this,L.originalEvent)))},S=L=>{_&&(_=!1,f.call(this,new Cr(m,this,L.originalEvent)))};return{layers:new Set(o),listener:f,delegates:{mousemove:w,mouseout:S}}}{const _=w=>{const S=o.filter((N=>this.getLayer(N))),L=S.length?this.queryRenderedFeatures(w.point,{layers:S}):[];L.length&&(w.features=L,f.call(this,w),delete w.features)};return{layers:new Set(o),listener:f,delegates:{[m]:_}}}}on(m,o,f){if(f===void 0)return super.on(m,o);Array.isArray(o)||(o=[o]);const _=this._createDelegatedListener(m,o,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(const w in _.delegates)this.on(w,_.delegates[w]);return this}once(m,o,f){if(f===void 0)return super.once(m,o);Array.isArray(o)||(o=[o]);const _=this._createDelegatedListener(m,o,f);for(const w in _.delegates)this.once(w,_.delegates[w]);return this}off(m,o,f){if(f===void 0)return super.off(m,o);o=new Set(Array.isArray(o)?o:[o]);const _=(S,L)=>{if(S.size!==L.size)return!1;for(const N of S)if(!L.has(N))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[m]:void 0;return w&&(S=>{for(let L=0;L<S.length;L++){const N=S[L];if(N.listener===f&&_(N.layers,o)){for(const P in N.delegates)this.off(P,N.delegates[P]);return S.splice(L,1),this}}})(w),this}queryRenderedFeatures(m,o){return this.style?(o!==void 0||m===void 0||m instanceof h.pointGeometry||Array.isArray(m)||(o=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(m,o){return this.style.querySourceFeatures(m,o)}setStyle(m,o){return(o=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(m,o))}_getUIString(m){const o=this._locale[m];if(o==null)throw new Error(`Missing UI string '${m}'`);return o}_updateStyle(m,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new Os(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Os(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,o){if(typeof m=="string"){const f=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(f,h.ResourceType.Style);h.getJSON(_,((w,S)=>{w?this.fire(new h.ErrorEvent(w)):S&&this._updateDiff(S,o)}))}else typeof m=="object"&&this._updateDiff(m,o)}_updateDiff(m,o){try{this.style.setState(m)&&this._update(!0)}catch(f){h.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(m,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(h.warnOnce("There is no style added to the map."),!1)}addSource(m,o){return this._lazyInitEmptyStyle(),this.style.addSource(m,o),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const o in m){const f=m[o]._tiles;for(const _ in f){const w=f[_];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(m,o,f){this._lazyInitEmptyStyle(),this.style.addSourceType(m,o,f)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,o,{pixelRatio:f=1,sdf:_=!1,stretchX:w,stretchY:S,content:L}={}){if(this._lazyInitEmptyStyle(),o instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&o instanceof h.window.ImageBitmap){const{width:N,height:P,data:Z}=h.exported.getImageData(o);this.style.addImage(m,{data:new h.RGBAImage({width:N,height:P},Z),pixelRatio:f,stretchX:w,stretchY:S,content:L,sdf:_,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:N,height:P}=o,Z=o;this.style.addImage(m,{data:new h.RGBAImage({width:N,height:P},new Uint8Array(Z.data)),pixelRatio:f,stretchX:w,stretchY:S,content:L,sdf:_,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,m)}}updateImage(m,o){const f=this.style.getImage(m);if(!f)return void this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=o instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&o instanceof h.window.ImageBitmap?h.exported.getImageData(o):o,{width:w,height:S}=_;w!==void 0&&S!==void 0?w===f.data.width&&S===f.data.height?(f.data.replace(_.data,!(o instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&o instanceof h.window.ImageBitmap)),this.style.updateImage(m,f)):this.fire(new h.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${S})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`))):this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,o){h.getImage(this._requestManager.transformRequest(m,h.ResourceType.Image),((f,_)=>{o(f,_ instanceof h.window.HTMLImageElement?h.exported.getImageData(_):_)}))}listImages(){return this.style.listImages()}addLayer(m,o){return this._lazyInitEmptyStyle(),this.style.addLayer(m,o),this._update(!0)}moveLayer(m,o){return this.style.moveLayer(m,o),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,o,f){return this.style.setLayerZoomRange(m,o,f),this._update(!0)}setFilter(m,o,f={}){return this.style.setFilter(m,o,f),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,o,f,_={}){return this.style.setPaintProperty(m,o,f,_),this._update(!0)}getPaintProperty(m,o){return this.style.getPaintProperty(m,o)}setLayoutProperty(m,o,f,_={}){return this.style.setLayoutProperty(m,o,f,_),this._update(!0)}getLayoutProperty(m,o){return this.style.getLayoutProperty(m,o)}setLight(m,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(h.LngLat.convert(m),this.transform):0}setFeatureState(m,o){return this.style.setFeatureState(m,o),this._update()}removeFeatureState(m,o){return this.style.removeFeatureState(m,o),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let f,_,w,S=this._container;for(;S&&(!_||!w);){const L=h.window.getComputedStyle(S).transform;L&&L!=="none"&&(f=L.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(_=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(w=f[3])),S=S.parentElement}this._containerWidth=_?Math.abs(m/_):m,this._containerHeight=w?Math.abs(o/w):o}_detectMissingCSS(){h.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&h.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=At("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=At("div","mapboxgl-canvas-container",m);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=At("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=At("div","mapboxgl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((w=>{_[w]=At("div",`mapboxgl-ctrl-${w}`,f)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,o){const f=h.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(m),this._canvas.height=f*Math.ceil(o),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${o}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const o=this._markers.indexOf(m);o!==-1&&this._markers.splice(o,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const o=this._popups.indexOf(m);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const m=h.extend({},tt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);o?(h.storeAuthState(o,!0),this.painter=new Fu(o,this.transform),this.on("data",(f=>{f.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),h.exported$1.testSupport(o)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let o;const f=this.painter.context.extTimerQuery,_=h.exported.now();if(this.listens("gpu-timing-frame")&&(o=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],h.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],h.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();let w=!1;const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,Z=this.transform.pitch,Y=h.exported.now();this.style.zoomHistory.update(P,Y);const nt=new h.EvaluationParameters(P,{now:Y,fadeDuration:S,pitch:Z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),dt=nt.crossFadingFactor();dt===1&&dt===this._crossFadingFactor||(w=!0,this._crossFadingFactor=dt),this.style.update(nt)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let L=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),L=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):L=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||w)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const P=h.exported.now()-_;f.endQueryEXT(f.TIME_ELAPSED_EXT,o),setTimeout((()=>{const Z=f.getQueryObjectEXT(o,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(o),this.fire(new h.Event("gpu-timing-frame",{cpuTime:P,gpuTime:Z})),h.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:Z}})}),50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout((()=>{const Z=this.painter.queryGpuTimers(P);this.fire(new h.Event("gpu-timing-layer",{layerTimes:Z}))}),50)}if(this.listens("gpu-timing-deferred-render")){const P=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const Z=this.painter.queryGpuTimeDeferredRender(P);this.fire(new h.Event("gpu-timing-deferred-render",{gpuTime:Z}))}),50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||L;if(N||this._repaint)this.triggerRepaint();else{const P=!this.isMoving()&&this.loaded();if(P&&(L=this._updateAverageElevation(_,!0)),L)this.triggerRepaint();else if(this._triggerFrame(!1),P&&(this.fire(new h.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Z=this._calculateSpeedIndex();this.fire(new h.Event("speedindexcompleted",{speedIndex:Z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,h.LivePerformanceUtils.mark(h.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&h.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.painter.transform.projection,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const o of this._markers)m&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!m||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(m,o=!1){const f=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((o||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const _=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),S=!1;this.transform.elevation&&(S=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=m;const L=Math.abs(_-w);if(L>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(w),f(w);this._averageElevation.easeTo(w,m,300)}else if(L>1e-4)return this._averageElevation.jumpTo(w),f(w)}return!!this._averageElevation.isEasing(m)&&f(this._averageElevation.getValue(m))}_authenticate(){h.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(m=>{if(m&&(m.message===h.AUTH_ERR_MSG||m.status===401)){const o=this.painter.context.gl;h.storeAuthState(o,!1),this._logoControl instanceof Ca&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new h.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),h.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const f=this.painter.context.gl,_=f.createFramebuffer();function w(S){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,S,0);const L=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,L),L}return f.bindFramebuffer(f.FRAMEBUFFER,_),this._canvasPixelComparison(w(m),o.canvasCopies.map(w),o.timeStamps)}_canvasPixelComparison(m,o,f){let _=f[1]-f[0];const w=m.length/4;for(let S=0;S<o.length;S++){const L=o[S];let N=0;for(let P=0;P<L.length;P+=4)L[P]===m[P]&&L[P+1]===m[P+1]&&L[P+2]===m[P+2]&&L[P+3]===m[P+3]&&(N+=1);_+=(f[S+2]-f[S+1])*(1-N/w)}return _}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),h.window!==void 0&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1),h.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),Dl(this._canvasContainer),Dl(this._controlContainer),Dl(this._missingCSSCanary),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),h.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new h.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=h.exported.frame((o=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(o)})))}_preloadTiles(m){const o=this.style?Object.values(this.style._sourceCaches):[];return h.asyncAll(o,((f,_)=>f._preloadTiles(m,_)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){h.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,o){h.setCacheLimits(m,o)}get version(){return h.version}},NavigationControl:class{constructor(m){this.options=h.extend({},Va,m),this._container=At("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(o=>{this._map&&this._map.zoomIn({},{originalEvent:o})})),At("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(o=>{this._map&&this._map.zoomOut({},{originalEvent:o})})),At("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(o=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:o}):f.resetNorth({},{originalEvent:o}))})),this._compassIcon=At("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const o=m.getZoom(),f=o===m.getMaxZoom(),_=o===m.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=o)}))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vu(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,o){const f=At("button",m,this._container);return f.type="button",f.addEventListener("click",o),f}_setButtonTitle(m,o){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${o}`);m.setAttribute("aria-label",f),m.firstElementChild&&m.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends h.Evented{constructor(m){super(),this.options=h.extend({geolocation:h.window.navigator.geolocation},Pc,m),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=tc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=At("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const o=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,m(f)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):h.window.navigator.permissions!==void 0?h.window.navigator.permissions.query({name:"geolocation"}).then((f=>o(f.state!=="denied"))).catch((()=>o())):o()}_isOutOfMapMaxBounds(m){const o=this._map.getMaxBounds(),f=m.coords;return!!o&&(f.longitude<o.getWest()||f.longitude>o.getEast()||f.latitude<o.getSouth()||f.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",m)),this._finish()}}_updateCamera(m){const o=new h.LngLat(m.coords.longitude,m.coords.latitude),f=m.coords.accuracy,_=this._map.getBearing(),w=h.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(f),w,{geolocateSource:!0})}_updateMarker(m){if(m){const o=new h.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,o=h.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,f=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this._geolocateButton=At("button","mapboxgl-ctrl-geolocate",this._container),At("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=At("div","mapboxgl-user-location"),this._dotElement.appendChild(At("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(At("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Bi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=At("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new h.Event("trackuserlocationend")))}))}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{h.window.addEventListener("ondeviceorientationabsolute"in h.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};h.window.DeviceMotionEvent!==void 0&&typeof h.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((o=>{o==="granted"&&m()})).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),h.window.removeEventListener("deviceorientation",this._onDeviceOrientation),h.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Rl,ScaleControl:class{constructor(m){this.options=h.extend({},qa,m),(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}})()||(this._setScale=tu.bind(this)),h.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,o=this._map,f=o._containerHeight/2,_=o._containerWidth/2-m/2,w=o.unproject([_,f]),S=o.unproject([_+m,f]),L=w.distanceTo(S);if(this.options.unit==="imperial"){const N=3.2808*L;N>5280?this._setScale(m,N/5280,"mile"):this._setScale(m,N,"foot")}else this.options.unit==="nautical"?this._setScale(m,L/1852,"nautical-mile"):L>=1e3?this._setScale(m,L/1e3,"kilometer"):this._setScale(m,L,"meter")}_setScale(m,o,f){const _=Nl(o),w=_/o;this._map._requestDomTask((()=>{this._container.style.width=m*w+"px",this._container.innerHTML=f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:f}).format(_):`${_}&nbsp;nm`}))}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=At("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof h.window.HTMLElement?this._container=m.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in h.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=At("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!h.window.document.fullscreenEnabled&&!h.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=At("button","mapboxgl-ctrl-fullscreen",this._controlContainer);At("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(h.window.document.fullscreenElement||h.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends h.Evented{constructor(m){super(),this.options=h.extend(Object.create(Ks),m),h.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new h.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new h.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=h.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(h.window.document.createTextNode(m))}setHTML(m){const o=h.window.document.createDocumentFragment(),f=h.window.document.createElement("body");let _;for(f.innerHTML=m;_=f.firstChild,_;)o.appendChild(_);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=At("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(m),this.options.closeButton){const f=this._closeButton=At("button","mapboxgl-popup-close-button",o);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let o;return this._classList.delete(m)?o=!1:(this._classList.add(m),o=!0),this._updateClassList(),o}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const o=this._map,f=this._container,_=this._pos;if(!o||!f||!_)return"bottom";const w=f.offsetWidth,S=f.offsetHeight,L=_.x<w/2,N=_.x>o.transform.width-w/2;if(_.y+m<S)return L?"top-left":N?"top-right":"top";if(_.y>o.transform.height-S){if(L)return"bottom-left";if(N)return"bottom-right"}return L?"left":N?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),m.className=o.join(" ")}_update(m){const o=this._map,f=this._content;if(!o||!this._lngLat&&!this._trackPointer||!f)return;let _=this._container;if(_||(_=this._container=At("div","mapboxgl-popup",o.getContainer()),this._tip=At("div","mapboxgl-popup-tip",_),_.appendChild(f)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Gu(this._lngLat,this._pos,o.transform)),!this._trackPointer||m){const w=this._pos=this._trackPointer&&m?m:o.project(this._lngLat),S=fl(this.options.offset),L=this._anchor=this._getAnchor(S.y),N=fl(this.options.offset,L),P=w.add(N).round();o._requestDomTask((()=>{this._container&&L&&(this._container.style.transform=`${gc[L]} translate(${P.x}px,${P.y}px)`)}))}if(!this._marker&&o._showingGlobe()){const w=h.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(nc);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Bi,Style:Os,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.pointGeometry,MercatorCoordinate:h.MercatorCoordinate,FreeCameraOptions:Jl,Evented:h.Evented,config:h.config,prewarm:function(){Qn().acquire(Zn)},clearPrewarmedResources:function(){const m=Fn;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Zn),Fn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(m){h.config.ACCESS_TOKEN=m},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(m){h.config.API_URL=m},get workerCount(){return jn.workerCount},set workerCount(m){jn.workerCount=m},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){h.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){h.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:h.exported.setNow,restoreNow:h.exported.restoreNow};return eu}));var J=q;return J}))})(Am)),Am.exports}var Tx=L1();const Cx=rp(Tx),W_=Ls.createContext({}),R1=(B,V)=>{switch(V.type){case"setMap":return{...B,isMapReady:!0,map:V.payload};default:return B}};var Lm={exports:{}},D1=Lm.exports,Gv;function N1(){return Gv||(Gv=1,(function(B,V){(function(F,T){B.exports=T()})(D1,(function(){var F=function(R,H){var ft={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},Ht={on:function(pe,be,en){if(ft[pe]===void 0)throw new Error("Invalid event type: "+pe);ft[pe].push({selector:be,fn:en})},render:function(pe){H.store.featureChanged(pe)}},Ce=function(pe,be){for(var en=ft[pe],nn=en.length;nn--;){var wn=en[nn];if(wn.selector(be)){wn.fn.call(Ht,be)||H.store.render(),H.ui.updateMapClasses();break}}};return R.start.call(Ht),{render:R.render,stop:function(){R.stop&&R.stop()},trash:function(){R.trash&&(R.trash(),H.store.render())},combineFeatures:function(){R.combineFeatures&&R.combineFeatures()},uncombineFeatures:function(){R.uncombineFeatures&&R.uncombineFeatures()},drag:function(pe){Ce("drag",pe)},click:function(pe){Ce("click",pe)},mousemove:function(pe){Ce("mousemove",pe)},mousedown:function(pe){Ce("mousedown",pe)},mouseup:function(pe){Ce("mouseup",pe)},mouseout:function(pe){Ce("mouseout",pe)},keydown:function(pe){Ce("keydown",pe)},keyup:function(pe){Ce("keyup",pe)},touchstart:function(pe){Ce("touchstart",pe)},touchmove:function(pe){Ce("touchmove",pe)},touchend:function(pe){Ce("touchend",pe)},tap:function(pe){Ce("tap",pe)}}},T=6378137;function G(R){var H=0;if(R&&R.length>0){H+=Math.abs(q(R[0]));for(var ft=1;ft<R.length;ft++)H-=Math.abs(q(R[ft]))}return H}function q(R){var H,ft,Ht,Ce,pe,be,en=0,nn=R.length;if(nn>2){for(be=0;be<nn;be++)be===nn-2?(Ht=nn-2,Ce=nn-1,pe=0):be===nn-1?(Ht=nn-1,Ce=0,pe=1):(Ht=be,Ce=be+1,pe=be+2),H=R[Ht],ft=R[Ce],en+=(j(R[pe][0])-j(H[0]))*Math.sin(j(ft[1]));en=en*T*T/2}return en}function j(R){return R*Math.PI/180}var J={geometry:function R(H){var ft,Ht=0;switch(H.type){case"Polygon":return G(H.coordinates);case"MultiPolygon":for(ft=0;ft<H.coordinates.length;ft++)Ht+=G(H.coordinates[ft]);return Ht;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(ft=0;ft<H.geometries.length;ft++)Ht+=R(H.geometries[ft]);return Ht}},ring:q},h="mapboxgl-ctrl",X="mapbox-gl-draw_ctrl-draw-btn",tt="mapbox-gl-draw_line",ht="mapbox-gl-draw_polygon",st="mapbox-gl-draw_point",At="mapbox-gl-draw_trash",yt="mapbox-gl-draw_combine",it="mapbox-gl-draw_uncombine",ae="mapboxgl-ctrl-group",le="active",Ft="mapbox-gl-draw_boxselect",lt="mapbox-gl-draw-hot",pt="mapbox-gl-draw-cold",It="add",Dt="move",_t="drag",Jt="pointer",Xt="none",ie={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Yt="Feature",rt="Polygon",qe="LineString",Sn="Point",Xn="FeatureCollection",ct="Multi",kt="MultiPoint",ut="MultiLineString",ye="MultiPolygon",te={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},mt="draw.create",Zt="draw.delete",ve="draw.update",Be="draw.selectionchange",de="draw.modechange",On="draw.actionable",An="draw.render",$n="draw.combine",yi="draw.uncombine",Gi="move",jr="change_coordinates",Bn="feature",lr="midpoint",Fr="vertex",Mn="true",ui="false",Vl=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],mr={Point:0,LineString:1,Polygon:2};function _l(R,H){var ft=mr[R.geometry.type]-mr[H.geometry.type];return ft===0&&R.geometry.type===rt?R.area-H.area:ft}function vi(R){if(this._items={},this._nums={},this._length=R?R.length:0,R)for(var H=0,ft=R.length;H<ft;H++)this.add(R[H]),R[H]!==void 0&&(typeof R[H]=="string"?this._items[R[H]]=H:this._nums[R[H]]=H)}vi.prototype.add=function(R){return this.has(R)||(this._length++,typeof R=="string"?this._items[R]=this._length:this._nums[R]=this._length),this},vi.prototype.delete=function(R){return this.has(R)===!1||(this._length--,delete this._items[R],delete this._nums[R]),this},vi.prototype.has=function(R){return(typeof R=="string"||typeof R=="number")&&(this._items[R]!==void 0||this._nums[R]!==void 0)},vi.prototype.values=function(){var R=this,H=[];return Object.keys(this._items).forEach((function(ft){H.push({k:ft,v:R._items[ft]})})),Object.keys(this._nums).forEach((function(ft){H.push({k:JSON.parse(ft),v:R._nums[ft]})})),H.sort((function(ft,Ht){return ft.v-Ht.v})).map((function(ft){return ft.k}))},vi.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Us=[Bn,lr,Fr],Wa={click:function(R,H,ft){return eo(R,H,ft,ft.options.clickBuffer)},touch:function(R,H,ft){return eo(R,H,ft,ft.options.touchBuffer)}};function eo(R,H,ft,Ht){if(ft.map===null)return[];var Ce=R?(function(wn,we){return we===void 0&&(we=0),[[wn.point.x-we,wn.point.y-we],[wn.point.x+we,wn.point.y+we]]})(R,Ht):H,pe={};ft.options.styles&&(pe.layers=ft.options.styles.map((function(wn){return wn.id})));var be=ft.map.queryRenderedFeatures(Ce,pe).filter((function(wn){return Us.indexOf(wn.properties.meta)!==-1})),en=new vi,nn=[];return be.forEach((function(wn){var we=wn.properties.id;en.has(we)||(en.add(we),nn.push(wn))})),(function(wn){return wn.map((function(we){return we.geometry.type===rt&&(we.area=J.geometry({type:Yt,property:{},geometry:we.geometry})),we})).sort(_l).map((function(we){return delete we.area,we}))})(nn)}function Ri(R,H){var ft=Wa.click(R,null,H),Ht={mouse:Xt};return ft[0]&&(Ht.mouse=ft[0].properties.active===Mn?Dt:Jt,Ht.feature=ft[0].properties.meta),H.events.currentModeName().indexOf("draw")!==-1&&(Ht.mouse=It),H.ui.queueMapClasses(Ht),H.ui.updateMapClasses(),ft[0]}function $a(R,H){var ft=R.x-H.x,Ht=R.y-H.y;return Math.sqrt(ft*ft+Ht*Ht)}function ql(R,H,ft){ft===void 0&&(ft={});var Ht=ft.fineTolerance!=null?ft.fineTolerance:4,Ce=ft.grossTolerance!=null?ft.grossTolerance:12,pe=ft.interval!=null?ft.interval:500;R.point=R.point||H.point,R.time=R.time||H.time;var be=$a(R.point,H.point);return be<Ht||be<Ce&&H.time-R.time<pe}function Qr(R,H,ft){ft===void 0&&(ft={});var Ht=ft.tolerance!=null?ft.tolerance:25,Ce=ft.interval!=null?ft.interval:250;return R.point=R.point||H.point,R.time=R.time||H.time,$a(R.point,H.point)<Ht&&H.time-R.time<Ce}function hs(R,H){return R(H={exports:{}},H.exports),H.exports}var $e=hs((function(R){var H=R.exports=function(ft,Ht){if(Ht||(Ht=16),ft===void 0&&(ft=128),ft<=0)return"0";for(var Ce=Math.log(Math.pow(2,ft))/Math.log(Ht),pe=2;Ce===1/0;pe*=2)Ce=Math.log(Math.pow(2,ft/pe))/Math.log(Ht)*pe;var be=Ce-Math.floor(Ce),en="";for(pe=0;pe<Math.floor(Ce);pe++)en=Math.floor(Math.random()*Ht).toString(Ht)+en;if(be){var nn=Math.pow(Ht,be);en=Math.floor(Math.random()*nn).toString(Ht)+en}var wn=parseInt(en,Ht);return wn!==1/0&&wn>=Math.pow(2,ft)?H(ft,Ht):en};H.rack=function(ft,Ht,Ce){var pe=function(en){var nn=0;do{if(nn++>10){if(!Ce)throw new Error("too many ID collisions, use more bits");ft+=Ce}var wn=H(ft,Ht)}while(Object.hasOwnProperty.call(be,wn));return be[wn]=en,wn},be=pe.hats={};return pe.get=function(en){return pe.hats[en]},pe.set=function(en,nn){return pe.hats[en]=nn,pe},pe.bits=ft||128,pe.base=Ht||16,pe}})),yr=function(R,H){this.ctx=R,this.properties=H.properties||{},this.coordinates=H.geometry.coordinates,this.id=H.id||$e(),this.type=H.geometry.type};yr.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},yr.prototype.incomingCoords=function(R){this.setCoordinates(R)},yr.prototype.setCoordinates=function(R){this.coordinates=R,this.changed()},yr.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},yr.prototype.setProperty=function(R,H){this.properties[R]=H},yr.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Yt,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},yr.prototype.internal=function(R){var H={id:this.id,meta:Bn,"meta:type":this.type,active:ui,mode:R};if(this.ctx.options.userProperties)for(var ft in this.properties)H["user_"+ft]=this.properties[ft];return{type:Yt,properties:H,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Xr=function(R,H){yr.call(this,R,H)};(Xr.prototype=Object.create(yr.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Xr.prototype.updateCoordinate=function(R,H,ft){this.coordinates=arguments.length===3?[H,ft]:[R,H],this.changed()},Xr.prototype.getCoordinate=function(){return this.getCoordinates()};var ri=function(R,H){yr.call(this,R,H)};(ri.prototype=Object.create(yr.prototype)).isValid=function(){return this.coordinates.length>1},ri.prototype.addCoordinate=function(R,H,ft){this.changed();var Ht=parseInt(R,10);this.coordinates.splice(Ht,0,[H,ft])},ri.prototype.getCoordinate=function(R){var H=parseInt(R,10);return JSON.parse(JSON.stringify(this.coordinates[H]))},ri.prototype.removeCoordinate=function(R){this.changed(),this.coordinates.splice(parseInt(R,10),1)},ri.prototype.updateCoordinate=function(R,H,ft){var Ht=parseInt(R,10);this.coordinates[Ht]=[H,ft],this.changed()};var Ki=function(R,H){yr.call(this,R,H),this.coordinates=this.coordinates.map((function(ft){return ft.slice(0,-1)}))};(Ki.prototype=Object.create(yr.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every((function(R){return R.length>2}))},Ki.prototype.incomingCoords=function(R){this.coordinates=R.map((function(H){return H.slice(0,-1)})),this.changed()},Ki.prototype.setCoordinates=function(R){this.coordinates=R,this.changed()},Ki.prototype.addCoordinate=function(R,H,ft){this.changed();var Ht=R.split(".").map((function(Ce){return parseInt(Ce,10)}));this.coordinates[Ht[0]].splice(Ht[1],0,[H,ft])},Ki.prototype.removeCoordinate=function(R){this.changed();var H=R.split(".").map((function(Ht){return parseInt(Ht,10)})),ft=this.coordinates[H[0]];ft&&(ft.splice(H[1],1),ft.length<3&&this.coordinates.splice(H[0],1))},Ki.prototype.getCoordinate=function(R){var H=R.split(".").map((function(Ht){return parseInt(Ht,10)})),ft=this.coordinates[H[0]];return JSON.parse(JSON.stringify(ft[H[1]]))},Ki.prototype.getCoordinates=function(){return this.coordinates.map((function(R){return R.concat([R[0]])}))},Ki.prototype.updateCoordinate=function(R,H,ft){this.changed();var Ht=R.split("."),Ce=parseInt(Ht[0],10),pe=parseInt(Ht[1],10);this.coordinates[Ce]===void 0&&(this.coordinates[Ce]=[]),this.coordinates[Ce][pe]=[H,ft]};var Tr={MultiPoint:Xr,MultiLineString:ri,MultiPolygon:Ki},Rs=function(R,H,ft,Ht,Ce){var pe=ft.split("."),be=parseInt(pe[0],10),en=pe[1]?pe.slice(1).join("."):null;return R[be][H](en,Ht,Ce)},_r=function(R,H){if(yr.call(this,R,H),delete this.coordinates,this.model=Tr[H.geometry.type],this.model===void 0)throw new TypeError(H.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(H.geometry.coordinates)};function Di(R){this.map=R.map,this.drawConfig=JSON.parse(JSON.stringify(R.options||{})),this._ctx=R}(_r.prototype=Object.create(yr.prototype))._coordinatesToFeatures=function(R){var H=this,ft=this.model.bind(this);return R.map((function(Ht){return new ft(H.ctx,{id:$e(),type:Yt,properties:{},geometry:{coordinates:Ht,type:H.type.replace("Multi","")}})}))},_r.prototype.isValid=function(){return this.features.every((function(R){return R.isValid()}))},_r.prototype.setCoordinates=function(R){this.features=this._coordinatesToFeatures(R),this.changed()},_r.prototype.getCoordinate=function(R){return Rs(this.features,"getCoordinate",R)},_r.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(R){return R.type===rt?R.getCoordinates():R.coordinates}))))},_r.prototype.updateCoordinate=function(R,H,ft){Rs(this.features,"updateCoordinate",R,H,ft),this.changed()},_r.prototype.addCoordinate=function(R,H,ft){Rs(this.features,"addCoordinate",R,H,ft),this.changed()},_r.prototype.removeCoordinate=function(R){Rs(this.features,"removeCoordinate",R),this.changed()},_r.prototype.getFeatures=function(){return this.features},Di.prototype.setSelected=function(R){return this._ctx.store.setSelected(R)},Di.prototype.setSelectedCoordinates=function(R){var H=this;this._ctx.store.setSelectedCoordinates(R),R.reduce((function(ft,Ht){return ft[Ht.feature_id]===void 0&&(ft[Ht.feature_id]=!0,H._ctx.store.get(Ht.feature_id).changed()),ft}),{})},Di.prototype.getSelected=function(){return this._ctx.store.getSelected()},Di.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Di.prototype.isSelected=function(R){return this._ctx.store.isSelected(R)},Di.prototype.getFeature=function(R){return this._ctx.store.get(R)},Di.prototype.select=function(R){return this._ctx.store.select(R)},Di.prototype.deselect=function(R){return this._ctx.store.deselect(R)},Di.prototype.deleteFeature=function(R,H){return H===void 0&&(H={}),this._ctx.store.delete(R,H)},Di.prototype.addFeature=function(R){return this._ctx.store.add(R)},Di.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Di.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Di.prototype.setActionableState=function(R){R===void 0&&(R={});var H={trash:R.trash||!1,combineFeatures:R.combineFeatures||!1,uncombineFeatures:R.uncombineFeatures||!1};return this._ctx.events.actionable(H)},Di.prototype.changeMode=function(R,H,ft){return H===void 0&&(H={}),ft===void 0&&(ft={}),this._ctx.events.changeMode(R,H,ft)},Di.prototype.updateUIClasses=function(R){return this._ctx.ui.queueMapClasses(R)},Di.prototype.activateUIButton=function(R){return this._ctx.ui.setActiveButton(R)},Di.prototype.featuresAt=function(R,H,ft){if(ft===void 0&&(ft="click"),ft!=="click"&&ft!=="touch")throw new Error("invalid buffer type");return Wa[ft](R,H,this._ctx)},Di.prototype.newFeature=function(R){var H=R.geometry.type;return H===Sn?new Xr(this._ctx,R):H===qe?new ri(this._ctx,R):H===rt?new Ki(this._ctx,R):new _r(this._ctx,R)},Di.prototype.isInstanceOf=function(R,H){if(R===Sn)return H instanceof Xr;if(R===qe)return H instanceof ri;if(R===rt)return H instanceof Ki;if(R==="MultiFeature")return H instanceof _r;throw new Error("Unknown feature class: "+R)},Di.prototype.doRender=function(R){return this._ctx.store.featureChanged(R)},Di.prototype.onSetup=function(){},Di.prototype.onDrag=function(){},Di.prototype.onClick=function(){},Di.prototype.onMouseMove=function(){},Di.prototype.onMouseDown=function(){},Di.prototype.onMouseUp=function(){},Di.prototype.onMouseOut=function(){},Di.prototype.onKeyUp=function(){},Di.prototype.onKeyDown=function(){},Di.prototype.onTouchStart=function(){},Di.prototype.onTouchMove=function(){},Di.prototype.onTouchEnd=function(){},Di.prototype.onTap=function(){},Di.prototype.onStop=function(){},Di.prototype.onTrash=function(){},Di.prototype.onCombineFeature=function(){},Di.prototype.onUncombineFeature=function(){},Di.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var fu={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},jl=Object.keys(fu);function vl(R){var H=Object.keys(R);return function(ft,Ht){Ht===void 0&&(Ht={});var Ce={},pe=H.reduce((function(be,en){return be[en]=R[en],be}),new Di(ft));return{start:function(){var be=this;Ce=pe.onSetup(Ht),jl.forEach((function(en){var nn,wn=fu[en],we=function(){return!1};R[wn]&&(we=function(){return!0}),be.on(en,we,(nn=wn,function(Qe){return pe[nn](Ce,Qe)}))}))},stop:function(){pe.onStop(Ce)},trash:function(){pe.onTrash(Ce)},combineFeatures:function(){pe.onCombineFeatures(Ce)},uncombineFeatures:function(){pe.onUncombineFeatures(Ce)},render:function(be,en){pe.toDisplayFeatures(Ce,be,en)}}}}function ya(R){return[].concat(R).filter((function(H){return H!==void 0}))}function Dr(){var R=this;if(!(R.ctx.map&&R.ctx.map.getSource(lt)!==void 0))return nn();var H=R.ctx.events.currentModeName();R.ctx.ui.queueMapClasses({mode:H});var ft=[],Ht=[];R.isDirty?Ht=R.getAllIds():(ft=R.getChangedIds().filter((function(wn){return R.get(wn)!==void 0})),Ht=R.sources.hot.filter((function(wn){return wn.properties.id&&ft.indexOf(wn.properties.id)===-1&&R.get(wn.properties.id)!==void 0})).map((function(wn){return wn.properties.id}))),R.sources.hot=[];var Ce=R.sources.cold.length;R.sources.cold=R.isDirty?[]:R.sources.cold.filter((function(wn){var we=wn.properties.id||wn.properties.parent;return ft.indexOf(we)===-1}));var pe=Ce!==R.sources.cold.length||Ht.length>0;function be(wn,we){var Qe=R.get(wn).internal(H);R.ctx.events.currentModeRender(Qe,(function(Tn){R.sources[we].push(Tn)}))}if(ft.forEach((function(wn){return be(wn,"hot")})),Ht.forEach((function(wn){return be(wn,"cold")})),pe&&R.ctx.map.getSource(pt).setData({type:Xn,features:R.sources.cold}),R.ctx.map.getSource(lt).setData({type:Xn,features:R.sources.hot}),R._emitSelectionChange&&(R.ctx.map.fire(Be,{features:R.getSelected().map((function(wn){return wn.toGeoJSON()})),points:R.getSelectedCoordinates().map((function(wn){return{type:Yt,properties:{},geometry:{type:Sn,coordinates:wn.coordinates}}}))}),R._emitSelectionChange=!1),R._deletedFeaturesToEmit.length){var en=R._deletedFeaturesToEmit.map((function(wn){return wn.toGeoJSON()}));R._deletedFeaturesToEmit=[],R.ctx.map.fire(Zt,{features:en})}function nn(){R.isDirty=!1,R.clearChangedIds()}nn(),R.ctx.map.fire(An,{})}function Kn(R){var H,ft=this;this._features={},this._featureIds=new vi,this._selectedFeatureIds=new vi,this._selectedCoordinates=[],this._changedFeatureIds=new vi,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=R,this.sources={hot:[],cold:[]},this.render=function(){H||(H=requestAnimationFrame((function(){H=null,Dr.call(ft)})))},this.isDirty=!1}function oi(R,H){var ft=R._selectedCoordinates.filter((function(Ht){return R._selectedFeatureIds.has(Ht.feature_id)}));R._selectedCoordinates.length===ft.length||H.silent||(R._emitSelectionChange=!0),R._selectedCoordinates=ft}Kn.prototype.createRenderBatch=function(){var R=this,H=this.render,ft=0;return this.render=function(){ft++},function(){R.render=H,ft>0&&R.render()}},Kn.prototype.setDirty=function(){return this.isDirty=!0,this},Kn.prototype.featureChanged=function(R){return this._changedFeatureIds.add(R),this},Kn.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Kn.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Kn.prototype.getAllIds=function(){return this._featureIds.values()},Kn.prototype.add=function(R){return this.featureChanged(R.id),this._features[R.id]=R,this._featureIds.add(R.id),this},Kn.prototype.delete=function(R,H){var ft=this;return H===void 0&&(H={}),ya(R).forEach((function(Ht){ft._featureIds.has(Ht)&&(ft._featureIds.delete(Ht),ft._selectedFeatureIds.delete(Ht),H.silent||ft._deletedFeaturesToEmit.indexOf(ft._features[Ht])===-1&&ft._deletedFeaturesToEmit.push(ft._features[Ht]),delete ft._features[Ht],ft.isDirty=!0)})),oi(this,H),this},Kn.prototype.get=function(R){return this._features[R]},Kn.prototype.getAll=function(){var R=this;return Object.keys(this._features).map((function(H){return R._features[H]}))},Kn.prototype.select=function(R,H){var ft=this;return H===void 0&&(H={}),ya(R).forEach((function(Ht){ft._selectedFeatureIds.has(Ht)||(ft._selectedFeatureIds.add(Ht),ft._changedFeatureIds.add(Ht),H.silent||(ft._emitSelectionChange=!0))})),this},Kn.prototype.deselect=function(R,H){var ft=this;return H===void 0&&(H={}),ya(R).forEach((function(Ht){ft._selectedFeatureIds.has(Ht)&&(ft._selectedFeatureIds.delete(Ht),ft._changedFeatureIds.add(Ht),H.silent||(ft._emitSelectionChange=!0))})),oi(this,H),this},Kn.prototype.clearSelected=function(R){return R===void 0&&(R={}),this.deselect(this._selectedFeatureIds.values(),{silent:R.silent}),this},Kn.prototype.setSelected=function(R,H){var ft=this;return H===void 0&&(H={}),R=ya(R),this.deselect(this._selectedFeatureIds.values().filter((function(Ht){return R.indexOf(Ht)===-1})),{silent:H.silent}),this.select(R.filter((function(Ht){return!ft._selectedFeatureIds.has(Ht)})),{silent:H.silent}),this},Kn.prototype.setSelectedCoordinates=function(R){return this._selectedCoordinates=R,this._emitSelectionChange=!0,this},Kn.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Kn.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Kn.prototype.getSelected=function(){var R=this;return this._selectedFeatureIds.values().map((function(H){return R.get(H)}))},Kn.prototype.getSelectedCoordinates=function(){var R=this;return this._selectedCoordinates.map((function(H){return{coordinates:R.get(H.feature_id).getCoordinate(H.coord_path)}}))},Kn.prototype.isSelected=function(R){return this._selectedFeatureIds.has(R)},Kn.prototype.setFeatureProperty=function(R,H,ft){this.get(R).setProperty(H,ft),this.featureChanged(R)},Kn.prototype.storeMapConfig=function(){var R=this;Vl.forEach((function(H){R.ctx.map[H]&&(R._mapInitialConfig[H]=R.ctx.map[H].isEnabled())}))},Kn.prototype.restoreMapConfig=function(){var R=this;Object.keys(this._mapInitialConfig).forEach((function(H){R._mapInitialConfig[H]?R.ctx.map[H].enable():R.ctx.map[H].disable()}))},Kn.prototype.getInitialConfigValue=function(R){return this._mapInitialConfig[R]===void 0||this._mapInitialConfig[R]};var Ds=function(){for(var R=arguments,H={},ft=0;ft<arguments.length;ft++){var Ht=R[ft];for(var Ce in Ht)rr.call(Ht,Ce)&&(H[Ce]=Ht[Ce])}return H},rr=Object.prototype.hasOwnProperty,ts=["mode","feature","mouse"];function Pi(R){var H=null,ft=null,Ht={onRemove:function(){return R.map.off("load",Ht.connect),clearInterval(ft),Ht.removeLayers(),R.store.restoreMapConfig(),R.ui.removeButtons(),R.events.removeEventListeners(),R.ui.clearMapClasses(),R.map=null,R.container=null,R.store=null,H&&H.parentNode&&H.parentNode.removeChild(H),H=null,this},connect:function(){R.map.off("load",Ht.connect),clearInterval(ft),Ht.addLayers(),R.store.storeMapConfig(),R.events.addEventListeners()},onAdd:function(Ce){var pe=Ce.fire;return Ce.fire=function(be,en){var nn=arguments;return pe.length===1&&arguments.length!==1&&(nn=[Ds({},{type:be},en)]),pe.apply(Ce,nn)},R.map=Ce,R.events=(function(be){var en=Object.keys(be.options.modes).reduce((function(ke,_n){return ke[_n]=vl(be.options.modes[_n]),ke}),{}),nn={},wn={},we={},Qe=null,Tn=null;we.drag=function(ke,_n){_n({point:ke.point,time:new Date().getTime()})?(be.ui.queueMapClasses({mouse:_t}),Tn.drag(ke)):ke.originalEvent.stopPropagation()},we.mousedrag=function(ke){we.drag(ke,(function(_n){return!ql(nn,_n)}))},we.touchdrag=function(ke){we.drag(ke,(function(_n){return!Qr(wn,_n)}))},we.mousemove=function(ke){if((ke.originalEvent.buttons!==void 0?ke.originalEvent.buttons:ke.originalEvent.which)===1)return we.mousedrag(ke);var _n=Ri(ke,be);ke.featureTarget=_n,Tn.mousemove(ke)},we.mousedown=function(ke){nn={time:new Date().getTime(),point:ke.point};var _n=Ri(ke,be);ke.featureTarget=_n,Tn.mousedown(ke)},we.mouseup=function(ke){var _n=Ri(ke,be);ke.featureTarget=_n,ql(nn,{point:ke.point,time:new Date().getTime()})?Tn.click(ke):Tn.mouseup(ke)},we.mouseout=function(ke){Tn.mouseout(ke)},we.touchstart=function(ke){if(ke.originalEvent.preventDefault(),be.options.touchEnabled){wn={time:new Date().getTime(),point:ke.point};var _n=Wa.touch(ke,null,be)[0];ke.featureTarget=_n,Tn.touchstart(ke)}},we.touchmove=function(ke){if(ke.originalEvent.preventDefault(),be.options.touchEnabled)return Tn.touchmove(ke),we.touchdrag(ke)},we.touchend=function(ke){if(ke.originalEvent.preventDefault(),be.options.touchEnabled){var _n=Wa.touch(ke,null,be)[0];ke.featureTarget=_n,Qr(wn,{time:new Date().getTime(),point:ke.point})?Tn.tap(ke):Tn.touchend(ke)}};var Yn=function(ke){return!(ke===8||ke===46||ke>=48&&ke<=57)};function Pn(ke,_n,kn){kn===void 0&&(kn={}),Tn.stop();var Xi=en[ke];if(Xi===void 0)throw new Error(ke+" is not valid");Qe=ke;var Wi=Xi(be,_n);Tn=F(Wi,be),kn.silent||be.map.fire(de,{mode:ke}),be.store.setDirty(),be.store.render()}we.keydown=function(ke){(ke.srcElement||ke.target).classList[0]==="mapboxgl-canvas"&&(ke.keyCode!==8&&ke.keyCode!==46||!be.options.controls.trash?Yn(ke.keyCode)?Tn.keydown(ke):ke.keyCode===49&&be.options.controls.point?Pn(te.DRAW_POINT):ke.keyCode===50&&be.options.controls.line_string?Pn(te.DRAW_LINE_STRING):ke.keyCode===51&&be.options.controls.polygon&&Pn(te.DRAW_POLYGON):(ke.preventDefault(),Tn.trash()))},we.keyup=function(ke){Yn(ke.keyCode)&&Tn.keyup(ke)},we.zoomend=function(){be.store.changeZoom()},we.data=function(ke){if(ke.dataType==="style"){var _n=be.setup,kn=be.map,Xi=be.options,Wi=be.store;Xi.styles.some((function(xn){return kn.getLayer(xn.id)}))||(_n.addLayers(),Wi.setDirty(),Wi.render())}};var Ni={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Qe=be.options.defaultMode,Tn=F(en[Qe](be),be)},changeMode:Pn,actionable:function(ke){var _n=!1;Object.keys(ke).forEach((function(kn){if(Ni[kn]===void 0)throw new Error("Invalid action type");Ni[kn]!==ke[kn]&&(_n=!0),Ni[kn]=ke[kn]})),_n&&be.map.fire(On,{actions:Ni})},currentModeName:function(){return Qe},currentModeRender:function(ke,_n){return Tn.render(ke,_n)},fire:function(ke,_n){we[ke]&&we[ke](_n)},addEventListeners:function(){be.map.on("mousemove",we.mousemove),be.map.on("mousedown",we.mousedown),be.map.on("mouseup",we.mouseup),be.map.on("data",we.data),be.map.on("touchmove",we.touchmove),be.map.on("touchstart",we.touchstart),be.map.on("touchend",we.touchend),be.container.addEventListener("mouseout",we.mouseout),be.options.keybindings&&(be.container.addEventListener("keydown",we.keydown),be.container.addEventListener("keyup",we.keyup))},removeEventListeners:function(){be.map.off("mousemove",we.mousemove),be.map.off("mousedown",we.mousedown),be.map.off("mouseup",we.mouseup),be.map.off("data",we.data),be.map.off("touchmove",we.touchmove),be.map.off("touchstart",we.touchstart),be.map.off("touchend",we.touchend),be.container.removeEventListener("mouseout",we.mouseout),be.options.keybindings&&(be.container.removeEventListener("keydown",we.keydown),be.container.removeEventListener("keyup",we.keyup))},trash:function(ke){Tn.trash(ke)},combineFeatures:function(){Tn.combineFeatures()},uncombineFeatures:function(){Tn.uncombineFeatures()},getMode:function(){return Qe}}})(R),R.ui=(function(be){var en={},nn=null,wn={mode:null,feature:null,mouse:null},we={mode:null,feature:null,mouse:null};function Qe(ke){we=Ds(we,ke)}function Tn(){var ke,_n;if(be.container){var kn=[],Xi=[];ts.forEach((function(Wi){we[Wi]!==wn[Wi]&&(kn.push(Wi+"-"+wn[Wi]),we[Wi]!==null&&Xi.push(Wi+"-"+we[Wi]))})),kn.length>0&&(ke=be.container.classList).remove.apply(ke,kn),Xi.length>0&&(_n=be.container.classList).add.apply(_n,Xi),wn=Ds(wn,we)}}function Yn(ke,_n){_n===void 0&&(_n={});var kn=document.createElement("button");return kn.className=X+" "+_n.className,kn.setAttribute("title",_n.title),_n.container.appendChild(kn),kn.addEventListener("click",(function(Xi){if(Xi.preventDefault(),Xi.stopPropagation(),Xi.target===nn)return Pn(),void _n.onDeactivate();Ni(ke),_n.onActivate()}),!0),kn}function Pn(){nn&&(nn.classList.remove(le),nn=null)}function Ni(ke){Pn();var _n=en[ke];_n&&_n&&ke!=="trash"&&(_n.classList.add(le),nn=_n)}return{setActiveButton:Ni,queueMapClasses:Qe,updateMapClasses:Tn,clearMapClasses:function(){Qe({mode:null,feature:null,mouse:null}),Tn()},addButtons:function(){var ke=be.options.controls,_n=document.createElement("div");return _n.className=ae+" "+h,ke&&(ke[ie.LINE]&&(en[ie.LINE]=Yn(ie.LINE,{container:_n,className:tt,title:"LineString tool "+(be.options.keybindings?"(l)":""),onActivate:function(){return be.events.changeMode(te.DRAW_LINE_STRING)},onDeactivate:function(){return be.events.trash()}})),ke[ie.POLYGON]&&(en[ie.POLYGON]=Yn(ie.POLYGON,{container:_n,className:ht,title:"Polygon tool "+(be.options.keybindings?"(p)":""),onActivate:function(){return be.events.changeMode(te.DRAW_POLYGON)},onDeactivate:function(){return be.events.trash()}})),ke[ie.POINT]&&(en[ie.POINT]=Yn(ie.POINT,{container:_n,className:st,title:"Marker tool "+(be.options.keybindings?"(m)":""),onActivate:function(){return be.events.changeMode(te.DRAW_POINT)},onDeactivate:function(){return be.events.trash()}})),ke.trash&&(en.trash=Yn("trash",{container:_n,className:At,title:"Delete",onActivate:function(){be.events.trash()}})),ke.combine_features&&(en.combine_features=Yn("combineFeatures",{container:_n,className:yt,title:"Combine",onActivate:function(){be.events.combineFeatures()}})),ke.uncombine_features&&(en.uncombine_features=Yn("uncombineFeatures",{container:_n,className:it,title:"Uncombine",onActivate:function(){be.events.uncombineFeatures()}}))),_n},removeButtons:function(){Object.keys(en).forEach((function(ke){var _n=en[ke];_n.parentNode&&_n.parentNode.removeChild(_n),delete en[ke]}))}}})(R),R.container=Ce.getContainer(),R.store=new Kn(R),H=R.ui.addButtons(),R.options.boxSelect&&(Ce.boxZoom.disable(),Ce.dragPan.disable(),Ce.dragPan.enable()),Ce.loaded()?Ht.connect():(Ce.on("load",Ht.connect),ft=setInterval((function(){Ce.loaded()&&Ht.connect()}),16)),R.events.start(),H},addLayers:function(){R.map.addSource(pt,{data:{type:Xn,features:[]},type:"geojson"}),R.map.addSource(lt,{data:{type:Xn,features:[]},type:"geojson"}),R.options.styles.forEach((function(Ce){R.map.addLayer(Ce)})),R.store.setDirty(!0),R.store.render()},removeLayers:function(){R.options.styles.forEach((function(Ce){R.map.getLayer(Ce.id)&&R.map.removeLayer(Ce.id)})),R.map.getSource(pt)&&R.map.removeSource(pt),R.map.getSource(lt)&&R.map.removeSource(lt)}};return R.setup=Ht,Ht}function Zr(R){return function(H){var ft=H.featureTarget;return!!ft&&!!ft.properties&&ft.properties.meta===R}}function Yi(R){return!!R.featureTarget&&!!R.featureTarget.properties&&R.featureTarget.properties.active===Mn&&R.featureTarget.properties.meta===Bn}function Ct(R){return!!R.featureTarget&&!!R.featureTarget.properties&&R.featureTarget.properties.active===ui&&R.featureTarget.properties.meta===Bn}function et(R){return R.featureTarget===void 0}function ot(R){var H=R.featureTarget;return!!H&&!!H.properties&&H.properties.meta===Fr}function Lt(R){return!!R.originalEvent&&R.originalEvent.shiftKey===!0}function Pt(R){return R.keyCode===27}function Kt(R){return R.keyCode===13}var ue=se;function se(R,H){this.x=R,this.y=H}function $t(R,H){var ft=H.getBoundingClientRect();return new ue(R.clientX-ft.left-(H.clientLeft||0),R.clientY-ft.top-(H.clientTop||0))}function me(R,H,ft,Ht){return{type:Yt,properties:{meta:Fr,parent:R,coord_path:ft,active:Ht?Mn:ui},geometry:{type:Sn,coordinates:H}}}function je(R,H,ft){H===void 0&&(H={}),ft===void 0&&(ft=null);var Ht,Ce=R.geometry,pe=Ce.type,be=Ce.coordinates,en=R.properties&&R.properties.id,nn=[];function wn(Qe,Tn){var Yn="",Pn=null;Qe.forEach((function(Ni,ke){var _n=Tn!=null?Tn+"."+ke:String(ke),kn=me(en,Ni,_n,we(_n));if(H.midpoints&&Pn){var Xi=(function(xn,gr,ur){var qi=gr.geometry.coordinates,Yr=ur.geometry.coordinates;if(qi[1]>85||qi[1]<-85||Yr[1]>85||Yr[1]<-85)return null;var ss={lng:(qi[0]+Yr[0])/2,lat:(qi[1]+Yr[1])/2};return{type:Yt,properties:{meta:lr,parent:xn,lng:ss.lng,lat:ss.lat,coord_path:ur.properties.coord_path},geometry:{type:Sn,coordinates:[ss.lng,ss.lat]}}})(en,Pn,kn);Xi&&nn.push(Xi)}Pn=kn;var Wi=JSON.stringify(Ni);Yn!==Wi&&nn.push(kn),ke===0&&(Yn=Wi)}))}function we(Qe){return!!H.selectedPaths&&H.selectedPaths.indexOf(Qe)!==-1}return pe===Sn?nn.push(me(en,be,ft,we(ft))):pe===rt?be.forEach((function(Qe,Tn){wn(Qe,ft!==null?ft+"."+Tn:String(Tn))})):pe===qe?wn(be,ft):pe.indexOf(ct)===0&&(Ht=pe.replace(ct,""),be.forEach((function(Qe,Tn){var Yn={properties:R.properties,geometry:{type:Ht,coordinates:Qe}};nn=nn.concat(je(Yn,H,Tn))}))),nn}se.prototype={clone:function(){return new se(this.x,this.y)},add:function(R){return this.clone()._add(R)},sub:function(R){return this.clone()._sub(R)},multByPoint:function(R){return this.clone()._multByPoint(R)},divByPoint:function(R){return this.clone()._divByPoint(R)},mult:function(R){return this.clone()._mult(R)},div:function(R){return this.clone()._div(R)},rotate:function(R){return this.clone()._rotate(R)},rotateAround:function(R,H){return this.clone()._rotateAround(R,H)},matMult:function(R){return this.clone()._matMult(R)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(R){return this.x===R.x&&this.y===R.y},dist:function(R){return Math.sqrt(this.distSqr(R))},distSqr:function(R){var H=R.x-this.x,ft=R.y-this.y;return H*H+ft*ft},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(R){return Math.atan2(this.y-R.y,this.x-R.x)},angleWith:function(R){return this.angleWithSep(R.x,R.y)},angleWithSep:function(R,H){return Math.atan2(this.x*H-this.y*R,this.x*R+this.y*H)},_matMult:function(R){var H=R[0]*this.x+R[1]*this.y,ft=R[2]*this.x+R[3]*this.y;return this.x=H,this.y=ft,this},_add:function(R){return this.x+=R.x,this.y+=R.y,this},_sub:function(R){return this.x-=R.x,this.y-=R.y,this},_mult:function(R){return this.x*=R,this.y*=R,this},_div:function(R){return this.x/=R,this.y/=R,this},_multByPoint:function(R){return this.x*=R.x,this.y*=R.y,this},_divByPoint:function(R){return this.x/=R.x,this.y/=R.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var R=this.y;return this.y=this.x,this.x=-R,this},_rotate:function(R){var H=Math.cos(R),ft=Math.sin(R),Ht=H*this.x-ft*this.y,Ce=ft*this.x+H*this.y;return this.x=Ht,this.y=Ce,this},_rotateAround:function(R,H){var ft=Math.cos(R),Ht=Math.sin(R),Ce=H.x+ft*(this.x-H.x)-Ht*(this.y-H.y),pe=H.y+Ht*(this.x-H.x)+ft*(this.y-H.y);return this.x=Ce,this.y=pe,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},se.convert=function(R){return R instanceof se?R:Array.isArray(R)?new se(R[0],R[1]):R};var yn=function(R){setTimeout((function(){R.map&&R.map.doubleClickZoom&&R._ctx&&R._ctx.store&&R._ctx.store.getInitialConfigValue&&R._ctx.store.getInitialConfigValue("doubleClickZoom")&&R.map.doubleClickZoom.enable()}),0)},Je=function(R){setTimeout((function(){R.map&&R.map.doubleClickZoom&&R.map.doubleClickZoom.disable()}),0)},Zn=function(R){if(!R||!R.type)return null;var H=jn[R.type];if(!H)return null;if(H==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:R}]};if(H==="feature")return{type:"FeatureCollection",features:[R]};if(H==="featurecollection")return R},jn={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function Fn(R){switch(R&&R.type||null){case"FeatureCollection":return R.features=R.features.reduce((function(H,ft){return H.concat(Fn(ft))}),[]),R;case"Feature":return R.geometry?Fn(R.geometry).map((function(H){var ft={type:"Feature",properties:JSON.parse(JSON.stringify(R.properties)),geometry:H};return R.id!==void 0&&(ft.id=R.id),ft})):[R];case"MultiPoint":return R.coordinates.map((function(H){return{type:"Point",coordinates:H}}));case"MultiPolygon":return R.coordinates.map((function(H){return{type:"Polygon",coordinates:H}}));case"MultiLineString":return R.coordinates.map((function(H){return{type:"LineString",coordinates:H}}));case"GeometryCollection":return R.geometries.map(Fn).reduce((function(H,ft){return H.concat(ft)}),[]);case"Point":case"Polygon":case"LineString":return[R]}}var Qn=function(R){if(!R)return[];var H=Fn(Zn(R)),ft=[];return H.features.forEach((function(Ht){Ht.geometry&&(ft=ft.concat((function Ce(pe){return Array.isArray(pe)&&pe.length&&typeof pe[0]=="number"?[pe]:pe.reduce((function(be,en){return Array.isArray(en)&&Array.isArray(en[0])?be.concat(Ce(en)):(be.push(en),be)}),[])})(Ht.geometry.coordinates)))})),ft},fi=hs((function(R){var H=R.exports=function(we){return new ft(we)};function ft(we){this.value=we}function Ht(we,Qe,Tn){var Yn=[],Pn=[],Ni=!0;return(function ke(_n){var kn=Tn?Ce(_n):_n,Xi={},Wi=!0,xn={node:kn,node_:_n,path:[].concat(Yn),parent:Pn[Pn.length-1],parents:Pn,key:Yn.slice(-1)[0],isRoot:Yn.length===0,level:Yn.length,circular:null,update:function(qi,Yr){xn.isRoot||(xn.parent.node[xn.key]=qi),xn.node=qi,Yr&&(Wi=!1)},delete:function(qi){delete xn.parent.node[xn.key],qi&&(Wi=!1)},remove:function(qi){en(xn.parent.node)?xn.parent.node.splice(xn.key,1):delete xn.parent.node[xn.key],qi&&(Wi=!1)},keys:null,before:function(qi){Xi.before=qi},after:function(qi){Xi.after=qi},pre:function(qi){Xi.pre=qi},post:function(qi){Xi.post=qi},stop:function(){Ni=!1},block:function(){Wi=!1}};if(!Ni)return xn;function gr(){if(typeof xn.node=="object"&&xn.node!==null){xn.keys&&xn.node_===xn.node||(xn.keys=pe(xn.node)),xn.isLeaf=xn.keys.length==0;for(var qi=0;qi<Pn.length;qi++)if(Pn[qi].node_===_n){xn.circular=Pn[qi];break}}else xn.isLeaf=!0,xn.keys=null;xn.notLeaf=!xn.isLeaf,xn.notRoot=!xn.isRoot}gr();var ur=Qe.call(xn,xn.node);return ur!==void 0&&xn.update&&xn.update(ur),Xi.before&&Xi.before.call(xn,xn.node),Wi&&(typeof xn.node!="object"||xn.node===null||xn.circular||(Pn.push(xn),gr(),nn(xn.keys,(function(qi,Yr){Yn.push(qi),Xi.pre&&Xi.pre.call(xn,xn.node[qi],qi);var ss=ke(xn.node[qi]);Tn&&wn.call(xn.node,qi)&&(xn.node[qi]=ss.node),ss.isLast=Yr==xn.keys.length-1,ss.isFirst=Yr==0,Xi.post&&Xi.post.call(xn,ss),Yn.pop()})),Pn.pop()),Xi.after&&Xi.after.call(xn,xn.node)),xn})(we).node}function Ce(we){if(typeof we=="object"&&we!==null){var Qe;if(en(we))Qe=[];else if(be(we)==="[object Date]")Qe=new Date(we.getTime?we.getTime():we);else if((function(Pn){return be(Pn)==="[object RegExp]"})(we))Qe=new RegExp(we);else if((function(Pn){return be(Pn)==="[object Error]"})(we))Qe={message:we.message};else if((function(Pn){return be(Pn)==="[object Boolean]"})(we))Qe=new Boolean(we);else if((function(Pn){return be(Pn)==="[object Number]"})(we))Qe=new Number(we);else if((function(Pn){return be(Pn)==="[object String]"})(we))Qe=new String(we);else if(Object.create&&Object.getPrototypeOf)Qe=Object.create(Object.getPrototypeOf(we));else if(we.constructor===Object)Qe={};else{var Tn=we.constructor&&we.constructor.prototype||we.__proto__||{},Yn=function(){};Yn.prototype=Tn,Qe=new Yn}return nn(pe(we),(function(Pn){Qe[Pn]=we[Pn]})),Qe}return we}ft.prototype.get=function(we){for(var Qe=this.value,Tn=0;Tn<we.length;Tn++){var Yn=we[Tn];if(!Qe||!wn.call(Qe,Yn)){Qe=void 0;break}Qe=Qe[Yn]}return Qe},ft.prototype.has=function(we){for(var Qe=this.value,Tn=0;Tn<we.length;Tn++){var Yn=we[Tn];if(!Qe||!wn.call(Qe,Yn))return!1;Qe=Qe[Yn]}return!0},ft.prototype.set=function(we,Qe){for(var Tn=this.value,Yn=0;Yn<we.length-1;Yn++){var Pn=we[Yn];wn.call(Tn,Pn)||(Tn[Pn]={}),Tn=Tn[Pn]}return Tn[we[Yn]]=Qe,Qe},ft.prototype.map=function(we){return Ht(this.value,we,!0)},ft.prototype.forEach=function(we){return this.value=Ht(this.value,we,!1),this.value},ft.prototype.reduce=function(we,Qe){var Tn=arguments.length===1,Yn=Tn?this.value:Qe;return this.forEach((function(Pn){this.isRoot&&Tn||(Yn=we.call(this,Yn,Pn))})),Yn},ft.prototype.paths=function(){var we=[];return this.forEach((function(Qe){we.push(this.path)})),we},ft.prototype.nodes=function(){var we=[];return this.forEach((function(Qe){we.push(this.node)})),we},ft.prototype.clone=function(){var we=[],Qe=[];return(function Tn(Yn){for(var Pn=0;Pn<we.length;Pn++)if(we[Pn]===Yn)return Qe[Pn];if(typeof Yn=="object"&&Yn!==null){var Ni=Ce(Yn);return we.push(Yn),Qe.push(Ni),nn(pe(Yn),(function(ke){Ni[ke]=Tn(Yn[ke])})),we.pop(),Qe.pop(),Ni}return Yn})(this.value)};var pe=Object.keys||function(we){var Qe=[];for(var Tn in we)Qe.push(Tn);return Qe};function be(we){return Object.prototype.toString.call(we)}var en=Array.isArray||function(we){return Object.prototype.toString.call(we)==="[object Array]"},nn=function(we,Qe){if(we.forEach)return we.forEach(Qe);for(var Tn=0;Tn<we.length;Tn++)Qe(we[Tn],Tn,we)};nn(pe(ft.prototype),(function(we){H[we]=function(Qe){var Tn=[].slice.call(arguments,1),Yn=new ft(Qe);return Yn[we].apply(Yn,Tn)}}));var wn=Object.hasOwnProperty||function(we,Qe){return Qe in we}})),ki=Dn;function Dn(R){if(!(this instanceof Dn))return new Dn(R);this._bbox=R||[1/0,1/0,-1/0,-1/0],this._valid=!!R}Dn.prototype.include=function(R){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],R[0]),this._bbox[1]=Math.min(this._bbox[1],R[1]),this._bbox[2]=Math.max(this._bbox[2],R[0]),this._bbox[3]=Math.max(this._bbox[3],R[1]),this},Dn.prototype.equals=function(R){var H;return H=R instanceof Dn?R.bbox():R,this._bbox[0]==H[0]&&this._bbox[1]==H[1]&&this._bbox[2]==H[2]&&this._bbox[3]==H[3]},Dn.prototype.center=function(R){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Dn.prototype.union=function(R){var H;return this._valid=!0,H=R instanceof Dn?R.bbox():R,this._bbox[0]=Math.min(this._bbox[0],H[0]),this._bbox[1]=Math.min(this._bbox[1],H[1]),this._bbox[2]=Math.max(this._bbox[2],H[2]),this._bbox[3]=Math.max(this._bbox[3],H[3]),this},Dn.prototype.bbox=function(){return this._valid?this._bbox:null},Dn.prototype.contains=function(R){if(!R)return this._fastContains();if(!this._valid)return null;var H=R[0],ft=R[1];return this._bbox[0]<=H&&this._bbox[1]<=ft&&this._bbox[2]>=H&&this._bbox[3]>=ft},Dn.prototype.intersect=function(R){return this._valid?(H=R instanceof Dn?R.bbox():R,!(this._bbox[0]>H[2]||this._bbox[2]<H[0]||this._bbox[3]<H[1]||this._bbox[1]>H[3])):null;var H},Dn.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var R="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",R)},Dn.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Vi={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},_i=Object.keys(Vi),Ra=function(R){return Ss(R).bbox()};function Ss(R){for(var H=ki(),ft=Qn(R),Ht=0;Ht<ft.length;Ht++)H.include(ft[Ht]);return H}Ra.polygon=function(R){return Ss(R).polygon()},Ra.bboxify=function(R){return fi(R).map((function(H){H&&_i.some((function(ft){return!!H[ft]&&Vi[ft].indexOf(H.type)!==-1}))&&(H.bbox=Ss(H).bbox(),this.update(H))}))};function _e(R,H){var ft=-90,Ht=90,Ce=-90,pe=90,be=270,en=-270;R.forEach((function(wn){var we=Ra(wn),Qe=we[1],Tn=we[3],Yn=we[0],Pn=we[2];Qe>ft&&(ft=Qe),Tn<Ht&&(Ht=Tn),Tn>Ce&&(Ce=Tn),Qe<pe&&(pe=Qe),Yn<be&&(be=Yn),Pn>en&&(en=Pn)}));var nn=H;return ft+nn.lat>85&&(nn.lat=85-ft),Ce+nn.lat>90&&(nn.lat=90-Ce),Ht+nn.lat<-85&&(nn.lat=-85-Ht),pe+nn.lat<-90&&(nn.lat=-90-pe),be+nn.lng<=-270&&(nn.lng+=360*Math.ceil(Math.abs(nn.lng)/360)),en+nn.lng>=270&&(nn.lng-=360*Math.ceil(Math.abs(nn.lng)/360)),nn}function Hr(R,H){var ft=_e(R.map((function(Ht){return Ht.toGeoJSON()})),H);R.forEach((function(Ht){var Ce,pe=Ht.getCoordinates(),be=function(nn){var wn={lng:nn[0]+ft.lng,lat:nn[1]+ft.lat};return[wn.lng,wn.lat]},en=function(nn){return nn.map((function(wn){return be(wn)}))};Ht.type===Sn?Ce=be(pe):Ht.type===qe||Ht.type===kt?Ce=pe.map(be):Ht.type===rt||Ht.type===ut?Ce=pe.map(en):Ht.type===ye&&(Ce=pe.map((function(nn){return nn.map((function(wn){return en(wn)}))}))),Ht.incomingCoords(Ce)}))}var Rn={onSetup:function(R){var H=this,ft={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:R.featureIds||[]};return this.setSelected(ft.initiallySelectedFeatureIds.filter((function(Ht){return H.getFeature(Ht)!==void 0}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),ft},fireUpdate:function(){this.map.fire(ve,{action:Gi,features:this.getSelected().map((function(R){return R.toGeoJSON()}))})},fireActionable:function(){var R=this,H=this.getSelected(),ft=H.filter((function(en){return R.isInstanceOf("MultiFeature",en)})),Ht=!1;if(H.length>1){Ht=!0;var Ce=H[0].type.replace("Multi","");H.forEach((function(en){en.type.replace("Multi","")!==Ce&&(Ht=!1)}))}var pe=ft.length>0,be=H.length>0;this.setActionableState({combineFeatures:Ht,uncombineFeatures:pe,trash:be})},getUniqueIds:function(R){return R.length?R.map((function(H){return H.properties.id})).filter((function(H){return H!==void 0})).reduce((function(H,ft){return H.add(ft),H}),new vi).values():[]},stopExtendedInteractions:function(R){R.boxSelectElement&&(R.boxSelectElement.parentNode&&R.boxSelectElement.parentNode.removeChild(R.boxSelectElement),R.boxSelectElement=null),this.map.dragPan.enable(),R.boxSelecting=!1,R.canBoxSelect=!1,R.dragMoving=!1,R.canDragMove=!1},onStop:function(){yn(this)},onMouseMove:function(R){return this.stopExtendedInteractions(R),!0},onMouseOut:function(R){return!R.dragMoving||this.fireUpdate()}};Rn.onTap=Rn.onClick=function(R,H){return et(H)?this.clickAnywhere(R,H):Zr(Fr)(H)?this.clickOnVertex(R,H):(function(ft){return!!ft.featureTarget&&!!ft.featureTarget.properties&&ft.featureTarget.properties.meta===Bn})(H)?this.clickOnFeature(R,H):void 0},Rn.clickAnywhere=function(R){var H=this,ft=this.getSelectedIds();ft.length&&(this.clearSelectedFeatures(),ft.forEach((function(Ht){return H.doRender(Ht)}))),yn(this),this.stopExtendedInteractions(R)},Rn.clickOnVertex=function(R,H){this.changeMode(te.DIRECT_SELECT,{featureId:H.featureTarget.properties.parent,coordPath:H.featureTarget.properties.coord_path,startPos:H.lngLat}),this.updateUIClasses({mouse:Dt})},Rn.startOnActiveFeature=function(R,H){this.stopExtendedInteractions(R),this.map.dragPan.disable(),this.doRender(H.featureTarget.properties.id),R.canDragMove=!0,R.dragMoveLocation=H.lngLat},Rn.clickOnFeature=function(R,H){var ft=this;Je(this),this.stopExtendedInteractions(R);var Ht=Lt(H),Ce=this.getSelectedIds(),pe=H.featureTarget.properties.id,be=this.isSelected(pe);if(!Ht&&be&&this.getFeature(pe).type!==Sn)return this.changeMode(te.DIRECT_SELECT,{featureId:pe});be&&Ht?(this.deselect(pe),this.updateUIClasses({mouse:Jt}),Ce.length===1&&yn(this)):!be&&Ht?(this.select(pe),this.updateUIClasses({mouse:Dt})):be||Ht||(Ce.forEach((function(en){return ft.doRender(en)})),this.setSelected(pe),this.updateUIClasses({mouse:Dt})),this.doRender(pe)},Rn.onMouseDown=function(R,H){return Yi(H)?this.startOnActiveFeature(R,H):this.drawConfig.boxSelect&&(function(ft){return!!ft.originalEvent&&!!ft.originalEvent.shiftKey&&ft.originalEvent.button===0})(H)?this.startBoxSelect(R,H):void 0},Rn.startBoxSelect=function(R,H){this.stopExtendedInteractions(R),this.map.dragPan.disable(),R.boxSelectStartLocation=$t(H.originalEvent,this.map.getContainer()),R.canBoxSelect=!0},Rn.onTouchStart=function(R,H){if(Yi(H))return this.startOnActiveFeature(R,H)},Rn.onDrag=function(R,H){return R.canDragMove?this.dragMove(R,H):this.drawConfig.boxSelect&&R.canBoxSelect?this.whileBoxSelect(R,H):void 0},Rn.whileBoxSelect=function(R,H){R.boxSelecting=!0,this.updateUIClasses({mouse:It}),R.boxSelectElement||(R.boxSelectElement=document.createElement("div"),R.boxSelectElement.classList.add(Ft),this.map.getContainer().appendChild(R.boxSelectElement));var ft=$t(H.originalEvent,this.map.getContainer()),Ht=Math.min(R.boxSelectStartLocation.x,ft.x),Ce=Math.max(R.boxSelectStartLocation.x,ft.x),pe=Math.min(R.boxSelectStartLocation.y,ft.y),be=Math.max(R.boxSelectStartLocation.y,ft.y),en="translate("+Ht+"px, "+pe+"px)";R.boxSelectElement.style.transform=en,R.boxSelectElement.style.WebkitTransform=en,R.boxSelectElement.style.width=Ce-Ht+"px",R.boxSelectElement.style.height=be-pe+"px"},Rn.dragMove=function(R,H){R.dragMoving=!0,H.originalEvent.stopPropagation();var ft={lng:H.lngLat.lng-R.dragMoveLocation.lng,lat:H.lngLat.lat-R.dragMoveLocation.lat};Hr(this.getSelected(),ft),R.dragMoveLocation=H.lngLat},Rn.onMouseUp=function(R,H){var ft=this;if(R.dragMoving)this.fireUpdate();else if(R.boxSelecting){var Ht=[R.boxSelectStartLocation,$t(H.originalEvent,this.map.getContainer())],Ce=this.featuresAt(null,Ht,"click"),pe=this.getUniqueIds(Ce).filter((function(be){return!ft.isSelected(be)}));pe.length&&(this.select(pe),pe.forEach((function(be){return ft.doRender(be)})),this.updateUIClasses({mouse:Dt}))}this.stopExtendedInteractions(R)},Rn.toDisplayFeatures=function(R,H,ft){H.properties.active=this.isSelected(H.properties.id)?Mn:ui,ft(H),this.fireActionable(),H.properties.active===Mn&&H.geometry.type!==Sn&&je(H).forEach(ft)},Rn.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Rn.onCombineFeatures=function(){var R=this.getSelected();if(!(R.length===0||R.length<2)){for(var H=[],ft=[],Ht=R[0].type.replace("Multi",""),Ce=0;Ce<R.length;Ce++){var pe=R[Ce];if(pe.type.replace("Multi","")!==Ht)return;pe.type.includes("Multi")?pe.getCoordinates().forEach((function(en){H.push(en)})):H.push(pe.getCoordinates()),ft.push(pe.toGeoJSON())}if(ft.length>1){var be=this.newFeature({type:Yt,properties:ft[0].properties,geometry:{type:"Multi"+Ht,coordinates:H}});this.addFeature(be),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([be.id]),this.map.fire($n,{createdFeatures:[be.toGeoJSON()],deletedFeatures:ft})}this.fireActionable()}},Rn.onUncombineFeatures=function(){var R=this,H=this.getSelected();if(H.length!==0){for(var ft=[],Ht=[],Ce=function(be){var en=H[be];R.isInstanceOf("MultiFeature",en)&&(en.getFeatures().forEach((function(nn){R.addFeature(nn),nn.properties=en.properties,ft.push(nn.toGeoJSON()),R.select([nn.id])})),R.deleteFeature(en.id,{silent:!0}),Ht.push(en.toGeoJSON()))},pe=0;pe<H.length;pe++)Ce(pe);ft.length>1&&this.map.fire(yi,{createdFeatures:ft,deletedFeatures:Ht}),this.fireActionable()}};var _a=Zr(Fr),Ns=Zr(lr),gi={fireUpdate:function(){this.map.fire(ve,{action:jr,features:this.getSelected().map((function(R){return R.toGeoJSON()}))})},fireActionable:function(R){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:R.selectedCoordPaths.length>0})},startDragging:function(R,H){this.map.dragPan.disable(),R.canDragMove=!0,R.dragMoveLocation=H.lngLat},stopDragging:function(R){this.map.dragPan.enable(),R.dragMoving=!1,R.canDragMove=!1,R.dragMoveLocation=null},onVertex:function(R,H){this.startDragging(R,H);var ft=H.featureTarget.properties,Ht=R.selectedCoordPaths.indexOf(ft.coord_path);Lt(H)||Ht!==-1?Lt(H)&&Ht===-1&&R.selectedCoordPaths.push(ft.coord_path):R.selectedCoordPaths=[ft.coord_path];var Ce=this.pathsToCoordinates(R.featureId,R.selectedCoordPaths);this.setSelectedCoordinates(Ce)},onMidpoint:function(R,H){this.startDragging(R,H);var ft=H.featureTarget.properties;R.feature.addCoordinate(ft.coord_path,ft.lng,ft.lat),this.fireUpdate(),R.selectedCoordPaths=[ft.coord_path]},pathsToCoordinates:function(R,H){return H.map((function(ft){return{feature_id:R,coord_path:ft}}))},onFeature:function(R,H){R.selectedCoordPaths.length===0?this.startDragging(R,H):this.stopDragging(R)},dragFeature:function(R,H,ft){Hr(this.getSelected(),ft),R.dragMoveLocation=H.lngLat},dragVertex:function(R,H,ft){for(var Ht=R.selectedCoordPaths.map((function(en){return R.feature.getCoordinate(en)})),Ce=_e(Ht.map((function(en){return{type:Yt,properties:{},geometry:{type:Sn,coordinates:en}}})),ft),pe=0;pe<Ht.length;pe++){var be=Ht[pe];R.feature.updateCoordinate(R.selectedCoordPaths[pe],be[0]+Ce.lng,be[1]+Ce.lat)}},clickNoTarget:function(){this.changeMode(te.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(te.SIMPLE_SELECT)},clickActiveFeature:function(R){R.selectedCoordPaths=[],this.clearSelectedCoordinates(),R.feature.changed()},onSetup:function(R){var H=R.featureId,ft=this.getFeature(H);if(!ft)throw new Error("You must provide a featureId to enter direct_select mode");if(ft.type===Sn)throw new TypeError("direct_select mode doesn't handle point features");var Ht={featureId:H,feature:ft,dragMoveLocation:R.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:R.coordPath?[R.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(H,Ht.selectedCoordPaths)),this.setSelected(H),Je(this),this.setActionableState({trash:!0}),Ht},onStop:function(){yn(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(R,H,ft){R.featureId===H.properties.id?(H.properties.active=Mn,ft(H),je(H,{map:this.map,midpoints:!0,selectedPaths:R.selectedCoordPaths}).forEach(ft)):(H.properties.active=ui,ft(H)),this.fireActionable(R)},onTrash:function(R){R.selectedCoordPaths.sort((function(H,ft){return ft.localeCompare(H,"en",{numeric:!0})})).forEach((function(H){return R.feature.removeCoordinate(H)})),this.fireUpdate(),R.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(R),R.feature.isValid()===!1&&(this.deleteFeature([R.featureId]),this.changeMode(te.SIMPLE_SELECT,{}))},onMouseMove:function(R,H){var ft=Yi(H),Ht=_a(H),Ce=R.selectedCoordPaths.length===0;return ft&&Ce||Ht&&!Ce?this.updateUIClasses({mouse:Dt}):this.updateUIClasses({mouse:Xt}),this.stopDragging(R),!0},onMouseOut:function(R){return R.dragMoving&&this.fireUpdate(),!0}};gi.onTouchStart=gi.onMouseDown=function(R,H){return _a(H)?this.onVertex(R,H):Yi(H)?this.onFeature(R,H):Ns(H)?this.onMidpoint(R,H):void 0},gi.onDrag=function(R,H){if(R.canDragMove===!0){R.dragMoving=!0,H.originalEvent.stopPropagation();var ft={lng:H.lngLat.lng-R.dragMoveLocation.lng,lat:H.lngLat.lat-R.dragMoveLocation.lat};R.selectedCoordPaths.length>0?this.dragVertex(R,H,ft):this.dragFeature(R,H,ft),R.dragMoveLocation=H.lngLat}},gi.onClick=function(R,H){return et(H)?this.clickNoTarget(R,H):Yi(H)?this.clickActiveFeature(R,H):Ct(H)?this.clickInactive(R,H):void this.stopDragging(R)},gi.onTap=function(R,H){return et(H)?this.clickNoTarget(R,H):Yi(H)?this.clickActiveFeature(R,H):Ct(H)?this.clickInactive(R,H):void 0},gi.onTouchEnd=gi.onMouseUp=function(R){R.dragMoving&&this.fireUpdate(),this.stopDragging(R)};var ji={};function ea(R,H){return!!R.lngLat&&R.lngLat.lng===H[0]&&R.lngLat.lat===H[1]}ji.onSetup=function(){var R=this.newFeature({type:Yt,properties:{},geometry:{type:Sn,coordinates:[]}});return this.addFeature(R),this.clearSelectedFeatures(),this.updateUIClasses({mouse:It}),this.activateUIButton(ie.POINT),this.setActionableState({trash:!0}),{point:R}},ji.stopDrawingAndRemove=function(R){this.deleteFeature([R.point.id],{silent:!0}),this.changeMode(te.SIMPLE_SELECT)},ji.onTap=ji.onClick=function(R,H){this.updateUIClasses({mouse:Dt}),R.point.updateCoordinate("",H.lngLat.lng,H.lngLat.lat),this.map.fire(mt,{features:[R.point.toGeoJSON()]}),this.changeMode(te.SIMPLE_SELECT,{featureIds:[R.point.id]})},ji.onStop=function(R){this.activateUIButton(),R.point.getCoordinate().length||this.deleteFeature([R.point.id],{silent:!0})},ji.toDisplayFeatures=function(R,H,ft){var Ht=H.properties.id===R.point.id;if(H.properties.active=Ht?Mn:ui,!Ht)return ft(H)},ji.onTrash=ji.stopDrawingAndRemove,ji.onKeyUp=function(R,H){if(Pt(H)||Kt(H))return this.stopDrawingAndRemove(R,H)};var kr={onSetup:function(){var R=this.newFeature({type:Yt,properties:{},geometry:{type:rt,coordinates:[[]]}});return this.addFeature(R),this.clearSelectedFeatures(),Je(this),this.updateUIClasses({mouse:It}),this.activateUIButton(ie.POLYGON),this.setActionableState({trash:!0}),{polygon:R,currentVertexPosition:0}},clickAnywhere:function(R,H){if(R.currentVertexPosition>0&&ea(H,R.polygon.coordinates[0][R.currentVertexPosition-1]))return this.changeMode(te.SIMPLE_SELECT,{featureIds:[R.polygon.id]});this.updateUIClasses({mouse:It}),R.polygon.updateCoordinate("0."+R.currentVertexPosition,H.lngLat.lng,H.lngLat.lat),R.currentVertexPosition++,R.polygon.updateCoordinate("0."+R.currentVertexPosition,H.lngLat.lng,H.lngLat.lat)},clickOnVertex:function(R){return this.changeMode(te.SIMPLE_SELECT,{featureIds:[R.polygon.id]})},onMouseMove:function(R,H){R.polygon.updateCoordinate("0."+R.currentVertexPosition,H.lngLat.lng,H.lngLat.lat),ot(H)&&this.updateUIClasses({mouse:Jt})}};kr.onTap=kr.onClick=function(R,H){return ot(H)?this.clickOnVertex(R,H):this.clickAnywhere(R,H)},kr.onKeyUp=function(R,H){Pt(H)?(this.deleteFeature([R.polygon.id],{silent:!0}),this.changeMode(te.SIMPLE_SELECT)):Kt(H)&&this.changeMode(te.SIMPLE_SELECT,{featureIds:[R.polygon.id]})},kr.onStop=function(R){this.updateUIClasses({mouse:Xt}),yn(this),this.activateUIButton(),this.getFeature(R.polygon.id)!==void 0&&(R.polygon.removeCoordinate("0."+R.currentVertexPosition),R.polygon.isValid()?this.map.fire(mt,{features:[R.polygon.toGeoJSON()]}):(this.deleteFeature([R.polygon.id],{silent:!0}),this.changeMode(te.SIMPLE_SELECT,{},{silent:!0})))},kr.toDisplayFeatures=function(R,H,ft){var Ht=H.properties.id===R.polygon.id;if(H.properties.active=Ht?Mn:ui,!Ht)return ft(H);if(H.geometry.coordinates.length!==0){var Ce=H.geometry.coordinates[0].length;if(!(Ce<3)){if(H.properties.meta=Bn,ft(me(R.polygon.id,H.geometry.coordinates[0][0],"0.0",!1)),Ce>3){var pe=H.geometry.coordinates[0].length-3;ft(me(R.polygon.id,H.geometry.coordinates[0][pe],"0."+pe,!1))}if(Ce<=4){var be=[[H.geometry.coordinates[0][0][0],H.geometry.coordinates[0][0][1]],[H.geometry.coordinates[0][1][0],H.geometry.coordinates[0][1][1]]];if(ft({type:Yt,properties:H.properties,geometry:{coordinates:be,type:qe}}),Ce===3)return}return ft(H)}}},kr.onTrash=function(R){this.deleteFeature([R.polygon.id],{silent:!0}),this.changeMode(te.SIMPLE_SELECT)};var re={onSetup:function(R){var H,ft,Ht=(R=R||{}).featureId,Ce="forward";if(Ht){if(!(H=this.getFeature(Ht)))throw new Error("Could not find a feature with the provided featureId");var pe=R.from;if(pe&&pe.type==="Feature"&&pe.geometry&&pe.geometry.type==="Point"&&(pe=pe.geometry),pe&&pe.type==="Point"&&pe.coordinates&&pe.coordinates.length===2&&(pe=pe.coordinates),!pe||!Array.isArray(pe))throw new Error("Please use the `from` property to indicate which point to continue the line from");var be=H.coordinates.length-1;if(H.coordinates[be][0]===pe[0]&&H.coordinates[be][1]===pe[1])ft=be+1,H.addCoordinate.apply(H,[ft].concat(H.coordinates[be]));else{if(H.coordinates[0][0]!==pe[0]||H.coordinates[0][1]!==pe[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Ce="backwards",ft=0,H.addCoordinate.apply(H,[ft].concat(H.coordinates[0]))}}else H=this.newFeature({type:Yt,properties:{},geometry:{type:qe,coordinates:[]}}),ft=0,this.addFeature(H);return this.clearSelectedFeatures(),Je(this),this.updateUIClasses({mouse:It}),this.activateUIButton(ie.LINE),this.setActionableState({trash:!0}),{line:H,currentVertexPosition:ft,direction:Ce}},clickAnywhere:function(R,H){if(R.currentVertexPosition>0&&ea(H,R.line.coordinates[R.currentVertexPosition-1])||R.direction==="backwards"&&ea(H,R.line.coordinates[R.currentVertexPosition+1]))return this.changeMode(te.SIMPLE_SELECT,{featureIds:[R.line.id]});this.updateUIClasses({mouse:It}),R.line.updateCoordinate(R.currentVertexPosition,H.lngLat.lng,H.lngLat.lat),R.direction==="forward"?(R.currentVertexPosition++,R.line.updateCoordinate(R.currentVertexPosition,H.lngLat.lng,H.lngLat.lat)):R.line.addCoordinate(0,H.lngLat.lng,H.lngLat.lat)},clickOnVertex:function(R){return this.changeMode(te.SIMPLE_SELECT,{featureIds:[R.line.id]})},onMouseMove:function(R,H){R.line.updateCoordinate(R.currentVertexPosition,H.lngLat.lng,H.lngLat.lat),ot(H)&&this.updateUIClasses({mouse:Jt})}};re.onTap=re.onClick=function(R,H){if(ot(H))return this.clickOnVertex(R,H);this.clickAnywhere(R,H)},re.onKeyUp=function(R,H){Kt(H)?this.changeMode(te.SIMPLE_SELECT,{featureIds:[R.line.id]}):Pt(H)&&(this.deleteFeature([R.line.id],{silent:!0}),this.changeMode(te.SIMPLE_SELECT))},re.onStop=function(R){yn(this),this.activateUIButton(),this.getFeature(R.line.id)!==void 0&&(R.line.removeCoordinate(""+R.currentVertexPosition),R.line.isValid()?this.map.fire(mt,{features:[R.line.toGeoJSON()]}):(this.deleteFeature([R.line.id],{silent:!0}),this.changeMode(te.SIMPLE_SELECT,{},{silent:!0})))},re.onTrash=function(R){this.deleteFeature([R.line.id],{silent:!0}),this.changeMode(te.SIMPLE_SELECT)},re.toDisplayFeatures=function(R,H,ft){var Ht=H.properties.id===R.line.id;if(H.properties.active=Ht?Mn:ui,!Ht)return ft(H);H.geometry.coordinates.length<2||(H.properties.meta=Bn,ft(me(R.line.id,H.geometry.coordinates[R.direction==="forward"?H.geometry.coordinates.length-2:1],""+(R.direction==="forward"?H.geometry.coordinates.length-2:1),!1)),ft(H))};var gn={simple_select:Rn,direct_select:gi,draw_point:ji,draw_polygon:kr,draw_line_string:re},zn={defaultMode:te.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:gn,controls:{},userProperties:!1},Ts={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Ja={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Hn(R,H){return R.map((function(ft){return ft.source?ft:Ds(ft,{id:ft.id+"."+H,source:H==="hot"?lt:pt})}))}var Ka=hs((function(R,H){var ft="[object Arguments]",Ht="[object Map]",Ce="[object Object]",pe="[object Set]",be=/^\[object .+?Constructor\]$/,en=/^(?:0|[1-9]\d*)$/,nn={};nn["[object Float32Array]"]=nn["[object Float64Array]"]=nn["[object Int8Array]"]=nn["[object Int16Array]"]=nn["[object Int32Array]"]=nn["[object Uint8Array]"]=nn["[object Uint8ClampedArray]"]=nn["[object Uint16Array]"]=nn["[object Uint32Array]"]=!0,nn[ft]=nn["[object Array]"]=nn["[object ArrayBuffer]"]=nn["[object Boolean]"]=nn["[object DataView]"]=nn["[object Date]"]=nn["[object Error]"]=nn["[object Function]"]=nn[Ht]=nn["[object Number]"]=nn[Ce]=nn["[object RegExp]"]=nn[pe]=nn["[object String]"]=nn["[object WeakMap]"]=!1;var wn=typeof Tm=="object"&&Tm&&Tm.Object===Object&&Tm,we=typeof self=="object"&&self&&self.Object===Object&&self,Qe=wn||we||Function("return this")(),Tn=H&&!H.nodeType&&H,Yn=Tn&&R&&!R.nodeType&&R,Pn=Yn&&Yn.exports===Tn,Ni=Pn&&wn.process,ke=(function(){try{return Ni&&Ni.binding&&Ni.binding("util")}catch{}})(),_n=ke&&ke.isTypedArray;function kn(oe,De){for(var vn=-1,Wn=oe==null?0:oe.length;++vn<Wn;)if(De(oe[vn],vn,oe))return!0;return!1}function Xi(oe){var De=-1,vn=Array(oe.size);return oe.forEach((function(Wn,mn){vn[++De]=[mn,Wn]})),vn}function Wi(oe){var De=-1,vn=Array(oe.size);return oe.forEach((function(Wn){vn[++De]=Wn})),vn}var xn,gr,ur,qi=Array.prototype,Yr=Function.prototype,ss=Object.prototype,Da=Qe["__core-js_shared__"],Co=Yr.toString,no=ss.hasOwnProperty,fs=(xn=/[^.]+$/.exec(Da&&Da.keys&&Da.keys.IE_PROTO||""))?"Symbol(src)_1."+xn:"",Ci=ss.toString,ho=RegExp("^"+Co.call(no).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fo=Pn?Qe.Buffer:void 0,io=Qe.Symbol,jo=Qe.Uint8Array,Io=ss.propertyIsEnumerable,Cs=qi.splice,ro=io?io.toStringTag:void 0,Os=Object.getOwnPropertySymbols,Pu=fo?fo.isBuffer:void 0,Qa=(gr=Object.keys,ur=Object,function(oe){return gr(ur(oe))}),xl=za(Qe,"DataView"),Ke=za(Qe,"Map"),Hs=za(Qe,"Promise"),wr=za(Qe,"Set"),tl=za(Qe,"WeakMap"),Xo=za(Object,"create"),du=Nr(xl),Na=Nr(Ke),ia=Nr(Hs),Xl=Nr(wr),zs=Nr(tl),Oi=io?io.prototype:void 0,Mo=Oi?Oi.valueOf:void 0;function Ps(oe){var De=-1,vn=oe==null?0:oe.length;for(this.clear();++De<vn;){var Wn=oe[De];this.set(Wn[0],Wn[1])}}function Ao(oe){var De=-1,vn=oe==null?0:oe.length;for(this.clear();++De<vn;){var Wn=oe[De];this.set(Wn[0],Wn[1])}}function va(oe){var De=-1,vn=oe==null?0:oe.length;for(this.clear();++De<vn;){var Wn=oe[De];this.set(Wn[0],Wn[1])}}function Zl(oe){var De=-1,vn=oe==null?0:oe.length;for(this.__data__=new va;++De<vn;)this.add(oe[De])}function Zo(oe){var De=this.__data__=new Ao(oe);this.size=De.size}function po(oe,De){var vn=el(oe),Wn=!vn&&ba(oe),mn=!vn&&!Wn&&Yl(oe),hi=!vn&&!Wn&&!mn&&Ys(oe),wi=vn||Wn||mn||hi,sr=wi?(function(Gr,Jn){for(var zi=-1,tr=Array(Gr);++zi<Gr;)tr[zi]=Jn(zi);return tr})(oe.length,String):[],Ws=sr.length;for(var ds in oe)!no.call(oe,ds)||wi&&(ds=="length"||mn&&(ds=="offset"||ds=="parent")||hi&&(ds=="buffer"||ds=="byteLength"||ds=="byteOffset")||Ju(ds,Ws))||sr.push(ds);return sr}function ra(oe,De){for(var vn=oe.length;vn--;)if(El(oe[vn][0],De))return vn;return-1}function xa(oe){return oe==null?oe===void 0?"[object Undefined]":"[object Null]":ro&&ro in Object(oe)?(function(De){var vn=no.call(De,ro),Wn=De[ro];try{De[ro]=void 0;var mn=!0}catch{}var hi=Ci.call(De);return mn&&(vn?De[ro]=Wn:delete De[ro]),hi})(oe):(function(De){return Ci.call(De)})(oe)}function Ho(oe){return Ro(oe)&&xa(oe)==ft}function bl(oe,De,vn,Wn,mn){return oe===De||(oe==null||De==null||!Ro(oe)&&!Ro(De)?oe!=oe&&De!=De:(function(hi,wi,sr,Ws,ds,Gr){var Jn=el(hi),zi=el(wi),tr=Jn?"[object Array]":sa(hi),cr=zi?"[object Array]":sa(wi),Yo=(tr=tr==ft?Ce:tr)==Ce,wa=(cr=cr==ft?Ce:cr)==Ce,Gs=tr==cr;if(Gs&&Yl(hi)){if(!Yl(wi))return!1;Jn=!0,Yo=!1}if(Gs&&!Yo)return Gr||(Gr=new Zo),Jn||Ys(hi)?Oa(hi,wi,sr,Ws,ds,Gr):(function(or,Ai,oa,nl,Do,Or,Bs){switch(oa){case"[object DataView]":if(or.byteLength!=Ai.byteLength||or.byteOffset!=Ai.byteOffset)return!1;or=or.buffer,Ai=Ai.buffer;case"[object ArrayBuffer]":return!(or.byteLength!=Ai.byteLength||!Or(new jo(or),new jo(Ai)));case"[object Boolean]":case"[object Date]":case"[object Number]":return El(+or,+Ai);case"[object Error]":return or.name==Ai.name&&or.message==Ai.message;case"[object RegExp]":case"[object String]":return or==Ai+"";case Ht:var mo=Xi;case pe:var Vs=1&nl;if(mo||(mo=Wi),or.size!=Ai.size&&!Vs)return!1;var Wl=Bs.get(or);if(Wl)return Wl==Ai;nl|=2,Bs.set(or,Ai);var il=Oa(mo(or),mo(Ai),nl,Do,Or,Bs);return Bs.delete(or),il;case"[object Symbol]":if(Mo)return Mo.call(or)==Mo.call(Ai)}return!1})(hi,wi,tr,sr,Ws,ds,Gr);if(!(1&sr)){var ps=Yo&&no.call(hi,"__wrapped__"),Ba=wa&&no.call(wi,"__wrapped__");if(ps||Ba){var Sl=ps?hi.value():hi,Tl=Ba?wi.value():wi;return Gr||(Gr=new Zo),ds(Sl,Tl,sr,Ws,Gr)}}return Gs?(Gr||(Gr=new Zo),(function(or,Ai,oa,nl,Do,Or){var Bs=1&oa,mo=Hl(or),Vs=mo.length,Wl=Hl(Ai).length;if(Vs!=Wl&&!Bs)return!1;for(var il=Vs;il--;){var yo=mo[il];if(!(Bs?yo in Ai:no.call(Ai,yo)))return!1}var $l=Or.get(or);if($l&&Or.get(Ai))return $l==Ai;var rl=!0;Or.set(or,Ai),Or.set(Ai,or);for(var Ea=Bs;++il<Vs;){yo=mo[il];var Wo=or[yo],sl=Ai[yo];if(nl)var _o=Bs?nl(sl,Wo,yo,Ai,or,Or):nl(Wo,sl,yo,or,Ai,Or);if(!(_o===void 0?Wo===sl||Do(Wo,sl,oa,nl,Or):_o)){rl=!1;break}Ea||(Ea=yo=="constructor")}if(rl&&!Ea){var In=or.constructor,so=Ai.constructor;In==so||!("constructor"in or)||!("constructor"in Ai)||typeof In=="function"&&In instanceof In&&typeof so=="function"&&so instanceof so||(rl=!1)}return Or.delete(or),Or.delete(Ai),rl})(hi,wi,sr,Ws,ds,Gr)):!1})(oe,De,vn,Wn,bl,mn))}function Ii(oe){return!(!Pa(oe)||(function(De){return!!fs&&fs in De})(oe))&&(Ku(oe)?ho:be).test(Nr(oe))}function wl(oe){if(vn=(De=oe)&&De.constructor,Wn=typeof vn=="function"&&vn.prototype||ss,De!==Wn)return Qa(oe);var De,vn,Wn,mn=[];for(var hi in Object(oe))no.call(oe,hi)&&hi!="constructor"&&mn.push(hi);return mn}function Oa(oe,De,vn,Wn,mn,hi){var wi=1&vn,sr=oe.length,Ws=De.length;if(sr!=Ws&&!(wi&&Ws>sr))return!1;var ds=hi.get(oe);if(ds&&hi.get(De))return ds==De;var Gr=-1,Jn=!0,zi=2&vn?new Zl:void 0;for(hi.set(oe,De),hi.set(De,oe);++Gr<sr;){var tr=oe[Gr],cr=De[Gr];if(Wn)var Yo=wi?Wn(cr,tr,Gr,De,oe,hi):Wn(tr,cr,Gr,oe,De,hi);if(Yo!==void 0){if(Yo)continue;Jn=!1;break}if(zi){if(!kn(De,(function(wa,Gs){if(ps=Gs,!zi.has(ps)&&(tr===wa||mn(tr,wa,vn,Wn,hi)))return zi.push(Gs);var ps}))){Jn=!1;break}}else if(tr!==cr&&!mn(tr,cr,vn,Wn,hi)){Jn=!1;break}}return hi.delete(oe),hi.delete(De),Jn}function Hl(oe){return(function(De,vn,Wn){var mn=vn(De);return el(De)?mn:(function(hi,wi){for(var sr=-1,Ws=wi.length,ds=hi.length;++sr<Ws;)hi[ds+sr]=wi[sr];return hi})(mn,Wn(De))})(oe,go,Bu)}function Lo(oe,De){var vn,Wn,mn=oe.__data__;return((Wn=typeof(vn=De))=="string"||Wn=="number"||Wn=="symbol"||Wn=="boolean"?vn!=="__proto__":vn===null)?mn[typeof De=="string"?"string":"hash"]:mn.map}function za(oe,De){var vn=(function(Wn,mn){return Wn?.[mn]})(oe,De);return Ii(vn)?vn:void 0}Ps.prototype.clear=function(){this.__data__=Xo?Xo(null):{},this.size=0},Ps.prototype.delete=function(oe){var De=this.has(oe)&&delete this.__data__[oe];return this.size-=De?1:0,De},Ps.prototype.get=function(oe){var De=this.__data__;if(Xo){var vn=De[oe];return vn==="__lodash_hash_undefined__"?void 0:vn}return no.call(De,oe)?De[oe]:void 0},Ps.prototype.has=function(oe){var De=this.__data__;return Xo?De[oe]!==void 0:no.call(De,oe)},Ps.prototype.set=function(oe,De){var vn=this.__data__;return this.size+=this.has(oe)?0:1,vn[oe]=Xo&&De===void 0?"__lodash_hash_undefined__":De,this},Ao.prototype.clear=function(){this.__data__=[],this.size=0},Ao.prototype.delete=function(oe){var De=this.__data__,vn=ra(De,oe);return!(vn<0)&&(vn==De.length-1?De.pop():Cs.call(De,vn,1),--this.size,!0)},Ao.prototype.get=function(oe){var De=this.__data__,vn=ra(De,oe);return vn<0?void 0:De[vn][1]},Ao.prototype.has=function(oe){return ra(this.__data__,oe)>-1},Ao.prototype.set=function(oe,De){var vn=this.__data__,Wn=ra(vn,oe);return Wn<0?(++this.size,vn.push([oe,De])):vn[Wn][1]=De,this},va.prototype.clear=function(){this.size=0,this.__data__={hash:new Ps,map:new(Ke||Ao),string:new Ps}},va.prototype.delete=function(oe){var De=Lo(this,oe).delete(oe);return this.size-=De?1:0,De},va.prototype.get=function(oe){return Lo(this,oe).get(oe)},va.prototype.has=function(oe){return Lo(this,oe).has(oe)},va.prototype.set=function(oe,De){var vn=Lo(this,oe),Wn=vn.size;return vn.set(oe,De),this.size+=vn.size==Wn?0:1,this},Zl.prototype.add=Zl.prototype.push=function(oe){return this.__data__.set(oe,"__lodash_hash_undefined__"),this},Zl.prototype.has=function(oe){return this.__data__.has(oe)},Zo.prototype.clear=function(){this.__data__=new Ao,this.size=0},Zo.prototype.delete=function(oe){var De=this.__data__,vn=De.delete(oe);return this.size=De.size,vn},Zo.prototype.get=function(oe){return this.__data__.get(oe)},Zo.prototype.has=function(oe){return this.__data__.has(oe)},Zo.prototype.set=function(oe,De){var vn=this.__data__;if(vn instanceof Ao){var Wn=vn.__data__;if(!Ke||Wn.length<199)return Wn.push([oe,De]),this.size=++vn.size,this;vn=this.__data__=new va(Wn)}return vn.set(oe,De),this.size=vn.size,this};var Bu=Os?function(oe){return oe==null?[]:(oe=Object(oe),(function(De,vn){for(var Wn=-1,mn=De==null?0:De.length,hi=0,wi=[];++Wn<mn;){var sr=De[Wn];vn(sr,Wn,De)&&(wi[hi++]=sr)}return wi})(Os(oe),(function(De){return Io.call(oe,De)})))}:function(){return[]},sa=xa;function Ju(oe,De){return!!(De=De??9007199254740991)&&(typeof oe=="number"||en.test(oe))&&oe>-1&&oe%1==0&&oe<De}function Nr(oe){if(oe!=null){try{return Co.call(oe)}catch{}try{return oe+""}catch{}}return""}function El(oe,De){return oe===De||oe!=oe&&De!=De}(xl&&sa(new xl(new ArrayBuffer(1)))!="[object DataView]"||Ke&&sa(new Ke)!=Ht||Hs&&sa(Hs.resolve())!="[object Promise]"||wr&&sa(new wr)!=pe||tl&&sa(new tl)!="[object WeakMap]")&&(sa=function(oe){var De=xa(oe),vn=De==Ce?oe.constructor:void 0,Wn=vn?Nr(vn):"";if(Wn)switch(Wn){case du:return"[object DataView]";case Na:return Ht;case ia:return"[object Promise]";case Xl:return pe;case zs:return"[object WeakMap]"}return De});var ba=Ho((function(){return arguments})())?Ho:function(oe){return Ro(oe)&&no.call(oe,"callee")&&!Io.call(oe,"callee")},el=Array.isArray,Yl=Pu||function(){return!1};function Ku(oe){if(!Pa(oe))return!1;var De=xa(oe);return De=="[object Function]"||De=="[object GeneratorFunction]"||De=="[object AsyncFunction]"||De=="[object Proxy]"}function Qu(oe){return typeof oe=="number"&&oe>-1&&oe%1==0&&oe<=9007199254740991}function Pa(oe){var De=typeof oe;return oe!=null&&(De=="object"||De=="function")}function Ro(oe){return oe!=null&&typeof oe=="object"}var Ys=_n?(function(oe){return function(De){return oe(De)}})(_n):function(oe){return Ro(oe)&&Qu(oe.length)&&!!nn[xa(oe)]};function go(oe){return(De=oe)!=null&&Qu(De.length)&&!Ku(De)?po(oe):wl(oe);var De}R.exports=function(oe,De){return bl(oe,De)}})),Ur={Polygon:Ki,LineString:ri,Point:Xr,MultiPolygon:_r,MultiLineString:_r,MultiPoint:_r};function na(R,H){return H.modes=te,H.getFeatureIdsAt=function(ft){return Wa.click({point:ft},null,R).map((function(Ht){return Ht.properties.id}))},H.getSelectedIds=function(){return R.store.getSelectedIds()},H.getSelected=function(){return{type:Xn,features:R.store.getSelectedIds().map((function(ft){return R.store.get(ft)})).map((function(ft){return ft.toGeoJSON()}))}},H.getSelectedPoints=function(){return{type:Xn,features:R.store.getSelectedCoordinates().map((function(ft){return{type:Yt,properties:{},geometry:{type:Sn,coordinates:ft.coordinates}}}))}},H.set=function(ft){if(ft.type===void 0||ft.type!==Xn||!Array.isArray(ft.features))throw new Error("Invalid FeatureCollection");var Ht=R.store.createRenderBatch(),Ce=R.store.getAllIds().slice(),pe=H.add(ft),be=new vi(pe);return(Ce=Ce.filter((function(en){return!be.has(en)}))).length&&H.delete(Ce),Ht(),pe},H.add=function(ft){var Ht=JSON.parse(JSON.stringify(Zn(ft))).features.map((function(Ce){if(Ce.id=Ce.id||$e(),Ce.geometry===null)throw new Error("Invalid geometry: null");if(R.store.get(Ce.id)===void 0||R.store.get(Ce.id).type!==Ce.geometry.type){var pe=Ur[Ce.geometry.type];if(pe===void 0)throw new Error("Invalid geometry type: "+Ce.geometry.type+".");var be=new pe(R,Ce);R.store.add(be)}else{var en=R.store.get(Ce.id);en.properties=Ce.properties,Ka(en.getCoordinates(),Ce.geometry.coordinates)||en.incomingCoords(Ce.geometry.coordinates)}return Ce.id}));return R.store.render(),Ht},H.get=function(ft){var Ht=R.store.get(ft);if(Ht)return Ht.toGeoJSON()},H.getAll=function(){return{type:Xn,features:R.store.getAll().map((function(ft){return ft.toGeoJSON()}))}},H.delete=function(ft){return R.store.delete(ft,{silent:!0}),H.getMode()!==te.DIRECT_SELECT||R.store.getSelectedIds().length?R.store.render():R.events.changeMode(te.SIMPLE_SELECT,void 0,{silent:!0}),H},H.deleteAll=function(){return R.store.delete(R.store.getAllIds(),{silent:!0}),H.getMode()===te.DIRECT_SELECT?R.events.changeMode(te.SIMPLE_SELECT,void 0,{silent:!0}):R.store.render(),H},H.changeMode=function(ft,Ht){return Ht===void 0&&(Ht={}),ft===te.SIMPLE_SELECT&&H.getMode()===te.SIMPLE_SELECT?(Ce=Ht.featureIds||[],pe=R.store.getSelectedIds(),Ce.length===pe.length&&JSON.stringify(Ce.map((function(be){return be})).sort())===JSON.stringify(pe.map((function(be){return be})).sort())||(R.store.setSelected(Ht.featureIds,{silent:!0}),R.store.render()),H):(ft===te.DIRECT_SELECT&&H.getMode()===te.DIRECT_SELECT&&Ht.featureId===R.store.getSelectedIds()[0]||R.events.changeMode(ft,Ht,{silent:!0}),H);var Ce,pe},H.getMode=function(){return R.events.getMode()},H.trash=function(){return R.events.trash({silent:!0}),H},H.combineFeatures=function(){return R.events.combineFeatures({silent:!0}),H},H.uncombineFeatures=function(){return R.events.uncombineFeatures({silent:!0}),H},H.setFeatureProperty=function(ft,Ht,Ce){return R.store.setFeatureProperty(ft,Ht,Ce),H},H}var br=function(R,H){var ft={options:R=(function(Ce){Ce===void 0&&(Ce={});var pe=Ds(Ce);return Ce.controls||(pe.controls={}),Ce.displayControlsDefault===!1?pe.controls=Ds(Ja,Ce.controls):pe.controls=Ds(Ts,Ce.controls),(pe=Ds(zn,pe)).styles=Hn(pe.styles,"cold").concat(Hn(pe.styles,"hot")),pe})(R)};H=na(ft,H),ft.api=H;var Ht=Pi(ft);return H.onAdd=Ht.onAdd,H.onRemove=Ht.onRemove,H.types=ie,H.options=R,H};function Qi(R){br(R,this)}return Qi.modes=gn,Qi}))})(Lm)),Lm.exports}var O1=N1();const z1=rp(O1),Ix=new z1({displayControlsDefault:!1,controls:{polygon:!0,trash:!1}}),P1={isMapReady:!1,draw:Ix,map:void 0},B1=({children:B})=>{const[V,F]=Ls.useReducer(R1,P1),T=G=>{G.addControl(Ix),G.addControl(new Cx.NavigationControl,"top-left"),F({type:"setMap",payload:G})};return Ui.jsx(W_.Provider,{value:{...V,setMap:T},children:B})},Mx=Ls.createContext({}),F1=async()=>new Promise((B,V)=>{navigator.geolocation.getCurrentPosition(({coords:F})=>{B([F.longitude,F.latitude])},F=>{alert("No se pudo obtener la geolocalizacin"),console.log(F),V()})}),k1=(B,V)=>{switch(V.type){case"setUserLocation":return{...B,isLoading:!1,userLocation:V.payload};default:return B}},U1={isLoading:!0,userLocation:void 0};function G1({children:B}){const[V,F]=Ls.useReducer(k1,U1);return Ls.useEffect(()=>{F1().then(T=>F({type:"setUserLocation",payload:T}))},[]),Ui.jsx(Mx.Provider,{value:{...V},children:B})}Ls.createContext({});function Ax(B,V){return function(){return B.apply(V,arguments)}}const{toString:Lx}=Object.prototype,{getPrototypeOf:$_}=Object,J_=(B=>V=>{const F=Lx.call(V);return B[F]||(B[F]=F.slice(8,-1).toLowerCase())})(Object.create(null)),Vh=B=>(B=B.toLowerCase(),V=>J_(V)===B),Om=B=>V=>typeof V===B,{isArray:sp}=Array,bg=Om("undefined");function V1(B){return B!==null&&!bg(B)&&B.constructor!==null&&!bg(B.constructor)&&gd(B.constructor.isBuffer)&&B.constructor.isBuffer(B)}const Rx=Vh("ArrayBuffer");function q1(B){let V;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?V=ArrayBuffer.isView(B):V=B&&B.buffer&&Rx(B.buffer),V}const j1=Om("string"),gd=Om("function"),Dx=Om("number"),K_=B=>B!==null&&typeof B=="object",X1=B=>B===!0||B===!1,Rm=B=>{if(J_(B)!=="object")return!1;const V=$_(B);return(V===null||V===Object.prototype||Object.getPrototypeOf(V)===null)&&!(Symbol.toStringTag in B)&&!(Symbol.iterator in B)},Z1=Vh("Date"),H1=Vh("File"),Y1=Vh("Blob"),W1=Vh("FileList"),$1=B=>K_(B)&&gd(B.pipe),J1=B=>{const V="[object FormData]";return B&&(typeof FormData=="function"&&B instanceof FormData||Lx.call(B)===V||gd(B.toString)&&B.toString()===V)},K1=Vh("URLSearchParams"),Q1=B=>B.trim?B.trim():B.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wg(B,V,{allOwnKeys:F=!1}={}){if(B===null||typeof B>"u")return;let T,G;if(typeof B!="object"&&(B=[B]),sp(B))for(T=0,G=B.length;T<G;T++)V.call(null,B[T],T,B);else{const q=F?Object.getOwnPropertyNames(B):Object.keys(B),j=q.length;let J;for(T=0;T<j;T++)J=q[T],V.call(null,B[J],J,B)}}function Nx(B,V){V=V.toLowerCase();const F=Object.keys(B);let T=F.length,G;for(;T-- >0;)if(G=F[T],V===G.toLowerCase())return G;return null}const Ox=typeof self>"u"?typeof global>"u"?void 0:global:self,zx=B=>!bg(B)&&B!==Ox;function V_(){const{caseless:B}=zx(this)&&this||{},V={},F=(T,G)=>{const q=B&&Nx(V,G)||G;Rm(V[q])&&Rm(T)?V[q]=V_(V[q],T):Rm(T)?V[q]=V_({},T):sp(T)?V[q]=T.slice():V[q]=T};for(let T=0,G=arguments.length;T<G;T++)arguments[T]&&wg(arguments[T],F);return V}const tb=(B,V,F,{allOwnKeys:T}={})=>(wg(V,(G,q)=>{F&&gd(G)?B[q]=Ax(G,F):B[q]=G},{allOwnKeys:T}),B),eb=B=>(B.charCodeAt(0)===65279&&(B=B.slice(1)),B),nb=(B,V,F,T)=>{B.prototype=Object.create(V.prototype,T),B.prototype.constructor=B,Object.defineProperty(B,"super",{value:V.prototype}),F&&Object.assign(B.prototype,F)},ib=(B,V,F,T)=>{let G,q,j;const J={};if(V=V||{},B==null)return V;do{for(G=Object.getOwnPropertyNames(B),q=G.length;q-- >0;)j=G[q],(!T||T(j,B,V))&&!J[j]&&(V[j]=B[j],J[j]=!0);B=F!==!1&&$_(B)}while(B&&(!F||F(B,V))&&B!==Object.prototype);return V},rb=(B,V,F)=>{B=String(B),(F===void 0||F>B.length)&&(F=B.length),F-=V.length;const T=B.indexOf(V,F);return T!==-1&&T===F},sb=B=>{if(!B)return null;if(sp(B))return B;let V=B.length;if(!Dx(V))return null;const F=new Array(V);for(;V-- >0;)F[V]=B[V];return F},ob=(B=>V=>B&&V instanceof B)(typeof Uint8Array<"u"&&$_(Uint8Array)),ab=(B,V)=>{const T=(B&&B[Symbol.iterator]).call(B);let G;for(;(G=T.next())&&!G.done;){const q=G.value;V.call(B,q[0],q[1])}},lb=(B,V)=>{let F;const T=[];for(;(F=B.exec(V))!==null;)T.push(F);return T},ub=Vh("HTMLFormElement"),cb=B=>B.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(F,T,G){return T.toUpperCase()+G}),Vv=(({hasOwnProperty:B})=>(V,F)=>B.call(V,F))(Object.prototype),hb=Vh("RegExp"),Px=(B,V)=>{const F=Object.getOwnPropertyDescriptors(B),T={};wg(F,(G,q)=>{V(G,q,B)!==!1&&(T[q]=G)}),Object.defineProperties(B,T)},fb=B=>{Px(B,(V,F)=>{if(gd(B)&&["arguments","caller","callee"].indexOf(F)!==-1)return!1;const T=B[F];if(gd(T)){if(V.enumerable=!1,"writable"in V){V.writable=!1;return}V.set||(V.set=()=>{throw Error("Can not rewrite read-only method '"+F+"'")})}})},db=(B,V)=>{const F={},T=G=>{G.forEach(q=>{F[q]=!0})};return sp(B)?T(B):T(String(B).split(V)),F},pb=()=>{},gb=(B,V)=>(B=+B,Number.isFinite(B)?B:V),mb=B=>{const V=new Array(10),F=(T,G)=>{if(K_(T)){if(V.indexOf(T)>=0)return;if(!("toJSON"in T)){V[G]=T;const q=sp(T)?[]:{};return wg(T,(j,J)=>{const h=F(j,G+1);!bg(h)&&(q[J]=h)}),V[G]=void 0,q}}return T};return F(B,0)},un={isArray:sp,isArrayBuffer:Rx,isBuffer:V1,isFormData:J1,isArrayBufferView:q1,isString:j1,isNumber:Dx,isBoolean:X1,isObject:K_,isPlainObject:Rm,isUndefined:bg,isDate:Z1,isFile:H1,isBlob:Y1,isRegExp:hb,isFunction:gd,isStream:$1,isURLSearchParams:K1,isTypedArray:ob,isFileList:W1,forEach:wg,merge:V_,extend:tb,trim:Q1,stripBOM:eb,inherits:nb,toFlatObject:ib,kindOf:J_,kindOfTest:Vh,endsWith:rb,toArray:sb,forEachEntry:ab,matchAll:lb,isHTMLForm:ub,hasOwnProperty:Vv,hasOwnProp:Vv,reduceDescriptors:Px,freezeMethods:fb,toObjectSet:db,toCamelCase:cb,noop:pb,toFiniteNumber:gb,findKey:Nx,global:Ox,isContextDefined:zx,toJSONObject:mb};function Kr(B,V,F,T,G){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=B,this.name="AxiosError",V&&(this.code=V),F&&(this.config=F),T&&(this.request=T),G&&(this.response=G)}un.inherits(Kr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:un.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Bx=Kr.prototype,Fx={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(B=>{Fx[B]={value:B}});Object.defineProperties(Kr,Fx);Object.defineProperty(Bx,"isAxiosError",{value:!0});Kr.from=(B,V,F,T,G,q)=>{const j=Object.create(Bx);return un.toFlatObject(B,j,function(h){return h!==Error.prototype},J=>J!=="isAxiosError"),Kr.call(j,B.message,V,F,T,G),j.cause=B,j.name=B.name,q&&Object.assign(j,q),j};var Ay,qv;function yb(){return qv||(qv=1,Ay=typeof self=="object"?self.FormData:window.FormData),Ay}var _b=yb();const vb=rp(_b);function q_(B){return un.isPlainObject(B)||un.isArray(B)}function kx(B){return un.endsWith(B,"[]")?B.slice(0,-2):B}function jv(B,V,F){return B?B.concat(V).map(function(G,q){return G=kx(G),!F&&q?"["+G+"]":G}).join(F?".":""):V}function xb(B){return un.isArray(B)&&!B.some(q_)}const bb=un.toFlatObject(un,{},null,function(V){return/^is[A-Z]/.test(V)});function wb(B){return B&&un.isFunction(B.append)&&B[Symbol.toStringTag]==="FormData"&&B[Symbol.iterator]}function zm(B,V,F){if(!un.isObject(B))throw new TypeError("target must be an object");V=V||new(vb||FormData),F=un.toFlatObject(F,{metaTokens:!0,dots:!1,indexes:!1},!1,function(it,ae){return!un.isUndefined(ae[it])});const T=F.metaTokens,G=F.visitor||tt,q=F.dots,j=F.indexes,h=(F.Blob||typeof Blob<"u"&&Blob)&&wb(V);if(!un.isFunction(G))throw new TypeError("visitor must be a function");function X(yt){if(yt===null)return"";if(un.isDate(yt))return yt.toISOString();if(!h&&un.isBlob(yt))throw new Kr("Blob is not supported. Use a Buffer instead.");return un.isArrayBuffer(yt)||un.isTypedArray(yt)?h&&typeof Blob=="function"?new Blob([yt]):Buffer.from(yt):yt}function tt(yt,it,ae){let le=yt;if(yt&&!ae&&typeof yt=="object"){if(un.endsWith(it,"{}"))it=T?it:it.slice(0,-2),yt=JSON.stringify(yt);else if(un.isArray(yt)&&xb(yt)||un.isFileList(yt)||un.endsWith(it,"[]")&&(le=un.toArray(yt)))return it=kx(it),le.forEach(function(lt,pt){!(un.isUndefined(lt)||lt===null)&&V.append(j===!0?jv([it],pt,q):j===null?it:it+"[]",X(lt))}),!1}return q_(yt)?!0:(V.append(jv(ae,it,q),X(yt)),!1)}const ht=[],st=Object.assign(bb,{defaultVisitor:tt,convertValue:X,isVisitable:q_});function At(yt,it){if(!un.isUndefined(yt)){if(ht.indexOf(yt)!==-1)throw Error("Circular reference detected in "+it.join("."));ht.push(yt),un.forEach(yt,function(le,Ft){(!(un.isUndefined(le)||le===null)&&G.call(V,le,un.isString(Ft)?Ft.trim():Ft,it,st))===!0&&At(le,it?it.concat(Ft):[Ft])}),ht.pop()}}if(!un.isObject(B))throw new TypeError("data must be an object");return At(B),V}function Xv(B){const V={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(B).replace(/[!'()~]|%20|%00/g,function(T){return V[T]})}function Q_(B,V){this._pairs=[],B&&zm(B,this,V)}const Ux=Q_.prototype;Ux.append=function(V,F){this._pairs.push([V,F])};Ux.toString=function(V){const F=V?function(T){return V.call(this,T,Xv)}:Xv;return this._pairs.map(function(G){return F(G[0])+"="+F(G[1])},"").join("&")};function Eb(B){return encodeURIComponent(B).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gx(B,V,F){if(!V)return B;const T=F&&F.encode||Eb,G=F&&F.serialize;let q;if(G?q=G(V,F):q=un.isURLSearchParams(V)?V.toString():new Q_(V,F).toString(T),q){const j=B.indexOf("#");j!==-1&&(B=B.slice(0,j)),B+=(B.indexOf("?")===-1?"?":"&")+q}return B}class Zv{constructor(){this.handlers=[]}use(V,F,T){return this.handlers.push({fulfilled:V,rejected:F,synchronous:T?T.synchronous:!1,runWhen:T?T.runWhen:null}),this.handlers.length-1}eject(V){this.handlers[V]&&(this.handlers[V]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(V){un.forEach(this.handlers,function(T){T!==null&&V(T)})}}const Vx={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Sb=typeof URLSearchParams<"u"?URLSearchParams:Q_,Tb=FormData,Cb=(()=>{let B;return typeof navigator<"u"&&((B=navigator.product)==="ReactNative"||B==="NativeScript"||B==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),Ib=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",mh={classes:{URLSearchParams:Sb,FormData:Tb,Blob},isStandardBrowserEnv:Cb,isStandardBrowserWebWorkerEnv:Ib,protocols:["http","https","file","blob","url","data"]};function Mb(B,V){return zm(B,new mh.classes.URLSearchParams,Object.assign({visitor:function(F,T,G,q){return mh.isNode&&un.isBuffer(F)?(this.append(T,F.toString("base64")),!1):q.defaultVisitor.apply(this,arguments)}},V))}function Ab(B){return un.matchAll(/\w+|\[(\w*)]/g,B).map(V=>V[0]==="[]"?"":V[1]||V[0])}function Lb(B){const V={},F=Object.keys(B);let T;const G=F.length;let q;for(T=0;T<G;T++)q=F[T],V[q]=B[q];return V}function qx(B){function V(F,T,G,q){let j=F[q++];const J=Number.isFinite(+j),h=q>=F.length;return j=!j&&un.isArray(G)?G.length:j,h?(un.hasOwnProp(G,j)?G[j]=[G[j],T]:G[j]=T,!J):((!G[j]||!un.isObject(G[j]))&&(G[j]=[]),V(F,T,G[j],q)&&un.isArray(G[j])&&(G[j]=Lb(G[j])),!J)}if(un.isFormData(B)&&un.isFunction(B.entries)){const F={};return un.forEachEntry(B,(T,G)=>{V(Ab(T),G,F,0)}),F}return null}const Rb={"Content-Type":void 0};function Db(B,V,F){if(un.isString(B))try{return(V||JSON.parse)(B),un.trim(B)}catch(T){if(T.name!=="SyntaxError")throw T}return(F||JSON.stringify)(B)}const op={transitional:Vx,adapter:["xhr","http"],transformRequest:[function(V,F){const T=F.getContentType()||"",G=T.indexOf("application/json")>-1,q=un.isObject(V);if(q&&un.isHTMLForm(V)&&(V=new FormData(V)),un.isFormData(V))return G&&G?JSON.stringify(qx(V)):V;if(un.isArrayBuffer(V)||un.isBuffer(V)||un.isStream(V)||un.isFile(V)||un.isBlob(V))return V;if(un.isArrayBufferView(V))return V.buffer;if(un.isURLSearchParams(V))return F.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),V.toString();let J;if(q){if(T.indexOf("application/x-www-form-urlencoded")>-1)return Mb(V,this.formSerializer).toString();if((J=un.isFileList(V))||T.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return zm(J?{"files[]":V}:V,h&&new h,this.formSerializer)}}return q||G?(F.setContentType("application/json",!1),Db(V)):V}],transformResponse:[function(V){const F=this.transitional||op.transitional,T=F&&F.forcedJSONParsing,G=this.responseType==="json";if(V&&un.isString(V)&&(T&&!this.responseType||G)){const j=!(F&&F.silentJSONParsing)&&G;try{return JSON.parse(V)}catch(J){if(j)throw J.name==="SyntaxError"?Kr.from(J,Kr.ERR_BAD_RESPONSE,this,null,this.response):J}}return V}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mh.classes.FormData,Blob:mh.classes.Blob},validateStatus:function(V){return V>=200&&V<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};un.forEach(["delete","get","head"],function(V){op.headers[V]={}});un.forEach(["post","put","patch"],function(V){op.headers[V]=un.merge(Rb)});const Nb=un.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ob=B=>{const V={};let F,T,G;return B&&B.split(`
`).forEach(function(j){G=j.indexOf(":"),F=j.substring(0,G).trim().toLowerCase(),T=j.substring(G+1).trim(),!(!F||V[F]&&Nb[F])&&(F==="set-cookie"?V[F]?V[F].push(T):V[F]=[T]:V[F]=V[F]?V[F]+", "+T:T)}),V},Hv=Symbol("internals");function _g(B){return B&&String(B).trim().toLowerCase()}function Dm(B){return B===!1||B==null?B:un.isArray(B)?B.map(Dm):String(B)}function zb(B){const V=Object.create(null),F=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let T;for(;T=F.exec(B);)V[T[1]]=T[2];return V}function Pb(B){return/^[-_a-zA-Z]+$/.test(B.trim())}function Yv(B,V,F,T){if(un.isFunction(T))return T.call(this,V,F);if(un.isString(V)){if(un.isString(T))return V.indexOf(T)!==-1;if(un.isRegExp(T))return T.test(V)}}function Bb(B){return B.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(V,F,T)=>F.toUpperCase()+T)}function Fb(B,V){const F=un.toCamelCase(" "+V);["get","set","has"].forEach(T=>{Object.defineProperty(B,T+F,{value:function(G,q,j){return this[T].call(this,V,G,q,j)},configurable:!0})})}let zc=class{constructor(V){V&&this.set(V)}set(V,F,T){const G=this;function q(J,h,X){const tt=_g(h);if(!tt)throw new Error("header name must be a non-empty string");const ht=un.findKey(G,tt);(!ht||G[ht]===void 0||X===!0||X===void 0&&G[ht]!==!1)&&(G[ht||h]=Dm(J))}const j=(J,h)=>un.forEach(J,(X,tt)=>q(X,tt,h));return un.isPlainObject(V)||V instanceof this.constructor?j(V,F):un.isString(V)&&(V=V.trim())&&!Pb(V)?j(Ob(V),F):V!=null&&q(F,V,T),this}get(V,F){if(V=_g(V),V){const T=un.findKey(this,V);if(T){const G=this[T];if(!F)return G;if(F===!0)return zb(G);if(un.isFunction(F))return F.call(this,G,T);if(un.isRegExp(F))return F.exec(G);throw new TypeError("parser must be boolean|regexp|function")}}}has(V,F){if(V=_g(V),V){const T=un.findKey(this,V);return!!(T&&(!F||Yv(this,this[T],T,F)))}return!1}delete(V,F){const T=this;let G=!1;function q(j){if(j=_g(j),j){const J=un.findKey(T,j);J&&(!F||Yv(T,T[J],J,F))&&(delete T[J],G=!0)}}return un.isArray(V)?V.forEach(q):q(V),G}clear(){return Object.keys(this).forEach(this.delete.bind(this))}normalize(V){const F=this,T={};return un.forEach(this,(G,q)=>{const j=un.findKey(T,q);if(j){F[j]=Dm(G),delete F[q];return}const J=V?Bb(q):String(q).trim();J!==q&&delete F[q],F[J]=Dm(G),T[J]=!0}),this}concat(...V){return this.constructor.concat(this,...V)}toJSON(V){const F=Object.create(null);return un.forEach(this,(T,G)=>{T!=null&&T!==!1&&(F[G]=V&&un.isArray(T)?T.join(", "):T)}),F}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([V,F])=>V+": "+F).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(V){return V instanceof this?V:new this(V)}static concat(V,...F){const T=new this(V);return F.forEach(G=>T.set(G)),T}static accessor(V){const T=(this[Hv]=this[Hv]={accessors:{}}).accessors,G=this.prototype;function q(j){const J=_g(j);T[J]||(Fb(G,j),T[J]=!0)}return un.isArray(V)?V.forEach(q):q(V),this}};zc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]);un.freezeMethods(zc.prototype);un.freezeMethods(zc);function Ly(B,V){const F=this||op,T=V||F,G=zc.from(T.headers);let q=T.data;return un.forEach(B,function(J){q=J.call(F,q,G.normalize(),V?V.status:void 0)}),G.normalize(),q}function jx(B){return!!(B&&B.__CANCEL__)}function Eg(B,V,F){Kr.call(this,B??"canceled",Kr.ERR_CANCELED,V,F),this.name="CanceledError"}un.inherits(Eg,Kr,{__CANCEL__:!0});const kb=null;function Ub(B,V,F){const T=F.config.validateStatus;!F.status||!T||T(F.status)?B(F):V(new Kr("Request failed with status code "+F.status,[Kr.ERR_BAD_REQUEST,Kr.ERR_BAD_RESPONSE][Math.floor(F.status/100)-4],F.config,F.request,F))}const Gb=mh.isStandardBrowserEnv?(function(){return{write:function(F,T,G,q,j,J){const h=[];h.push(F+"="+encodeURIComponent(T)),un.isNumber(G)&&h.push("expires="+new Date(G).toGMTString()),un.isString(q)&&h.push("path="+q),un.isString(j)&&h.push("domain="+j),J===!0&&h.push("secure"),document.cookie=h.join("; ")},read:function(F){const T=document.cookie.match(new RegExp("(^|;\\s*)("+F+")=([^;]*)"));return T?decodeURIComponent(T[3]):null},remove:function(F){this.write(F,"",Date.now()-864e5)}}})():(function(){return{write:function(){},read:function(){return null},remove:function(){}}})();function Vb(B){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(B)}function qb(B,V){return V?B.replace(/\/+$/,"")+"/"+V.replace(/^\/+/,""):B}function Xx(B,V){return B&&!Vb(V)?qb(B,V):V}const jb=mh.isStandardBrowserEnv?(function(){const V=/(msie|trident)/i.test(navigator.userAgent),F=document.createElement("a");let T;function G(q){let j=q;return V&&(F.setAttribute("href",j),j=F.href),F.setAttribute("href",j),{href:F.href,protocol:F.protocol?F.protocol.replace(/:$/,""):"",host:F.host,search:F.search?F.search.replace(/^\?/,""):"",hash:F.hash?F.hash.replace(/^#/,""):"",hostname:F.hostname,port:F.port,pathname:F.pathname.charAt(0)==="/"?F.pathname:"/"+F.pathname}}return T=G(window.location.href),function(j){const J=un.isString(j)?G(j):j;return J.protocol===T.protocol&&J.host===T.host}})():(function(){return function(){return!0}})();function Xb(B){const V=/^([-+\w]{1,25})(:?\/\/|:)/.exec(B);return V&&V[1]||""}function Zb(B,V){B=B||10;const F=new Array(B),T=new Array(B);let G=0,q=0,j;return V=V!==void 0?V:1e3,function(h){const X=Date.now(),tt=T[q];j||(j=X),F[G]=h,T[G]=X;let ht=q,st=0;for(;ht!==G;)st+=F[ht++],ht=ht%B;if(G=(G+1)%B,G===q&&(q=(q+1)%B),X-j<V)return;const At=tt&&X-tt;return At?Math.round(st*1e3/At):void 0}}function Wv(B,V){let F=0;const T=Zb(50,250);return G=>{const q=G.loaded,j=G.lengthComputable?G.total:void 0,J=q-F,h=T(J),X=q<=j;F=q;const tt={loaded:q,total:j,progress:j?q/j:void 0,bytes:J,rate:h||void 0,estimated:h&&j&&X?(j-q)/h:void 0,event:G};tt[V?"download":"upload"]=!0,B(tt)}}const Hb=typeof XMLHttpRequest<"u",Yb=Hb&&function(B){return new Promise(function(F,T){let G=B.data;const q=zc.from(B.headers).normalize(),j=B.responseType;let J;function h(){B.cancelToken&&B.cancelToken.unsubscribe(J),B.signal&&B.signal.removeEventListener("abort",J)}un.isFormData(G)&&(mh.isStandardBrowserEnv||mh.isStandardBrowserWebWorkerEnv)&&q.setContentType(!1);let X=new XMLHttpRequest;if(B.auth){const At=B.auth.username||"",yt=B.auth.password?unescape(encodeURIComponent(B.auth.password)):"";q.set("Authorization","Basic "+btoa(At+":"+yt))}const tt=Xx(B.baseURL,B.url);X.open(B.method.toUpperCase(),Gx(tt,B.params,B.paramsSerializer),!0),X.timeout=B.timeout;function ht(){if(!X)return;const At=zc.from("getAllResponseHeaders"in X&&X.getAllResponseHeaders()),it={data:!j||j==="text"||j==="json"?X.responseText:X.response,status:X.status,statusText:X.statusText,headers:At,config:B,request:X};Ub(function(le){F(le),h()},function(le){T(le),h()},it),X=null}if("onloadend"in X?X.onloadend=ht:X.onreadystatechange=function(){!X||X.readyState!==4||X.status===0&&!(X.responseURL&&X.responseURL.indexOf("file:")===0)||setTimeout(ht)},X.onabort=function(){X&&(T(new Kr("Request aborted",Kr.ECONNABORTED,B,X)),X=null)},X.onerror=function(){T(new Kr("Network Error",Kr.ERR_NETWORK,B,X)),X=null},X.ontimeout=function(){let yt=B.timeout?"timeout of "+B.timeout+"ms exceeded":"timeout exceeded";const it=B.transitional||Vx;B.timeoutErrorMessage&&(yt=B.timeoutErrorMessage),T(new Kr(yt,it.clarifyTimeoutError?Kr.ETIMEDOUT:Kr.ECONNABORTED,B,X)),X=null},mh.isStandardBrowserEnv){const At=(B.withCredentials||jb(tt))&&B.xsrfCookieName&&Gb.read(B.xsrfCookieName);At&&q.set(B.xsrfHeaderName,At)}G===void 0&&q.setContentType(null),"setRequestHeader"in X&&un.forEach(q.toJSON(),function(yt,it){X.setRequestHeader(it,yt)}),un.isUndefined(B.withCredentials)||(X.withCredentials=!!B.withCredentials),j&&j!=="json"&&(X.responseType=B.responseType),typeof B.onDownloadProgress=="function"&&X.addEventListener("progress",Wv(B.onDownloadProgress,!0)),typeof B.onUploadProgress=="function"&&X.upload&&X.upload.addEventListener("progress",Wv(B.onUploadProgress)),(B.cancelToken||B.signal)&&(J=At=>{X&&(T(!At||At.type?new Eg(null,B,X):At),X.abort(),X=null)},B.cancelToken&&B.cancelToken.subscribe(J),B.signal&&(B.signal.aborted?J():B.signal.addEventListener("abort",J)));const st=Xb(tt);if(st&&mh.protocols.indexOf(st)===-1){T(new Kr("Unsupported protocol "+st+":",Kr.ERR_BAD_REQUEST,B));return}X.send(G||null)})},Nm={http:kb,xhr:Yb};un.forEach(Nm,(B,V)=>{if(B){try{Object.defineProperty(B,"name",{value:V})}catch{}Object.defineProperty(B,"adapterName",{value:V})}});const Wb={getAdapter:B=>{B=un.isArray(B)?B:[B];const{length:V}=B;let F,T;for(let G=0;G<V&&(F=B[G],!(T=un.isString(F)?Nm[F.toLowerCase()]:F));G++);if(!T)throw T===!1?new Kr(`Adapter ${F} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(un.hasOwnProp(Nm,F)?`Adapter '${F}' is not available in the build`:`Unknown adapter '${F}'`);if(!un.isFunction(T))throw new TypeError("adapter is not a function");return T},adapters:Nm};function Ry(B){if(B.cancelToken&&B.cancelToken.throwIfRequested(),B.signal&&B.signal.aborted)throw new Eg(null,B)}function $v(B){return Ry(B),B.headers=zc.from(B.headers),B.data=Ly.call(B,B.transformRequest),["post","put","patch"].indexOf(B.method)!==-1&&B.headers.setContentType("application/x-www-form-urlencoded",!1),Wb.getAdapter(B.adapter||op.adapter)(B).then(function(T){return Ry(B),T.data=Ly.call(B,B.transformResponse,T),T.headers=zc.from(T.headers),T},function(T){return jx(T)||(Ry(B),T&&T.response&&(T.response.data=Ly.call(B,B.transformResponse,T.response),T.response.headers=zc.from(T.response.headers))),Promise.reject(T)})}const Jv=B=>B instanceof zc?B.toJSON():B;function ip(B,V){V=V||{};const F={};function T(X,tt,ht){return un.isPlainObject(X)&&un.isPlainObject(tt)?un.merge.call({caseless:ht},X,tt):un.isPlainObject(tt)?un.merge({},tt):un.isArray(tt)?tt.slice():tt}function G(X,tt,ht){if(un.isUndefined(tt)){if(!un.isUndefined(X))return T(void 0,X,ht)}else return T(X,tt,ht)}function q(X,tt){if(!un.isUndefined(tt))return T(void 0,tt)}function j(X,tt){if(un.isUndefined(tt)){if(!un.isUndefined(X))return T(void 0,X)}else return T(void 0,tt)}function J(X,tt,ht){if(ht in V)return T(X,tt);if(ht in B)return T(void 0,X)}const h={url:q,method:q,data:q,baseURL:j,transformRequest:j,transformResponse:j,paramsSerializer:j,timeout:j,timeoutMessage:j,withCredentials:j,adapter:j,responseType:j,xsrfCookieName:j,xsrfHeaderName:j,onUploadProgress:j,onDownloadProgress:j,decompress:j,maxContentLength:j,maxBodyLength:j,beforeRedirect:j,transport:j,httpAgent:j,httpsAgent:j,cancelToken:j,socketPath:j,responseEncoding:j,validateStatus:J,headers:(X,tt)=>G(Jv(X),Jv(tt),!0)};return un.forEach(Object.keys(B).concat(Object.keys(V)),function(tt){const ht=h[tt]||G,st=ht(B[tt],V[tt],tt);un.isUndefined(st)&&ht!==J||(F[tt]=st)}),F}const Zx="1.2.1",tv={};["object","boolean","number","function","string","symbol"].forEach((B,V)=>{tv[B]=function(T){return typeof T===B||"a"+(V<1?"n ":" ")+B}});const Kv={};tv.transitional=function(V,F,T){function G(q,j){return"[Axios v"+Zx+"] Transitional option '"+q+"'"+j+(T?". "+T:"")}return(q,j,J)=>{if(V===!1)throw new Kr(G(j," has been removed"+(F?" in "+F:"")),Kr.ERR_DEPRECATED);return F&&!Kv[j]&&(Kv[j]=!0,console.warn(G(j," has been deprecated since v"+F+" and will be removed in the near future"))),V?V(q,j,J):!0}};function $b(B,V,F){if(typeof B!="object")throw new Kr("options must be an object",Kr.ERR_BAD_OPTION_VALUE);const T=Object.keys(B);let G=T.length;for(;G-- >0;){const q=T[G],j=V[q];if(j){const J=B[q],h=J===void 0||j(J,q,B);if(h!==!0)throw new Kr("option "+q+" must be "+h,Kr.ERR_BAD_OPTION_VALUE);continue}if(F!==!0)throw new Kr("Unknown option "+q,Kr.ERR_BAD_OPTION)}}const j_={assertOptions:$b,validators:tv},Df=j_.validators;let pd=class{constructor(V){this.defaults=V,this.interceptors={request:new Zv,response:new Zv}}request(V,F){typeof V=="string"?(F=F||{},F.url=V):F=V||{},F=ip(this.defaults,F);const{transitional:T,paramsSerializer:G,headers:q}=F;T!==void 0&&j_.assertOptions(T,{silentJSONParsing:Df.transitional(Df.boolean),forcedJSONParsing:Df.transitional(Df.boolean),clarifyTimeoutError:Df.transitional(Df.boolean)},!1),G!==void 0&&j_.assertOptions(G,{encode:Df.function,serialize:Df.function},!0),F.method=(F.method||this.defaults.method||"get").toLowerCase();let j;j=q&&un.merge(q.common,q[F.method]),j&&un.forEach(["delete","get","head","post","put","patch","common"],yt=>{delete q[yt]}),F.headers=zc.concat(j,q);const J=[];let h=!0;this.interceptors.request.forEach(function(it){typeof it.runWhen=="function"&&it.runWhen(F)===!1||(h=h&&it.synchronous,J.unshift(it.fulfilled,it.rejected))});const X=[];this.interceptors.response.forEach(function(it){X.push(it.fulfilled,it.rejected)});let tt,ht=0,st;if(!h){const yt=[$v.bind(this),void 0];for(yt.unshift.apply(yt,J),yt.push.apply(yt,X),st=yt.length,tt=Promise.resolve(F);ht<st;)tt=tt.then(yt[ht++],yt[ht++]);return tt}st=J.length;let At=F;for(ht=0;ht<st;){const yt=J[ht++],it=J[ht++];try{At=yt(At)}catch(ae){it.call(this,ae);break}}try{tt=$v.call(this,At)}catch(yt){return Promise.reject(yt)}for(ht=0,st=X.length;ht<st;)tt=tt.then(X[ht++],X[ht++]);return tt}getUri(V){V=ip(this.defaults,V);const F=Xx(V.baseURL,V.url);return Gx(F,V.params,V.paramsSerializer)}};un.forEach(["delete","get","head","options"],function(V){pd.prototype[V]=function(F,T){return this.request(ip(T||{},{method:V,url:F,data:(T||{}).data}))}});un.forEach(["post","put","patch"],function(V){function F(T){return function(q,j,J){return this.request(ip(J||{},{method:V,headers:T?{"Content-Type":"multipart/form-data"}:{},url:q,data:j}))}}pd.prototype[V]=F(),pd.prototype[V+"Form"]=F(!0)});let Jb=class Hx{constructor(V){if(typeof V!="function")throw new TypeError("executor must be a function.");let F;this.promise=new Promise(function(q){F=q});const T=this;this.promise.then(G=>{if(!T._listeners)return;let q=T._listeners.length;for(;q-- >0;)T._listeners[q](G);T._listeners=null}),this.promise.then=G=>{let q;const j=new Promise(J=>{T.subscribe(J),q=J}).then(G);return j.cancel=function(){T.unsubscribe(q)},j},V(function(q,j,J){T.reason||(T.reason=new Eg(q,j,J),F(T.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(V){if(this.reason){V(this.reason);return}this._listeners?this._listeners.push(V):this._listeners=[V]}unsubscribe(V){if(!this._listeners)return;const F=this._listeners.indexOf(V);F!==-1&&this._listeners.splice(F,1)}static source(){let V;return{token:new Hx(function(G){V=G}),cancel:V}}};function Kb(B){return function(F){return B.apply(null,F)}}function Qb(B){return un.isObject(B)&&B.isAxiosError===!0}function Yx(B){const V=new pd(B),F=Ax(pd.prototype.request,V);return un.extend(F,pd.prototype,V,{allOwnKeys:!0}),un.extend(F,V,null,{allOwnKeys:!0}),F.create=function(G){return Yx(ip(B,G))},F}const La=Yx(op);La.Axios=pd;La.CanceledError=Eg;La.CancelToken=Jb;La.isCancel=jx;La.VERSION=Zx;La.toFormData=zm;La.AxiosError=Kr;La.Cancel=La.CanceledError;La.all=function(V){return Promise.all(V)};La.spread=Kb;La.isAxiosError=Qb;La.mergeConfig=ip;La.AxiosHeaders=zc;La.formToJSON=B=>qx(un.isHTMLForm(B)?new FormData(B):B);La.default=La;const{Axios:TE,AxiosError:CE,CanceledError:IE,isCancel:ME,CancelToken:AE,VERSION:LE,all:RE,Cancel:DE,isAxiosError:NE,spread:OE,toFormData:zE,AxiosHeaders:PE,formToJSON:BE,mergeConfig:FE}=La,tw=La.create({baseURL:"https://api.mapbox.com/geocoding/v5/mapbox.places",params:{limit:1,types:"place,postcode,address",access_token:void 0}});var Oc={exports:{}},$u={},Qv;function qr(){if(Qv)return $u;Qv=1;function B(F,T){return{type:"Feature",properties:T||{},geometry:F}}$u.feature=B,$u.point=function(F,T){if(!Array.isArray(F))throw new Error("Coordinates must be an array");if(F.length<2)throw new Error("Coordinates must be at least 2 numbers long");return B({type:"Point",coordinates:F.slice()},T)},$u.polygon=function(F,T){if(!F)throw new Error("No coordinates passed");for(var G=0;G<F.length;G++){var q=F[G];if(q.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var j=0;j<q[q.length-1].length;j++)if(q[q.length-1][j]!==q[0][j])throw new Error("First and last Position are not equivalent.")}return B({type:"Polygon",coordinates:F},T)},$u.lineString=function(F,T){if(!F)throw new Error("No coordinates passed");return B({type:"LineString",coordinates:F},T)},$u.featureCollection=function(F){return{type:"FeatureCollection",features:F}},$u.multiLineString=function(F,T){if(!F)throw new Error("No coordinates passed");return B({type:"MultiLineString",coordinates:F},T)},$u.multiPoint=function(F,T){if(!F)throw new Error("No coordinates passed");return B({type:"MultiPoint",coordinates:F},T)},$u.multiPolygon=function(F,T){if(!F)throw new Error("No coordinates passed");return B({type:"MultiPolygon",coordinates:F},T)},$u.geometryCollection=function(F,T){return B({type:"GeometryCollection",geometries:F},T)};var V={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,kilometers:6373,kilometres:6373};return $u.radiansToDistance=function(F,T){var G=V[T||"kilometers"];if(G===void 0)throw new Error("Invalid unit");return F*G},$u.distanceToRadians=function(F,T){var G=V[T||"kilometers"];if(G===void 0)throw new Error("Invalid unit");return F/G},$u.distanceToDegrees=function(F,T){var G=V[T||"kilometers"];if(G===void 0)throw new Error("Invalid unit");return F/G*57.2958},$u}var Dy,t0;function ev(){if(t0)return Dy;t0=1;var B=qr().polygon,V=qr().featureCollection;Dy=function(j,J){return V(q(j.features.map(function(h){var X={x:h.geometry.coordinates[0],y:h.geometry.coordinates[1]};return J&&(X.z=h.properties[J]),X})).map(function(h){return B([[[h.a.x,h.a.y],[h.b.x,h.b.y],[h.c.x,h.c.y],[h.a.x,h.a.y]]],{a:h.a.z,b:h.b.z,c:h.c.z})}))};function F(j,J,h){this.a=j,this.b=J,this.c=h;var X=J.x-j.x,tt=J.y-j.y,ht=h.x-j.x,st=h.y-j.y,At=X*(j.x+J.x)+tt*(j.y+J.y),yt=ht*(j.x+h.x)+st*(j.y+h.y),it=2*(X*(h.y-J.y)-tt*(h.x-J.x)),ae,le,Ft,lt;Math.abs(it)<1e-6?(ae=Math.min(j.x,J.x,h.x),le=Math.min(j.y,J.y,h.y),Ft=(Math.max(j.x,J.x,h.x)-ae)*.5,lt=(Math.max(j.y,J.y,h.y)-le)*.5,this.x=ae+Ft,this.y=le+lt,this.r=Ft*Ft+lt*lt):(this.x=(st*At-tt*yt)/it,this.y=(X*yt-ht*At)/it,Ft=this.x-j.x,lt=this.y-j.y,this.r=Ft*Ft+lt*lt)}function T(j,J){return J.x-j.x}function G(j){var J=j.length,h,X,tt,ht,st;t:for(;J;)for(X=j[--J],h=j[--J],tt=J;tt;)if(st=j[--tt],ht=j[--tt],h===ht&&X===st||h===st&&X===ht){j.splice(J,2),j.splice(tt,2),J-=2;continue t}}function q(j){if(j.length<3)return[];j.sort(T);for(var J=j.length-1,h=j[J].x,X=j[0].x,tt=j[J].y,ht=tt;J--;)j[J].y<tt&&(tt=j[J].y),j[J].y>ht&&(ht=j[J].y);var st=X-h,At=ht-tt,yt=st>At?st:At,it=(X+h)*.5,ae=(ht+tt)*.5,le=[new F({x:it-20*yt,y:ae-yt,__sentinel:!0},{x:it,y:ae+20*yt,__sentinel:!0},{x:it+20*yt,y:ae-yt,__sentinel:!0})],Ft=[],lt=[],pt,It,Dt;for(J=j.length;J--;){for(lt.length=0,pt=le.length;pt--;){if(st=j[J].x-le[pt].x,st>0&&st*st>le[pt].r){Ft.push(le[pt]),le.splice(pt,1);continue}At=j[J].y-le[pt].y,!(st*st+At*At>le[pt].r)&&(lt.push(le[pt].a,le[pt].b,le[pt].b,le[pt].c,le[pt].c,le[pt].a),le.splice(pt,1))}for(G(lt),pt=lt.length;pt;)Dt=lt[--pt],It=lt[--pt],le.push(new F(It,Dt,j[J]))}for(Array.prototype.push.apply(Ft,le),J=Ft.length;J--;)(Ft[J].a.__sentinel||Ft[J].b.__sentinel||Ft[J].c.__sentinel)&&Ft.splice(J,1);return Ft}return Dy}var ep={},e0;function Pm(){if(e0)return ep;e0=1;function B(G){if(Array.isArray(G)&&typeof G[0]=="number"&&typeof G[1]=="number")return G;if(G){if(G.type==="Feature"&&G.geometry&&G.geometry.type==="Point"&&Array.isArray(G.geometry.coordinates))return G.geometry.coordinates;if(G.type==="Point"&&Array.isArray(G.coordinates))return G.coordinates}throw new Error("A coordinate, feature, or point geometry is required")}function V(G,q,j){if(!q||!j)throw new Error("type and name required");if(!G||G.type!==q)throw new Error("Invalid input to "+j+": must be a "+q+", given "+G.type)}function F(G,q,j){if(!j)throw new Error(".featureOf() requires a name");if(!G||G.type!=="Feature"||!G.geometry)throw new Error("Invalid input to "+j+", Feature with geometry required");if(!G.geometry||G.geometry.type!==q)throw new Error("Invalid input to "+j+": must be a "+q+", given "+G.geometry.type)}function T(G,q,j){if(!j)throw new Error(".collectionOf() requires a name");if(!G||G.type!=="FeatureCollection")throw new Error("Invalid input to "+j+", FeatureCollection required");for(var J=0;J<G.features.length;J++){var h=G.features[J];if(!h||h.type!=="Feature"||!h.geometry)throw new Error("Invalid input to "+j+", Feature with geometry required");if(!h.geometry||h.geometry.type!==q)throw new Error("Invalid input to "+j+": must be a "+q+", given "+h.geometry.type)}}return ep.geojsonType=V,ep.collectionOf=T,ep.featureOf=F,ep.getCoord=B,ep}var Ny,n0;function ap(){if(n0)return Ny;n0=1;var B=Pm();Ny=function(T,G){var q=B.getCoord(T),j=G.geometry.coordinates;G.geometry.type==="Polygon"&&(j=[j]);for(var J=0,h=!1;J<j.length&&!h;J++)if(V(q,j[J][0])){for(var X=!1,tt=1;tt<j[J].length&&!X;)V(q,j[J][tt])&&(X=!0),tt++;X||(h=!0)}return h};function V(F,T){for(var G=!1,q=0,j=T.length-1;q<T.length;j=q++){var J=T[q][0],h=T[q][1],X=T[j][0],tt=T[j][1],ht=h>F[1]!=tt>F[1]&&F[0]<(X-J)*(F[1]-h)/(tt-h)+J;ht&&(G=!G)}return G}return Ny}var Oy,i0;function ew(){if(i0)return Oy;i0=1;var B=Array.isArray||function(V){return Object.prototype.toString.call(V)==="[object Array]"};return Oy=function(V,F){if(!B(V))throw new Error("Coordinates must be an array");if(V.length<2)throw new Error("Coordinates must be at least 2 numbers long");return{type:"Feature",geometry:{type:"Point",coordinates:V},properties:F||{}}},Oy}var zy,r0;function nw(){if(r0)return zy;r0=1;var B=ew();return zy=function(V,F){var T=V[0],G=V[1],q=V[2];V[3];for(var j=(q-T)/F,J={type:"FeatureCollection",features:[]},h=0;h<=F;h++)for(var X=0;X<=F;X++)J.features.push(B([h*j+T,X*j+G]));return J},zy}var Nf={},s0;function lp(){if(s0)return Nf;s0=1;function B(j,J,h){var X,tt,ht,st,At,yt,it,ae,le,Ft=0,lt,pt=j.type==="FeatureCollection",It=j.type==="Feature",Dt=pt?j.features.length:1;for(X=0;X<Dt;X++)for(le=pt?j.features[X].geometry:It?j.geometry:j,lt=le.type==="GeometryCollection",it=lt?le.geometries.length:1,st=0;st<it;st++)if(yt=lt?le.geometries[st]:le,ae=yt.coordinates,Ft=h&&(yt.type==="Polygon"||yt.type==="MultiPolygon")?1:0,yt.type==="Point")J(ae);else if(yt.type==="LineString"||yt.type==="MultiPoint")for(tt=0;tt<ae.length;tt++)J(ae[tt]);else if(yt.type==="Polygon"||yt.type==="MultiLineString")for(tt=0;tt<ae.length;tt++)for(ht=0;ht<ae[tt].length-Ft;ht++)J(ae[tt][ht]);else if(yt.type==="MultiPolygon")for(tt=0;tt<ae.length;tt++)for(ht=0;ht<ae[tt].length;ht++)for(At=0;At<ae[tt][ht].length-Ft;At++)J(ae[tt][ht][At]);else throw new Error("Unknown Geometry Type")}Nf.coordEach=B;function V(j,J,h,X){return B(j,function(tt){h=J(h,tt)},X),h}Nf.coordReduce=V;function F(j,J){var h;switch(j.type){case"FeatureCollection":for(h=0;h<j.features.length;h++)J(j.features[h].properties);break;case"Feature":J(j.properties);break}}Nf.propEach=F;function T(j,J,h){return F(j,function(X){h=J(h,X)}),h}Nf.propReduce=T;function G(j,J){if(j.type==="Feature")J(j);else if(j.type==="FeatureCollection")for(var h=0;h<j.features.length;h++)J(j.features[h])}Nf.featureEach=G;function q(j){var J=[];return B(j,function(h){J.push(h)}),J}return Nf.coordAll=q,Nf}var Py,o0;function Bm(){if(o0)return Py;o0=1;var B=lp().coordEach;return Py=function(V){var F=[1/0,1/0,-1/0,-1/0];return B(V,function(T){F[0]>T[0]&&(F[0]=T[0]),F[1]>T[1]&&(F[1]=T[1]),F[2]<T[0]&&(F[2]=T[0]),F[3]<T[1]&&(F[3]=T[1])}),F},Py}var By,a0;function Wx(){return a0||(a0=1,By=function(B,V){var F=B.geometry.coordinates[0],T=B.geometry.coordinates[1],G=V.geometry.coordinates[0][0][0],q=V.geometry.coordinates[0][0][1],j=V.properties.a,J=V.geometry.coordinates[0][1][0],h=V.geometry.coordinates[0][1][1],X=V.properties.b,tt=V.geometry.coordinates[0][2][0],ht=V.geometry.coordinates[0][2][1],st=V.properties.c,At=(st*(F-G)*(T-h)+j*(F-J)*(T-ht)+X*(F-tt)*(T-q)-X*(F-G)*(T-ht)-st*(F-J)*(T-q)-j*(F-tt)*(T-h))/((F-G)*(T-h)+(F-J)*(T-ht)+(F-tt)*(T-q)-(F-G)*(T-ht)-(F-J)*(T-q)-(F-tt)*(T-h));return At}),By}var Fy,l0;function cc(){if(l0)return Fy;l0=1;var B=Pm().getCoord,V=qr().radiansToDistance;return Fy=function(F,T,G){var q=Math.PI/180,j=B(F),J=B(T),h=q*(J[1]-j[1]),X=q*(J[0]-j[0]),tt=q*j[1],ht=q*J[1],st=Math.pow(Math.sin(h/2),2)+Math.pow(Math.sin(X/2),2)*Math.cos(tt)*Math.cos(ht);return V(2*Math.atan2(Math.sqrt(st),Math.sqrt(1-st)),G)},Fy}var ky,u0;function $x(){if(u0)return ky;u0=1;var B=cc();return ky=function(V){var F=B(V.slice(0,2),[V[2],V[1]],"miles"),T=B(V.slice(0,2),[V[0],V[3]],"miles");if(F>=T){var G=(V[1]+V[3])/2;return[V[0],G-(V[2]-V[0])/2,V[2],G+(V[2]-V[0])/2]}else{var q=(V[0]+V[2])/2;return[q-(V[3]-V[1])/2,V[1],q+(V[3]-V[1])/2,V[3]]}},ky}var Uy,c0;function iw(){if(c0)return Uy;c0=1,Uy=G;var B=1e-10;function V(q,j){var J=q.x-j.x,h=q.y-j.y;return J*J+h*h<B}function F(q){for(var j=q.head;j;){var J=j.next;j.next=j.prev,j.prev=J,j=J}var J=q.head;q.head=q.tail,q.tail=J}function T(q){this.level=q,this.s=null,this.count=0}T.prototype.remove_seq=function(q){q.prev?q.prev.next=q.next:this.s=q.next,q.next&&(q.next.prev=q.prev),--this.count},T.prototype.addSegment=function(q,j){for(var J=this.s,h=null,X=null,tt=!1,ht=!1;J&&(h==null&&(V(q,J.head.p)?(h=J,tt=!0):V(q,J.tail.p)&&(h=J)),X==null&&(V(j,J.head.p)?(X=J,ht=!0):V(j,J.tail.p)&&(X=J)),!(X!=null&&h!=null));)J=J.next;var st=(h!=null?1:0)|(X!=null?2:0);switch(st){case 0:var At={p:q,prev:null},yt={p:j,next:null};At.next=yt,yt.prev=At,h={head:At,tail:yt,next:this.s,prev:null,closed:!1},this.s&&(this.s.prev=h),this.s=h,++this.count;break;case 1:var it={p:j};tt?(it.next=h.head,it.prev=null,h.head.prev=it,h.head=it):(it.next=null,it.prev=h.tail,h.tail.next=it,h.tail=it);break;case 2:var it={p:q};ht?(it.next=X.head,it.prev=null,X.head.prev=it,X.head=it):(it.next=null,it.prev=X.tail,X.tail.next=it,X.tail=it);break;case 3:if(h===X){var it={p:h.tail.p,next:h.head,prev:null};h.head.prev=it,h.head=it,h.closed=!0;break}switch((tt?1:0)|(ht?2:0)){case 0:F(h);case 1:X.tail.next=h.head,h.head.prev=X.tail,X.tail=h.tail,this.remove_seq(h);break;case 3:F(h);case 2:h.tail.next=X.head,X.head.prev=h.tail,h.tail=X.tail,this.remove_seq(X);break}}};function G(q){if(q)this.drawContour=q;else{var j=this;j.contours={},this.drawContour=function(J,h,X,tt,ht,st){var At=j.contours[st];At||(At=j.contours[st]=new T(ht)),At.addSegment({x:J,y:h},{x:X,y:tt})},this.contourList=function(){var J=[],h=j.contours;for(var X in h)for(var tt=h[X].s,ht=h[X].level;tt;){var st=tt.head,At=[];for(At.level=ht,At.k=X;st&&st.p;)At.push(st.p),st=st.next;J.push(At),tt=tt.next}return J.sort(function(yt,it){return yt.k-it.k}),J}}this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5)}return G.prototype.contour=function(q,j,J,h,X,tt,ht,st,At){var yt=this.h,it=this.sh,ae=this.xh,le=this.yh,Ft=this.drawContour;this.contours={};for(var lt=function(Be,de){return(yt[de]*ae[Be]-yt[Be]*ae[de])/(yt[de]-yt[Be])},pt=function(Be,de){return(yt[de]*le[Be]-yt[Be]*le[de])/(yt[de]-yt[Be])},It,Dt,_t,Jt,Xt,ie,Yt=0,rt=0,qe=0,Sn=0,Xn=[0,1,1,0],ct=[0,0,1,1],kt=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],ut=X-1;ut>=h;ut--)for(var ye=j;ye<=J-1;ye++){var te,mt;if(te=Math.min(q[ye][ut],q[ye][ut+1]),mt=Math.min(q[ye+1][ut],q[ye+1][ut+1]),Xt=Math.min(te,mt),te=Math.max(q[ye][ut],q[ye][ut+1]),mt=Math.max(q[ye+1][ut],q[ye+1][ut+1]),ie=Math.max(te,mt),ie>=At[0]&&Xt<=At[st-1]){for(var Zt=0;Zt<st;Zt++)if(At[Zt]>=Xt&&At[Zt]<=ie){for(var ve=4;ve>=0;ve--)ve>0?(yt[ve]=q[ye+Xn[ve-1]][ut+ct[ve-1]]-At[Zt],ae[ve]=tt[ye+Xn[ve-1]],le[ve]=ht[ut+ct[ve-1]]):(yt[0]=.25*(yt[1]+yt[2]+yt[3]+yt[4]),ae[0]=.5*(tt[ye]+tt[ye+1]),le[0]=.5*(ht[ut]+ht[ut+1])),yt[ve]>B?it[ve]=1:yt[ve]<-B?it[ve]=-1:it[ve]=0;for(ve=1;ve<=4;ve++)if(It=ve,Dt=0,ve!=4?_t=ve+1:_t=1,Jt=kt[it[It]+1][it[Dt]+1][it[_t]+1],Jt!=0){switch(Jt){case 1:Yt=ae[It],qe=le[It],rt=ae[Dt],Sn=le[Dt];break;case 2:Yt=ae[Dt],qe=le[Dt],rt=ae[_t],Sn=le[_t];break;case 3:Yt=ae[_t],qe=le[_t],rt=ae[It],Sn=le[It];break;case 4:Yt=ae[It],qe=le[It],rt=lt(Dt,_t),Sn=pt(Dt,_t);break;case 5:Yt=ae[Dt],qe=le[Dt],rt=lt(_t,It),Sn=pt(_t,It);break;case 6:Yt=ae[_t],qe=le[_t],rt=lt(It,Dt),Sn=pt(It,Dt);break;case 7:Yt=lt(It,Dt),qe=pt(It,Dt),rt=lt(Dt,_t),Sn=pt(Dt,_t);break;case 8:Yt=lt(Dt,_t),qe=pt(Dt,_t),rt=lt(_t,It),Sn=pt(_t,It);break;case 9:Yt=lt(_t,It),qe=pt(_t,It),rt=lt(It,Dt),Sn=pt(It,Dt);break}Ft(Yt,qe,rt,Sn,At[Zt],Zt)}}}}},Uy}var Gy,h0;function rw(){if(h0)return Gy;h0=1;var B=ev(),V=ap(),F=nw(),T=Bm(),G=Wx(),q=qr().featureCollection,j=qr().lineString,J=$x(),h=iw();return Gy=function(X,tt,ht,st){for(var At=B(X,tt),yt=T(X),it=J(yt),ae=F(it,ht),le=[],Ft=0;Ft<ae.features.length;Ft++)for(var lt=ae.features[Ft],pt=0;pt<At.features.length;pt++){var It=At.features[pt];V(lt,It)&&(lt.properties={},lt.properties[tt]=G(lt,It))}for(var Dt=Math.sqrt(ae.features.length),_t=0;_t<Dt;_t++){for(var Jt=ae.features.slice(_t*Dt,(_t+1)*Dt),Xt=[],ie=0;ie<Jt.length;ie++)Jt[ie].properties?Xt.push(Jt[ie].properties[tt]):Xt.push(0);le.push(Xt)}for(var Yt=(it[2]-it[0])/Dt,rt=[],qe=[],Sn=0;Sn<Dt;Sn++)rt.push(Sn*Yt+it[0]),qe.push(Sn*Yt+it[1]);var Xn=new h;Xn.contour(le,0,ht,0,ht,rt,qe,st.length,st);var ct=Xn.contourList(),kt=q([]);return ct.forEach(function(ut){if(ut.length>2){var ye=[];ut.forEach(function(mt){ye.push([mt.x,mt.y])});var te=j(ye);te.properties={},te.properties[tt]=ut.level,kt.features.push(te)}}),kt},Gy}var Vy,f0;function sw(){if(f0)return Vy;f0=1,Vy=B;function B(V){for(var F=0,T=0,G=1;G<V.length;++G)V[G][0]<V[F][0]&&(F=G),V[G][0]>V[T][0]&&(T=G);return F<T?[[F],[T]]:F>T?[[T],[F]]:[[F]]}return Vy}var qy={exports:{}},jy,d0;function Jx(){if(d0)return jy;d0=1,jy=V;var B=+(Math.pow(2,27)+1);function V(F,T,G){var q=F*T,j=B*F,J=j-F,h=j-J,X=F-h,tt=B*T,ht=tt-T,st=tt-ht,At=T-st,yt=q-h*st,it=yt-X*st,ae=it-h*At,le=X*At-ae;return G?(G[0]=le,G[1]=q,G):[le,q]}return jy}var Xy,p0;function ow(){if(p0)return Xy;p0=1,Xy=V;function B(F,T){var G=F+T,q=G-F,j=G-q,J=T-q,h=F-j,X=h+J;return X?[X,G]:[G]}function V(F,T){var G=F.length|0,q=T.length|0;if(G===1&&q===1)return B(F[0],T[0]);var j=G+q,J=new Array(j),h=0,X=0,tt=0,ht=Math.abs,st=F[X],At=ht(st),yt=T[tt],it=ht(yt),ae,le;At<it?(le=st,X+=1,X<G&&(st=F[X],At=ht(st))):(le=yt,tt+=1,tt<q&&(yt=T[tt],it=ht(yt))),X<G&&At<it||tt>=q?(ae=st,X+=1,X<G&&(st=F[X],At=ht(st))):(ae=yt,tt+=1,tt<q&&(yt=T[tt],it=ht(yt)));for(var Ft=ae+le,lt=Ft-ae,pt=le-lt,It=pt,Dt=Ft,_t,Jt,Xt,ie,Yt;X<G&&tt<q;)At<it?(ae=st,X+=1,X<G&&(st=F[X],At=ht(st))):(ae=yt,tt+=1,tt<q&&(yt=T[tt],it=ht(yt))),le=It,Ft=ae+le,lt=Ft-ae,pt=le-lt,pt&&(J[h++]=pt),_t=Dt+Ft,Jt=_t-Dt,Xt=_t-Jt,ie=Ft-Jt,Yt=Dt-Xt,It=Yt+ie,Dt=_t;for(;X<G;)ae=st,le=It,Ft=ae+le,lt=Ft-ae,pt=le-lt,pt&&(J[h++]=pt),_t=Dt+Ft,Jt=_t-Dt,Xt=_t-Jt,ie=Ft-Jt,Yt=Dt-Xt,It=Yt+ie,Dt=_t,X+=1,X<G&&(st=F[X]);for(;tt<q;)ae=yt,le=It,Ft=ae+le,lt=Ft-ae,pt=le-lt,pt&&(J[h++]=pt),_t=Dt+Ft,Jt=_t-Dt,Xt=_t-Jt,ie=Ft-Jt,Yt=Dt-Xt,It=Yt+ie,Dt=_t,tt+=1,tt<q&&(yt=T[tt]);return It&&(J[h++]=It),Dt&&(J[h++]=Dt),h||(J[h++]=0),J.length=h,J}return Xy}var Zy,g0;function aw(){if(g0)return Zy;g0=1,Zy=B;function B(V,F,T){var G=V+F,q=G-V,j=G-q,J=F-q,h=V-j;return T?(T[0]=h+J,T[1]=G,T):[h+J,G]}return Zy}var Hy,m0;function lw(){if(m0)return Hy;m0=1;var B=Jx(),V=aw();Hy=F;function F(T,G){var q=T.length;if(q===1){var j=B(T[0],G);return j[0]?j:[j[1]]}var J=new Array(2*q),h=[.1,.1],X=[.1,.1],tt=0;B(T[0],G,h),h[0]&&(J[tt++]=h[0]);for(var ht=1;ht<q;++ht){B(T[ht],G,X);var st=h[1];V(st,X[0],h),h[0]&&(J[tt++]=h[0]);var At=X[1],yt=h[1],it=At+yt,ae=it-At,le=yt-ae;h[1]=it,le&&(J[tt++]=le)}return h[1]&&(J[tt++]=h[1]),tt===0&&(J[tt++]=0),J.length=tt,J}return Hy}var Yy,y0;function uw(){if(y0)return Yy;y0=1,Yy=V;function B(F,T){var G=F+T,q=G-F,j=G-q,J=T-q,h=F-j,X=h+J;return X?[X,G]:[G]}function V(F,T){var G=F.length|0,q=T.length|0;if(G===1&&q===1)return B(F[0],-T[0]);var j=G+q,J=new Array(j),h=0,X=0,tt=0,ht=Math.abs,st=F[X],At=ht(st),yt=-T[tt],it=ht(yt),ae,le;At<it?(le=st,X+=1,X<G&&(st=F[X],At=ht(st))):(le=yt,tt+=1,tt<q&&(yt=-T[tt],it=ht(yt))),X<G&&At<it||tt>=q?(ae=st,X+=1,X<G&&(st=F[X],At=ht(st))):(ae=yt,tt+=1,tt<q&&(yt=-T[tt],it=ht(yt)));for(var Ft=ae+le,lt=Ft-ae,pt=le-lt,It=pt,Dt=Ft,_t,Jt,Xt,ie,Yt;X<G&&tt<q;)At<it?(ae=st,X+=1,X<G&&(st=F[X],At=ht(st))):(ae=yt,tt+=1,tt<q&&(yt=-T[tt],it=ht(yt))),le=It,Ft=ae+le,lt=Ft-ae,pt=le-lt,pt&&(J[h++]=pt),_t=Dt+Ft,Jt=_t-Dt,Xt=_t-Jt,ie=Ft-Jt,Yt=Dt-Xt,It=Yt+ie,Dt=_t;for(;X<G;)ae=st,le=It,Ft=ae+le,lt=Ft-ae,pt=le-lt,pt&&(J[h++]=pt),_t=Dt+Ft,Jt=_t-Dt,Xt=_t-Jt,ie=Ft-Jt,Yt=Dt-Xt,It=Yt+ie,Dt=_t,X+=1,X<G&&(st=F[X]);for(;tt<q;)ae=yt,le=It,Ft=ae+le,lt=Ft-ae,pt=le-lt,pt&&(J[h++]=pt),_t=Dt+Ft,Jt=_t-Dt,Xt=_t-Jt,ie=Ft-Jt,Yt=Dt-Xt,It=Yt+ie,Dt=_t,tt+=1,tt<q&&(yt=-T[tt]);return It&&(J[h++]=It),Dt&&(J[h++]=Dt),h||(J[h++]=0),J.length=h,J}return Yy}var _0;function nv(){return _0||(_0=1,(function(B){var V=Jx(),F=ow(),T=lw(),G=uw(),q=5,j=11102230246251565e-32,J=(3+16*j)*j,h=(7+56*j)*j;function X(lt,pt,It,Dt){return function(Jt,Xt,ie){var Yt=lt(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0]))),rt=lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),qe=Dt(Yt,rt);return qe[qe.length-1]}}function tt(lt,pt,It,Dt){return function(Jt,Xt,ie,Yt){var rt=lt(lt(It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),Xt[2]),lt(It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),-ie[2]),It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),Yt[2]))),lt(It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),Yt[2])))),qe=lt(lt(It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),Jt[2]),lt(It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),-ie[2]),It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),Yt[2]))),lt(It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),ie[2])))),Sn=Dt(rt,qe);return Sn[Sn.length-1]}}function ht(lt,pt,It,Dt){return function(Jt,Xt,ie,Yt,rt){var qe=lt(lt(lt(It(lt(It(lt(pt(Yt[1],rt[0]),pt(-rt[1],Yt[0])),ie[2]),lt(It(lt(pt(ie[1],rt[0]),pt(-rt[1],ie[0])),-Yt[2]),It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),rt[2]))),Xt[3]),lt(It(lt(It(lt(pt(Yt[1],rt[0]),pt(-rt[1],Yt[0])),Xt[2]),lt(It(lt(pt(Xt[1],rt[0]),pt(-rt[1],Xt[0])),-Yt[2]),It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),rt[2]))),-ie[3]),It(lt(It(lt(pt(ie[1],rt[0]),pt(-rt[1],ie[0])),Xt[2]),lt(It(lt(pt(Xt[1],rt[0]),pt(-rt[1],Xt[0])),-ie[2]),It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),rt[2]))),Yt[3]))),lt(It(lt(It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),Xt[2]),lt(It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),-ie[2]),It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),Yt[2]))),-rt[3]),lt(It(lt(It(lt(pt(Yt[1],rt[0]),pt(-rt[1],Yt[0])),Xt[2]),lt(It(lt(pt(Xt[1],rt[0]),pt(-rt[1],Xt[0])),-Yt[2]),It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),rt[2]))),Jt[3]),It(lt(It(lt(pt(Yt[1],rt[0]),pt(-rt[1],Yt[0])),Jt[2]),lt(It(lt(pt(Jt[1],rt[0]),pt(-rt[1],Jt[0])),-Yt[2]),It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),rt[2]))),-Xt[3])))),lt(lt(It(lt(It(lt(pt(Xt[1],rt[0]),pt(-rt[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],rt[0]),pt(-rt[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),rt[2]))),Yt[3]),lt(It(lt(It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),Yt[2]))),-rt[3]),It(lt(It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),Xt[2]),lt(It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),-ie[2]),It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),Yt[2]))),Jt[3]))),lt(It(lt(It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),Jt[2]),lt(It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),-ie[2]),It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),Yt[2]))),-Xt[3]),lt(It(lt(It(lt(pt(Xt[1],Yt[0]),pt(-Yt[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),Yt[2]))),ie[3]),It(lt(It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),ie[2]))),-Yt[3]))))),Sn=lt(lt(lt(It(lt(It(lt(pt(Yt[1],rt[0]),pt(-rt[1],Yt[0])),ie[2]),lt(It(lt(pt(ie[1],rt[0]),pt(-rt[1],ie[0])),-Yt[2]),It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),rt[2]))),Jt[3]),It(lt(It(lt(pt(Yt[1],rt[0]),pt(-rt[1],Yt[0])),Jt[2]),lt(It(lt(pt(Jt[1],rt[0]),pt(-rt[1],Jt[0])),-Yt[2]),It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),rt[2]))),-ie[3])),lt(It(lt(It(lt(pt(ie[1],rt[0]),pt(-rt[1],ie[0])),Jt[2]),lt(It(lt(pt(Jt[1],rt[0]),pt(-rt[1],Jt[0])),-ie[2]),It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),rt[2]))),Yt[3]),It(lt(It(lt(pt(ie[1],Yt[0]),pt(-Yt[1],ie[0])),Jt[2]),lt(It(lt(pt(Jt[1],Yt[0]),pt(-Yt[1],Jt[0])),-ie[2]),It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),Yt[2]))),-rt[3]))),lt(lt(It(lt(It(lt(pt(ie[1],rt[0]),pt(-rt[1],ie[0])),Xt[2]),lt(It(lt(pt(Xt[1],rt[0]),pt(-rt[1],Xt[0])),-ie[2]),It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),rt[2]))),Jt[3]),It(lt(It(lt(pt(ie[1],rt[0]),pt(-rt[1],ie[0])),Jt[2]),lt(It(lt(pt(Jt[1],rt[0]),pt(-rt[1],Jt[0])),-ie[2]),It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),rt[2]))),-Xt[3])),lt(It(lt(It(lt(pt(Xt[1],rt[0]),pt(-rt[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],rt[0]),pt(-rt[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),rt[2]))),ie[3]),It(lt(It(lt(pt(Xt[1],ie[0]),pt(-ie[1],Xt[0])),Jt[2]),lt(It(lt(pt(Jt[1],ie[0]),pt(-ie[1],Jt[0])),-Xt[2]),It(lt(pt(Jt[1],Xt[0]),pt(-Xt[1],Jt[0])),ie[2]))),-rt[3])))),Xn=Dt(qe,Sn);return Xn[Xn.length-1]}}function st(lt){var pt=lt===3?X:lt===4?tt:ht;return pt(F,V,T,G)}var At=st(3),yt=st(4),it=[function(){return 0},function(){return 0},function(pt,It){return It[0]-pt[0]},function(pt,It,Dt){var _t=(pt[1]-Dt[1])*(It[0]-Dt[0]),Jt=(pt[0]-Dt[0])*(It[1]-Dt[1]),Xt=_t-Jt,ie;if(_t>0){if(Jt<=0)return Xt;ie=_t+Jt}else if(_t<0){if(Jt>=0)return Xt;ie=-(_t+Jt)}else return Xt;var Yt=J*ie;return Xt>=Yt||Xt<=-Yt?Xt:At(pt,It,Dt)},function(pt,It,Dt,_t){var Jt=pt[0]-_t[0],Xt=It[0]-_t[0],ie=Dt[0]-_t[0],Yt=pt[1]-_t[1],rt=It[1]-_t[1],qe=Dt[1]-_t[1],Sn=pt[2]-_t[2],Xn=It[2]-_t[2],ct=Dt[2]-_t[2],kt=Xt*qe,ut=ie*rt,ye=ie*Yt,te=Jt*qe,mt=Jt*rt,Zt=Xt*Yt,ve=Sn*(kt-ut)+Xn*(ye-te)+ct*(mt-Zt),Be=(Math.abs(kt)+Math.abs(ut))*Math.abs(Sn)+(Math.abs(ye)+Math.abs(te))*Math.abs(Xn)+(Math.abs(mt)+Math.abs(Zt))*Math.abs(ct),de=h*Be;return ve>de||-ve>de?ve:yt(pt,It,Dt,_t)}];function ae(lt){var pt=it[lt.length];return pt||(pt=it[lt.length]=st(lt.length)),pt.apply(void 0,lt)}function le(lt,pt,It,Dt,_t,Jt,Xt){return function(Yt,rt,qe,Sn,Xn){switch(arguments.length){case 0:case 1:return 0;case 2:return Dt(Yt,rt);case 3:return _t(Yt,rt,qe);case 4:return Jt(Yt,rt,qe,Sn);case 5:return Xt(Yt,rt,qe,Sn,Xn)}for(var ct=new Array(arguments.length),kt=0;kt<arguments.length;++kt)ct[kt]=arguments[kt];return lt(ct)}}function Ft(){for(;it.length<=q;)it.push(st(it.length));B.exports=le.apply(void 0,[ae].concat(it));for(var lt=0;lt<=q;++lt)B.exports[lt]=it[lt]}Ft()})(qy)),qy.exports}var Wy,v0;function cw(){if(v0)return Wy;v0=1,Wy=V;var B=nv()[3];function V(F){var T=F.length;if(T<3){for(var ht=new Array(T),G=0;G<T;++G)ht[G]=G;return T===2&&F[0][0]===F[1][0]&&F[0][1]===F[1][1]?[0]:ht}for(var q=new Array(T),G=0;G<T;++G)q[G]=G;q.sort(function(it,ae){var le=F[it][0]-F[ae][0];return le||F[it][1]-F[ae][1]});for(var j=[q[0],q[1]],J=[q[0],q[1]],G=2;G<T;++G){for(var h=q[G],X=F[h],tt=j.length;tt>1&&B(F[j[tt-2]],F[j[tt-1]],X)<=0;)tt-=1,j.pop();for(j.push(h),tt=J.length;tt>1&&B(F[J[tt-2]],F[J[tt-1]],X)>=0;)tt-=1,J.pop();J.push(h)}for(var ht=new Array(J.length+j.length-2),st=0,G=0,At=j.length;G<At;++G)ht[st++]=j[G];for(var yt=J.length-2;yt>0;--yt)ht[st++]=J[yt];return ht}return Wy}var $y,x0;function hw(){if(x0)return $y;x0=1,$y=V;var B=cw();function V(F){var T=B(F),G=T.length;if(G<=2)return[];for(var q=new Array(G),j=T[G-1],J=0;J<G;++J){var h=T[J];q[J]=[j,h],j=h}return q}return $y}var zu={},qo={},b0;function fw(){if(b0)return qo;b0=1;var B=32;qo.INT_BITS=B,qo.INT_MAX=2147483647,qo.INT_MIN=-1<<B-1,qo.sign=function(T){return(T>0)-(T<0)},qo.abs=function(T){var G=T>>B-1;return(T^G)-G},qo.min=function(T,G){return G^(T^G)&-(T<G)},qo.max=function(T,G){return T^(T^G)&-(T<G)},qo.isPow2=function(T){return!(T&T-1)&&!!T},qo.log2=function(T){var G,q;return G=(T>65535)<<4,T>>>=G,q=(T>255)<<3,T>>>=q,G|=q,q=(T>15)<<2,T>>>=q,G|=q,q=(T>3)<<1,T>>>=q,G|=q,G|T>>1},qo.log10=function(T){return T>=1e9?9:T>=1e8?8:T>=1e7?7:T>=1e6?6:T>=1e5?5:T>=1e4?4:T>=1e3?3:T>=100?2:T>=10?1:0},qo.popCount=function(T){return T=T-(T>>>1&1431655765),T=(T&858993459)+(T>>>2&858993459),(T+(T>>>4)&252645135)*16843009>>>24};function V(T){var G=32;return T&=-T,T&&G--,T&65535&&(G-=16),T&16711935&&(G-=8),T&252645135&&(G-=4),T&858993459&&(G-=2),T&1431655765&&(G-=1),G}qo.countTrailingZeros=V,qo.nextPow2=function(T){return T+=T===0,--T,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T+1},qo.prevPow2=function(T){return T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T-(T>>>1)},qo.parity=function(T){return T^=T>>>16,T^=T>>>8,T^=T>>>4,T&=15,27030>>>T&1};var F=new Array(256);return(function(T){for(var G=0;G<256;++G){var q=G,j=G,J=7;for(q>>>=1;q;q>>>=1)j<<=1,j|=q&1,--J;T[G]=j<<J&255}})(F),qo.reverse=function(T){return F[T&255]<<24|F[T>>>8&255]<<16|F[T>>>16&255]<<8|F[T>>>24&255]},qo.interleave2=function(T,G){return T&=65535,T=(T|T<<8)&16711935,T=(T|T<<4)&252645135,T=(T|T<<2)&858993459,T=(T|T<<1)&1431655765,G&=65535,G=(G|G<<8)&16711935,G=(G|G<<4)&252645135,G=(G|G<<2)&858993459,G=(G|G<<1)&1431655765,T|G<<1},qo.deinterleave2=function(T,G){return T=T>>>G&1431655765,T=(T|T>>>1)&858993459,T=(T|T>>>2)&252645135,T=(T|T>>>4)&16711935,T=(T|T>>>16)&65535,T<<16>>16},qo.interleave3=function(T,G,q){return T&=1023,T=(T|T<<16)&4278190335,T=(T|T<<8)&251719695,T=(T|T<<4)&3272356035,T=(T|T<<2)&1227133513,G&=1023,G=(G|G<<16)&4278190335,G=(G|G<<8)&251719695,G=(G|G<<4)&3272356035,G=(G|G<<2)&1227133513,T|=G<<1,q&=1023,q=(q|q<<16)&4278190335,q=(q|q<<8)&251719695,q=(q|q<<4)&3272356035,q=(q|q<<2)&1227133513,T|q<<2},qo.deinterleave3=function(T,G){return T=T>>>G&1227133513,T=(T|T>>>2)&3272356035,T=(T|T>>>4)&251719695,T=(T|T>>>8)&4278190335,T=(T|T>>>16)&1023,T<<22>>22},qo.nextCombination=function(T){var G=T|T-1;return G+1|(~G&-~G)-1>>>V(T)+1},qo}var Jy,w0;function dw(){if(w0)return Jy;w0=1,Jy=B;function B(F){this.roots=new Array(F),this.ranks=new Array(F);for(var T=0;T<F;++T)this.roots[T]=T,this.ranks[T]=0}var V=B.prototype;return Object.defineProperty(V,"length",{get:function(){return this.roots.length}}),V.makeSet=function(){var F=this.roots.length;return this.roots.push(F),this.ranks.push(0),F},V.find=function(F){for(var T=F,G=this.roots;G[F]!==F;)F=G[F];for(;G[T]!==F;){var q=G[T];G[T]=F,T=q}return F},V.link=function(F,T){var G=this.find(F),q=this.find(T);if(G!==q){var j=this.ranks,J=this.roots,h=j[G],X=j[q];h<X?J[G]=q:X<h?J[q]=G:(J[q]=G,++j[G])}},Jy}var E0;function pw(){if(E0)return zu;E0=1;var B=fw(),V=dw();function F(Ft){for(var lt=0,pt=Math.max,It=0,Dt=Ft.length;It<Dt;++It)lt=pt(lt,Ft[It].length);return lt-1}zu.dimension=F;function T(Ft){for(var lt=-1,pt=Math.max,It=0,Dt=Ft.length;It<Dt;++It)for(var _t=Ft[It],Jt=0,Xt=_t.length;Jt<Xt;++Jt)lt=pt(lt,_t[Jt]);return lt+1}zu.countVertices=T;function G(Ft){for(var lt=new Array(Ft.length),pt=0,It=Ft.length;pt<It;++pt)lt[pt]=Ft[pt].slice(0);return lt}zu.cloneCells=G;function q(Ft,lt){var pt=Ft.length,It=Ft.length-lt.length,Dt=Math.min;if(It)return It;switch(pt){case 0:return 0;case 1:return Ft[0]-lt[0];case 2:var Yt=Ft[0]+Ft[1]-lt[0]-lt[1];return Yt||Dt(Ft[0],Ft[1])-Dt(lt[0],lt[1]);case 3:var _t=Ft[0]+Ft[1],Jt=lt[0]+lt[1];if(Yt=_t+Ft[2]-(Jt+lt[2]),Yt)return Yt;var Xt=Dt(Ft[0],Ft[1]),ie=Dt(lt[0],lt[1]),Yt=Dt(Xt,Ft[2])-Dt(ie,lt[2]);return Yt||Dt(Xt+Ft[2],_t)-Dt(ie+lt[2],Jt);default:var rt=Ft.slice(0);rt.sort();var qe=lt.slice(0);qe.sort();for(var Sn=0;Sn<pt;++Sn)if(It=rt[Sn]-qe[Sn],It)return It;return 0}}zu.compareCells=q;function j(Ft,lt){return q(Ft[0],lt[0])}function J(Ft,lt){if(lt){for(var pt=Ft.length,It=new Array(pt),Dt=0;Dt<pt;++Dt)It[Dt]=[Ft[Dt],lt[Dt]];It.sort(j);for(var Dt=0;Dt<pt;++Dt)Ft[Dt]=It[Dt][0],lt[Dt]=It[Dt][1];return Ft}else return Ft.sort(q),Ft}zu.normalize=J;function h(Ft){if(Ft.length===0)return[];for(var lt=1,pt=Ft.length,It=1;It<pt;++It){var Dt=Ft[It];if(q(Dt,Ft[It-1])){if(It===lt){lt++;continue}Ft[lt++]=Dt}}return Ft.length=lt,Ft}zu.unique=h;function X(Ft,lt){for(var pt=0,It=Ft.length-1,Dt=-1;pt<=It;){var _t=pt+It>>1,Jt=q(Ft[_t],lt);Jt<=0?(Jt===0&&(Dt=_t),pt=_t+1):Jt>0&&(It=_t-1)}return Dt}zu.findCell=X;function tt(Ft,lt){for(var pt=new Array(Ft.length),It=0,Dt=pt.length;It<Dt;++It)pt[It]=[];for(var _t=[],It=0,Jt=lt.length;It<Jt;++It)for(var Xt=lt[It],ie=Xt.length,Yt=1,rt=1<<ie;Yt<rt;++Yt){_t.length=B.popCount(Yt);for(var qe=0,Sn=0;Sn<ie;++Sn)Yt&1<<Sn&&(_t[qe++]=Xt[Sn]);var Xn=X(Ft,_t);if(!(Xn<0))for(;pt[Xn++].push(It),!(Xn>=Ft.length||q(Ft[Xn],_t)!==0););}return pt}zu.incidence=tt;function ht(Ft,lt){if(!lt)return tt(h(At(Ft,0)),Ft);for(var pt=new Array(lt),It=0;It<lt;++It)pt[It]=[];for(var It=0,Dt=Ft.length;It<Dt;++It)for(var _t=Ft[It],Jt=0,Xt=_t.length;Jt<Xt;++Jt)pt[_t[Jt]].push(It);return pt}zu.dual=ht;function st(Ft){for(var lt=[],pt=0,It=Ft.length;pt<It;++pt)for(var Dt=Ft[pt],_t=Dt.length|0,Jt=1,Xt=1<<_t;Jt<Xt;++Jt){for(var ie=[],Yt=0;Yt<_t;++Yt)Jt>>>Yt&1&&ie.push(Dt[Yt]);lt.push(ie)}return J(lt)}zu.explode=st;function At(Ft,lt){if(lt<0)return[];for(var pt=[],It=(1<<lt+1)-1,Dt=0;Dt<Ft.length;++Dt)for(var _t=Ft[Dt],Jt=It;Jt<1<<_t.length;Jt=B.nextCombination(Jt)){for(var Xt=new Array(lt+1),ie=0,Yt=0;Yt<_t.length;++Yt)Jt&1<<Yt&&(Xt[ie++]=_t[Yt]);pt.push(Xt)}return J(pt)}zu.skeleton=At;function yt(Ft){for(var lt=[],pt=0,It=Ft.length;pt<It;++pt)for(var Dt=Ft[pt],_t=0,Jt=Dt.length;_t<Jt;++_t){for(var Xt=new Array(Dt.length-1),ie=0,Yt=0;ie<Jt;++ie)ie!==_t&&(Xt[Yt++]=Dt[ie]);lt.push(Xt)}return J(lt)}zu.boundary=yt;function it(Ft,lt){for(var pt=new V(lt),It=0;It<Ft.length;++It)for(var Dt=Ft[It],_t=0;_t<Dt.length;++_t)for(var Jt=_t+1;Jt<Dt.length;++Jt)pt.link(Dt[_t],Dt[Jt]);for(var Xt=[],ie=pt.ranks,It=0;It<ie.length;++It)ie[It]=-1;for(var It=0;It<Ft.length;++It){var Yt=pt.find(Ft[It][0]);ie[Yt]<0?(ie[Yt]=Xt.length,Xt.push([Ft[It].slice(0)])):Xt[ie[Yt]].push(Ft[It].slice(0))}return Xt}function ae(Ft){for(var lt=h(J(At(Ft,0))),pt=new V(lt.length),It=0;It<Ft.length;++It)for(var Dt=Ft[It],_t=0;_t<Dt.length;++_t)for(var Jt=X(lt,[Dt[_t]]),Xt=_t+1;Xt<Dt.length;++Xt)pt.link(Jt,X(lt,[Dt[Xt]]));for(var ie=[],Yt=pt.ranks,It=0;It<Yt.length;++It)Yt[It]=-1;for(var It=0;It<Ft.length;++It){var rt=pt.find(X(lt,[Ft[It][0]]));Yt[rt]<0?(Yt[rt]=ie.length,ie.push([Ft[It].slice(0)])):ie[Yt[rt]].push(Ft[It].slice(0))}return ie}function le(Ft,lt){return lt?it(Ft,lt):ae(Ft)}return zu.connectedComponents=le,zu}var Ky,S0;function gw(){if(S0)return Ky;S0=1,Ky=X;var B=nv(),V=pw().compareCells;function F(tt,ht,st){this.vertices=tt,this.adjacent=ht,this.boundary=st,this.lastVisited=-1}F.prototype.flip=function(){var tt=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=tt;var ht=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=ht};function T(tt,ht,st){this.vertices=tt,this.cell=ht,this.index=st}function G(tt,ht){return V(tt.vertices,ht.vertices)}function q(tt){for(var ht=["function orient(){var tuple=this.tuple;return test("],st=0;st<=tt;++st)st>0&&ht.push(","),ht.push("tuple[",st,"]");ht.push(")}return orient");var At=new Function("test",ht.join("")),yt=B[tt+1];return yt||(yt=B),At(yt)}var j=[];function J(tt,ht,st){this.dimension=tt,this.vertices=ht,this.simplices=st,this.interior=st.filter(function(it){return!it.boundary}),this.tuple=new Array(tt+1);for(var At=0;At<=tt;++At)this.tuple[At]=this.vertices[At];var yt=j[tt];yt||(yt=j[tt]=q(tt)),this.orient=yt}var h=J.prototype;h.handleBoundaryDegeneracy=function(tt,ht){var st=this.dimension,At=this.vertices.length-1,yt=this.tuple,it=this.vertices,ae=[tt];for(tt.lastVisited=-At;ae.length>0;){tt=ae.pop(),tt.vertices;for(var le=tt.adjacent,Ft=0;Ft<=st;++Ft){var lt=le[Ft];if(!(!lt.boundary||lt.lastVisited<=-At)){for(var pt=lt.vertices,It=0;It<=st;++It){var Dt=pt[It];Dt<0?yt[It]=ht:yt[It]=it[Dt]}var _t=this.orient();if(_t>0)return lt;lt.lastVisited=-At,_t===0&&ae.push(lt)}}}return null},h.walk=function(tt,ht){var st=this.vertices.length-1,At=this.dimension,yt=this.vertices,it=this.tuple,ae=ht?this.interior.length*Math.random()|0:this.interior.length-1,le=this.interior[ae];t:for(;!le.boundary;){for(var Ft=le.vertices,lt=le.adjacent,pt=0;pt<=At;++pt)it[pt]=yt[Ft[pt]];le.lastVisited=st;for(var pt=0;pt<=At;++pt){var It=lt[pt];if(!(It.lastVisited>=st)){var Dt=it[pt];it[pt]=tt;var _t=this.orient();if(it[pt]=Dt,_t<0){le=It;continue t}else It.boundary?It.lastVisited=-st:It.lastVisited=st}}return}return le},h.addPeaks=function(tt,ht){var st=this.vertices.length-1,At=this.dimension,yt=this.vertices,it=this.tuple,ae=this.interior,le=this.simplices,Ft=[ht];ht.lastVisited=st,ht.vertices[ht.vertices.indexOf(-1)]=st,ht.boundary=!1,ae.push(ht);for(var lt=[];Ft.length>0;){var ht=Ft.pop(),pt=ht.vertices,It=ht.adjacent,Dt=pt.indexOf(st);if(!(Dt<0)){for(var _t=0;_t<=At;++_t)if(_t!==Dt){var Jt=It[_t];if(!(!Jt.boundary||Jt.lastVisited>=st)){var Xt=Jt.vertices;if(Jt.lastVisited!==-st){for(var ie=0,Yt=0;Yt<=At;++Yt)Xt[Yt]<0?(ie=Yt,it[Yt]=tt):it[Yt]=yt[Xt[Yt]];var rt=this.orient();if(rt>0){Xt[ie]=st,Jt.boundary=!1,ae.push(Jt),Ft.push(Jt),Jt.lastVisited=st;continue}else Jt.lastVisited=-st}var qe=Jt.adjacent,Sn=pt.slice(),Xn=It.slice(),ct=new F(Sn,Xn,!0);le.push(ct);var kt=qe.indexOf(ht);if(!(kt<0)){qe[kt]=ct,Xn[Dt]=Jt,Sn[_t]=-1,Xn[_t]=ht,It[_t]=ct,ct.flip();for(var Yt=0;Yt<=At;++Yt){var ut=Sn[Yt];if(!(ut<0||ut===st)){for(var ye=new Array(At-1),te=0,mt=0;mt<=At;++mt){var Zt=Sn[mt];Zt<0||mt===Yt||(ye[te++]=Zt)}lt.push(new T(ye,ct,Yt))}}}}}}}lt.sort(G);for(var _t=0;_t+1<lt.length;_t+=2){var ve=lt[_t],Be=lt[_t+1],de=ve.index,On=Be.index;de<0||On<0||(ve.cell.adjacent[ve.index]=Be.cell,Be.cell.adjacent[Be.index]=ve.cell)}},h.insert=function(tt,ht){var st=this.vertices;st.push(tt);var At=this.walk(tt,ht);if(At){for(var yt=this.dimension,it=this.tuple,ae=0;ae<=yt;++ae){var le=At.vertices[ae];le<0?it[ae]=tt:it[ae]=st[le]}var Ft=this.orient(it);Ft<0||Ft===0&&(At=this.handleBoundaryDegeneracy(At,tt),!At)||this.addPeaks(tt,At)}},h.boundary=function(){for(var tt=this.dimension,ht=[],st=this.simplices,At=st.length,yt=0;yt<At;++yt){var it=st[yt];if(it.boundary){for(var ae=new Array(tt),le=it.vertices,Ft=0,lt=0,pt=0;pt<=tt;++pt)le[pt]>=0?ae[Ft++]=le[pt]:lt=pt&1;if(lt===(tt&1)){var It=ae[0];ae[0]=ae[1],ae[1]=It}ht.push(ae)}}return ht};function X(tt,ht){var st=tt.length;if(st===0)throw new Error("Must have at least d+1 points");var At=tt[0].length;if(st<=At)throw new Error("Must input at least d+1 points");var yt=tt.slice(0,At+1),it=B.apply(void 0,yt);if(it===0)throw new Error("Input not in general position");for(var ae=new Array(At+1),le=0;le<=At;++le)ae[le]=le;it<0&&(ae[0]=1,ae[1]=0);for(var Ft=new F(ae,new Array(At+1),!1),lt=Ft.adjacent,pt=new Array(At+2),le=0;le<=At;++le){for(var It=ae.slice(),Dt=0;Dt<=At;++Dt)Dt===le&&(It[Dt]=-1);var _t=It[0];It[0]=It[1],It[1]=_t;var Jt=new F(It,new Array(At+1),!0);lt[le]=Jt,pt[le]=Jt}pt[At+1]=Ft;for(var le=0;le<=At;++le)for(var It=lt[le].vertices,Xt=lt[le].adjacent,Dt=0;Dt<=At;++Dt){var ie=It[Dt];if(ie<0){Xt[Dt]=Ft;continue}for(var Yt=0;Yt<=At;++Yt)lt[Yt].vertices.indexOf(ie)<0&&(Xt[Dt]=lt[Yt])}for(var rt=new J(At,yt,pt),qe=!!ht,le=At+1;le<st;++le)rt.insert(tt[le],qe);return rt.boundary()}return Ky}var Qy,T0;function mw(){if(T0)return Qy;T0=1,Qy=F;var B=nv();function V(T,G){for(var q=new Array(G+1),j=0;j<T.length;++j)q[j]=T[j];for(var j=0;j<=T.length;++j){for(var J=T.length;J<=G;++J){for(var h=new Array(G),X=0;X<G;++X)h[X]=Math.pow(J+1-j,X);q[J]=h}var tt=B.apply(void 0,q);if(tt)return!0}return!1}function F(T){var G=T.length;if(G===0)return[];if(G===1)return[0];for(var q=T[0].length,j=[T[0]],J=[0],h=1;h<G;++h){if(j.push(T[h]),!V(j,q)){j.pop();continue}if(J.push(h),J.length===q+1)return J}return J}return Qy}var t_,C0;function yw(){if(C0)return t_;C0=1,t_=G;var B=gw(),V=mw();function F(q,j){for(var J=q.length,h=new Array(J),X=0;X<j.length;++X)h[X]=q[j[X]];for(var tt=j.length,X=0;X<J;++X)j.indexOf(X)<0&&(h[tt++]=q[X]);return h}function T(q,j){for(var J=q.length,h=j.length,X=0;X<J;++X)for(var tt=q[X],ht=0;ht<tt.length;++ht){var st=tt[ht];if(st<h)tt[ht]=j[st];else{st=st-h;for(var At=0;At<h;++At)st>=j[At]&&(st+=1);tt[ht]=st}}return q}function G(q,j){try{return B(q,!0)}catch{var J=V(q);if(J.length<=j)return[];var h=F(q,J),X=B(h,!0);return T(X,J)}}return t_}var e_,I0;function _w(){if(I0)return e_;I0=1;var B=sw(),V=hw(),F=yw();e_=T;function T(G){var q=G.length;if(q===0)return[];if(q===1)return[[0]];var j=G[0].length;return j===0?[]:j===1?B(G):j===2?V(G):F(G,j)}return e_}var n_,M0;function vw(){if(M0)return n_;M0=1;var B=lp().coordEach,V=_w(),F=qr().polygon;return n_=function(T){var G=[];B(T,function(h){G.push(h)});var q=V(G);if(q.length>0){for(var j=[],J=0;J<q.length;J++)j.push(G[q[J][0]]);return j.push(G[q[q.length-1][1]]),F([j])}},n_}var i_,A0;function xw(){if(A0)return i_;A0=1;var B=ap(),V=qr().featureCollection;return i_=function(F,T){for(var G=V([]),q=0;q<T.features.length;q++)for(var j=0;j<F.features.length;j++){var J=B(F.features[j],T.features[q]);J&&G.features.push(F.features[j])}return G},i_}var xg={exports:{}},bw=xg.exports,L0;function Fm(){return L0||(L0=1,(function(B,V){(function(F,T){T(V)})(bw,function(F){function T(t,n){for(var l in n)n.hasOwnProperty(l)&&(t[l]=n[l])}function G(){}function q(){}function j(){}function J(){}function h(){}function X(){}function tt(){}function ht(t){this.message=t}function st(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t}function At(){if(arguments.length===0)ht.call(this);else if(arguments.length===1){var t=arguments[0];ht.call(this,t)}}function yt(){}function it(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)it.call(this,0,0);else if(arguments.length===1){var t=arguments[0];it.call(this,t.x,t.y,t.z)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];it.call(this,n,l,it.NULL_ORDINATE)}else if(arguments.length===3){var d=arguments[0],v=arguments[1],C=arguments[2];this.x=d,this.y=v,this.z=C}}function ae(){if(this.dimensionsToTest=2,arguments.length===0)ae.call(this,2);else if(arguments.length===1){var t=arguments[0];if(t!==2&&t!==3)throw new q;this.dimensionsToTest=t}}function le(){}function Ft(){}function lt(t){this.message=t||""}function pt(){}function It(t){this.message=t||""}function Dt(t){this.message=t||""}function _t(){this.array_=[],arguments[0]instanceof Ft&&this.addAll(arguments[0])}function Jt(){if(_t.apply(this),arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.ensureCapacity(n.length),this.add(n,l)}}}function Xt(){if(this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof it){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Xt){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];this.init(l.x,d.x,l.y,d.y)}else if(arguments.length===4){var v=arguments[0],C=arguments[1],z=arguments[2],W=arguments[3];this.init(v,C,z,W)}}function ie(){}function Yt(){ie.call(this,"Projective point not representable on the Cartesian plane.")}function rt(){}function qe(t,n){return t.interfaces_&&t.interfaces_().indexOf(n)>-1}function Sn(){}function Xn(t){this.str=t}function ct(t){this.value=t}function kt(){}function ut(){if(this.hi=0,this.lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof ut){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var l=arguments[0];ut.call(this,ut.parse(l))}}else if(arguments.length===2){var d=arguments[0],v=arguments[1];this.init(d,v)}}function ye(){}function te(){}function mt(){}function Zt(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],l=arguments[1];this.x=n,this.y=l,this.w=1}else if(arguments[0]instanceof Zt&&arguments[1]instanceof Zt){var d=arguments[0],v=arguments[1];this.x=d.y*v.w-v.y*d.w,this.y=v.x*d.w-d.x*v.w,this.w=d.x*v.y-v.x*d.y}else if(arguments[0]instanceof it&&arguments[1]instanceof it){var C=arguments[0],z=arguments[1];this.x=C.y-z.y,this.y=z.x-C.x,this.w=C.x*z.y-z.x*C.y}}else if(arguments.length===3){var W=arguments[0],gt=arguments[1],Bt=arguments[2];this.x=W,this.y=gt,this.w=Bt}else if(arguments.length===4){var Se=arguments[0],Ae=arguments[1],rn=arguments[2],Nn=arguments[3],ei=Se.y-Ae.y,ci=Ae.x-Se.x,Mr=Se.x*Ae.y-Ae.x*Se.y,_s=rn.y-Nn.y,ha=Nn.x-rn.x,mc=rn.x*Nn.y-Nn.x*rn.y;this.x=ci*mc-ha*Mr,this.y=_s*Mr-ei*mc,this.w=ei*ha-_s*ci}}function ve(){}function Be(){}function de(){this.envelope=null,this.factory=null,this.SRID=null,this.userData=null;var t=arguments[0];this.factory=t,this.SRID=t.getSRID()}function On(){}function An(){}function $n(){}function yi(){}function Gi(){}function jr(){}function Bn(){}function lr(){}function Fr(){}function Mn(){}function ui(){}function Vl(){}function mr(){this.array_=[],arguments[0]instanceof Ft&&this.addAll(arguments[0])}function _l(t){return t==null?Pe:t.color}function vi(t){return t==null?null:t.parent}function Us(t,n){t!==null&&(t.color=n)}function Wa(t){return t==null?null:t.left}function eo(t){return t==null?null:t.right}function Ri(){this.root_=null,this.size_=0}function $a(){}function ql(){}function Qr(){this.array_=[],arguments[0]instanceof Ft&&this.addAll(arguments[0])}function hs(){}function $e(){}function yr(){}function Xr(){}function ri(){this.geometries=null;var t=arguments[0],n=arguments[1];if(de.call(this,n),t===null&&(t=[]),de.hasNullElements(t))throw new q;this.geometries=t}function Ki(){var t=arguments[0],n=arguments[1];ri.call(this,t,n)}function Tr(){if(this.geom=null,this.geomFact=null,this.bnRule=null,this.endpointMap=null,arguments.length===1){var t=arguments[0];Tr.call(this,t,An.MOD2_BOUNDARY_RULE)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.geom=n,this.geomFact=n.getFactory(),this.bnRule=l}}function Rs(){this.count=null}function _r(){}function Di(){}function fu(){}function jl(){}function vl(){}function ya(){}function Dr(){}function Kn(){}function oi(){this.points=null;var t=arguments[0],n=arguments[1];de.call(this,n),this.init(t)}function Ds(){}function rr(){this.coordinates=null;var t=arguments[0],n=arguments[1];de.call(this,n),this.init(t)}function ts(){}function Pi(){this.shell=null,this.holes=null;var t=arguments[0],n=arguments[1],l=arguments[2];if(de.call(this,l),t===null&&(t=this.getFactory().createLinearRing()),n===null&&(n=[]),de.hasNullElements(n))throw new q;if(t.isEmpty()&&de.hasNonEmptyElements(n))throw new q;this.shell=t,this.holes=n}function Zr(){var t=arguments[0],n=arguments[1];ri.call(this,t,n)}function Yi(){if(arguments[0]instanceof it&&arguments[1]instanceof Rn){var t=arguments[0],n=arguments[1];Yi.call(this,n.getCoordinateSequenceFactory().create(t),n)}else if(qe(arguments[0],te)&&arguments[1]instanceof Rn){var l=arguments[0],d=arguments[1];oi.call(this,l,d),this.validateConstruction()}}function Ct(){var t=arguments[0],n=arguments[1];ri.call(this,t,n)}function et(){if(this.factory=null,this.isUserDataCopied=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.factory=t}}}function ot(){}function Lt(){}function Pt(){}function Kt(){}function ue(){if(this.dimension=3,this.coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];ue.call(this,t,3)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.coordinates=new Array(n).fill(null);for(var l=0;n>l;l++)this.coordinates[l]=new it}else if(qe(arguments[0],te)){var d=arguments[0];if(d===null)return this.coordinates=new Array(0).fill(null),null;this.dimension=d.getDimension(),this.coordinates=new Array(d.size()).fill(null);for(var l=0;l<this.coordinates.length;l++)this.coordinates[l]=d.getCoordinateCopy(l)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var v=arguments[0],C=arguments[1];this.coordinates=v,this.dimension=C,v===null&&(this.coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var z=arguments[0],W=arguments[1];this.coordinates=new Array(z).fill(null),this.dimension=W;for(var l=0;z>l;l++)this.coordinates[l]=new it}}}function se(){}function $t(t,n){return t===n||t!==t&&n!==n}function me(t,n){function l(d){return this&&this.constructor===l?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=n,void(d&&je.call(this,d))):new l(d)}return an(t,"size",{get:_i}),t.constructor=l,l.prototype=t,l}function je(t){this.add?t.forEach(this.add,this):t.forEach(function(n){this.set(n[0],n[1])},this)}function yn(t){return this.has(t)&&(this._keys.splice(fn,1),this._values.splice(fn,1),this._itp.forEach(function(n){fn<n[0]&&n[0]--})),fn>-1}function Je(t){return this.has(t)?this._values[fn]:void 0}function Zn(t,n){if(this.objectOnly&&n!==Object(n))throw new TypeError("Invalid value used as weak collection key");if(n!==n||n===0)for(fn=t.length;fn--&&!$t(t[fn],n););else fn=t.indexOf(n);return fn>-1}function jn(t){return Zn.call(this,this._keys,t)}function Fn(t,n){return this.has(t)?this._values[fn]=n:this._values[this._keys.push(t)-1]=n,this}function Qn(){(this._keys||0).length=this._values.length=0}function fi(){return Vi(this._itp,this._keys)}function ki(){return Vi(this._itp,this._values)}function Dn(){return Vi(this._itp,this._keys,this._values)}function Vi(t,n,l){var d=[0],v=!1;return t.push(d),{next:function(){var C,z=d[0];return!v&&z<n.length?(C=l?[n[z],l[z]]:n[z],d[0]++):(v=!0,t.splice(t.indexOf(d),1)),{done:v,value:C}}}}function _i(){return this._values.length}function Ra(t,n){for(var l=this.entries();;){var d=l.next();if(d.done)break;t.call(n,d.value[1],d.value[0],this)}}function Ss(){this.map_=new Xe}function _e(){if(this.modelType=null,this.scale=null,arguments.length===0)this.modelType=_e.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Hr){var t=arguments[0];this.modelType=t,t===_e.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this.modelType=_e.FIXED,this.setScale(n)}else if(arguments[0]instanceof _e){var l=arguments[0];this.modelType=l.modelType,this.scale=l.scale}}}function Hr(){this.name=null;var t=arguments[0];this.name=t,Hr.nameToTypeMap.put(t,this)}function Rn(){if(this.precisionModel=null,this.coordinateSequenceFactory=null,this.SRID=null,arguments.length===0)Rn.call(this,new _e,0);else if(arguments.length===1){if(qe(arguments[0],ve)){var t=arguments[0];Rn.call(this,new _e,0,t)}else if(arguments[0]instanceof _e){var n=arguments[0];Rn.call(this,n,0,Rn.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];Rn.call(this,l,d,Rn.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2];this.precisionModel=v,this.coordinateSequenceFactory=z,this.SRID=C}}function _a(t){this.geometryFactory=t||new Rn}function Ns(t){this.parser=new _a(t)}function gi(){this.result=null,this.inputLines=Array(2).fill().map(function(){return Array(2)}),this.intPt=new Array(2).fill(null),this.intLineIndex=null,this._isProper=null,this.pa=null,this.pb=null,this.precisionModel=null,this.intPt[0]=new it,this.intPt[1]=new it,this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=0}function ji(){gi.apply(this)}function ea(){}function kr(){this.p=null,this.crossingCount=0,this.isPointOnSegment=!1;var t=arguments[0];this.p=t}function re(){}function gn(){if(this.p0=null,this.p1=null,arguments.length===0)gn.call(this,new it,new it);else if(arguments.length===1){var t=arguments[0];gn.call(this,t.p0,t.p1)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.p0=n,this.p1=l}else if(arguments.length===4){var d=arguments[0],v=arguments[1],C=arguments[2],z=arguments[3];gn.call(this,new it(d,v),new it(C,z))}}function zn(){if(this.matrix=null,arguments.length===0)this.matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll($e.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var t=arguments[0];zn.call(this),this.set(t)}else if(arguments[0]instanceof zn){var n=arguments[0];zn.call(this),this.matrix[rt.INTERIOR][rt.INTERIOR]=n.matrix[rt.INTERIOR][rt.INTERIOR],this.matrix[rt.INTERIOR][rt.BOUNDARY]=n.matrix[rt.INTERIOR][rt.BOUNDARY],this.matrix[rt.INTERIOR][rt.EXTERIOR]=n.matrix[rt.INTERIOR][rt.EXTERIOR],this.matrix[rt.BOUNDARY][rt.INTERIOR]=n.matrix[rt.BOUNDARY][rt.INTERIOR],this.matrix[rt.BOUNDARY][rt.BOUNDARY]=n.matrix[rt.BOUNDARY][rt.BOUNDARY],this.matrix[rt.BOUNDARY][rt.EXTERIOR]=n.matrix[rt.BOUNDARY][rt.EXTERIOR],this.matrix[rt.EXTERIOR][rt.INTERIOR]=n.matrix[rt.EXTERIOR][rt.INTERIOR],this.matrix[rt.EXTERIOR][rt.BOUNDARY]=n.matrix[rt.EXTERIOR][rt.BOUNDARY],this.matrix[rt.EXTERIOR][rt.EXTERIOR]=n.matrix[rt.EXTERIOR][rt.EXTERIOR]}}}function Ts(){this.areaBasePt=null,this.triangleCent3=new it,this.areasum2=0,this.cg3=new it,this.lineCentSum=new it,this.totalLength=0,this.ptCount=0,this.ptCentSum=new it;var t=arguments[0];this.areaBasePt=null,this.add(t)}function Ja(t){this.message=t||""}function Hn(){this.array_=[]}function Ka(){this.treeSet=new Qr,this.list=new _t}function Ur(){if(this.geomFactory=null,this.inputPts=null,arguments.length===1){var t=arguments[0];Ur.call(this,Ur.extractCoordinates(t),t.getFactory())}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.inputPts=Ka.filterCoordinates(n),this.geomFactory=l}}function na(){this.origin=null;var t=arguments[0];this.origin=t}function br(){this.inputGeom=null,this.factory=null,this.pruneEmptyGeometry=!0,this.preserveGeometryCollectionType=!0,this.preserveCollections=!1,this.preserveType=!1}function Qi(){if(this.snapTolerance=0,this.srcPts=null,this.seg=new gn,this.allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof oi&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];Qi.call(this,t.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var l=arguments[0],d=arguments[1];this.srcPts=l,this._isClosed=Qi.isClosed(l),this.snapTolerance=d}}function R(){this.srcGeom=null;var t=arguments[0];this.srcGeom=t}function H(){if(br.apply(this),this.snapTolerance=null,this.snapPts=null,this.isSelfSnap=!1,arguments.length===2){var t=arguments[0],n=arguments[1];this.snapTolerance=t,this.snapPts=n}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.snapTolerance=l,this.snapPts=d,this.isSelfSnap=v}}function ft(){this.isFirst=!0,this.commonMantissaBitsCount=53,this.commonBits=0,this.commonSignExp=null}function Ht(){this.commonCoord=null,this.ccFilter=new Ce}function Ce(){this.commonBitsX=new ft,this.commonBitsY=new ft}function pe(){this.trans=null;var t=arguments[0];this.trans=t}function be(){this.parent=null,this.atStart=null,this.max=null,this.index=null,this.subcollectionIterator=null;var t=arguments[0];this.parent=t,this.atStart=!0,this.index=0,this.max=t.getNumGeometries()}function en(){if(this.boundaryRule=An.OGC_SFS_BOUNDARY_RULE,this.isIn=null,this.numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new q;this.boundaryRule=t}}}function nn(){}function wn(){}function we(){this.pts=null,this.data=null;var t=arguments[0],n=arguments[1];this.pts=t,this.data=n}function Qe(){}function Tn(){this.bounds=null,this.item=null;var t=arguments[0],n=arguments[1];this.bounds=t,this.item=n}function Yn(){this._size=null,this.items=null,this._size=0,this.items=new _t,this.items.add(null)}function Pn(){}function Ni(){}function ke(){if(this.childBoundables=new _t,this.bounds=null,this.level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.level=t}}}function _n(){this.boundable1=null,this.boundable2=null,this._distance=null,this.itemDistance=null;var t=arguments[0],n=arguments[1],l=arguments[2];this.boundable1=t,this.boundable2=n,this.itemDistance=l,this._distance=this.distance()}function kn(){if(this.root=null,this.built=!1,this.itemBoundables=new _t,this.nodeCapacity=null,arguments.length===0)kn.call(this,kn.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];yt.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t}}function Xi(){}function Wi(){}function xn(){if(arguments.length===0)xn.call(this,xn.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];kn.call(this,t)}}function gr(){var t=arguments[0];ke.call(this,t)}function ur(){}function qi(){this.segString=null,this.coord=null,this.segmentIndex=null,this.segmentOctant=null,this._isInterior=null;var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3];this.segString=t,this.coord=new it(n),this.segmentIndex=l,this.segmentOctant=d,this._isInterior=!n.equals2D(t.getCoordinate(l))}function Yr(){this.nodeMap=new Ri,this.edge=null;var t=arguments[0];this.edge=t}function ss(){this.nodeList=null,this.edge=null,this.nodeIt=null,this.currNode=null,this.nextNode=null,this.currSegIndex=0;var t=arguments[0];this.nodeList=t,this.edge=t.getEdge(),this.nodeIt=t.iterator(),this.readNextNode()}function Da(){}function Co(){this.nodeList=new Yr(this),this.pts=null,this.data=null;var t=arguments[0],n=arguments[1];this.pts=t,this.data=n}function no(){this.tempEnv1=new Xt,this.tempEnv2=new Xt,this.overlapSeg1=new gn,this.overlapSeg2=new gn}function fs(){this.pts=null,this.start=null,this.end=null,this.env=null,this.context=null,this.id=null;var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3];this.pts=t,this.start=n,this.end=l,this.context=d}function Ci(){}function ho(){}function fo(){}function io(){if(this.segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}}function jo(){if(this.monoChains=new _t,this.index=new xn,this.idCounter=0,this.nodedSegStrings=null,this.nOverlaps=0,arguments.length!==0){if(arguments.length===1){var t=arguments[0];io.call(this,t)}}}function Io(){no.apply(this),this.si=null;var t=arguments[0];this.si=t}function Cs(){if(this.pt=null,arguments.length===1){var t=arguments[0];ht.call(this,t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];ht.call(this,Cs.msgWithCoord(n,l)),this.pt=new it(l)}}function ro(){}function Os(){this.findAllIntersections=!1,this.isCheckEndSegmentsOnly=!1,this.li=null,this.interiorIntersection=null,this.intSegments=null,this.intersections=new _t,this.intersectionCount=0,this.keepIntersections=!0;var t=arguments[0];this.li=t,this.interiorIntersection=null}function Pu(){this.li=new ji,this.segStrings=null,this.findAllIntersections=!1,this.segInt=null,this._isValid=!0;var t=arguments[0];this.segStrings=t}function Qa(){this.nv=null;var t=arguments[0];this.nv=new Pu(Qa.toSegmentStrings(t))}function xl(){this.mapOp=null;var t=arguments[0];this.mapOp=t}function Ke(){}function Hs(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Ke.ON]=n}else if(arguments[0]instanceof Hs){var l=arguments[0];if(this.init(l.location.length),l!==null)for(var d=0;d<this.location.length;d++)this.location[d]=l.location[d]}}else if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2];this.init(3),this.location[Ke.ON]=v,this.location[Ke.LEFT]=C,this.location[Ke.RIGHT]=z}}function wr(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Hs(t),this.elt[1]=new Hs(t)}else if(arguments[0]instanceof wr){var n=arguments[0];this.elt[0]=new Hs(n.elt[0]),this.elt[1]=new Hs(n.elt[1])}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];this.elt[0]=new Hs(rt.NONE),this.elt[1]=new Hs(rt.NONE),this.elt[l].setLocation(d)}else if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2];this.elt[0]=new Hs(v,C,z),this.elt[1]=new Hs(v,C,z)}else if(arguments.length===4){var W=arguments[0],gt=arguments[1],Bt=arguments[2],Se=arguments[3];this.elt[0]=new Hs(rt.NONE,rt.NONE,rt.NONE),this.elt[1]=new Hs(rt.NONE,rt.NONE,rt.NONE),this.elt[W].setLocations(gt,Bt,Se)}}function tl(){this.startDe=null,this.maxNodeDegree=-1,this.edges=new _t,this.pts=new _t,this.label=new wr(rt.NONE),this.ring=null,this._isHole=null,this.shell=null,this.holes=new _t,this.geometryFactory=null;var t=arguments[0],n=arguments[1];this.geometryFactory=n,this.computePoints(t),this.computeRing()}function Xo(){var t=arguments[0],n=arguments[1];tl.call(this,t,n)}function du(){var t=arguments[0],n=arguments[1];tl.call(this,t,n)}function Na(){if(this.label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.label=t}}}function ia(){Na.apply(this),this.coord=null,this.edges=null;var t=arguments[0],n=arguments[1];this.coord=t,this.edges=n,this.label=new wr(0,rt.NONE)}function Xl(){this.nodeMap=new Ri,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}function zs(){if(this.edge=null,this.label=null,this.node=null,this.p0=null,this.p1=null,this.dx=null,this.dy=null,this.quadrant=null,arguments.length===1){var t=arguments[0];this.edge=t}else if(arguments.length===3){var n=arguments[0],l=arguments[1],d=arguments[2];zs.call(this,n,l,d,null)}else if(arguments.length===4){var v=arguments[0],C=arguments[1],z=arguments[2],W=arguments[3];zs.call(this,v),this.init(C,z),this.label=W}}function Oi(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this.sym=null,this.next=null,this.nextMin=null,this.edgeRing=null,this.minEdgeRing=null,this.depth=[0,-999,-999];var t=arguments[0],n=arguments[1];if(zs.call(this,t),this._isForward=n,n)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var l=t.getNumPoints()-1;this.init(t.getCoordinate(l),t.getCoordinate(l-1))}this.computeDirectedLabel()}function Mo(){}function Ps(){if(this.edges=new _t,this.nodes=null,this.edgeEndList=new _t,arguments.length===0)this.nodes=new Xl(new Mo);else if(arguments.length===1){var t=arguments[0];this.nodes=new Xl(t)}}function Ao(){this.geometryFactory=null,this.shellList=new _t;var t=arguments[0];this.geometryFactory=t}function va(){this.op=null,this.geometryFactory=null,this.ptLocator=null,this.lineEdgesList=new _t,this.resultLineList=new _t;var t=arguments[0],n=arguments[1],l=arguments[2];this.op=t,this.geometryFactory=n,this.ptLocator=l}function Zl(){this.op=null,this.geometryFactory=null,this.resultPointList=new _t;var t=arguments[0],n=arguments[1];this.op=t,this.geometryFactory=n}function Zo(){}function po(){this.geom=null;var t=arguments[0];this.geom=t}function ra(){this.edgeMap=new Ri,this.edgeList=null,this.ptInAreaLocation=[rt.NONE,rt.NONE]}function xa(){ra.apply(this),this.resultAreaEdgeList=null,this.label=null,this.SCANNING_FOR_INCOMING=1,this.LINKING_TO_OUTGOING=2}function Ho(){Mo.apply(this)}function bl(){this.mce=null,this.chainIndex=null;var t=arguments[0],n=arguments[1];this.mce=t,this.chainIndex=n}function Ii(){if(this.label=null,this.xValue=null,this.eventType=null,this.insertEvent=null,this.deleteEventIndex=null,this.obj=null,arguments.length===2){var t=arguments[0],n=arguments[1];this.eventType=Ii.DELETE,this.xValue=t,this.insertEvent=n}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.eventType=Ii.INSERT,this.label=l,this.xValue=d,this.obj=v}}function wl(){}function Oa(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.properIntersectionPoint=null,this.li=null,this.includeProper=null,this.recordIsolated=null,this.isSelfIntersection=null,this.numIntersections=0,this.numTests=0,this.bdyNodes=null,this._isDone=!1,this.isDoneWhenProperInt=!1;var t=arguments[0],n=arguments[1],l=arguments[2];this.li=t,this.includeProper=n,this.recordIsolated=l}function Hl(){wl.apply(this),this.events=new _t,this.nOverlaps=null}function Lo(){this.min=j.POSITIVE_INFINITY,this.max=j.NEGATIVE_INFINITY}function za(){}function Bu(){Lo.apply(this),this.item=null;var t=arguments[0],n=arguments[1],l=arguments[2];this.min=t,this.max=n,this.item=l}function sa(){Lo.apply(this),this.node1=null,this.node2=null;var t=arguments[0],n=arguments[1];this.node1=t,this.node2=n,this.buildExtent(this.node1,this.node2)}function Ju(){this.leaves=new _t,this.root=null,this.level=0}function Nr(){if(this.lines=null,this.isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this.lines=t}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.lines=n,this.isForcedToLineString=l}}function El(){this.items=new _t}function ba(){this.index=null;var t=arguments[0];if(!qe(t,ts))throw new q;this.index=new Yl(t)}function el(){this.counter=null;var t=arguments[0];this.counter=t}function Yl(){this.index=new Ju;var t=arguments[0];this.init(t)}function Ku(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],n=arguments[1],l=arguments[2];this.coord=new it(t),this.segmentIndex=n,this.dist=l}function Qu(){this.nodeMap=new Ri,this.edge=null;var t=arguments[0];this.edge=t}function Pa(){}function Ro(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Xt,this.env2=new Xt;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var n=new Pa;this.startIndex=n.getChainStartIndices(this.pts)}function Ys(){this.depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;2>t;t++)for(var n=0;3>n;n++)this.depth[t][n]=Ys.NULL_VALUE}function go(){if(Na.apply(this),this.pts=null,this.env=null,this.eiList=new Qu(this),this.name=null,this.mce=null,this._isIsolated=!0,this.depth=new Ys,this.depthDelta=0,arguments.length===1){var t=arguments[0];go.call(this,t,null)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.pts=n,this.label=l}}function oe(){if(Ps.apply(this),this.parentGeom=null,this.lineEdgeMap=new Ss,this.boundaryNodeRule=null,this.useBoundaryDeterminationRule=!0,this.argIndex=null,this.boundaryNodes=null,this._hasTooFewPoints=!1,this.invalidPoint=null,this.areaPtLocator=null,this.ptLocator=new en,arguments.length===2){var t=arguments[0],n=arguments[1];oe.call(this,t,n,An.OGC_SFS_BOUNDARY_RULE)}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.argIndex=l,this.parentGeom=d,this.boundaryNodeRule=v,d!==null&&this.add(d)}}function De(){if(this.li=new ji,this.resultPrecisionModel=null,this.arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this.arg=new Array(1).fill(null),this.arg[0]=new oe(0,t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];De.call(this,n,l,An.OGC_SFS_BOUNDARY_RULE)}else if(arguments.length===3){var d=arguments[0],v=arguments[1],C=arguments[2];d.getPrecisionModel().compareTo(v.getPrecisionModel())>=0?this.setComputationPrecision(d.getPrecisionModel()):this.setComputationPrecision(v.getPrecisionModel()),this.arg=new Array(2).fill(null),this.arg[0]=new oe(0,d,C),this.arg[1]=new oe(1,v,C)}}function vn(){this.pts=null,this._orientation=null;var t=arguments[0];this.pts=t,this._orientation=vn.orientation(t)}function Wn(){this.edges=new _t,this.ocaMap=new Ri}function mn(){this.ptLocator=new en,this.geomFact=null,this.resultGeom=null,this.graph=null,this.edgeList=new Wn,this.resultPolyList=new _t,this.resultLineList=new _t,this.resultPointList=new _t;var t=arguments[0],n=arguments[1];De.call(this,t,n),this.graph=new Ps(new Ho),this.geomFact=t.getFactory()}function hi(){this.geom=new Array(2).fill(null),this.snapTolerance=null,this.cbr=null;var t=arguments[0],n=arguments[1];this.geom[0]=t,this.geom[1]=n,this.computeSnapTolerance()}function wi(){this.geom=new Array(2).fill(null);var t=arguments[0],n=arguments[1];this.geom[0]=t,this.geom[1]=n}function sr(){this.factory=null,this.interiorPoint=null,this.maxWidth=0;var t=arguments[0];this.factory=t.getFactory(),this.add(t)}function Ws(){this.poly=null,this.centreY=null,this.hiY=j.MAX_VALUE,this.loY=-j.MAX_VALUE;var t=arguments[0];this.poly=t,this.hiY=t.getEnvelopeInternal().getMaxY(),this.loY=t.getEnvelopeInternal().getMinY(),this.centreY=sr.avg(this.loY,this.hiY)}function ds(){this.centroid=null,this.minDistance=j.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.addInterior(t),this.interiorPoint===null&&this.addEndpoints(t)}function Gr(){this.centroid=null,this.minDistance=j.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.add(t)}function Jn(){}function zi(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],n=arguments[1],l=arguments[2];this.p0=t,this.p1=n,this.p2=l}function tr(){this.input=null,this.extremalPts=null,this.centre=null,this.radius=0;var t=arguments[0];this.input=t}function cr(){if(this.inputGeom=null,this.isConvex=null,this.convexHullPts=null,this.minBaseSeg=new gn,this.minWidthPt=null,this.minPtIndex=null,this.minWidth=0,arguments.length===1){var t=arguments[0];cr.call(this,t,!1)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.inputGeom=n,this.isConvex=l}}function Yo(){this.inputGeom=null,this.distanceTolerance=null;var t=arguments[0];this.inputGeom=t}function wa(){br.apply(this),this.distanceTolerance=null;var t=arguments[0];this.distanceTolerance=t}function Gs(){this._orig=null,this._sym=null,this._next=null;var t=arguments[0];this._orig=t}function ps(){this._isMarked=!1;var t=arguments[0];Gs.call(this,t)}function Ba(){this.vertexMap=new Ss}function Sl(){this._isStart=!1;var t=arguments[0];ps.call(this,t)}function Tl(){Ba.apply(this)}function or(){this.result=null,this.factory=null,this.graph=null,this.lines=new _t,this.nodeEdgeStack=new Hn,this.ringStartEdge=null,this.graph=new Tl}function Ai(){this.items=new _t,this.subnode=new Array(4).fill(null)}function oa(){}function nl(t,n){var l,d,v,C,z={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}},W={32:8,64:11}[t];if(C||(l=0>n||0>1/n,isFinite(n)||(C=z[t],l&&(C.d+=1<<t/4-1),d=Math.pow(2,W)-1,v=0)),!C){for(d={32:127,64:1023}[t],v=Math.abs(n);v>=2;)d++,v/=2;for(;1>v&&d>0;)d--,v*=2;0>=d&&(v/=2)}return d}function Do(){this.pt=new it,this.level=0,this.env=null;var t=arguments[0];this.computeKey(t)}function Or(){Ai.apply(this),this.env=null,this.centrex=null,this.centrey=null,this.level=null;var t=arguments[0],n=arguments[1];this.env=t,this.level=n,this.centrex=(t.getMinX()+t.getMaxX())/2,this.centrey=(t.getMinY()+t.getMaxY())/2}function Bs(){}function mo(){Ai.apply(this)}function Vs(){this.root=null,this.minExtent=1,this.root=new mo}function Wl(t){this.geometryFactory=t||new Rn}function il(t){this.geometryFactory=t||new Rn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Wl(this.geometryFactory)}function yo(){this.parser=new Wl(this.geometryFactory)}function $l(t){this.geometryFactory=t||new Rn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new _a(this.geometryFactory)}function rl(t){return[t.x,t.y]}function Ea(t){this.geometryFactory=t||new Rn}function Wo(){if(this.noder=null,this.scaleFactor=null,this.offsetX=null,this.offsetY=null,this.isScaled=!1,arguments.length===2){var t=arguments[0],n=arguments[1];Wo.call(this,t,n,0,0)}else if(arguments.length===4){var l=arguments[0],d=arguments[1];this.noder=l,this.scaleFactor=d,this.isScaled=!this.isIntegerPrecision()}}function sl(){if(this.inputGeom=null,this.isClosedEndpointsInInterior=!0,this.nonSimpleLocation=null,arguments.length===1){var t=arguments[0];this.inputGeom=t}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.inputGeom=n,this.isClosedEndpointsInInterior=!l.isInBoundary(2)}}function _o(){this.pt=null,this.isClosed=null,this.degree=null;var t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0}function In(){if(this.quadrantSegments=In.DEFAULT_QUADRANT_SEGMENTS,this.endCapStyle=In.CAP_ROUND,this.joinStyle=In.JOIN_ROUND,this.mitreLimit=In.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this.simplifyFactor=In.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(l)}else if(arguments.length===4){var d=arguments[0],v=arguments[1],C=arguments[2],z=arguments[3];this.setQuadrantSegments(d),this.setEndCapStyle(v),this.setJoinStyle(C),this.setMitreLimit(z)}}}function so(){this.minIndex=-1,this.minCoord=null,this.minDe=null,this.orientedDe=null}function aa(){this.array_=[]}function pu(){this.finder=null,this.dirEdgeList=new _t,this.nodes=new _t,this.rightMostCoord=null,this.env=null,this.finder=new so}function es(){this.inputLine=null,this.distanceTol=null,this.isDeleted=null,this.angleOrientation=re.COUNTERCLOCKWISE;var t=arguments[0];this.inputLine=t}function Fu(){this.ptList=null,this.precisionModel=null,this.minimimVertexDistance=0,this.ptList=new _t}function $o(){this.maxCurveSegmentError=0,this.filletAngleQuantum=null,this.closingSegLengthFactor=1,this.segList=null,this.distance=0,this.precisionModel=null,this.bufParams=null,this.li=null,this.s0=null,this.s1=null,this.s2=null,this.seg0=new gn,this.seg1=new gn,this.offset0=new gn,this.offset1=new gn,this.side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],l=arguments[2];this.precisionModel=t,this.bufParams=n,this.li=new ji,this.filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===In.JOIN_ROUND&&(this.closingSegLengthFactor=$o.MAX_CLOSING_SEG_LEN_FACTOR),this.init(l)}function gu(){this.distance=0,this.precisionModel=null,this.bufParams=null;var t=arguments[0],n=arguments[1];this.precisionModel=t,this.bufParams=n}function al(){this.subgraphs=null,this.seg=new gn,this.cga=new re;var t=arguments[0];this.subgraphs=t}function mu(){this.upwardSeg=null,this.leftDepth=null;var t=arguments[0],n=arguments[1];this.upwardSeg=new gn(t),this.leftDepth=n}function Jl(){this.inputGeom=null,this.distance=null,this.curveBuilder=null,this.curveList=new _t;var t=arguments[0],n=arguments[1],l=arguments[2];this.inputGeom=t,this.distance=n,this.curveBuilder=l}function Jo(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.hasInterior=!1,this.properIntersectionPoint=null,this.li=null,this.isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this.li=t}function Cl(){this.bufParams=null,this.workingPrecisionModel=null,this.workingNoder=null,this.geomFact=null,this.graph=null,this.edgeList=new Wn;var t=arguments[0];this.bufParams=t}function $s(){this.li=new ji,this.segStrings=null;var t=arguments[0];this.segStrings=t}function ll(){this.li=null,this.pt=null,this.originalPt=null,this.ptScaled=null,this.p0Scaled=null,this.p1Scaled=null,this.scaleFactor=null,this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,this.corner=new Array(4).fill(null),this.safeEnv=null;var t=arguments[0],n=arguments[1],l=arguments[2];if(this.originalPt=t,this.pt=t,this.scaleFactor=n,this.li=l,0>=n)throw new q;n!==1&&(this.pt=new it(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new it,this.p1Scaled=new it),this.initCorners(this.pt)}function gs(){this.tempEnv1=new Xt,this.selectedSegment=new gn}function yu(){this.index=null;var t=arguments[0];this.index=t}function bn(){gs.apply(this),this.hotPixel=null,this.parentEdge=null,this.hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],n=arguments[1],l=arguments[2];this.hotPixel=t,this.parentEdge=n,this.hotPixelVertexIndex=l}function qs(){this.li=null,this.interiorIntersections=null;var t=arguments[0];this.li=t,this.interiorIntersections=new _t}function tc(){this.pm=null,this.li=null,this.scaleFactor=null,this.noder=null,this.pointSnapper=null,this.nodedSegStrings=null;var t=arguments[0];this.pm=t,this.li=new ji,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()}function js(){if(this.argGeom=null,this.distance=null,this.bufParams=new In,this.resultGeometry=null,this.saveException=null,arguments.length===1){var t=arguments[0];this.argGeom=t}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.argGeom=n,this.bufParams=l}}function Il(){this.comps=null;var t=arguments[0];this.comps=t}function ms(){if(this.component=null,this.segIndex=null,this.pt=null,arguments.length===2){var t=arguments[0],n=arguments[1];ms.call(this,t,ms.INSIDE_AREA,n)}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.component=l,this.segIndex=d,this.pt=v}}function oo(){this.pts=null;var t=arguments[0];this.pts=t}function Fa(){this.locations=null;var t=arguments[0];this.locations=t}function ao(){if(this.geom=null,this.terminateDistance=0,this.ptLocator=new en,this.minDistanceLocation=null,this.minDistance=j.MAX_VALUE,arguments.length===2){var t=arguments[0],n=arguments[1];ao.call(this,t,n,0)}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.geom=new Array(2).fill(null),this.geom[0]=l,this.geom[1]=d,this.terminateDistance=v}}function _u(){this.factory=null,this.directedEdges=new _t,this.coordinates=null;var t=arguments[0];this.factory=t}function vo(){this._isMarked=!1,this._isVisited=!1,this.data=null}function zr(){vo.apply(this),this.parentEdge=null,this.from=null,this.to=null,this.p0=null,this.p1=null,this.sym=null,this.edgeDirection=null,this.quadrant=null,this.angle=null;var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3];this.from=t,this.to=n,this.edgeDirection=d,this.p0=t.getCoordinate(),this.p1=l;var v=this.p1.x-this.p0.x,C=this.p1.y-this.p0.y;this.quadrant=Ci.quadrant(v,C),this.angle=Math.atan2(C,v)}function ys(){var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3];zr.call(this,t,n,l,d)}function Cr(){if(vo.apply(this),this.dirEdge=null,arguments.length!==0){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.setDirectedEdges(t,n)}}}function la(){this.outEdges=new _t,this.sorted=!1}function Js(){if(vo.apply(this),this.pt=null,this.deStar=null,arguments.length===1){var t=arguments[0];Js.call(this,t,new la)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.pt=n,this.deStar=l}}function ua(){Cr.apply(this),this.line=null;var t=arguments[0];this.line=t}function hc(){this.nodeMap=new Ri}function vu(){this.edges=new mr,this.dirEdges=new mr,this.nodeMap=new hc}function xu(){vu.apply(this)}function ec(){this.graph=new xu,this.mergedLineStrings=null,this.factory=null,this.edgeStrings=null}function os(){this.edgeRing=null,this.next=null,this.label=-1;var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3];zr.call(this,t,n,l,d)}function Pr(){Cr.apply(this),this.line=null;var t=arguments[0];this.line=t}function Mi(){this.factory=null,this.deList=new _t,this.lowestEdge=null,this.ring=null,this.ringPts=null,this.holes=null,this.shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;var t=arguments[0];this.factory=t}function ka(){}function hr(){vu.apply(this),this.factory=null;var t=arguments[0];this.factory=t}function lo(){if(this.lineStringAdder=new No(this),this.graph=null,this.dangles=new _t,this.cutEdges=new _t,this.invalidRingLines=new _t,this.holeList=null,this.shellList=null,this.polyList=null,this.isCheckingRingsValid=!0,this.extractOnlyPolygonal=null,this.geomFactory=null,arguments.length===0)lo.call(this,!1);else if(arguments.length===1){var t=arguments[0];this.extractOnlyPolygonal=t}}function No(){this.p=null;var t=arguments[0];this.p=t}function fc(){}function bu(){if(this.edgeEnds=new _t,arguments.length===1){var t=arguments[0];bu.call(this,null,t)}else if(arguments.length===2){var n=arguments[1];zs.call(this,n.getEdge(),n.getCoordinate(),n.getDirectedCoordinate(),new wr(n.getLabel())),this.insert(n)}}function Ua(){ra.apply(this)}function ul(){var t=arguments[0],n=arguments[1];ia.call(this,t,n)}function ku(){Mo.apply(this)}function Kl(){this.li=new ji,this.ptLocator=new en,this.arg=null,this.nodes=new Xl(new ku),this.im=null,this.isolatedEdges=new _t,this.invalidPoint=null;var t=arguments[0];this.arg=t}function Fs(){this.rectEnv=null;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal()}function Ml(){this.li=new ji,this.rectEnv=null,this.diagUp0=null,this.diagUp1=null,this.diagDown0=null,this.diagDown1=null;var t=arguments[0];this.rectEnv=t,this.diagUp0=new it(t.getMinX(),t.getMinY()),this.diagUp1=new it(t.getMaxX(),t.getMaxY()),this.diagDown0=new it(t.getMinX(),t.getMaxY()),this.diagDown1=new it(t.getMaxX(),t.getMinY())}function Oo(){this._isDone=!1}function Ga(){this.rectangle=null,this.rectEnv=null;var t=arguments[0];this.rectangle=t,this.rectEnv=t.getEnvelopeInternal()}function cl(){Oo.apply(this),this.rectEnv=null,this._intersects=!1;var t=arguments[0];this.rectEnv=t}function Sa(){Oo.apply(this),this.rectSeq=null,this.rectEnv=null,this._containsPoint=!1;var t=arguments[0];this.rectSeq=t.getExteriorRing().getCoordinateSequence(),this.rectEnv=t.getEnvelopeInternal()}function Uu(){Oo.apply(this),this.rectEnv=null,this.rectIntersector=null,this.hasIntersection=!1,this.p0=new it,this.p1=new it;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal(),this.rectIntersector=new Ml(this.rectEnv)}function Ei(){if(this._relate=null,arguments.length===2){var t=arguments[0],n=arguments[1];De.call(this,t,n),this._relate=new Kl(this.arg)}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];De.call(this,l,d,v),this._relate=new Kl(this.arg)}}function ns(){this.geomFactory=null,this.skipEmpty=!1,this.inputGeoms=null;var t=arguments[0];this.geomFactory=ns.extractFactory(t),this.inputGeoms=t}function Ta(){this.pointGeom=null,this.otherGeom=null,this.geomFact=null;var t=arguments[0],n=arguments[1];this.pointGeom=t,this.otherGeom=n,this.geomFact=n.getFactory()}function dn(){this.sortIndex=-1,this.comps=null;var t=arguments[0],n=arguments[1];this.sortIndex=t,this.comps=n}function zo(){this.inputPolys=null,this.geomFactory=null;var t=arguments[0];this.inputPolys=t,this.inputPolys===null&&(this.inputPolys=new _t)}function Ql(){if(this.polygons=new _t,this.lines=new _t,this.points=new _t,this.geomFact=null,arguments.length===1){if(qe(arguments[0],Ft)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof de){var n=arguments[0];this.extract(n)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];this.geomFact=d,this.extract(l)}}function wu(){this.geometryFactory=new Rn,this.geomGraph=null,this.disconnectedRingcoord=null;var t=arguments[0];this.geomGraph=t}function xo(){this.items=new _t,this.subnode=[null,null]}function Al(){if(this.min=null,this.max=null,arguments.length===0)this.min=0,this.max=0;else if(arguments.length===1){var t=arguments[0];this.init(t.min,t.max)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.init(n,l)}}function as(){this.pt=0,this.level=0,this.interval=null;var t=arguments[0];this.computeKey(t)}function ca(){xo.apply(this),this.interval=null,this.centre=null,this.level=null;var t=arguments[0],n=arguments[1];this.interval=t,this.level=n,this.centre=(t.getMin()+t.getMax())/2}function Ll(){xo.apply(this)}function hl(){this.root=null,this.minExtent=1,this.root=new Ll}function dc(){}function Rl(){this.ring=null,this.tree=null,this.crossings=0,this.interval=new Al;var t=arguments[0];this.ring=t,this.buildIndex()}function Ca(){gs.apply(this),this.mcp=null,this.p=null;var t=arguments[0],n=arguments[1];this.mcp=t,this.p=n}function pc(){this.nodes=new Xl(new ku)}function Gu(){this.li=new ji,this.geomGraph=null,this.nodeGraph=new pc,this.invalidPoint=null;var t=arguments[0];this.geomGraph=t}function gc(){this.graph=null,this.rings=new _t,this.totalEnv=new Xt,this.index=null,this.nestedPt=null;var t=arguments[0];this.graph=t}function Bi(){if(this.errorType=null,this.pt=null,arguments.length===1){var t=arguments[0];Bi.call(this,t,null)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.errorType=n,l!==null&&(this.pt=l.copy())}}function Ks(){this.parentGeometry=null,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null;var t=arguments[0];this.parentGeometry=t}function nc(){et.CoordinateOperation.apply(this),this.targetPM=null,this.removeCollapsed=!0;var t=arguments[0],n=arguments[1];this.targetPM=t,this.removeCollapsed=n}function fl(){this.targetPM=null,this.removeCollapsed=!0,this.changePrecisionModel=!1,this.isPointwise=!1;var t=arguments[0];this.targetPM=t}function ic(){this.pts=null,this.usePt=null,this.distanceTolerance=null,this.seg=new gn;var t=arguments[0];this.pts=t}function dl(){this.inputGeom=null,this.distanceTolerance=null,this.isEnsureValidTopology=!0;var t=arguments[0];this.inputGeom=t}function Eu(){br.apply(this),this.isEnsureValidTopology=!0,this.distanceTolerance=null;var t=arguments[0],n=arguments[1];this.isEnsureValidTopology=t,this.distanceTolerance=n}function Dl(){if(this.parent=null,this.index=null,arguments.length===2){var t=arguments[0],n=arguments[1];Dl.call(this,t,n,null,-1)}else if(arguments.length===4){var l=arguments[0],d=arguments[1],v=arguments[2],C=arguments[3];gn.call(this,l,d),this.parent=v,this.index=C}}function Va(){if(this.parentLine=null,this.segs=null,this.resultSegs=new _t,this.minimumSize=null,arguments.length===1){var t=arguments[0];Va.call(this,t,2)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.parentLine=n,this.minimumSize=l,this.init()}}function Vu(){this.index=new Vs}function Pc(){this.querySeg=null,this.items=new _t;var t=arguments[0];this.querySeg=t}function qa(){this.li=new ji,this.inputIndex=new Vu,this.outputIndex=new Vu,this.line=null,this.linePts=null,this.distanceTolerance=0;var t=arguments[0],n=arguments[1];this.inputIndex=t,this.outputIndex=n}function tu(){this.inputIndex=new Vu,this.outputIndex=new Vu,this.distanceTolerance=0}function Nl(){this.inputGeom=null,this.lineSimplifier=new tu,this.linestringMap=null;var t=arguments[0];this.inputGeom=t}function eu(){br.apply(this),this.linestringMap=null;var t=arguments[0];this.linestringMap=t}function m(){this.tps=null;var t=arguments[0];this.tps=t}function o(){this.seg=null,this.segLen=null,this.splitPt=null,this.minimumLen=0;var t=arguments[0];this.seg=t,this.segLen=t.getLength()}function f(){}function _(){}function w(){}function S(){if(this.p=null,arguments.length===1){var t=arguments[0];this.p=new it(t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.p=new it(n,l)}else if(arguments.length===3){var d=arguments[0],v=arguments[1],C=arguments[2];this.p=new it(d,v,C)}}function L(){this._isOnConstraint=null,this.constraint=null;var t=arguments[0];S.call(this,t)}function N(){this._rot=null,this.vertex=null,this.next=null,this.data=null}function P(){this.subdiv=null,this.isUsingTolerance=!1;var t=arguments[0];this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0}function Z(){}function Y(){this.subdiv=null,this.lastEdge=null;var t=arguments[0];this.subdiv=t,this.init()}function nt(){if(this.seg=null,arguments.length===1){if(typeof arguments[0]=="string"){var t=arguments[0];ht.call(this,t)}else if(arguments[0]instanceof gn){var n=arguments[0];ht.call(this,"Locate failed to converge (at edge: "+n+").  Possible causes include invalid Subdivision topology or very close sites"),this.seg=new gn(n)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];ht.call(this,nt.msgWithSpatial(l,d)),this.seg=new gn(d)}}function dt(){}function Et(){this.visitedKey=0,this.quadEdges=new _t,this.startingEdge=null,this.tolerance=null,this.edgeCoincidenceTolerance=null,this.frameVertex=new Array(3).fill(null),this.frameEnv=null,this.locator=null,this.seg=new gn,this.triEdges=new Array(3).fill(null);var t=arguments[0],n=arguments[1];this.tolerance=n,this.edgeCoincidenceTolerance=n/Et.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new Y(this)}function xt(){}function Mt(){this.triList=new _t}function St(){this.triList=new _t}function vt(){this.coordList=new Jt,this.triCoords=new _t}function Rt(){if(this.ls=null,this.data=null,arguments.length===2){var t=arguments[0],n=arguments[1];this.ls=new gn(t,n)}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.ls=new gn(l,d),this.data=v}else if(arguments.length===6){var C=arguments[0],z=arguments[1],W=arguments[2],gt=arguments[3],Bt=arguments[4],Se=arguments[5];Rt.call(this,new it(C,z,W),new it(gt,Bt,Se))}else if(arguments.length===7){var Ae=arguments[0],rn=arguments[1],Nn=arguments[2],ei=arguments[3],ci=arguments[4],Mr=arguments[5],_s=arguments[6];Rt.call(this,new it(Ae,rn,Nn),new it(ei,ci,Mr),_s)}}function Tt(){}function Ut(){if(this.p=null,this.data=null,this.left=null,this.right=null,this.count=null,arguments.length===2){var t=arguments[0],n=arguments[1];this.p=new it(t),this.left=null,this.right=null,this.count=1,this.data=n}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.p=new it(l,d),this.left=null,this.right=null,this.count=1,this.data=v}}function Gt(){if(this.root=null,this.numberOfNodes=null,this.tolerance=null,arguments.length===0)Gt.call(this,0);else if(arguments.length===1){var t=arguments[0];this.tolerance=t}}function Nt(){this.tolerance=null,this.matchNode=null,this.matchDist=0,this.p=null;var t=arguments[0],n=arguments[1];this.p=t,this.tolerance=n}function jt(){this.initialVertices=null,this.segVertices=null,this.segments=new _t,this.subdiv=null,this.incDel=null,this.convexHull=null,this.splitFinder=new _,this.kdt=null,this.vertexFactory=null,this.computeAreaEnv=null,this.splitPt=null,this.tolerance=null;var t=arguments[0],n=arguments[1];this.initialVertices=new _t(t),this.tolerance=n,this.kdt=new Gt(n)}function fe(){this.siteCoords=null,this.tolerance=0,this.subdiv=null}function Ee(){this.siteCoords=null,this.constraintLines=null,this.tolerance=0,this.subdiv=null,this.constraintVertexMap=new Ri}function xe(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null}function We(){}Array.prototype.fill||(Array.prototype.fill=function(t){for(var n=Object(this),l=parseInt(n.length,10),d=arguments[1],v=parseInt(d,10)||0,C=0>v?Math.max(l+v,0):Math.min(v,l),z=arguments[2],W=z===void 0?l:parseInt(z,10)||0,gt=0>W?Math.max(l+W,0):Math.min(W,l);gt>C;C++)n[C]=t;return n}),Number.isFinite=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!==t},Math.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)},T(G.prototype,{interfaces_:function(){return[]},getClass:function(){return G}}),G.equalsWithTolerance=function(t,n,l){return Math.abs(t-n)<=l},j.isNaN=function(t){return Number.isNaN(t)},j.doubleToLongBits=function(t){return t},j.longBitsToDouble=function(t){return t},j.isInfinite=function(t){return!Number.isFinite(t)},j.MAX_VALUE=Number.MAX_VALUE,st(At,ht),T(At.prototype,{interfaces_:function(){return[]},getClass:function(){return At}}),T(yt.prototype,{interfaces_:function(){return[]},getClass:function(){return yt}}),yt.shouldNeverReachHere=function(){if(arguments.length===0)yt.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new At("Should never reach here"+(t!==null?": "+t:""))}},yt.isTrue=function(){if(arguments.length===1){var t=arguments[0];yt.isTrue(t,null)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];if(!n)throw l===null?new At:new At(l)}},yt.equals=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];yt.equals(t,n,null)}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];if(!d.equals(l))throw new At("Expected "+l+" but encountered "+d+(v!==null?": "+v:""))}},T(it.prototype,{setOrdinate:function(t,n){switch(t){case it.X:this.x=n;break;case it.Y:this.y=n;break;case it.Z:this.z=n;break;default:throw new q}},equals2D:function(){if(arguments.length===1){var t=arguments[0];return this.x!==t.x?!1:this.y===t.y}if(arguments.length===2){var n=arguments[0],l=arguments[1];return G.equalsWithTolerance(this.x,n.x,l)?!!G.equalsWithTolerance(this.y,n.y,l):!1}},getOrdinate:function(t){switch(t){case it.X:return this.x;case it.Y:return this.y;case it.Z:return this.z}throw new q},equals3D:function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||j.isNaN(this.z)&&j.isNaN(t.z))},equals:function(t){return t instanceof it?this.equals2D(t):!1},equalInZ:function(t,n){return G.equalsWithTolerance(this.z,t.z,n)},compareTo:function(t){var n=t;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0},clone:function(){try{var t=null;return t}catch(n){if(n instanceof CloneNotSupportedException)return yt.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw n}finally{}},copy:function(){return new it(this)},toString:function(){return"("+this.x+", "+this.y+", "+this.z+")"},distance3D:function(t){var n=this.x-t.x,l=this.y-t.y,d=this.z-t.z;return Math.sqrt(n*n+l*l+d*d)},distance:function(t){var n=this.x-t.x,l=this.y-t.y;return Math.sqrt(n*n+l*l)},hashCode:function(){var t=17;return t=37*t+it.hashCode(this.x),t=37*t+it.hashCode(this.y)},setCoordinate:function(t){this.x=t.x,this.y=t.y,this.z=t.z},interfaces_:function(){return[J,h,tt]},getClass:function(){return it}}),it.hashCode=function(){if(arguments.length===1){var t=arguments[0],n=j.doubleToLongBits(t);return Math.trunc(n^n>>>32)}},T(ae.prototype,{compare:function(t,n){var l=t,d=n,v=ae.compare(l.x,d.x);if(v!==0)return v;var C=ae.compare(l.y,d.y);if(C!==0)return C;if(this.dimensionsToTest<=2)return 0;var z=ae.compare(l.z,d.z);return z},interfaces_:function(){return[X]},getClass:function(){return ae}}),ae.compare=function(t,n){return n>t?-1:t>n?1:j.isNaN(t)?j.isNaN(n)?0:-1:j.isNaN(n)?1:0},it.DimensionalComparator=ae,it.serialVersionUID=6683108902428367e3,it.NULL_ORDINATE=j.NaN,it.X=0,it.Y=1,it.Z=2,le.prototype.hasNext=function(){},le.prototype.next=function(){},le.prototype.remove=function(){},Ft.prototype.add=function(){},Ft.prototype.addAll=function(){},Ft.prototype.isEmpty=function(){},Ft.prototype.iterator=function(){},Ft.prototype.size=function(){},Ft.prototype.toArray=function(){},Ft.prototype.remove=function(){},lt.prototype=new Error,lt.prototype.name="IndexOutOfBoundsException",pt.prototype=Object.create(Ft.prototype),pt.prototype.constructor=pt,pt.prototype.get=function(){},pt.prototype.set=function(){},pt.prototype.isEmpty=function(){},It.prototype=new Error,It.prototype.name="NoSuchElementException",Dt.prototype=new Error,Dt.prototype.name="OperationNotSupported",_t.prototype=Object.create(pt.prototype),_t.prototype.constructor=_t,_t.prototype.ensureCapacity=function(){},_t.prototype.interfaces_=function(){return[pt,Ft]},_t.prototype.add=function(t){return this.array_.push(t),!0},_t.prototype.clear=function(){this.array_=[]},_t.prototype.addAll=function(t){for(var n=t.iterator();n.hasNext();)this.add(n.next());return!0},_t.prototype.set=function(t,n){var l=this.array_[t];return this.array_[t]=n,l},_t.prototype.iterator=function(){return new ce(this)},_t.prototype.get=function(t){if(0>t||t>=this.size())throw new lt;return this.array_[t]},_t.prototype.isEmpty=function(){return this.array_.length===0},_t.prototype.size=function(){return this.array_.length},_t.prototype.toArray=function(){for(var t=[],n=0,l=this.array_.length;l>n;n++)t.push(this.array_[n]);return t},_t.prototype.remove=function(t){for(var n=!1,l=0,d=this.array_.length;d>l;l++)if(this.array_[l]===t){this.array_.splice(l,1),n=!0;break}return n};var ce=function(t){this.arrayList_=t,this.position_=0};ce.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new It;return this.arrayList_.get(this.position_++)},ce.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},ce.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},ce.prototype.remove=function(){throw new Dt},st(Jt,_t),T(Jt.prototype,{getCoordinate:function(t){return this.get(t)},addAll:function(){if(arguments.length===2){for(var t=arguments[0],n=arguments[1],l=!1,d=t.iterator();d.hasNext();)this.add(d.next(),n),l=!0;return l}return _t.prototype.addAll.apply(this,arguments)},clone:function(){for(var n=_t.prototype.clone.call(this),l=0;l<this.size();l++)n.add(l,this.get(l).copy());return n},toCoordinateArray:function(){return this.toArray(Jt.coordArrayType)},add:function(){if(arguments.length===1){var t=arguments[0];_t.prototype.add.call(this,t)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var n=arguments[0],l=arguments[1];return this.add(n,l,!0),!0}if(arguments[0]instanceof it&&typeof arguments[1]=="boolean"){var d=arguments[0],v=arguments[1];if(!v&&this.size()>=1){var C=this.get(this.size()-1);if(C.equals2D(d))return null}_t.prototype.add.call(this,d)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var z=arguments[0],W=arguments[1];return this.add(z,W),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var gt=arguments[0],Bt=arguments[1],Se=arguments[2];if(Se)for(var Ae=0;Ae<gt.length;Ae++)this.add(gt[Ae],Bt);else for(var Ae=gt.length-1;Ae>=0;Ae--)this.add(gt[Ae],Bt);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof it){var rn=arguments[0],Nn=arguments[1],ei=arguments[2];if(!ei){var ci=this.size();if(ci>0){if(rn>0){var Mr=this.get(rn-1);if(Mr.equals2D(Nn))return null}if(ci>rn){var _s=this.get(rn);if(_s.equals2D(Nn))return null}}}_t.prototype.add.call(this,rn,Nn)}}else if(arguments.length===4){var ha=arguments[0],mc=arguments[1],nu=arguments[2],yc=arguments[3],Wc=1;nu>yc&&(Wc=-1);for(var Ae=nu;Ae!==yc;Ae+=Wc)this.add(ha[Ae],mc);return!0}},closeRing:function(){this.size()>0&&this.add(new it(this.get(0)),!1)},interfaces_:function(){return[]},getClass:function(){return Jt}}),Jt.coordArrayType=new Array(0).fill(null),T(Xt.prototype,{getArea:function(){return this.getWidth()*this.getHeight()},equals:function(t){if(!(t instanceof Xt))return!1;var n=t;return this.isNull()?n.isNull():this.maxx===n.getMaxX()&&this.maxy===n.getMaxY()&&this.minx===n.getMinX()&&this.miny===n.getMinY()},intersection:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Xt;var n=this.minx>t.minx?this.minx:t.minx,l=this.miny>t.miny?this.miny:t.miny,d=this.maxx<t.maxx?this.maxx:t.maxx,v=this.maxy<t.maxy?this.maxy:t.maxy;return new Xt(n,d,l,v)},isNull:function(){return this.maxx<this.minx},getMaxX:function(){return this.maxx},covers:function(){if(arguments.length===1){if(arguments[0]instanceof it){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Xt){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this.minx&&n.getMaxX()<=this.maxx&&n.getMinY()>=this.miny&&n.getMaxY()<=this.maxy}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];return this.isNull()?!1:l>=this.minx&&l<=this.maxx&&d>=this.miny&&d<=this.maxy}},intersects:function(){if(arguments.length===1){if(arguments[0]instanceof Xt){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny)}if(arguments[0]instanceof it){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];return this.isNull()?!1:!(l>this.maxx||l<this.minx||d>this.maxy||d<this.miny)}},getMinY:function(){return this.miny},getMinX:function(){return this.minx},expandToInclude:function(){if(arguments.length===1){if(arguments[0]instanceof it){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Xt){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this.minx=n.getMinX(),this.maxx=n.getMaxX(),this.miny=n.getMinY(),this.maxy=n.getMaxY()):(n.minx<this.minx&&(this.minx=n.minx),n.maxx>this.maxx&&(this.maxx=n.maxx),n.miny<this.miny&&(this.miny=n.miny),n.maxy>this.maxy&&(this.maxy=n.maxy))}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];this.isNull()?(this.minx=l,this.maxx=l,this.miny=d,this.maxy=d):(l<this.minx&&(this.minx=l),l>this.maxx&&(this.maxx=l),d<this.miny&&(this.miny=d),d>this.maxy&&(this.maxy=d))}},minExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return n>t?t:n},getWidth:function(){return this.isNull()?0:this.maxx-this.minx},compareTo:function(t){var n=t;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this.minx<n.minx?-1:this.minx>n.minx?1:this.miny<n.miny?-1:this.miny>n.miny?1:this.maxx<n.maxx?-1:this.maxx>n.maxx?1:this.maxy<n.maxy?-1:this.maxy>n.maxy?1:0},translate:function(t,n){return this.isNull()?null:void this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+n,this.getMaxY()+n)},toString:function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},setToNull:function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},getHeight:function(){return this.isNull()?0:this.maxy-this.miny},maxExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t>n?t:n},expandBy:function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];if(this.isNull())return null;this.minx-=n,this.maxx+=n,this.miny-=l,this.maxy+=l,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull()}},contains:function(){if(arguments.length===1){if(arguments[0]instanceof Xt){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof it){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];return this.covers(l,d)}},centre:function(){return this.isNull()?null:new it((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},init:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof it){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Xt){var n=arguments[0];this.minx=n.minx,this.maxx=n.maxx,this.miny=n.miny,this.maxy=n.maxy}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];this.init(l.x,d.x,l.y,d.y)}else if(arguments.length===4){var v=arguments[0],C=arguments[1],z=arguments[2],W=arguments[3];C>v?(this.minx=v,this.maxx=C):(this.minx=C,this.maxx=v),W>z?(this.miny=z,this.maxy=W):(this.miny=W,this.maxy=z)}},getMaxY:function(){return this.maxy},distance:function(t){if(this.intersects(t))return 0;var n=0;this.maxx<t.minx?n=t.minx-this.maxx:this.minx>t.maxx&&(n=this.minx-t.maxx);var l=0;return this.maxy<t.miny?l=t.miny-this.maxy:this.miny>t.maxy&&(l=this.miny-t.maxy),n===0?l:l===0?n:Math.sqrt(n*n+l*l)},hashCode:function(){var t=17;return t=37*t+it.hashCode(this.minx),t=37*t+it.hashCode(this.maxx),t=37*t+it.hashCode(this.miny),t=37*t+it.hashCode(this.maxy)},interfaces_:function(){return[J,tt]},getClass:function(){return Xt}}),Xt.intersects=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],l=arguments[2];return l.x>=(t.x<n.x?t.x:n.x)&&l.x<=(t.x>n.x?t.x:n.x)&&l.y>=(t.y<n.y?t.y:n.y)&&l.y<=(t.y>n.y?t.y:n.y)}if(arguments.length===4){var d=arguments[0],v=arguments[1],C=arguments[2],z=arguments[3],W=Math.min(C.x,z.x),gt=Math.max(C.x,z.x),Bt=Math.min(d.x,v.x),Se=Math.max(d.x,v.x);return Bt>gt||W>Se?!1:(W=Math.min(C.y,z.y),gt=Math.max(C.y,z.y),Bt=Math.min(d.y,v.y),Se=Math.max(d.y,v.y),Bt>gt?!1:!(W>Se))}},Xt.serialVersionUID=5873921885273102e3,st(Yt,ie),T(Yt.prototype,{interfaces_:function(){return[]},getClass:function(){return Yt}}),T(rt.prototype,{interfaces_:function(){return[]},getClass:function(){return rt}}),rt.toLocationSymbol=function(t){switch(t){case rt.EXTERIOR:return"e";case rt.BOUNDARY:return"b";case rt.INTERIOR:return"i";case rt.NONE:return"-"}throw new q},rt.INTERIOR=0,rt.BOUNDARY=1,rt.EXTERIOR=2,rt.NONE=-1,T(Sn.prototype,{interfaces_:function(){return[]},getClass:function(){return Sn}}),Sn.log10=function(t){var n=Math.log(t);return j.isInfinite(n)||j.isNaN(n)?n:n/Sn.LOG_10},Sn.min=function(t,n,l,d){var v=t;return v>n&&(v=n),v>l&&(v=l),v>d&&(v=d),v},Sn.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1],l=arguments[2];return n>t?n:t>l?l:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var d=arguments[0],v=arguments[1],C=arguments[2];return v>d?v:d>C?C:d}},Sn.wrap=function(t,n){return 0>t?n- -t%n:t%n},Sn.max=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],l=arguments[2],d=t;return n>d&&(d=n),l>d&&(d=l),d}if(arguments.length===4){var v=arguments[0],C=arguments[1],z=arguments[2],W=arguments[3],d=v;return C>d&&(d=C),z>d&&(d=z),W>d&&(d=W),d}},Sn.average=function(t,n){return(t+n)/2},Sn.LOG_10=Math.log(10),Xn.prototype.append=function(t){this.str+=t},Xn.prototype.setCharAt=function(t,n){return this.str.substr(0,t)+n+this.str.substr(t+1)},Xn.prototype.toString=function(t){return this.str},ct.prototype.intValue=function(){return this.value},ct.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},ct.isNaN=function(t){return Number.isNaN(t)},kt.isWhitespace=function(t){return 32>=t&&t>=0||t==127},kt.toUpperCase=function(t){return t.toUpperCase()},T(ut.prototype,{le:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<=t.lo},extractSignificantDigits:function(t,n){var l=this.abs(),d=ut.magnitude(l.hi),v=ut.TEN.pow(d);l=l.divide(v),l.gt(ut.TEN)?(l=l.divide(ut.TEN),d+=1):l.lt(ut.ONE)&&(l=l.multiply(ut.TEN),d-=1);for(var C=d+1,z=new Xn,W=ut.MAX_PRINT_DIGITS-1,gt=0;W>=gt;gt++){t&&gt===C&&z.append(".");var Bt=Math.trunc(l.hi);if(0>Bt)break;var Se=!1,Ae=0;Bt>9?(Se=!0,Ae="9"):Ae="0"+Bt,z.append(Ae),l=l.subtract(ut.valueOf(Bt)).multiply(ut.TEN),Se&&l.selfAdd(ut.TEN);var rn=!0,Nn=ut.magnitude(l.hi);if(0>Nn&&Math.abs(Nn)>=W-gt&&(rn=!1),!rn)break}return n[0]=d,z.toString()},sqr:function(){return this.multiply(this)},doubleValue:function(){return this.hi+this.lo},subtract:function(){if(arguments[0]instanceof ut){var t=arguments[0];return this.add(t.negate())}if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}},equals:function(){if(arguments.length===1){var t=arguments[0];return this.hi===t.hi&&this.lo===t.lo}},isZero:function(){return this.hi===0&&this.lo===0},selfSubtract:function(){if(arguments[0]instanceof ut){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t.hi,-t.lo)}if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}},getSpecialNumberString:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},min:function(t){return this.le(t)?this:t},selfDivide:function(){if(arguments.length===1){if(arguments[0]instanceof ut){var t=arguments[0];return this.selfDivide(t.hi,t.lo)}if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1],v=null,C=null,z=null,W=null,gt=null,Bt=null,Se=null,Ae=null;return gt=this.hi/l,Bt=ut.SPLIT*gt,v=Bt-gt,Ae=ut.SPLIT*l,v=Bt-v,C=gt-v,z=Ae-l,Se=gt*l,z=Ae-z,W=l-z,Ae=v*z-Se+v*W+C*z+C*W,Bt=(this.hi-Se-Ae+this.lo-gt*d)/l,Ae=gt+Bt,this.hi=Ae,this.lo=gt-Ae+Bt,this}},dump:function(){return"DD<"+this.hi+", "+this.lo+">"},divide:function(){if(arguments[0]instanceof ut){var t=arguments[0],n=null,l=null,d=null,v=null,C=null,z=null,W=null,gt=null;C=this.hi/t.hi,z=ut.SPLIT*C,n=z-C,gt=ut.SPLIT*t.hi,n=z-n,l=C-n,d=gt-t.hi,W=C*t.hi,d=gt-d,v=t.hi-d,gt=n*d-W+n*v+l*d+l*v,z=(this.hi-W-gt+this.lo-C*t.lo)/t.hi,gt=C+z;var Bt=gt,Se=C-gt+z;return new ut(Bt,Se)}if(typeof arguments[0]=="number"){var Ae=arguments[0];return j.isNaN(Ae)?ut.createNaN():ut.copy(this).selfDivide(Ae,0)}},ge:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>=t.lo},pow:function(t){if(t===0)return ut.valueOf(1);var n=new ut(this),l=ut.valueOf(1),d=Math.abs(t);if(d>1)for(;d>0;)d%2===1&&l.selfMultiply(n),d/=2,d>0&&(n=n.sqr());else l=n;return 0>t?l.reciprocal():l},ceil:function(){if(this.isNaN())return ut.NaN;var t=Math.ceil(this.hi),n=0;return t===this.hi&&(n=Math.ceil(this.lo)),new ut(t,n)},compareTo:function(t){var n=t;return this.hi<n.hi?-1:this.hi>n.hi?1:this.lo<n.lo?-1:this.lo>n.lo?1:0},rint:function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()},setValue:function(){if(arguments[0]instanceof ut){var t=arguments[0];return this.init(t),this}if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}},max:function(t){return this.ge(t)?this:t},sqrt:function(){if(this.isZero())return ut.valueOf(0);if(this.isNegative())return ut.NaN;var t=1/Math.sqrt(this.hi),n=this.hi*t,l=ut.valueOf(n),d=this.subtract(l.sqr()),v=d.hi*(.5*t);return l.add(v)},selfAdd:function(){if(arguments.length===1){if(arguments[0]instanceof ut){var t=arguments[0];return this.selfAdd(t.hi,t.lo)}if(typeof arguments[0]=="number"){var n=arguments[0],l=null,d=null,v=null,C=null,z=null,W=null;return v=this.hi+n,z=v-this.hi,C=v-z,C=n-z+(this.hi-C),W=C+this.lo,l=v+W,d=W+(v-l),this.hi=l+d,this.lo=d+(l-this.hi),this}}else if(arguments.length===2){var gt=arguments[0],Bt=arguments[1],l=null,d=null,Se=null,Ae=null,v=null,C=null,z=null,W=null;v=this.hi+gt,Se=this.lo+Bt,z=v-this.hi,W=Se-this.lo,C=v-z,Ae=Se-W,C=gt-z+(this.hi-C),Ae=Bt-W+(this.lo-Ae),z=C+Se,l=v+z,d=z+(v-l),z=Ae+d;var rn=l+z,Nn=z+(l-rn);return this.hi=rn,this.lo=Nn,this}},selfMultiply:function(){if(arguments.length===1){if(arguments[0]instanceof ut){var t=arguments[0];return this.selfMultiply(t.hi,t.lo)}if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1],v=null,C=null,z=null,W=null,gt=null,Bt=null;gt=ut.SPLIT*this.hi,v=gt-this.hi,Bt=ut.SPLIT*l,v=gt-v,C=this.hi-v,z=Bt-l,gt=this.hi*l,z=Bt-z,W=l-z,Bt=v*z-gt+v*W+C*z+C*W+(this.hi*d+this.lo*l);var Se=gt+Bt;v=gt-Se;var Ae=Bt+v;return this.hi=Se,this.lo=Ae,this}},selfSqr:function(){return this.selfMultiply(this)},floor:function(){if(this.isNaN())return ut.NaN;var t=Math.floor(this.hi),n=0;return t===this.hi&&(n=Math.floor(this.lo)),new ut(t,n)},negate:function(){return this.isNaN()?this:new ut(-this.hi,-this.lo)},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}finally{}},multiply:function(){if(arguments[0]instanceof ut){var t=arguments[0];return t.isNaN()?ut.createNaN():ut.copy(this).selfMultiply(t)}if(typeof arguments[0]=="number"){var n=arguments[0];return j.isNaN(n)?ut.createNaN():ut.copy(this).selfMultiply(n,0)}},isNaN:function(){return j.isNaN(this.hi)},intValue:function(){return Math.trunc(this.hi)},toString:function(){var t=ut.magnitude(this.hi);return t>=-3&&20>=t?this.toStandardNotation():this.toSciNotation()},toStandardNotation:function(){var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),l=this.extractSignificantDigits(!0,n),d=n[0]+1,v=l;if(l.charAt(0)===".")v="0"+l;else if(0>d)v="0."+ut.stringOfChar("0",-d)+l;else if(l.indexOf(".")===-1){var C=d-l.length,z=ut.stringOfChar("0",C);v=l+z+".0"}return this.isNegative()?"-"+v:v},reciprocal:function(){var t=null,n=null,l=null,d=null,v=null,C=null,z=null,W=null;v=1/this.hi,C=ut.SPLIT*v,t=C-v,W=ut.SPLIT*this.hi,t=C-t,n=v-t,l=W-this.hi,z=v*this.hi,l=W-l,d=this.hi-l,W=t*l-z+t*d+n*l+n*d,C=(1-z-W-v*this.lo)/this.hi;var gt=v+C,Bt=v-gt+C;return new ut(gt,Bt)},toSciNotation:function(){if(this.isZero())return ut.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),l=this.extractSignificantDigits(!1,n),d=ut.SCI_NOT_EXPONENT_CHAR+n[0];if(l.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+l);var v="";l.length>1&&(v=l.substring(1));var C=l.charAt(0)+"."+v;return this.isNegative()?"-"+C+d:C+d},abs:function(){return this.isNaN()?ut.NaN:this.isNegative()?this.negate():new ut(this)},isPositive:function(){return this.hi>0||this.hi===0&&this.lo>0},lt:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<t.lo},add:function(){if(arguments[0]instanceof ut){var t=arguments[0];return ut.copy(this).selfAdd(t)}if(typeof arguments[0]=="number"){var n=arguments[0];return ut.copy(this).selfAdd(n)}},init:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.hi=t,this.lo=0}else if(arguments[0]instanceof ut){var n=arguments[0];this.hi=n.hi,this.lo=n.lo}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];this.hi=l,this.lo=d}},gt:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>t.lo},isNegative:function(){return this.hi<0||this.hi===0&&this.lo<0},trunc:function(){return this.isNaN()?ut.NaN:this.isPositive()?this.floor():this.ceil()},signum:function(){return this.hi>0?1:this.hi<0?-1:this.lo>0?1:this.lo<0?-1:0},interfaces_:function(){return[tt,J,h]},getClass:function(){return ut}}),ut.sqr=function(t){return ut.valueOf(t).selfMultiply(t)},ut.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return ut.parse(t)}if(typeof arguments[0]=="number"){var n=arguments[0];return new ut(n)}},ut.sqrt=function(t){return ut.valueOf(t).sqrt()},ut.parse=function(t){for(var n=0,l=t.length;kt.isWhitespace(t.charAt(n));)n++;var d=!1;if(l>n){var v=t.charAt(n);v!=="-"&&v!=="+"||(n++,v==="-"&&(d=!0))}for(var C=new ut,z=0,W=0,gt=0;!(n>=l);){var Bt=t.charAt(n);if(n++,kt.isDigit(Bt)){var Se=Bt-"0";C.selfMultiply(ut.TEN),C.selfAdd(Se),z++}else{if(Bt!=="."){if(Bt==="e"||Bt==="E"){var Ae=t.substring(n);try{gt=ct.parseInt(Ae)}catch(ci){throw ci instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+Ae+" in string "+t):ci}finally{}break}throw new NumberFormatException("Unexpected character '"+Bt+"' at position "+n+" in string "+t)}W=z}}var rn=C,Nn=z-W-gt;if(Nn===0)rn=C;else if(Nn>0){var ei=ut.TEN.pow(Nn);rn=C.divide(ei)}else if(0>Nn){var ei=ut.TEN.pow(-Nn);rn=C.multiply(ei)}return d?rn.negate():rn},ut.createNaN=function(){return new ut(j.NaN,j.NaN)},ut.copy=function(t){return new ut(t)},ut.magnitude=function(t){var n=Math.abs(t),l=Math.log(n)/Math.log(10),d=Math.trunc(Math.floor(l)),v=Math.pow(10,d);return n>=10*v&&(d+=1),d},ut.stringOfChar=function(t,n){for(var l=new Xn,d=0;n>d;d++)l.append(t);return l.toString()},ut.PI=new ut(3.141592653589793,12246467991473532e-32),ut.TWO_PI=new ut(6.283185307179586,24492935982947064e-32),ut.PI_2=new ut(1.5707963267948966,6123233995736766e-32),ut.E=new ut(2.718281828459045,14456468917292502e-32),ut.NaN=new ut(j.NaN,j.NaN),ut.EPS=123259516440783e-46,ut.SPLIT=134217729,ut.MAX_PRINT_DIGITS=32,ut.TEN=ut.valueOf(10),ut.ONE=ut.valueOf(1),ut.SCI_NOT_EXPONENT_CHAR="E",ut.SCI_NOT_ZERO="0.0E0",T(ye.prototype,{interfaces_:function(){return[]},getClass:function(){return ye}}),ye.orientationIndex=function(t,n,l){var d=ye.orientationIndexFilter(t,n,l);if(1>=d)return d;var v=ut.valueOf(n.x).selfAdd(-t.x),C=ut.valueOf(n.y).selfAdd(-t.y),z=ut.valueOf(l.x).selfAdd(-n.x),W=ut.valueOf(l.y).selfAdd(-n.y);return v.selfMultiply(W).selfSubtract(C.selfMultiply(z)).signum()},ye.signOfDet2x2=function(t,n,l,d){var v=t.multiply(d).selfSubtract(n.multiply(l));return v.signum()},ye.intersection=function(t,n,l,d){var v=ut.valueOf(d.y).selfSubtract(l.y).selfMultiply(ut.valueOf(n.x).selfSubtract(t.x)),C=ut.valueOf(d.x).selfSubtract(l.x).selfMultiply(ut.valueOf(n.y).selfSubtract(t.y)),z=v.subtract(C),W=ut.valueOf(d.x).selfSubtract(l.x).selfMultiply(ut.valueOf(t.y).selfSubtract(l.y)),gt=ut.valueOf(d.y).selfSubtract(l.y).selfMultiply(ut.valueOf(t.x).selfSubtract(l.x)),Bt=W.subtract(gt),Se=Bt.selfDivide(z).doubleValue(),Ae=ut.valueOf(t.x).selfAdd(ut.valueOf(n.x).selfSubtract(t.x).selfMultiply(Se)).doubleValue(),rn=ut.valueOf(n.x).selfSubtract(t.x).selfMultiply(ut.valueOf(t.y).selfSubtract(l.y)),Nn=ut.valueOf(n.y).selfSubtract(t.y).selfMultiply(ut.valueOf(t.x).selfSubtract(l.x)),ei=rn.subtract(Nn),ci=ei.selfDivide(z).doubleValue(),Mr=ut.valueOf(l.y).selfAdd(ut.valueOf(d.y).selfSubtract(l.y).selfMultiply(ci)).doubleValue();return new it(Ae,Mr)},ye.orientationIndexFilter=function(t,n,l){var d=null,v=(t.x-l.x)*(n.y-l.y),C=(t.y-l.y)*(n.x-l.x),z=v-C;if(v>0){if(0>=C)return ye.signum(z);d=v+C}else{if(!(0>v)||C>=0)return ye.signum(z);d=-v-C}var W=ye.DP_SAFE_EPSILON*d;return z>=W||-z>=W?ye.signum(z):2},ye.signum=function(t){return t>0?1:0>t?-1:0},ye.DP_SAFE_EPSILON=1e-15,T(te.prototype,{setOrdinate:function(t,n,l){},size:function(){},getOrdinate:function(t,n){},getCoordinate:function(){},getCoordinateCopy:function(t){},getDimension:function(){},getX:function(t){},clone:function(){},expandEnvelope:function(t){},copy:function(){},getY:function(t){},toCoordinateArray:function(){},interfaces_:function(){return[h]},getClass:function(){return te}}),te.X=0,te.Y=1,te.Z=2,te.M=3,mt.arraycopy=function(t,n,l,d,v){for(var C=0,z=n;n+v>z;z++)l[d+C]=t[z],C++},mt.getProperty=function(t){return{"line.separator":`
`}[t]},T(Zt.prototype,{getY:function(){var t=this.y/this.w;if(j.isNaN(t)||j.isInfinite(t))throw new Yt;return t},getX:function(){var t=this.x/this.w;if(j.isNaN(t)||j.isInfinite(t))throw new Yt;return t},getCoordinate:function(){var t=new it;return t.x=this.getX(),t.y=this.getY(),t},interfaces_:function(){return[]},getClass:function(){return Zt}}),Zt.intersection=function(t,n,l,d){var v=t.y-n.y,C=n.x-t.x,z=t.x*n.y-n.x*t.y,W=l.y-d.y,gt=d.x-l.x,Bt=l.x*d.y-d.x*l.y,Se=C*Bt-gt*z,Ae=W*z-v*Bt,rn=v*gt-W*C,Nn=Se/rn,ei=Ae/rn;if(j.isNaN(Nn)||j.isInfinite(Nn)||j.isNaN(ei)||j.isInfinite(ei))throw new Yt;return new it(Nn,ei)},T(ve.prototype,{create:function(){arguments.length===1&&(arguments[0]instanceof Array||qe(arguments[0],te))},interfaces_:function(){return[]},getClass:function(){return ve}}),T(Be.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return Be}}),T(de.prototype,{isGeometryCollection:function(){return this.getSortIndex()===de.SORTINDEX_GEOMETRYCOLLECTION},getFactory:function(){return this.factory},getGeometryN:function(t){return this},getArea:function(){return 0},isRectangle:function(){return!1},equals:function(){if(arguments.length===1){if(arguments[0]instanceof de){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof de))return!1;var l=n;return this.equalsExact(l)}}},equalsExact:function(t){return this===t||this.equalsExact(t,0)},geometryChanged:function(){this.apply(de.geometryChangedFilter)},geometryChangedAction:function(){this.envelope=null},equalsNorm:function(t){return t===null?!1:this.norm().equalsExact(t.norm())},getLength:function(){return 0},getNumGeometries:function(){return 1},compareTo:function(){if(arguments.length===1){var t=arguments[0],n=t;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(t)}if(arguments.length===2){var l=arguments[0],d=arguments[1],n=l;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(l,d)}},getUserData:function(){return this.userData},getSRID:function(){return this.SRID},getEnvelope:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},checkNotGeometryCollection:function(t){if(t.getSortIndex()===de.SORTINDEX_GEOMETRYCOLLECTION)throw new q},equal:function(t,n,l){return l===0?t.equals(n):t.distance(n)<=l},norm:function(){var t=this.copy();return t.normalize(),t},getPrecisionModel:function(){return this.factory.getPrecisionModel()},getEnvelopeInternal:function(){return this.envelope===null&&(this.envelope=this.computeEnvelopeInternal()),new Xt(this.envelope)},setSRID:function(t){this.SRID=t},setUserData:function(t){this.userData=t},compare:function(t,n){for(var l=t.iterator(),d=n.iterator();l.hasNext()&&d.hasNext();){var v=l.next(),C=d.next(),z=v.compareTo(C);if(z!==0)return z}return l.hasNext()?1:d.hasNext()?-1:0},hashCode:function(){return this.getEnvelopeInternal().hashCode()},isGeometryCollectionOrDerived:function(){return this.getSortIndex()===de.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===de.SORTINDEX_MULTIPOINT||this.getSortIndex()===de.SORTINDEX_MULTILINESTRING||this.getSortIndex()===de.SORTINDEX_MULTIPOLYGON},interfaces_:function(){return[h,J,tt]},getClass:function(){return de}}),de.hasNonEmptyElements=function(t){for(var n=0;n<t.length;n++)if(!t[n].isEmpty())return!0;return!1},de.hasNullElements=function(t){for(var n=0;n<t.length;n++)if(t[n]===null)return!0;return!1},de.serialVersionUID=8763622679187377e3,de.SORTINDEX_POINT=0,de.SORTINDEX_MULTIPOINT=1,de.SORTINDEX_LINESTRING=2,de.SORTINDEX_LINEARRING=3,de.SORTINDEX_MULTILINESTRING=4,de.SORTINDEX_POLYGON=5,de.SORTINDEX_MULTIPOLYGON=6,de.SORTINDEX_GEOMETRYCOLLECTION=7,de.geometryChangedFilter={interfaces_:function(){return[Be]},filter:function(t){t.geometryChangedAction()}},T(On.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return On}}),T(An.prototype,{isInBoundary:function(t){},interfaces_:function(){return[]},getClass:function(){return An}}),T($n.prototype,{isInBoundary:function(t){return t%2===1},interfaces_:function(){return[An]},getClass:function(){return $n}}),T(yi.prototype,{isInBoundary:function(t){return t>0},interfaces_:function(){return[An]},getClass:function(){return yi}}),T(Gi.prototype,{isInBoundary:function(t){return t>1},interfaces_:function(){return[An]},getClass:function(){return Gi}}),T(jr.prototype,{isInBoundary:function(t){return t===1},interfaces_:function(){return[An]},getClass:function(){return jr}}),An.Mod2BoundaryNodeRule=$n,An.EndPointBoundaryNodeRule=yi,An.MultiValentEndPointBoundaryNodeRule=Gi,An.MonoValentEndPointBoundaryNodeRule=jr,An.MOD2_BOUNDARY_RULE=new $n,An.ENDPOINT_BOUNDARY_RULE=new yi,An.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new Gi,An.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new jr,An.OGC_SFS_BOUNDARY_RULE=An.MOD2_BOUNDARY_RULE,T(Bn.prototype,{interfaces_:function(){return[]},getClass:function(){return Bn}}),Bn.isRing=function(t){return t.length<4?!1:!!t[0].equals2D(t[t.length-1])},Bn.ptNotInList=function(t,n){for(var l=0;l<t.length;l++){var d=t[l];if(Bn.indexOf(d,n)<0)return d}return null},Bn.scroll=function(t,n){var l=Bn.indexOf(n,t);if(0>l)return null;var d=new Array(t.length).fill(null);mt.arraycopy(t,l,d,0,t.length-l),mt.arraycopy(t,0,d,t.length-l,l),mt.arraycopy(d,0,t,0,t.length)},Bn.equals=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(t===n)return!0;if(t===null||n===null||t.length!==n.length)return!1;for(var l=0;l<t.length;l++)if(!t[l].equals(n[l]))return!1;return!0}if(arguments.length===3){var d=arguments[0],v=arguments[1],C=arguments[2];if(d===v)return!0;if(d===null||v===null||d.length!==v.length)return!1;for(var l=0;l<d.length;l++)if(C.compare(d[l],v[l])!==0)return!1;return!0}},Bn.intersection=function(t,n){for(var l=new Jt,d=0;d<t.length;d++)n.intersects(t[d])&&l.add(t[d],!0);return l.toCoordinateArray()},Bn.hasRepeatedPoints=function(t){for(var n=1;n<t.length;n++)if(t[n-1].equals(t[n]))return!0;return!1},Bn.removeRepeatedPoints=function(t){if(!Bn.hasRepeatedPoints(t))return t;var n=new Jt(t,!1);return n.toCoordinateArray()},Bn.reverse=function(t){for(var n=t.length-1,l=Math.trunc(n/2),d=0;l>=d;d++){var v=t[d];t[d]=t[n-d],t[n-d]=v}},Bn.removeNull=function(t){for(var n=0,l=0;l<t.length;l++)t[l]!==null&&n++;var d=new Array(n).fill(null);if(n===0)return d;for(var v=0,l=0;l<t.length;l++)t[l]!==null&&(d[v++]=t[l]);return d},Bn.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],n=new Array(t.length).fill(null),l=0;l<t.length;l++)n[l]=new it(t[l]);return n}if(arguments.length===5)for(var d=arguments[0],v=arguments[1],C=arguments[2],z=arguments[3],W=arguments[4],l=0;W>l;l++)C[z+l]=new it(d[v+l])},Bn.isEqualReversed=function(t,n){for(var l=0;l<t.length;l++){var d=t[l],v=n[t.length-l-1];if(d.compareTo(v)!==0)return!1}return!0},Bn.envelope=function(t){for(var n=new Xt,l=0;l<t.length;l++)n.expandToInclude(t[l]);return n},Bn.toCoordinateArray=function(t){return t.toArray(Bn.coordArrayType)},Bn.atLeastNCoordinatesOrNothing=function(t,n){return n.length>=t?n:[]},Bn.indexOf=function(t,n){for(var l=0;l<n.length;l++)if(t.equals(n[l]))return l;return-1},Bn.increasingDirection=function(t){for(var n=0;n<Math.trunc(t.length/2);n++){var l=t.length-1-n,d=t[n].compareTo(t[l]);if(d!==0)return d}return 1},Bn.compare=function(t,n){for(var l=0;l<t.length&&l<n.length;){var d=t[l].compareTo(n[l]);if(d!==0)return d;l++}return l<n.length?-1:l<t.length?1:0},Bn.minCoordinate=function(t){for(var n=null,l=0;l<t.length;l++)(n===null||n.compareTo(t[l])>0)&&(n=t[l]);return n},Bn.extract=function(t,n,l){n=Sn.clamp(n,0,t.length),l=Sn.clamp(l,-1,t.length);var d=l-n+1;0>l&&(d=0),n>=t.length&&(d=0),n>l&&(d=0);var v=new Array(d).fill(null);if(d===0)return v;for(var C=0,z=n;l>=z;z++)v[C++]=t[z];return v},T(lr.prototype,{compare:function(t,n){var l=t,d=n;return Bn.compare(l,d)},interfaces_:function(){return[X]},getClass:function(){return lr}}),T(Fr.prototype,{compare:function(t,n){var l=t,d=n;if(l.length<d.length)return-1;if(l.length>d.length)return 1;if(l.length===0)return 0;var v=Bn.compare(l,d),C=Bn.isEqualReversed(l,d);return C?0:v},OLDcompare:function(t,n){var l=t,d=n;if(l.length<d.length)return-1;if(l.length>d.length)return 1;if(l.length===0)return 0;for(var v=Bn.increasingDirection(l),C=Bn.increasingDirection(d),z=v>0?0:l.length-1,W=C>0?0:l.length-1,gt=0;gt<l.length;gt++){var Bt=l[z].compareTo(d[W]);if(Bt!==0)return Bt;z+=v,W+=C}return 0},interfaces_:function(){return[X]},getClass:function(){return Fr}}),Bn.ForwardComparator=lr,Bn.BidirectionalComparator=Fr,Bn.coordArrayType=new Array(0).fill(null),Mn.prototype.get=function(){},Mn.prototype.put=function(){},Mn.prototype.size=function(){},Mn.prototype.values=function(){},Mn.prototype.entrySet=function(){},ui.prototype=new Mn,Vl.prototype=new Ft,Vl.prototype.contains=function(){},mr.prototype=new Vl,mr.prototype.contains=function(t){for(var n=0,l=this.array_.length;l>n;n++){var d=this.array_[n];if(d===t)return!0}return!1},mr.prototype.add=function(t){return this.contains(t)?!1:(this.array_.push(t),!0)},mr.prototype.addAll=function(t){for(var n=t.iterator();n.hasNext();)this.add(n.next());return!0},mr.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},mr.prototype.size=function(){return this.array_.length},mr.prototype.isEmpty=function(){return this.array_.length===0},mr.prototype.toArray=function(){for(var t=[],n=0,l=this.array_.length;l>n;n++)t.push(this.array_[n]);return t},mr.prototype.iterator=function(){return new Ve(this)};var Ve=function(t){this.hashSet_=t,this.position_=0};Ve.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new It;return this.hashSet_.array_[this.position_++]},Ve.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},Ve.prototype.remove=function(){throw new Dt};var Pe=0,ge=1;Ri.prototype=new ui,Ri.prototype.get=function(t){for(var n=this.root_;n!==null;){var l=t.compareTo(n.key);if(0>l)n=n.left;else{if(!(l>0))return n.value;n=n.right}}return null},Ri.prototype.put=function(t,n){if(this.root_===null)return this.root_={key:t,value:n,left:null,right:null,parent:null,color:Pe,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var l,d,v=this.root_;do if(l=v,d=t.compareTo(v.key),0>d)v=v.left;else{if(!(d>0)){var C=v.value;return v.value=n,C}v=v.right}while(v!==null);var z={key:t,left:null,right:null,value:n,parent:l,color:Pe,getValue:function(){return this.value},getKey:function(){return this.key}};return 0>d?l.left=z:l.right=z,this.fixAfterInsertion(z),this.size_++,null},Ri.prototype.fixAfterInsertion=function(t){for(t.color=ge;t!=null&&t!=this.root_&&t.parent.color==ge;)if(vi(t)==Wa(vi(vi(t)))){var n=eo(vi(vi(t)));_l(n)==ge?(Us(vi(t),Pe),Us(n,Pe),Us(vi(vi(t)),ge),t=vi(vi(t))):(t==eo(vi(t))&&(t=vi(t),this.rotateLeft(t)),Us(vi(t),Pe),Us(vi(vi(t)),ge),this.rotateRight(vi(vi(t))))}else{var n=Wa(vi(vi(t)));_l(n)==ge?(Us(vi(t),Pe),Us(n,Pe),Us(vi(vi(t)),ge),t=vi(vi(t))):(t==Wa(vi(t))&&(t=vi(t),this.rotateRight(t)),Us(vi(t),Pe),Us(vi(vi(t)),ge),this.rotateLeft(vi(vi(t))))}this.root_.color=Pe},Ri.prototype.values=function(){var t=new _t,n=this.getFirstEntry();if(n!==null)for(t.add(n.value);(n=Ri.successor(n))!==null;)t.add(n.value);return t},Ri.prototype.entrySet=function(){var t=new mr,n=this.getFirstEntry();if(n!==null)for(t.add(n);(n=Ri.successor(n))!==null;)t.add(n);return t},Ri.prototype.rotateLeft=function(t){if(t!=null){var n=t.right;t.right=n.left,n.left!=null&&(n.left.parent=t),n.parent=t.parent,t.parent==null?this.root_=n:t.parent.left==t?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n}},Ri.prototype.rotateRight=function(t){if(t!=null){var n=t.left;t.left=n.right,n.right!=null&&(n.right.parent=t),n.parent=t.parent,t.parent==null?this.root_=n:t.parent.right==t?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n}},Ri.prototype.getFirstEntry=function(){var t=this.root_;if(t!=null)for(;t.left!=null;)t=t.left;return t},Ri.successor=function(t){if(t===null)return null;if(t.right!==null){for(var n=t.right;n.left!==null;)n=n.left;return n}for(var n=t.parent,l=t;n!==null&&l===n.right;)l=n,n=n.parent;return n},Ri.prototype.size=function(){return this.size_},T($a.prototype,{interfaces_:function(){return[]},getClass:function(){return $a}}),ql.prototype=new Vl,Qr.prototype=new ql,Qr.prototype.contains=function(t){for(var n=0,l=this.array_.length;l>n;n++){var d=this.array_[n];if(d.compareTo(t)===0)return!0}return!1},Qr.prototype.add=function(t){if(this.contains(t))return!1;for(var n=0,l=this.array_.length;l>n;n++){var d=this.array_[n];if(d.compareTo(t)===1)return this.array_.splice(n,0,t),!0}return this.array_.push(t),!0},Qr.prototype.addAll=function(t){for(var n=t.iterator();n.hasNext();)this.add(n.next());return!0},Qr.prototype.remove=function(t){throw new Dt},Qr.prototype.size=function(){return this.array_.length},Qr.prototype.isEmpty=function(){return this.array_.length===0},Qr.prototype.toArray=function(){for(var t=[],n=0,l=this.array_.length;l>n;n++)t.push(this.array_[n]);return t},Qr.prototype.iterator=function(){return new Qt(this)};var Qt=function(t){this.treeSet_=t,this.position_=0};Qt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new It;return this.treeSet_.array_[this.position_++]},Qt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Qt.prototype.remove=function(){throw new Dt},hs.sort=function(){var t,n,l,d,v=arguments[0];if(arguments.length===1)return d=function(z,W){return z.compareTo(W)},void v.sort(d);if(arguments.length===2)l=arguments[1],d=function(z,W){return l.compare(z,W)},v.sort(d);else{if(arguments.length===3){n=v.slice(arguments[1],arguments[2]),n.sort();var C=v.slice(0,arguments[1]).concat(n,v.slice(arguments[2],v.length));for(v.splice(0,v.length),t=0;t<C.length;t++)v.push(C[t]);return}if(arguments.length===4){for(n=v.slice(arguments[1],arguments[2]),l=arguments[3],d=function(z,W){return l.compare(z,W)},n.sort(d),C=v.slice(0,arguments[1]).concat(n,v.slice(arguments[2],v.length)),v.splice(0,v.length),t=0;t<C.length;t++)v.push(C[t]);return}}},hs.asList=function(t){for(var n=new _t,l=0,d=t.length;d>l;l++)n.add(t[l]);return n},T($e.prototype,{interfaces_:function(){return[]},getClass:function(){return $e}}),$e.toDimensionSymbol=function(t){switch(t){case $e.FALSE:return $e.SYM_FALSE;case $e.TRUE:return $e.SYM_TRUE;case $e.DONTCARE:return $e.SYM_DONTCARE;case $e.P:return $e.SYM_P;case $e.L:return $e.SYM_L;case $e.A:return $e.SYM_A}throw new q},$e.toDimensionValue=function(t){switch(kt.toUpperCase(t)){case $e.SYM_FALSE:return $e.FALSE;case $e.SYM_TRUE:return $e.TRUE;case $e.SYM_DONTCARE:return $e.DONTCARE;case $e.SYM_P:return $e.P;case $e.SYM_L:return $e.L;case $e.SYM_A:return $e.A}throw new q},$e.P=0,$e.L=1,$e.A=2,$e.FALSE=-1,$e.TRUE=-2,$e.DONTCARE=-3,$e.SYM_FALSE="F",$e.SYM_TRUE="T",$e.SYM_DONTCARE="*",$e.SYM_P="0",$e.SYM_L="1",$e.SYM_A="2",T(yr.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return yr}}),T(Xr.prototype,{filter:function(t,n){},isDone:function(){},isGeometryChanged:function(){},interfaces_:function(){return[]},getClass:function(){return Xr}}),st(ri,de),T(ri.prototype,{computeEnvelopeInternal:function(){for(var t=new Xt,n=0;n<this.geometries.length;n++)t.expandToInclude(this.geometries[n].getEnvelopeInternal());return t},getGeometryN:function(t){return this.geometries[t]},getSortIndex:function(){return de.SORTINDEX_GEOMETRYCOLLECTION},getCoordinates:function(){for(var t=new Array(this.getNumPoints()).fill(null),n=-1,l=0;l<this.geometries.length;l++)for(var d=this.geometries[l].getCoordinates(),v=0;v<d.length;v++)n++,t[n]=d[v];return t},getArea:function(){for(var t=0,n=0;n<this.geometries.length;n++)t+=this.geometries[n].getArea();return t},equalsExact:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var l=t;if(this.geometries.length!==l.geometries.length)return!1;for(var d=0;d<this.geometries.length;d++)if(!this.geometries[d].equalsExact(l.geometries[d],n))return!1;return!0}return de.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<this.geometries.length;t++)this.geometries[t].normalize();hs.sort(this.geometries)},getCoordinate:function(){return this.isEmpty()?null:this.geometries[0].getCoordinate()},getBoundaryDimension:function(){for(var t=$e.FALSE,n=0;n<this.geometries.length;n++)t=Math.max(t,this.geometries[n].getBoundaryDimension());return t},getDimension:function(){for(var t=$e.FALSE,n=0;n<this.geometries.length;n++)t=Math.max(t,this.geometries[n].getDimension());return t},getLength:function(){for(var t=0,n=0;n<this.geometries.length;n++)t+=this.geometries[n].getLength();return t},getNumPoints:function(){for(var t=0,n=0;n<this.geometries.length;n++)t+=this.geometries[n].getNumPoints();return t},getNumGeometries:function(){return this.geometries.length},reverse:function(){for(var t=this.geometries.length,n=new Array(t).fill(null),l=0;l<this.geometries.length;l++)n[l]=this.geometries[l].reverse();return this.getFactory().createGeometryCollection(n)},compareToSameClass:function(){if(arguments.length===1){var t=arguments[0],n=new Qr(hs.asList(this.geometries)),l=new Qr(hs.asList(t.geometries));return this.compare(n,l)}if(arguments.length===2){for(var d=arguments[0],v=arguments[1],C=d,z=this.getNumGeometries(),W=C.getNumGeometries(),gt=0;z>gt&&W>gt;){var Bt=this.getGeometryN(gt),Se=C.getGeometryN(gt),Ae=Bt.compareToSameClass(Se,v);if(Ae!==0)return Ae;gt++}return z>gt?1:W>gt?-1:0}},apply:function(){if(qe(arguments[0],On))for(var t=arguments[0],n=0;n<this.geometries.length;n++)this.geometries[n].apply(t);else if(qe(arguments[0],Xr)){var l=arguments[0];if(this.geometries.length===0)return null;for(var n=0;n<this.geometries.length&&(this.geometries[n].apply(l),!l.isDone());n++);l.isGeometryChanged()&&this.geometryChanged()}else if(qe(arguments[0],yr)){var d=arguments[0];d.filter(this);for(var n=0;n<this.geometries.length;n++)this.geometries[n].apply(d)}else if(qe(arguments[0],Be)){var v=arguments[0];v.filter(this);for(var n=0;n<this.geometries.length;n++)this.geometries[n].apply(v)}},getBoundary:function(){return this.checkNotGeometryCollection(this),yt.shouldNeverReachHere(),null},clone:function(){var t=de.prototype.clone.call(this);t.geometries=new Array(this.geometries.length).fill(null);for(var n=0;n<this.geometries.length;n++)t.geometries[n]=this.geometries[n].clone();return t},getGeometryType:function(){return"GeometryCollection"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this.geometries[n].copy();return new ri(t,this.factory)},isEmpty:function(){for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isEmpty())return!1;return!0},interfaces_:function(){return[]},getClass:function(){return ri}}),ri.serialVersionUID=-5694727726395021e3,st(Ki,ri),T(Ki.prototype,{getSortIndex:function(){return de.SORTINDEX_MULTILINESTRING},equalsExact:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.isEquivalentClass(t)?ri.prototype.equalsExact.call(this,t,n):!1}return ri.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return this.isClosed()?$e.FALSE:0},isClosed:function(){if(this.isEmpty())return!1;for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isClosed())return!1;return!0},getDimension:function(){return 1},reverse:function(){for(var t=this.geometries.length,n=new Array(t).fill(null),l=0;l<this.geometries.length;l++)n[t-1-l]=this.geometries[l].reverse();return this.getFactory().createMultiLineString(n)},getBoundary:function(){return new Tr(this).getBoundary()},getGeometryType:function(){return"MultiLineString"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this.geometries[n].copy();return new Ki(t,this.factory)},interfaces_:function(){return[$a]},getClass:function(){return Ki}}),Ki.serialVersionUID=8166665132445434e3,T(Tr.prototype,{boundaryMultiLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(t);return n.length===1?this.geomFact.createPoint(n[0]):this.geomFact.createMultiPointFromCoords(n)},getBoundary:function(){return this.geom instanceof oi?this.boundaryLineString(this.geom):this.geom instanceof Ki?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},boundaryLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var n=this.bnRule.isInBoundary(2);return n?t.getStartPoint():this.geomFact.createMultiPoint()}return this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},getEmptyMultiPoint:function(){return this.geomFact.createMultiPoint()},computeBoundaryCoordinates:function(t){var n=new _t;this.endpointMap=new Ri;for(var l=0;l<t.getNumGeometries();l++){var d=t.getGeometryN(l);d.getNumPoints()!==0&&(this.addEndpoint(d.getCoordinateN(0)),this.addEndpoint(d.getCoordinateN(d.getNumPoints()-1)))}for(var v=this.endpointMap.entrySet().iterator();v.hasNext();){var C=v.next(),z=C.getValue(),W=z.count;this.bnRule.isInBoundary(W)&&n.add(C.getKey())}return Bn.toCoordinateArray(n)},addEndpoint:function(t){var n=this.endpointMap.get(t);n===null&&(n=new Rs,this.endpointMap.put(t,n)),n.count++},interfaces_:function(){return[]},getClass:function(){return Tr}}),Tr.getBoundary=function(){if(arguments.length===1){var t=arguments[0],n=new Tr(t);return n.getBoundary()}if(arguments.length===2){var l=arguments[0],d=arguments[1],n=new Tr(l,d);return n.getBoundary()}},T(Rs.prototype,{interfaces_:function(){return[]},getClass:function(){return Rs}}),T(Dr.prototype,{interfaces_:function(){return[]},getClass:function(){return Dr}}),Dr.chars=function(t,n){for(var l=new Array(n).fill(null),d=0;n>d;d++)l[d]=t;return new String(l)},Dr.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],n=new jl,l=new _r;return t.printStackTrace(l),n.toString()}if(arguments.length===2){for(var d=arguments[0],v=arguments[1],C="",z=new Di(Dr.getStackTrace(d)),W=new ya,gt=0;v>gt;gt++)try{C+=W.readLine()+Dr.NEWLINE}catch(Bt){if(!(Bt instanceof vl))throw Bt;yt.shouldNeverReachHere()}finally{}return C}},Dr.split=function(t,n){for(var l=n.length,d=new _t,v=""+t,C=v.indexOf(n);C>=0;){var z=v.substring(0,C);d.add(z),v=v.substring(C+l),C=v.indexOf(n)}v.length>0&&d.add(v);for(var W=new Array(d.size()).fill(null),gt=0;gt<W.length;gt++)W[gt]=d.get(gt);return W},Dr.toString=function(){if(arguments.length===1){var t=arguments[0];return Dr.SIMPLE_ORDINATE_FORMAT.format(t)}},Dr.spaces=function(t){return Dr.chars(" ",t)},Dr.NEWLINE=mt.getProperty("line.separator"),Dr.SIMPLE_ORDINATE_FORMAT=new fu,T(Kn.prototype,{interfaces_:function(){return[]},getClass:function(){return Kn}}),Kn.copyCoord=function(t,n,l,d){for(var v=Math.min(t.getDimension(),l.getDimension()),C=0;v>C;C++)l.setOrdinate(d,C,t.getOrdinate(n,C))},Kn.isRing=function(t){var n=t.size();return n===0?!0:3>=n?!1:t.getOrdinate(0,te.X)===t.getOrdinate(n-1,te.X)&&t.getOrdinate(0,te.Y)===t.getOrdinate(n-1,te.Y)},Kn.isEqual=function(t,n){var l=t.size(),d=n.size();if(l!==d)return!1;for(var v=Math.min(t.getDimension(),n.getDimension()),C=0;l>C;C++)for(var z=0;v>z;z++){var W=t.getOrdinate(C,z),gt=n.getOrdinate(C,z);if(!(t.getOrdinate(C,z)===n.getOrdinate(C,z)||j.isNaN(W)&&j.isNaN(gt)))return!1}return!0},Kn.extend=function(t,n,l){var d=t.create(l,n.getDimension()),v=n.size();if(Kn.copy(n,0,d,0,v),v>0)for(var C=v;l>C;C++)Kn.copy(n,v-1,d,C,1);return d},Kn.reverse=function(t){for(var n=t.size()-1,l=Math.trunc(n/2),d=0;l>=d;d++)Kn.swap(t,d,n-d)},Kn.swap=function(t,n,l){if(n===l)return null;for(var d=0;d<t.getDimension();d++){var v=t.getOrdinate(n,d);t.setOrdinate(n,d,t.getOrdinate(l,d)),t.setOrdinate(l,d,v)}},Kn.copy=function(t,n,l,d,v){for(var C=0;v>C;C++)Kn.copyCoord(t,n+C,l,d+C)},Kn.toString=function(){if(arguments.length===1){var t=arguments[0],n=t.size();if(n===0)return"()";var l=t.getDimension(),d=new Xn;d.append("(");for(var v=0;n>v;v++){v>0&&d.append(" ");for(var C=0;l>C;C++)C>0&&d.append(","),d.append(Dr.toString(t.getOrdinate(v,C)))}return d.append(")"),d.toString()}},Kn.ensureValidRing=function(t,n){var l=n.size();if(l===0)return n;if(3>=l)return Kn.createClosedRing(t,n,4);var d=n.getOrdinate(0,te.X)===n.getOrdinate(l-1,te.X)&&n.getOrdinate(0,te.Y)===n.getOrdinate(l-1,te.Y);return d?n:Kn.createClosedRing(t,n,l+1)},Kn.createClosedRing=function(t,n,l){var d=t.create(l,n.getDimension()),v=n.size();Kn.copy(n,0,d,0,v);for(var C=v;l>C;C++)Kn.copy(n,0,d,C,1);return d},st(oi,de),T(oi.prototype,{computeEnvelopeInternal:function(){return this.isEmpty()?new Xt:this.points.expandEnvelope(new Xt)},isRing:function(){return this.isClosed()&&this.isSimple()},getSortIndex:function(){return de.SORTINDEX_LINESTRING},getCoordinates:function(){return this.points.toCoordinateArray()},equalsExact:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var l=t;if(this.points.size()!==l.points.size())return!1;for(var d=0;d<this.points.size();d++)if(!this.equal(this.points.getCoordinate(d),l.points.getCoordinate(d),n))return!1;return!0}return de.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<Math.trunc(this.points.size()/2);t++){var n=this.points.size()-1-t;if(!this.points.getCoordinate(t).equals(this.points.getCoordinate(n)))return this.points.getCoordinate(t).compareTo(this.points.getCoordinate(n))>0&&Kn.reverse(this.points),null}},getCoordinate:function(){return this.isEmpty()?null:this.points.getCoordinate(0)},getBoundaryDimension:function(){return this.isClosed()?$e.FALSE:0},isClosed:function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},getEndPoint:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},getDimension:function(){return 1},getLength:function(){return re.computeLength(this.points)},getNumPoints:function(){return this.points.size()},reverse:function(){var t=this.points.copy();Kn.reverse(t);var n=this.getFactory().createLineString(t);return n},compareToSameClass:function(){if(arguments.length===1){for(var t=arguments[0],n=t,l=0,d=0;l<this.points.size()&&d<n.points.size();){var v=this.points.getCoordinate(l).compareTo(n.points.getCoordinate(d));if(v!==0)return v;l++,d++}return l<this.points.size()?1:d<n.points.size()?-1:0}if(arguments.length===2){var C=arguments[0],z=arguments[1],n=C;return z.compare(this.points,n.points)}},apply:function(){if(qe(arguments[0],On))for(var t=arguments[0],n=0;n<this.points.size();n++)t.filter(this.points.getCoordinate(n));else if(qe(arguments[0],Xr)){var l=arguments[0];if(this.points.size()===0)return null;for(var n=0;n<this.points.size()&&(l.filter(this.points,n),!l.isDone());n++);l.isGeometryChanged()&&this.geometryChanged()}else if(qe(arguments[0],yr)){var d=arguments[0];d.filter(this)}else if(qe(arguments[0],Be)){var v=arguments[0];v.filter(this)}},getBoundary:function(){return new Tr(this).getBoundary()},isEquivalentClass:function(t){return t instanceof oi},clone:function(){var t=de.prototype.clone.call(this);return t.points=this.points.clone(),t},getCoordinateN:function(t){return this.points.getCoordinate(t)},getGeometryType:function(){return"LineString"},copy:function(){return new oi(this.points.copy(),this.factory)},getCoordinateSequence:function(){return this.points},isEmpty:function(){return this.points.size()===0},init:function(t){if(t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),t.size()===1)throw new q("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this.points=t},isCoordinate:function(t){for(var n=0;n<this.points.size();n++)if(this.points.getCoordinate(n).equals(t))return!0;return!1},getStartPoint:function(){return this.isEmpty()?null:this.getPointN(0)},getPointN:function(t){return this.getFactory().createPoint(this.points.getCoordinate(t))},interfaces_:function(){return[$a]},getClass:function(){return oi}}),oi.serialVersionUID=0x2b2b51ba435c8e00,T(Ds.prototype,{interfaces_:function(){return[]},getClass:function(){return Ds}}),st(rr,de),T(rr.prototype,{computeEnvelopeInternal:function(){if(this.isEmpty())return new Xt;var t=new Xt;return t.expandToInclude(this.coordinates.getX(0),this.coordinates.getY(0)),t},getSortIndex:function(){return de.SORTINDEX_POINT},getCoordinates:function(){return this.isEmpty()?[]:[this.getCoordinate()]},equalsExact:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.isEquivalentClass(t)?this.isEmpty()&&t.isEmpty()?!0:this.isEmpty()!==t.isEmpty()?!1:this.equal(t.getCoordinate(),this.getCoordinate(),n):!1}return de.prototype.equalsExact.apply(this,arguments)},normalize:function(){},getCoordinate:function(){return this.coordinates.size()!==0?this.coordinates.getCoordinate(0):null},getBoundaryDimension:function(){return $e.FALSE},getDimension:function(){return 0},getNumPoints:function(){return this.isEmpty()?0:1},reverse:function(){return this.copy()},getX:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x},compareToSameClass:function(){if(arguments.length===1){var t=arguments[0],n=t;return this.getCoordinate().compareTo(n.getCoordinate())}if(arguments.length===2){var l=arguments[0],d=arguments[1],n=l;return d.compare(this.coordinates,n.coordinates)}},apply:function(){if(qe(arguments[0],On)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(qe(arguments[0],Xr)){var n=arguments[0];if(this.isEmpty())return null;n.filter(this.coordinates,0),n.isGeometryChanged()&&this.geometryChanged()}else if(qe(arguments[0],yr)){var l=arguments[0];l.filter(this)}else if(qe(arguments[0],Be)){var d=arguments[0];d.filter(this)}},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},clone:function(){var t=de.prototype.clone.call(this);return t.coordinates=this.coordinates.clone(),t},getGeometryType:function(){return"Point"},copy:function(){return new rr(this.coordinates.copy(),this.factory)},getCoordinateSequence:function(){return this.coordinates},getY:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y},isEmpty:function(){return this.coordinates.size()===0},init:function(t){t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),yt.isTrue(t.size()<=1),this.coordinates=t},isSimple:function(){return!0},interfaces_:function(){return[Ds]},getClass:function(){return rr}}),rr.serialVersionUID=4902022702746615e3,T(ts.prototype,{interfaces_:function(){return[]},getClass:function(){return ts}}),st(Pi,de),T(Pi.prototype,{computeEnvelopeInternal:function(){return this.shell.getEnvelopeInternal()},getSortIndex:function(){return de.SORTINDEX_POLYGON},getCoordinates:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),n=-1,l=this.shell.getCoordinates(),d=0;d<l.length;d++)n++,t[n]=l[d];for(var v=0;v<this.holes.length;v++)for(var C=this.holes[v].getCoordinates(),z=0;z<C.length;z++)n++,t[n]=C[z];return t},getArea:function(){var t=0;t+=Math.abs(re.signedArea(this.shell.getCoordinateSequence()));for(var n=0;n<this.holes.length;n++)t-=Math.abs(re.signedArea(this.holes[n].getCoordinateSequence()));return t},isRectangle:function(){if(this.getNumInteriorRing()!==0||this.shell===null||this.shell.getNumPoints()!==5)return!1;for(var t=this.shell.getCoordinateSequence(),n=this.getEnvelopeInternal(),l=0;5>l;l++){var d=t.getX(l);if(d!==n.getMinX()&&d!==n.getMaxX())return!1;var v=t.getY(l);if(v!==n.getMinY()&&v!==n.getMaxY())return!1}for(var C=t.getX(0),z=t.getY(0),l=1;4>=l;l++){var d=t.getX(l),v=t.getY(l),W=d!==C,gt=v!==z;if(W===gt)return!1;C=d,z=v}return!0},equalsExact:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var l=t,d=this.shell,v=l.shell;if(!d.equalsExact(v,n)||this.holes.length!==l.holes.length)return!1;for(var C=0;C<this.holes.length;C++)if(!this.holes[C].equalsExact(l.holes[C],n))return!1;return!0}return de.prototype.equalsExact.apply(this,arguments)},normalize:function(){if(arguments.length===0){this.normalize(this.shell,!0);for(var t=0;t<this.holes.length;t++)this.normalize(this.holes[t],!1);hs.sort(this.holes)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];if(n.isEmpty())return null;var d=new Array(n.getCoordinates().length-1).fill(null);mt.arraycopy(n.getCoordinates(),0,d,0,d.length);var v=Bn.minCoordinate(n.getCoordinates());Bn.scroll(d,v),mt.arraycopy(d,0,n.getCoordinates(),0,d.length),n.getCoordinates()[d.length]=d[0],re.isCCW(n.getCoordinates())===l&&Bn.reverse(n.getCoordinates())}},getCoordinate:function(){return this.shell.getCoordinate()},getNumInteriorRing:function(){return this.holes.length},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},getLength:function(){var t=0;t+=this.shell.getLength();for(var n=0;n<this.holes.length;n++)t+=this.holes[n].getLength();return t},getNumPoints:function(){for(var t=this.shell.getNumPoints(),n=0;n<this.holes.length;n++)t+=this.holes[n].getNumPoints();return t},reverse:function(){var t=this.copy();t.shell=this.shell.copy().reverse(),t.holes=new Array(this.holes.length).fill(null);for(var n=0;n<this.holes.length;n++)t.holes[n]=this.holes[n].copy().reverse();return t},convexHull:function(){return this.getExteriorRing().convexHull()},compareToSameClass:function(){if(arguments.length===1){var t=arguments[0],n=this.shell,l=t.shell;return n.compareToSameClass(l)}if(arguments.length===2){var d=arguments[0],v=arguments[1],C=d,n=this.shell,l=C.shell,z=n.compareToSameClass(l,v);if(z!==0)return z;for(var W=this.getNumInteriorRing(),gt=C.getNumInteriorRing(),Bt=0;W>Bt&&gt>Bt;){var Se=this.getInteriorRingN(Bt),Ae=C.getInteriorRingN(Bt),rn=Se.compareToSameClass(Ae,v);if(rn!==0)return rn;Bt++}return W>Bt?1:gt>Bt?-1:0}},apply:function(){if(qe(arguments[0],On)){var t=arguments[0];this.shell.apply(t);for(var n=0;n<this.holes.length;n++)this.holes[n].apply(t)}else if(qe(arguments[0],Xr)){var l=arguments[0];if(this.shell.apply(l),!l.isDone())for(var n=0;n<this.holes.length&&(this.holes[n].apply(l),!l.isDone());n++);l.isGeometryChanged()&&this.geometryChanged()}else if(qe(arguments[0],yr)){var d=arguments[0];d.filter(this)}else if(qe(arguments[0],Be)){var v=arguments[0];v.filter(this),this.shell.apply(v);for(var n=0;n<this.holes.length;n++)this.holes[n].apply(v)}},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this.holes.length+1).fill(null);t[0]=this.shell;for(var n=0;n<this.holes.length;n++)t[n+1]=this.holes[n];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},clone:function(){var t=de.prototype.clone.call(this);t.shell=this.shell.clone(),t.holes=new Array(this.holes.length).fill(null);for(var n=0;n<this.holes.length;n++)t.holes[n]=this.holes[n].clone();return t},getGeometryType:function(){return"Polygon"},copy:function(){for(var t=this.shell.copy(),n=new Array(this.holes.length).fill(null),l=0;l<n.length;l++)n[l]=this.holes[l].copy();return new Pi(t,n,this.factory)},getExteriorRing:function(){return this.shell},isEmpty:function(){return this.shell.isEmpty()},getInteriorRingN:function(t){return this.holes[t]},interfaces_:function(){return[ts]},getClass:function(){return Pi}}),Pi.serialVersionUID=-0x307ffefd8dc97200,st(Zr,ri),T(Zr.prototype,{getSortIndex:function(){return de.SORTINDEX_MULTIPOINT},isValid:function(){return!0},equalsExact:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.isEquivalentClass(t)?ri.prototype.equalsExact.call(this,t,n):!1}return ri.prototype.equalsExact.apply(this,arguments)},getCoordinate:function(){if(arguments.length===1){var t=arguments[0];return this.geometries[t].getCoordinate()}return ri.prototype.getCoordinate.apply(this,arguments)},getBoundaryDimension:function(){return $e.FALSE},getDimension:function(){return 0},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},getGeometryType:function(){return"MultiPoint"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this.geometries[n].copy();return new Zr(t,this.factory)},interfaces_:function(){return[Ds]},getClass:function(){return Zr}}),Zr.serialVersionUID=-8048474874175356e3,st(Yi,oi),T(Yi.prototype,{getSortIndex:function(){return de.SORTINDEX_LINEARRING},getBoundaryDimension:function(){return $e.FALSE},isClosed:function(){return this.isEmpty()?!0:oi.prototype.isClosed.call(this)},reverse:function(){var t=this.points.copy();Kn.reverse(t);var n=this.getFactory().createLinearRing(t);return n},validateConstruction:function(){if(!this.isEmpty()&&!oi.prototype.isClosed.call(this))throw new q;if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Yi.MINIMUM_VALID_SIZE)throw new q("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},getGeometryType:function(){return"LinearRing"},copy:function(){return new Yi(this.points.copy(),this.factory)},interfaces_:function(){return[]},getClass:function(){return Yi}}),Yi.MINIMUM_VALID_SIZE=4,Yi.serialVersionUID=-0x3b229e262367a600,st(Ct,ri),T(Ct.prototype,{getSortIndex:function(){return de.SORTINDEX_MULTIPOLYGON},equalsExact:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.isEquivalentClass(t)?ri.prototype.equalsExact.call(this,t,n):!1}return ri.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},reverse:function(){for(var t=this.geometries.length,n=new Array(t).fill(null),l=0;l<this.geometries.length;l++)n[l]=this.geometries[l].reverse();return this.getFactory().createMultiPolygon(n)},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new _t,n=0;n<this.geometries.length;n++)for(var l=this.geometries[n],d=l.getBoundary(),v=0;v<d.getNumGeometries();v++)t.add(d.getGeometryN(v));var C=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(C))},getGeometryType:function(){return"MultiPolygon"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this.geometries[n].copy();return new Ct(t,this.factory)},interfaces_:function(){return[ts]},getClass:function(){return Ct}}),Ct.serialVersionUID=-0x7a5aa1369171980,T(et.prototype,{setCopyUserData:function(t){this.isUserDataCopied=t},edit:function(t,n){if(t===null)return null;var l=this.editInternal(t,n);return this.isUserDataCopied&&l.setUserData(t.getUserData()),l},editInternal:function(t,n){return this.factory===null&&(this.factory=t.getFactory()),t instanceof ri?this.editGeometryCollection(t,n):t instanceof Pi?this.editPolygon(t,n):t instanceof rr?n.edit(t,this.factory):t instanceof oi?n.edit(t,this.factory):(yt.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},editGeometryCollection:function(t,n){for(var l=n.edit(t,this.factory),d=new _t,v=0;v<l.getNumGeometries();v++){var C=this.edit(l.getGeometryN(v),n);C===null||C.isEmpty()||d.add(C)}return l.getClass()===Zr?this.factory.createMultiPoint(d.toArray([])):l.getClass()===Ki?this.factory.createMultiLineString(d.toArray([])):l.getClass()===Ct?this.factory.createMultiPolygon(d.toArray([])):this.factory.createGeometryCollection(d.toArray([]))},editPolygon:function(t,n){var l=n.edit(t,this.factory);if(l===null&&(l=this.factory.createPolygon(null)),l.isEmpty())return l;var d=this.edit(l.getExteriorRing(),n);if(d===null||d.isEmpty())return this.factory.createPolygon();for(var v=new _t,C=0;C<l.getNumInteriorRing();C++){var z=this.edit(l.getInteriorRingN(C),n);z===null||z.isEmpty()||v.add(z)}return this.factory.createPolygon(d,v.toArray([]))},interfaces_:function(){return[]},getClass:function(){return et}}),et.GeometryEditorOperation=ot,T(Lt.prototype,{edit:function(t,n){return t},interfaces_:function(){return[ot]},getClass:function(){return Lt}}),T(Pt.prototype,{edit:function(t,n){if(t instanceof Yi)return n.createLinearRing(this.editCoordinates(t.getCoordinates(),t));if(t instanceof oi)return n.createLineString(this.editCoordinates(t.getCoordinates(),t));if(t instanceof rr){var l=this.editCoordinates(t.getCoordinates(),t);return l.length>0?n.createPoint(l[0]):n.createPoint()}return t},interfaces_:function(){return[ot]},getClass:function(){return Pt}}),T(Kt.prototype,{edit:function(t,n){return t instanceof Yi?n.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof oi?n.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof rr?n.createPoint(this.edit(t.getCoordinateSequence(),t)):t},interfaces_:function(){return[ot]},getClass:function(){return Kt}}),et.NoOpGeometryOperation=Lt,et.CoordinateOperation=Pt,et.CoordinateSequenceOperation=Kt,T(ue.prototype,{setOrdinate:function(t,n,l){switch(n){case te.X:this.coordinates[t].x=l;break;case te.Y:this.coordinates[t].y=l;break;case te.Z:this.coordinates[t].z=l;break;default:throw new q}},size:function(){return this.coordinates.length},getOrdinate:function(t,n){switch(n){case te.X:return this.coordinates[t].x;case te.Y:return this.coordinates[t].y;case te.Z:return this.coordinates[t].z}return j.NaN},getCoordinate:function(){if(arguments.length===1){var t=arguments[0];return this.coordinates[t]}if(arguments.length===2){var n=arguments[0],l=arguments[1];l.x=this.coordinates[n].x,l.y=this.coordinates[n].y,l.z=this.coordinates[n].z}},getCoordinateCopy:function(t){return new it(this.coordinates[t])},getDimension:function(){return this.dimension},getX:function(t){return this.coordinates[t].x},clone:function(){for(var t=new Array(this.size()).fill(null),n=0;n<this.coordinates.length;n++)t[n]=this.coordinates[n].clone();return new ue(t,this.dimension)},expandEnvelope:function(t){for(var n=0;n<this.coordinates.length;n++)t.expandToInclude(this.coordinates[n]);return t},copy:function(){for(var t=new Array(this.size()).fill(null),n=0;n<this.coordinates.length;n++)t[n]=this.coordinates[n].copy();return new ue(t,this.dimension)},toString:function(){if(this.coordinates.length>0){var t=new Xn(17*this.coordinates.length);t.append("("),t.append(this.coordinates[0]);for(var n=1;n<this.coordinates.length;n++)t.append(", "),t.append(this.coordinates[n]);return t.append(")"),t.toString()}return"()"},getY:function(t){return this.coordinates[t].y},toCoordinateArray:function(){return this.coordinates},interfaces_:function(){return[te,tt]},getClass:function(){return ue}}),ue.serialVersionUID=-0xcb44a778db18e00,T(se.prototype,{readResolve:function(){return se.instance()},create:function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new ue(t)}if(qe(arguments[0],te)){var n=arguments[0];return new ue(n)}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];return d>3&&(d=3),2>d?new ue(l):new ue(l,d)}},interfaces_:function(){return[ve,tt]},getClass:function(){return se}}),se.instance=function(){return se.instanceObject},se.serialVersionUID=-0x38e49fa6cf6f2e00,se.instanceObject=new se;var fn,an=Object.defineProperty,Fe=me({delete:yn,has:jn,get:Je,set:Fn,keys:fi,values:ki,entries:Dn,forEach:Ra,clear:Qn}),Xe=typeof Map<"u"&&Map.prototype.values?Map:Fe;Ss.prototype=new Mn,Ss.prototype.get=function(t){return this.map_.get(t)||null},Ss.prototype.put=function(t,n){return this.map_.set(t,n),n},Ss.prototype.values=function(){for(var t=new _t,n=this.map_.values(),l=n.next();!l.done;)t.add(l.value),l=n.next();return t},Ss.prototype.entrySet=function(){var t=new mr;return this.map_.entries().forEach(function(n){return t.add(n)}),t},Ss.prototype.size=function(){return this.map_.size()},T(_e.prototype,{equals:function(t){if(!(t instanceof _e))return!1;var n=t;return this.modelType===n.modelType&&this.scale===n.scale},compareTo:function(t){var n=t,l=this.getMaximumSignificantDigits(),d=n.getMaximumSignificantDigits();return new ct(l).compareTo(new ct(d))},getScale:function(){return this.scale},isFloating:function(){return this.modelType===_e.FLOATING||this.modelType===_e.FLOATING_SINGLE},getType:function(){return this.modelType},toString:function(){var t="UNKNOWN";return this.modelType===_e.FLOATING?t="Floating":this.modelType===_e.FLOATING_SINGLE?t="Floating-Single":this.modelType===_e.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},makePrecise:function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(j.isNaN(t))return t;if(this.modelType===_e.FLOATING_SINGLE){var n=t;return n}return this.modelType===_e.FIXED?Math.round(t*this.scale)/this.scale:t}if(arguments[0]instanceof it){var l=arguments[0];if(this.modelType===_e.FLOATING)return null;l.x=this.makePrecise(l.x),l.y=this.makePrecise(l.y)}},getMaximumSignificantDigits:function(){var t=16;return this.modelType===_e.FLOATING?t=16:this.modelType===_e.FLOATING_SINGLE?t=6:this.modelType===_e.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},setScale:function(t){this.scale=Math.abs(t)},interfaces_:function(){return[tt,J]},getClass:function(){return _e}}),_e.mostPrecise=function(t,n){return t.compareTo(n)>=0?t:n},T(Hr.prototype,{readResolve:function(){return Hr.nameToTypeMap.get(this.name)},toString:function(){return this.name},interfaces_:function(){return[tt]},getClass:function(){return Hr}}),Hr.serialVersionUID=-552860263173159e4,Hr.nameToTypeMap=new Ss,_e.Type=Hr,_e.serialVersionUID=7777263578777804e3,_e.FIXED=new Hr("FIXED"),_e.FLOATING=new Hr("FLOATING"),_e.FLOATING_SINGLE=new Hr("FLOATING SINGLE"),_e.maximumPreciseValue=9007199254740992,T(Rn.prototype,{toGeometry:function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new it(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new it(t.getMinX(),t.getMinY()),new it(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new it(t.getMinX(),t.getMinY()),new it(t.getMinX(),t.getMaxY()),new it(t.getMaxX(),t.getMaxY()),new it(t.getMaxX(),t.getMinY()),new it(t.getMinX(),t.getMinY())]),null)},createLineString:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(qe(arguments[0],te)){var n=arguments[0];return new oi(n,this)}}},createMultiLineString:function(){if(arguments.length===0)return new Ki(null,this);if(arguments.length===1){var t=arguments[0];return new Ki(t,this)}},buildGeometry:function(t){for(var n=null,l=!1,d=!1,v=t.iterator();v.hasNext();){var C=v.next(),z=C.getClass();n===null&&(n=z),z!==n&&(l=!0),C.isGeometryCollectionOrDerived()&&(d=!0)}if(n===null)return this.createGeometryCollection();if(l||d)return this.createGeometryCollection(Rn.toGeometryArray(t));var W=t.iterator().next(),gt=t.size()>1;if(gt){if(W instanceof Pi)return this.createMultiPolygon(Rn.toPolygonArray(t));if(W instanceof oi)return this.createMultiLineString(Rn.toLineStringArray(t));if(W instanceof rr)return this.createMultiPoint(Rn.toPointArray(t));yt.shouldNeverReachHere("Unhandled class: "+W.getClass().getName())}return W},createMultiPointFromCoords:function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)},createPoint:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof it){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}if(qe(arguments[0],te)){var n=arguments[0];return new rr(n,this)}}},getCoordinateSequenceFactory:function(){return this.coordinateSequenceFactory},createPolygon:function(){if(arguments.length===0)return new Pi(null,null,this);if(arguments.length===1){if(qe(arguments[0],te)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}if(arguments[0]instanceof Yi){var l=arguments[0];return this.createPolygon(l,null)}}else if(arguments.length===2){var d=arguments[0],v=arguments[1];return new Pi(d,v,this)}},getSRID:function(){return this.SRID},createGeometryCollection:function(){if(arguments.length===0)return new ri(null,this);if(arguments.length===1){var t=arguments[0];return new ri(t,this)}},createGeometry:function(t){var n=new et(this);return n.edit(t,{edit:function(){if(arguments.length===2){var l=arguments[0];return this.coordinateSequenceFactory.create(l)}}})},getPrecisionModel:function(){return this.precisionModel},createLinearRing:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(qe(arguments[0],te)){var n=arguments[0];return new Yi(n,this)}}},createMultiPolygon:function(){if(arguments.length===0)return new Ct(null,this);if(arguments.length===1){var t=arguments[0];return new Ct(t,this)}},createMultiPoint:function(){if(arguments.length===0)return new Zr(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new Zr(t,this)}if(arguments[0]instanceof Array){var n=arguments[0];return this.createMultiPoint(n!==null?this.getCoordinateSequenceFactory().create(n):null)}if(qe(arguments[0],te)){var l=arguments[0];if(l===null)return this.createMultiPoint(new Array(0).fill(null));for(var d=new Array(l.size()).fill(null),v=0;v<l.size();v++){var C=this.getCoordinateSequenceFactory().create(1,l.getDimension());Kn.copy(l,v,C,0,1),d[v]=this.createPoint(C)}return this.createMultiPoint(d)}}},interfaces_:function(){return[tt]},getClass:function(){return Rn}}),Rn.toMultiPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.toGeometryArray=function(t){if(t===null)return null;var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.getDefaultCoordinateSequenceFactory=function(){return se.instance()},Rn.toMultiLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.toLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.toMultiPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.toLinearRingArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.toPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.toPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)},Rn.createPointFromInternalCoord=function(t,n){return n.getPrecisionModel().makePrecise(t),n.getFactory().createPoint(t)},Rn.serialVersionUID=-6820524753094096e3;var pn={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};T(_a.prototype,{read:function(t){var n,l,d;t=t.replace(/[\n\r]/g," ");var v=pn.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(v=pn.emptyTypeStr.exec(t),v[2]=void 0),v&&(l=v[1].toLowerCase(),d=v[2],Gn[l]&&(n=Gn[l].apply(this,[d]))),n===void 0)throw new Error("Could not parse WKT "+t);return n},write:function(t){return this.extractGeometry(t)},extractGeometry:function(t){var n=t.getGeometryType().toLowerCase();if(!Vn[n])return null;var l=n.toUpperCase();return t.isEmpty()?l+" EMPTY":l+"("+Vn[n].apply(this,[t])+")"}});var Vn={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Vn.coordinate.call(this,t.coordinates.coordinates[0])},multipoint:function(t){for(var n=[],l=0,d=t.geometries.length;d>l;++l)n.push("("+Vn.point.apply(this,[t.geometries[l]])+")");return n.join(",")},linestring:function(t){for(var n=[],l=0,d=t.points.coordinates.length;d>l;++l)n.push(Vn.coordinate.apply(this,[t.points.coordinates[l]]));return n.join(",")},linearring:function(t){for(var n=[],l=0,d=t.points.coordinates.length;d>l;++l)n.push(Vn.coordinate.apply(this,[t.points.coordinates[l]]));return n.join(",")},multilinestring:function(t){for(var n=[],l=0,d=t.geometries.length;d>l;++l)n.push("("+Vn.linestring.apply(this,[t.geometries[l]])+")");return n.join(",")},polygon:function(t){var n=[];n.push("("+Vn.linestring.apply(this,[t.shell])+")");for(var l=0,d=t.holes.length;d>l;++l)n.push("("+Vn.linestring.apply(this,[t.holes[l]])+")");return n.join(",")},multipolygon:function(t){for(var n=[],l=0,d=t.geometries.length;d>l;++l)n.push("("+Vn.polygon.apply(this,[t.geometries[l]])+")");return n.join(",")},geometrycollection:function(t){for(var n=[],l=0,d=t.geometries.length;d>l;++l)n.push(this.extractGeometry(t.geometries[l]));return n.join(",")}},Gn={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var n=t.trim().split(pn.spaces);return this.geometryFactory.createPoint(new it(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(t){if(t===void 0)return this.geometryFactory.createMultiPoint();for(var n,l=t.trim().split(","),d=[],v=0,C=l.length;C>v;++v)n=l[v].replace(pn.trimParens,"$1"),d.push(Gn.point.apply(this,[n]));return this.geometryFactory.createMultiPoint(d)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var n,l=t.trim().split(","),d=[],v=0,C=l.length;C>v;++v)n=l[v].trim().split(pn.spaces),d.push(new it(Number.parseFloat(n[0]),Number.parseFloat(n[1])));return this.geometryFactory.createLineString(d)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var n,l=t.trim().split(","),d=[],v=0,C=l.length;C>v;++v)n=l[v].trim().split(pn.spaces),d.push(new it(Number.parseFloat(n[0]),Number.parseFloat(n[1])));return this.geometryFactory.createLinearRing(d)},multilinestring:function(t){if(t===void 0)return this.geometryFactory.createMultiLineString();for(var n,l=t.trim().split(pn.parenComma),d=[],v=0,C=l.length;C>v;++v)n=l[v].replace(pn.trimParens,"$1"),d.push(Gn.linestring.apply(this,[n]));return this.geometryFactory.createMultiLineString(d)},polygon:function(t){if(t===void 0)return this.geometryFactory.createPolygon();for(var n,l,d,v,C=t.trim().split(pn.parenComma),z=[],W=0,gt=C.length;gt>W;++W)n=C[W].replace(pn.trimParens,"$1"),l=Gn.linestring.apply(this,[n]),d=this.geometryFactory.createLinearRing(l.points),W===0?v=d:z.push(d);return this.geometryFactory.createPolygon(v,z)},multipolygon:function(t){if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var n,l=t.trim().split(pn.doubleParenComma),d=[],v=0,C=l.length;C>v;++v)n=l[v].replace(pn.trimParens,"$1"),d.push(Gn.polygon.apply(this,[n]));return this.geometryFactory.createMultiPolygon(d)},geometrycollection:function(t){if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var n=t.trim().split("|"),l=[],d=0,v=n.length;v>d;++d)l.push(this.read(n[d]));return this.geometryFactory.createGeometryCollection(l)}};T(Ns.prototype,{write:function(t){return this.parser.write(t)}}),T(Ns,{toLineString:function(t,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+n.x+" "+n.y+" )"}}),T(gi.prototype,{getIndexAlongSegment:function(t,n){return this.computeIntLineIndex(),this.intLineIndex[t][n]},getTopologySummary:function(){var t=new Xn;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},computeIntersection:function(t,n,l,d){this.inputLines[0][0]=t,this.inputLines[0][1]=n,this.inputLines[1][0]=l,this.inputLines[1][1]=d,this.result=this.computeIntersect(t,n,l,d)},getIntersectionNum:function(){return this.result},computeIntLineIndex:function(){if(arguments.length===0)this.intLineIndex===null&&(this.intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],n=this.getEdgeDistance(t,0),l=this.getEdgeDistance(t,1);n>l?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)}},isProper:function(){return this.hasIntersection()&&this._isProper},setPrecisionModel:function(t){this.precisionModel=t},isInteriorIntersection:function(){if(arguments.length===0)return this.isInteriorIntersection(0)?!0:!!this.isInteriorIntersection(1);if(arguments.length===1){for(var t=arguments[0],n=0;n<this.result;n++)if(!this.intPt[n].equals2D(this.inputLines[t][0])&&!this.intPt[n].equals2D(this.inputLines[t][1]))return!0;return!1}},getIntersection:function(t){return this.intPt[t]},isEndPoint:function(){return this.hasIntersection()&&!this._isProper},hasIntersection:function(){return this.result!==gi.NO_INTERSECTION},getEdgeDistance:function(t,n){var l=gi.computeEdgeDistance(this.intPt[n],this.inputLines[t][0],this.inputLines[t][1]);return l},isCollinear:function(){return this.result===gi.COLLINEAR_INTERSECTION},toString:function(){return Ns.toLineString(this.inputLines[0][0],this.inputLines[0][1])+" - "+Ns.toLineString(this.inputLines[1][0],this.inputLines[1][1])+this.getTopologySummary()},getEndpoint:function(t,n){return this.inputLines[t][n]},isIntersection:function(t){for(var n=0;n<this.result;n++)if(this.intPt[n].equals2D(t))return!0;return!1},getIntersectionAlongSegment:function(t,n){return this.computeIntLineIndex(),this.intPt[this.intLineIndex[t][n]]},interfaces_:function(){return[]},getClass:function(){return gi}}),gi.computeEdgeDistance=function(t,n,l){var d=Math.abs(l.x-n.x),v=Math.abs(l.y-n.y),C=-1;if(t.equals(n))C=0;else if(t.equals(l))C=d>v?d:v;else{var z=Math.abs(t.x-n.x),W=Math.abs(t.y-n.y);C=d>v?z:W,C!==0||t.equals(n)||(C=Math.max(z,W))}return yt.isTrue(!(C===0&&!t.equals(n)),"Bad distance calculation"),C},gi.nonRobustComputeEdgeDistance=function(t,n,l){var d=t.x-n.x,v=t.y-n.y,C=Math.sqrt(d*d+v*v);return yt.isTrue(!(C===0&&!t.equals(n)),"Invalid distance calculation"),C},gi.DONT_INTERSECT=0,gi.DO_INTERSECT=1,gi.COLLINEAR=2,gi.NO_INTERSECTION=0,gi.POINT_INTERSECTION=1,gi.COLLINEAR_INTERSECTION=2,st(ji,gi),T(ji.prototype,{isInSegmentEnvelopes:function(t){var n=new Xt(this.inputLines[0][0],this.inputLines[0][1]),l=new Xt(this.inputLines[1][0],this.inputLines[1][1]);return n.contains(t)&&l.contains(t)},computeIntersection:function(){if(arguments.length!==3)return gi.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],n=arguments[1],l=arguments[2];return this._isProper=!1,Xt.intersects(n,l,t)&&re.orientationIndex(n,l,t)===0&&re.orientationIndex(l,n,t)===0?(this._isProper=!0,(t.equals(n)||t.equals(l))&&(this._isProper=!1),this.result=gi.POINT_INTERSECTION,null):void(this.result=gi.NO_INTERSECTION)},normalizeToMinimum:function(t,n,l,d,v){v.x=this.smallestInAbsValue(t.x,n.x,l.x,d.x),v.y=this.smallestInAbsValue(t.y,n.y,l.y,d.y),t.x-=v.x,t.y-=v.y,n.x-=v.x,n.y-=v.y,l.x-=v.x,l.y-=v.y,d.x-=v.x,d.y-=v.y},safeHCoordinateIntersection:function(t,n,l,d){var v=null;try{v=Zt.intersection(t,n,l,d)}catch(C){if(!(C instanceof Yt))throw C;v=ji.nearestEndpoint(t,n,l,d)}finally{}return v},intersection:function(t,n,l,d){var v=this.intersectionWithNormalization(t,n,l,d);return this.isInSegmentEnvelopes(v)||(v=new it(ji.nearestEndpoint(t,n,l,d))),this.precisionModel!==null&&this.precisionModel.makePrecise(v),v},smallestInAbsValue:function(t,n,l,d){var v=t,C=Math.abs(v);return Math.abs(n)<C&&(v=n,C=Math.abs(n)),Math.abs(l)<C&&(v=l,C=Math.abs(l)),Math.abs(d)<C&&(v=d),v},checkDD:function(t,n,l,d,v){var C=ye.intersection(t,n,l,d),z=this.isInSegmentEnvelopes(C);mt.out.println("DD in env = "+z+"  --------------------- "+C),v.distance(C)>1e-4&&mt.out.println("Distance = "+v.distance(C))},intersectionWithNormalization:function(t,n,l,d){var v=new it(t),C=new it(n),z=new it(l),W=new it(d),gt=new it;this.normalizeToEnvCentre(v,C,z,W,gt);var Bt=this.safeHCoordinateIntersection(v,C,z,W);return Bt.x+=gt.x,Bt.y+=gt.y,Bt},computeCollinearIntersection:function(t,n,l,d){var v=Xt.intersects(t,n,l),C=Xt.intersects(t,n,d),z=Xt.intersects(l,d,t),W=Xt.intersects(l,d,n);return v&&C?(this.intPt[0]=l,this.intPt[1]=d,gi.COLLINEAR_INTERSECTION):z&&W?(this.intPt[0]=t,this.intPt[1]=n,gi.COLLINEAR_INTERSECTION):v&&z?(this.intPt[0]=l,this.intPt[1]=t,!l.equals(t)||C||W?gi.COLLINEAR_INTERSECTION:gi.POINT_INTERSECTION):v&&W?(this.intPt[0]=l,this.intPt[1]=n,!l.equals(n)||C||z?gi.COLLINEAR_INTERSECTION:gi.POINT_INTERSECTION):C&&z?(this.intPt[0]=d,this.intPt[1]=t,!d.equals(t)||v||W?gi.COLLINEAR_INTERSECTION:gi.POINT_INTERSECTION):C&&W?(this.intPt[0]=d,this.intPt[1]=n,!d.equals(n)||v||z?gi.COLLINEAR_INTERSECTION:gi.POINT_INTERSECTION):gi.NO_INTERSECTION},normalizeToEnvCentre:function(t,n,l,d,v){var C=t.x<n.x?t.x:n.x,z=t.y<n.y?t.y:n.y,W=t.x>n.x?t.x:n.x,gt=t.y>n.y?t.y:n.y,Bt=l.x<d.x?l.x:d.x,Se=l.y<d.y?l.y:d.y,Ae=l.x>d.x?l.x:d.x,rn=l.y>d.y?l.y:d.y,Nn=C>Bt?C:Bt,ei=Ae>W?W:Ae,ci=z>Se?z:Se,Mr=rn>gt?gt:rn,_s=(Nn+ei)/2,ha=(ci+Mr)/2;v.x=_s,v.y=ha,t.x-=v.x,t.y-=v.y,n.x-=v.x,n.y-=v.y,l.x-=v.x,l.y-=v.y,d.x-=v.x,d.y-=v.y},computeIntersect:function(t,n,l,d){if(this._isProper=!1,!Xt.intersects(t,n,l,d))return gi.NO_INTERSECTION;var v=re.orientationIndex(t,n,l),C=re.orientationIndex(t,n,d);if(v>0&&C>0||0>v&&0>C)return gi.NO_INTERSECTION;var z=re.orientationIndex(l,d,t),W=re.orientationIndex(l,d,n);if(z>0&&W>0||0>z&&0>W)return gi.NO_INTERSECTION;var gt=v===0&&C===0&&z===0&&W===0;return gt?this.computeCollinearIntersection(t,n,l,d):(v===0||C===0||z===0||W===0?(this._isProper=!1,t.equals2D(l)||t.equals2D(d)?this.intPt[0]=t:n.equals2D(l)||n.equals2D(d)?this.intPt[0]=n:v===0?this.intPt[0]=new it(l):C===0?this.intPt[0]=new it(d):z===0?this.intPt[0]=new it(t):W===0&&(this.intPt[0]=new it(n))):(this._isProper=!0,this.intPt[0]=this.intersection(t,n,l,d)),gi.POINT_INTERSECTION)},interfaces_:function(){return[]},getClass:function(){return ji}}),ji.nearestEndpoint=function(t,n,l,d){var v=t,C=re.distancePointLine(t,l,d),z=re.distancePointLine(n,l,d);return C>z&&(C=z,v=n),z=re.distancePointLine(l,t,n),C>z&&(C=z,v=l),z=re.distancePointLine(d,t,n),C>z&&(C=z,v=d),v},T(ea.prototype,{interfaces_:function(){return[]},getClass:function(){return ea}}),ea.orientationIndex=function(t,n,l){var d=n.x-t.x,v=n.y-t.y,C=l.x-n.x,z=l.y-n.y;return ea.signOfDet2x2(d,v,C,z)},ea.signOfDet2x2=function(t,n,l,d){var v=null,C=null,z=null;if(v=1,t===0||d===0)return n===0||l===0?0:n>0?l>0?-v:v:l>0?v:-v;if(n===0||l===0)return d>0?t>0?v:-v:t>0?-v:v;if(n>0?d>0?d>=n||(v=-v,C=t,t=l,l=C,C=n,n=d,d=C):-d>=n?(v=-v,l=-l,d=-d):(C=t,t=-l,l=C,C=n,n=-d,d=C):d>0?d>=-n?(v=-v,t=-t,n=-n):(C=-t,t=l,l=C,C=-n,n=d,d=C):n>=d?(t=-t,n=-n,l=-l,d=-d):(v=-v,C=-t,t=-l,l=C,C=-n,n=-d,d=C),t>0){if(!(l>0)||!(l>=t))return v}else{if(l>0||!(t>=l))return-v;v=-v,t=-t,l=-l}for(;;){if(z=Math.floor(l/t),l-=z*t,d-=z*n,0>d)return-v;if(d>n)return v;if(t>l+l){if(d+d>n)return v}else{if(n>d+d)return-v;l=t-l,d=n-d,v=-v}if(d===0)return l===0?0:-v;if(l===0||(z=Math.floor(t/l),t-=z*l,n-=z*d,0>n))return v;if(n>d)return-v;if(l>t+t){if(n+n>d)return-v}else{if(d>n+n)return v;t=l-t,n=d-n,v=-v}if(n===0)return t===0?0:v;if(t===0)return-v}},T(kr.prototype,{countSegment:function(t,n){if(t.x<this.p.x&&n.x<this.p.x)return null;if(this.p.x===n.x&&this.p.y===n.y)return this.isPointOnSegment=!0,null;if(t.y===this.p.y&&n.y===this.p.y){var l=t.x,d=n.x;return l>d&&(l=n.x,d=t.x),this.p.x>=l&&this.p.x<=d&&(this.isPointOnSegment=!0),null}if(t.y>this.p.y&&n.y<=this.p.y||n.y>this.p.y&&t.y<=this.p.y){var v=t.x-this.p.x,C=t.y-this.p.y,z=n.x-this.p.x,W=n.y-this.p.y,gt=ea.signOfDet2x2(v,C,z,W);if(gt===0)return this.isPointOnSegment=!0,null;C>W&&(gt=-gt),gt>0&&this.crossingCount++}},isPointInPolygon:function(){return this.getLocation()!==rt.EXTERIOR},getLocation:function(){return this.isPointOnSegment?rt.BOUNDARY:this.crossingCount%2===1?rt.INTERIOR:rt.EXTERIOR},isOnSegment:function(){return this.isPointOnSegment},interfaces_:function(){return[]},getClass:function(){return kr}}),kr.locatePointInRing=function(){if(arguments[0]instanceof it&&qe(arguments[1],te)){for(var t=arguments[0],n=arguments[1],l=new kr(t),d=new it,v=new it,C=1;C<n.size();C++)if(n.getCoordinate(C,d),n.getCoordinate(C-1,v),l.countSegment(d,v),l.isOnSegment())return l.getLocation();return l.getLocation()}if(arguments[0]instanceof it&&arguments[1]instanceof Array){for(var z=arguments[0],W=arguments[1],l=new kr(z),C=1;C<W.length;C++){var d=W[C],v=W[C-1];if(l.countSegment(d,v),l.isOnSegment())return l.getLocation()}return l.getLocation()}},T(re.prototype,{interfaces_:function(){return[]},getClass:function(){return re}}),re.orientationIndex=function(t,n,l){return ye.orientationIndex(t,n,l)},re.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var n=0,l=t[0].x,d=1;d<t.length-1;d++){var v=t[d].x-l,C=t[d+1].y,z=t[d-1].y;n+=v*(z-C)}return n/2}if(qe(arguments[0],te)){var W=arguments[0],gt=W.size();if(3>gt)return 0;var Bt=new it,Se=new it,Ae=new it;W.getCoordinate(0,Se),W.getCoordinate(1,Ae);var l=Se.x;Ae.x-=l;for(var n=0,d=1;gt-1>d;d++)Bt.y=Se.y,Se.x=Ae.x,Se.y=Ae.y,W.getCoordinate(d+1,Ae),Ae.x-=l,n+=Se.x*(Bt.y-Ae.y);return n/2}},re.distanceLineLine=function(t,n,l,d){if(t.equals(n))return re.distancePointLine(t,l,d);if(l.equals(d))return re.distancePointLine(d,t,n);var v=!1;if(Xt.intersects(t,n,l,d)){var C=(n.x-t.x)*(d.y-l.y)-(n.y-t.y)*(d.x-l.x);if(C===0)v=!0;else{var z=(t.y-l.y)*(d.x-l.x)-(t.x-l.x)*(d.y-l.y),W=(t.y-l.y)*(n.x-t.x)-(t.x-l.x)*(n.y-t.y),gt=W/C,Bt=z/C;(0>Bt||Bt>1||0>gt||gt>1)&&(v=!0)}}else v=!0;return v?Sn.min(re.distancePointLine(t,l,d),re.distancePointLine(n,l,d),re.distancePointLine(l,t,n),re.distancePointLine(d,t,n)):0},re.isPointInRing=function(t,n){return re.locatePointInRing(t,n)!==rt.EXTERIOR},re.computeLength=function(t){var n=t.size();if(1>=n)return 0;var l=0,d=new it;t.getCoordinate(0,d);for(var v=d.x,C=d.y,z=1;n>z;z++){t.getCoordinate(z,d);var W=d.x,gt=d.y,Bt=W-v,Se=gt-C;l+=Math.sqrt(Bt*Bt+Se*Se),v=W,C=gt}return l},re.isCCW=function(t){var n=t.length-1;if(3>n)throw new q;for(var l=t[0],d=0,v=1;n>=v;v++){var C=t[v];C.y>l.y&&(l=C,d=v)}var z=d;do z-=1,0>z&&(z=n);while(t[z].equals2D(l)&&z!==d);var W=d;do W=(W+1)%n;while(t[W].equals2D(l)&&W!==d);var gt=t[z],Bt=t[W];if(gt.equals2D(l)||Bt.equals2D(l)||gt.equals2D(Bt))return!1;var Se=re.computeOrientation(gt,l,Bt);return Se===0?gt.x>Bt.x:Se>0},re.locatePointInRing=function(t,n){return kr.locatePointInRing(t,n)},re.distancePointLinePerpendicular=function(t,n,l){var d=(l.x-n.x)*(l.x-n.x)+(l.y-n.y)*(l.y-n.y),v=((n.y-t.y)*(l.x-n.x)-(n.x-t.x)*(l.y-n.y))/d;return Math.abs(v)*Math.sqrt(d)},re.computeOrientation=function(t,n,l){return re.orientationIndex(t,n,l)},re.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(n.length===0)throw new q;for(var l=t.distance(n[0]),d=0;d<n.length-1;d++){var v=re.distancePointLine(t,n[d],n[d+1]);l>v&&(l=v)}return l}if(arguments.length===3){var C=arguments[0],z=arguments[1],W=arguments[2];if(z.x===W.x&&z.y===W.y)return C.distance(z);var gt=(W.x-z.x)*(W.x-z.x)+(W.y-z.y)*(W.y-z.y),Bt=((C.x-z.x)*(W.x-z.x)+(C.y-z.y)*(W.y-z.y))/gt;if(0>=Bt)return C.distance(z);if(Bt>=1)return C.distance(W);var Se=((z.y-C.y)*(W.x-z.x)-(z.x-C.x)*(W.y-z.y))/gt;return Math.abs(Se)*Math.sqrt(gt)}},re.isOnLine=function(t,n){for(var l=new ji,d=1;d<n.length;d++){var v=n[d-1],C=n[d];if(l.computeIntersection(t,v,C),l.hasIntersection())return!0}return!1},re.CLOCKWISE=-1,re.RIGHT=re.CLOCKWISE,re.COUNTERCLOCKWISE=1,re.LEFT=re.COUNTERCLOCKWISE,re.COLLINEAR=0,re.STRAIGHT=re.COLLINEAR,T(gn.prototype,{minX:function(){return Math.min(this.p0.x,this.p1.x)},orientationIndex:function(){if(arguments[0]instanceof gn){var t=arguments[0],n=re.orientationIndex(this.p0,this.p1,t.p0),l=re.orientationIndex(this.p0,this.p1,t.p1);return n>=0&&l>=0||0>=n&&0>=l?Math.max(n,l):0}if(arguments[0]instanceof it){var d=arguments[0];return re.orientationIndex(this.p0,this.p1,d)}},toGeometry:function(t){return t.createLineString([this.p0,this.p1])},isVertical:function(){return this.p0.x===this.p1.x},equals:function(t){if(!(t instanceof gn))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)},intersection:function(t){var n=new ji;return n.computeIntersection(this.p0,this.p1,t.p0,t.p1),n.hasIntersection()?n.getIntersection(0):null},project:function(){if(arguments[0]instanceof it){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new it(t);var n=this.projectionFactor(t),l=new it;return l.x=this.p0.x+n*(this.p1.x-this.p0.x),l.y=this.p0.y+n*(this.p1.y-this.p0.y),l}if(arguments[0]instanceof gn){var d=arguments[0],v=this.projectionFactor(d.p0),C=this.projectionFactor(d.p1);if(v>=1&&C>=1||0>=v&&0>=C)return null;var z=this.project(d.p0);0>v&&(z=this.p0),v>1&&(z=this.p1);var W=this.project(d.p1);return 0>C&&(W=this.p0),C>1&&(W=this.p1),new gn(z,W)}},normalize:function(){this.p1.compareTo(this.p0)<0&&this.reverse()},angle:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},getCoordinate:function(t){return t===0?this.p0:this.p1},distancePerpendicular:function(t){return re.distancePointLinePerpendicular(t,this.p0,this.p1)},minY:function(){return Math.min(this.p0.y,this.p1.y)},midPoint:function(){return gn.midPoint(this.p0,this.p1)},projectionFactor:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,l=this.p1.y-this.p0.y,d=n*n+l*l;if(0>=d)return j.NaN;var v=((t.x-this.p0.x)*n+(t.y-this.p0.y)*l)/d;return v},closestPoints:function(t){var n=this.intersection(t);if(n!==null)return[n,n];var l=new Array(2).fill(null),d=j.MAX_VALUE,v=null,C=this.closestPoint(t.p0);d=C.distance(t.p0),l[0]=C,l[1]=t.p0;var z=this.closestPoint(t.p1);v=z.distance(t.p1),d>v&&(d=v,l[0]=z,l[1]=t.p1);var W=t.closestPoint(this.p0);v=W.distance(this.p0),d>v&&(d=v,l[0]=this.p0,l[1]=W);var gt=t.closestPoint(this.p1);return v=gt.distance(this.p1),d>v&&(d=v,l[0]=this.p1,l[1]=gt),l},closestPoint:function(t){var n=this.projectionFactor(t);if(n>0&&1>n)return this.project(t);var l=this.p0.distance(t),d=this.p1.distance(t);return d>l?this.p0:this.p1},maxX:function(){return Math.max(this.p0.x,this.p1.x)},getLength:function(){return this.p0.distance(this.p1)},compareTo:function(t){var n=t,l=this.p0.compareTo(n.p0);return l!==0?l:this.p1.compareTo(n.p1)},reverse:function(){var t=this.p0;this.p0=this.p1,this.p1=t},equalsTopo:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)},lineIntersection:function(t){try{var n=Zt.intersection(this.p0,this.p1,t.p0,t.p1);return n}catch(l){if(!(l instanceof Yt))throw l}finally{}return null},maxY:function(){return Math.max(this.p0.y,this.p1.y)},pointAlongOffset:function(t,n){var l=this.p0.x+t*(this.p1.x-this.p0.x),d=this.p0.y+t*(this.p1.y-this.p0.y),v=this.p1.x-this.p0.x,C=this.p1.y-this.p0.y,z=Math.sqrt(v*v+C*C),W=0,gt=0;if(n!==0){if(0>=z)throw new IllegalStateException("Cannot compute offset from zero-length line segment");W=n*v/z,gt=n*C/z}var Bt=l-gt,Se=d+W,Ae=new it(Bt,Se);return Ae},setCoordinates:function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=l.x,this.p1.y=l.y}},segmentFraction:function(t){var n=this.projectionFactor(t);return 0>n?n=0:(n>1||j.isNaN(n))&&(n=1),n},toString:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},isHorizontal:function(){return this.p0.y===this.p1.y},distance:function(){if(arguments[0]instanceof gn){var t=arguments[0];return re.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof it){var n=arguments[0];return re.distancePointLine(n,this.p0,this.p1)}},pointAlong:function(t){var n=new it;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n},hashCode:function(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var n=Math.trunc(t)^Math.trunc(t>>32),l=java.lang.Double.doubleToLongBits(this.p1.x);l^=31*java.lang.Double.doubleToLongBits(this.p1.y);var d=Math.trunc(l)^Math.trunc(l>>32);return n^d},interfaces_:function(){return[J,tt]},getClass:function(){return gn}}),gn.midPoint=function(t,n){return new it((t.x+n.x)/2,(t.y+n.y)/2)},gn.serialVersionUID=0x2d2172135f411c00,T(zn.prototype,{isIntersects:function(){return!this.isDisjoint()},isCovers:function(){var t=zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])||zn.isTrue(this.matrix[rt.INTERIOR][rt.BOUNDARY])||zn.isTrue(this.matrix[rt.BOUNDARY][rt.INTERIOR])||zn.isTrue(this.matrix[rt.BOUNDARY][rt.BOUNDARY]);return t&&this.matrix[rt.EXTERIOR][rt.INTERIOR]===$e.FALSE&&this.matrix[rt.EXTERIOR][rt.BOUNDARY]===$e.FALSE},isCoveredBy:function(){var t=zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])||zn.isTrue(this.matrix[rt.INTERIOR][rt.BOUNDARY])||zn.isTrue(this.matrix[rt.BOUNDARY][rt.INTERIOR])||zn.isTrue(this.matrix[rt.BOUNDARY][rt.BOUNDARY]);return t&&this.matrix[rt.INTERIOR][rt.EXTERIOR]===$e.FALSE&&this.matrix[rt.BOUNDARY][rt.EXTERIOR]===$e.FALSE},set:function(){if(arguments.length===1)for(var t=arguments[0],n=0;n<t.length;n++){var l=Math.trunc(n/3),d=n%3;this.matrix[l][d]=$e.toDimensionValue(t.charAt(n))}else if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2];this.matrix[v][C]=z}},isContains:function(){return zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])&&this.matrix[rt.EXTERIOR][rt.INTERIOR]===$e.FALSE&&this.matrix[rt.EXTERIOR][rt.BOUNDARY]===$e.FALSE},setAtLeast:function(){if(arguments.length===1)for(var t=arguments[0],n=0;n<t.length;n++){var l=Math.trunc(n/3),d=n%3;this.setAtLeast(l,d,$e.toDimensionValue(t.charAt(n)))}else if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2];this.matrix[v][C]<z&&(this.matrix[v][C]=z)}},setAtLeastIfValid:function(t,n,l){t>=0&&n>=0&&this.setAtLeast(t,n,l)},isWithin:function(){return zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])&&this.matrix[rt.INTERIOR][rt.EXTERIOR]===$e.FALSE&&this.matrix[rt.BOUNDARY][rt.EXTERIOR]===$e.FALSE},isTouches:function(t,n){return t>n?this.isTouches(n,t):t===$e.A&&n===$e.A||t===$e.L&&n===$e.L||t===$e.L&&n===$e.A||t===$e.P&&n===$e.A||t===$e.P&&n===$e.L?this.matrix[rt.INTERIOR][rt.INTERIOR]===$e.FALSE&&(zn.isTrue(this.matrix[rt.INTERIOR][rt.BOUNDARY])||zn.isTrue(this.matrix[rt.BOUNDARY][rt.INTERIOR])||zn.isTrue(this.matrix[rt.BOUNDARY][rt.BOUNDARY])):!1},isOverlaps:function(t,n){return t===$e.P&&n===$e.P||t===$e.A&&n===$e.A?zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])&&zn.isTrue(this.matrix[rt.INTERIOR][rt.EXTERIOR])&&zn.isTrue(this.matrix[rt.EXTERIOR][rt.INTERIOR]):t===$e.L&&n===$e.L?this.matrix[rt.INTERIOR][rt.INTERIOR]===1&&zn.isTrue(this.matrix[rt.INTERIOR][rt.EXTERIOR])&&zn.isTrue(this.matrix[rt.EXTERIOR][rt.INTERIOR]):!1},isEquals:function(t,n){return t!==n?!1:zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])&&this.matrix[rt.INTERIOR][rt.EXTERIOR]===$e.FALSE&&this.matrix[rt.BOUNDARY][rt.EXTERIOR]===$e.FALSE&&this.matrix[rt.EXTERIOR][rt.INTERIOR]===$e.FALSE&&this.matrix[rt.EXTERIOR][rt.BOUNDARY]===$e.FALSE},toString:function(){for(var t=new Xn("123456789"),n=0;3>n;n++)for(var l=0;3>l;l++)t.setCharAt(3*n+l,$e.toDimensionSymbol(this.matrix[n][l]));return t.toString()},setAll:function(t){for(var n=0;3>n;n++)for(var l=0;3>l;l++)this.matrix[n][l]=t},get:function(t,n){return this.matrix[t][n]},transpose:function(){var t=this.matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},matches:function(t){if(t.length!==9)throw new q;for(var n=0;3>n;n++)for(var l=0;3>l;l++)if(!zn.matches(this.matrix[n][l],t.charAt(3*n+l)))return!1;return!0},add:function(t){for(var n=0;3>n;n++)for(var l=0;3>l;l++)this.setAtLeast(n,l,t.get(n,l))},isDisjoint:function(){return this.matrix[rt.INTERIOR][rt.INTERIOR]===$e.FALSE&&this.matrix[rt.INTERIOR][rt.BOUNDARY]===$e.FALSE&&this.matrix[rt.BOUNDARY][rt.INTERIOR]===$e.FALSE&&this.matrix[rt.BOUNDARY][rt.BOUNDARY]===$e.FALSE},isCrosses:function(t,n){return t===$e.P&&n===$e.L||t===$e.P&&n===$e.A||t===$e.L&&n===$e.A?zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])&&zn.isTrue(this.matrix[rt.INTERIOR][rt.EXTERIOR]):t===$e.L&&n===$e.P||t===$e.A&&n===$e.P||t===$e.A&&n===$e.L?zn.isTrue(this.matrix[rt.INTERIOR][rt.INTERIOR])&&zn.isTrue(this.matrix[rt.EXTERIOR][rt.INTERIOR]):t===$e.L&&n===$e.L?this.matrix[rt.INTERIOR][rt.INTERIOR]===0:!1},interfaces_:function(){return[h]},getClass:function(){return zn}}),zn.matches=function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var t=arguments[0],n=arguments[1];return n===$e.SYM_DONTCARE||n===$e.SYM_TRUE&&(t>=0||t===$e.TRUE)||n===$e.SYM_FALSE&&t===$e.FALSE||n===$e.SYM_P&&t===$e.P||n===$e.SYM_L&&t===$e.L?!0:n===$e.SYM_A&&t===$e.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var l=arguments[0],d=arguments[1],v=new zn(l);return v.matches(d)}},zn.isTrue=function(t){return t>=0||t===$e.TRUE};var Un=Object.freeze({Coordinate:it,CoordinateList:Jt,Envelope:Xt,LineSegment:gn,GeometryFactory:Rn,Geometry:de,Point:rr,LineString:oi,LinearRing:Yi,Polygon:Pi,GeometryCollection:ri,MultiPoint:Zr,MultiLineString:Ki,MultiPolygon:Ct,Dimension:$e,IntersectionMatrix:zn});T(Ts.prototype,{addPoint:function(t){this.ptCount+=1,this.ptCentSum.x+=t.x,this.ptCentSum.y+=t.y},setBasePoint:function(t){this.areaBasePt===null&&(this.areaBasePt=t)},addLineSegments:function(t){for(var n=0,l=0;l<t.length-1;l++){var d=t[l].distance(t[l+1]);if(d!==0){n+=d;var v=(t[l].x+t[l+1].x)/2;this.lineCentSum.x+=d*v;var C=(t[l].y+t[l+1].y)/2;this.lineCentSum.y+=d*C}}this.totalLength+=n,n===0&&t.length>0&&this.addPoint(t[0])},addHole:function(t){for(var n=re.isCCW(t),l=0;l<t.length-1;l++)this.addTriangle(this.areaBasePt,t[l],t[l+1],n);this.addLineSegments(t)},getCentroid:function(){var t=new it;if(Math.abs(this.areasum2)>0)t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2;else if(this.totalLength>0)t.x=this.lineCentSum.x/this.totalLength,t.y=this.lineCentSum.y/this.totalLength;else{if(!(this.ptCount>0))return null;t.x=this.ptCentSum.x/this.ptCount,t.y=this.ptCentSum.y/this.ptCount}return t},addShell:function(t){t.length>0&&this.setBasePoint(t[0]);for(var n=!re.isCCW(t),l=0;l<t.length-1;l++)this.addTriangle(this.areaBasePt,t[l],t[l+1],n);this.addLineSegments(t)},addTriangle:function(t,n,l,d){var v=d?1:-1;Ts.centroid3(t,n,l,this.triangleCent3);var C=Ts.area2(t,n,l);this.cg3.x+=v*C*this.triangleCent3.x,this.cg3.y+=v*C*this.triangleCent3.y,this.areasum2+=v*C},add:function(){if(arguments[0]instanceof Pi){var t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(var n=0;n<t.getNumInteriorRing();n++)this.addHole(t.getInteriorRingN(n).getCoordinates())}else if(arguments[0]instanceof de){var l=arguments[0];if(l.isEmpty())return null;if(l instanceof rr)this.addPoint(l.getCoordinate());else if(l instanceof oi)this.addLineSegments(l.getCoordinates());else if(l instanceof Pi){var d=l;this.add(d)}else if(l instanceof ri)for(var v=l,n=0;n<v.getNumGeometries();n++)this.add(v.getGeometryN(n))}},interfaces_:function(){return[]},getClass:function(){return Ts}}),Ts.area2=function(t,n,l){return(n.x-t.x)*(l.y-t.y)-(l.x-t.x)*(n.y-t.y)},Ts.centroid3=function(t,n,l,d){return d.x=t.x+n.x+l.x,d.y=t.y+n.y+l.y,null},Ts.getCentroid=function(t){var n=new Ts(t);return n.getCentroid()},Ja.prototype=new Error,Ja.prototype.name="EmptyStackException",Hn.prototype=new pt,Hn.prototype.add=function(t){return this.array_.push(t),!0},Hn.prototype.get=function(t){if(0>t||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},Hn.prototype.push=function(t){return this.array_.push(t),t},Hn.prototype.pop=function(t){if(this.array_.length===0)throw new Ja;return this.array_.pop()},Hn.prototype.peek=function(){if(this.array_.length===0)throw new Ja;return this.array_[this.array_.length-1]},Hn.prototype.empty=function(){return this.array_.length===0},Hn.prototype.isEmpty=function(){return this.empty()},Hn.prototype.search=function(t){return this.array_.indexOf(t)},Hn.prototype.size=function(){return this.array_.length},Hn.prototype.toArray=function(){for(var t=[],n=0,l=this.array_.length;l>n;n++)t.push(this.array_[n]);return t},T(Ka.prototype,{filter:function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))},getCoordinates:function(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)},interfaces_:function(){return[On]},getClass:function(){return Ka}}),Ka.filterCoordinates=function(t){for(var n=new Ka,l=0;l<t.length;l++)n.filter(t[l]);return n.getCoordinates()},T(Ur.prototype,{preSort:function(t){for(var n=null,l=1;l<t.length;l++)(t[l].y<t[0].y||t[l].y===t[0].y&&t[l].x<t[0].x)&&(n=t[0],t[0]=t[l],t[l]=n);return hs.sort(t,1,t.length,new na(t[0])),t},computeOctRing:function(t){var n=this.computeOctPts(t),l=new Jt;return l.add(n,!1),l.size()<3?null:(l.closeRing(),l.toCoordinateArray())},lineOrPolygon:function(t){if(t=this.cleanRing(t),t.length===3)return this.geomFactory.createLineString([t[0],t[1]]);var n=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(n,null)},cleanRing:function(t){yt.equals(t[0],t[t.length-1]);for(var n=new _t,l=null,d=0;d<=t.length-2;d++){var v=t[d],C=t[d+1];v.equals(C)||l!==null&&this.isBetween(l,v,C)||(n.add(v),l=v)}n.add(t[t.length-1]);var z=new Array(n.size()).fill(null);return n.toArray(z)},isBetween:function(t,n,l){return re.computeOrientation(t,n,l)!==0?!1:t.x!==l.x&&(t.x<=n.x&&n.x<=l.x||l.x<=n.x&&n.x<=t.x)||t.y!==l.y&&(t.y<=n.y&&n.y<=l.y||l.y<=n.y&&n.y<=t.y)},reduce:function(t){var n=this.computeOctRing(t);if(n===null)return t;for(var l=new Qr,d=0;d<n.length;d++)l.add(n[d]);for(var d=0;d<t.length;d++)re.isPointInRing(t[d],n)||l.add(t[d]);var v=Bn.toCoordinateArray(l);return v.length<3?this.padArray3(v):v},getConvexHull:function(){if(this.inputPts.length===0)return this.geomFactory.createGeometryCollection(null);if(this.inputPts.length===1)return this.geomFactory.createPoint(this.inputPts[0]);if(this.inputPts.length===2)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var n=this.preSort(t),l=this.grahamScan(n),d=this.toCoordinateArray(l);return this.lineOrPolygon(d)},padArray3:function(t){for(var n=new Array(3).fill(null),l=0;l<n.length;l++)l<t.length?n[l]=t[l]:n[l]=t[0];return n},computeOctPts:function(t){for(var n=new Array(8).fill(null),l=0;l<n.length;l++)n[l]=t[0];for(var d=1;d<t.length;d++)t[d].x<n[0].x&&(n[0]=t[d]),t[d].x-t[d].y<n[1].x-n[1].y&&(n[1]=t[d]),t[d].y>n[2].y&&(n[2]=t[d]),t[d].x+t[d].y>n[3].x+n[3].y&&(n[3]=t[d]),t[d].x>n[4].x&&(n[4]=t[d]),t[d].x-t[d].y>n[5].x-n[5].y&&(n[5]=t[d]),t[d].y<n[6].y&&(n[6]=t[d]),t[d].x+t[d].y<n[7].x+n[7].y&&(n[7]=t[d]);return n},toCoordinateArray:function(t){for(var n=new Array(t.size()).fill(null),l=0;l<t.size();l++){var d=t.get(l);n[l]=d}return n},grahamScan:function(t){var n=null,l=new Hn;n=l.push(t[0]),n=l.push(t[1]),n=l.push(t[2]);for(var d=3;d<t.length;d++){for(n=l.pop();!l.empty()&&re.computeOrientation(l.peek(),n,t[d])>0;)n=l.pop();n=l.push(n),n=l.push(t[d])}return n=l.push(t[0]),l},interfaces_:function(){return[]},getClass:function(){return Ur}}),Ur.extractCoordinates=function(t){var n=new Ka;return t.apply(n),n.getCoordinates()},T(na.prototype,{compare:function(t,n){var l=t,d=n;return na.polarCompare(this.origin,l,d)},interfaces_:function(){return[X]},getClass:function(){return na}}),na.polarCompare=function(t,n,l){var d=n.x-t.x,v=n.y-t.y,C=l.x-t.x,z=l.y-t.y,W=re.computeOrientation(t,n,l);if(W===re.COUNTERCLOCKWISE)return 1;if(W===re.CLOCKWISE)return-1;var gt=d*d+v*v,Bt=C*C+z*z;return Bt>gt?-1:gt>Bt?1:0},Ur.RadialComparator=na,T(br.prototype,{transformPoint:function(t,n){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},transformPolygon:function(t,n){var l=!0,d=this.transformLinearRing(t.getExteriorRing(),t);d!==null&&d instanceof Yi&&!d.isEmpty()||(l=!1);for(var v=new _t,C=0;C<t.getNumInteriorRing();C++){var z=this.transformLinearRing(t.getInteriorRingN(C),t);z===null||z.isEmpty()||(z instanceof Yi||(l=!1),v.add(z))}if(l)return this.factory.createPolygon(d,v.toArray([]));var W=new _t;return d!==null&&W.add(d),W.addAll(v),this.factory.buildGeometry(W)},createCoordinateSequence:function(t){return this.factory.getCoordinateSequenceFactory().create(t)},getInputGeometry:function(){return this.inputGeom},transformMultiLineString:function(t,n){for(var l=new _t,d=0;d<t.getNumGeometries();d++){var v=this.transformLineString(t.getGeometryN(d),t);v!==null&&(v.isEmpty()||l.add(v))}return this.factory.buildGeometry(l)},transformCoordinates:function(t,n){return this.copy(t)},transformLineString:function(t,n){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},transformMultiPoint:function(t,n){for(var l=new _t,d=0;d<t.getNumGeometries();d++){var v=this.transformPoint(t.getGeometryN(d),t);v!==null&&(v.isEmpty()||l.add(v))}return this.factory.buildGeometry(l)},transformMultiPolygon:function(t,n){for(var l=new _t,d=0;d<t.getNumGeometries();d++){var v=this.transformPolygon(t.getGeometryN(d),t);v!==null&&(v.isEmpty()||l.add(v))}return this.factory.buildGeometry(l)},copy:function(t){return t.copy()},transformGeometryCollection:function(t,n){for(var l=new _t,d=0;d<t.getNumGeometries();d++){var v=this.transform(t.getGeometryN(d));v!==null&&(this.pruneEmptyGeometry&&v.isEmpty()||l.add(v))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection(Rn.toGeometryArray(l)):this.factory.buildGeometry(l)},transform:function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof rr)return this.transformPoint(t,null);if(t instanceof Zr)return this.transformMultiPoint(t,null);if(t instanceof Yi)return this.transformLinearRing(t,null);if(t instanceof oi)return this.transformLineString(t,null);if(t instanceof Ki)return this.transformMultiLineString(t,null);if(t instanceof Pi)return this.transformPolygon(t,null);if(t instanceof Ct)return this.transformMultiPolygon(t,null);if(t instanceof ri)return this.transformGeometryCollection(t,null);throw new q("Unknown Geometry subtype: "+t.getClass().getName())},transformLinearRing:function(t,n){var l=this.transformCoordinates(t.getCoordinateSequence(),t);if(l===null)return this.factory.createLinearRing(null);var d=l.size();return d>0&&4>d&&!this.preserveType?this.factory.createLineString(l):this.factory.createLinearRing(l)},interfaces_:function(){return[]},getClass:function(){return br}}),T(Qi.prototype,{snapVertices:function(t,n){for(var l=this._isClosed?t.size()-1:t.size(),d=0;l>d;d++){var v=t.get(d),C=this.findSnapForVertex(v,n);C!==null&&(t.set(d,new it(C)),d===0&&this._isClosed&&t.set(t.size()-1,new it(C)))}},findSnapForVertex:function(t,n){for(var l=0;l<n.length;l++){if(t.equals2D(n[l]))return null;if(t.distance(n[l])<this.snapTolerance)return n[l]}return null},snapTo:function(t){var n=new Jt(this.srcPts);this.snapVertices(n,t),this.snapSegments(n,t);var l=n.toCoordinateArray();return l},snapSegments:function(t,n){if(n.length===0)return null;var l=n.length;n[0].equals2D(n[n.length-1])&&(l=n.length-1);for(var d=0;l>d;d++){var v=n[d],C=this.findSegmentIndexToSnap(v,t);C>=0&&t.add(C+1,new it(v),!1)}},findSegmentIndexToSnap:function(t,n){for(var l=j.MAX_VALUE,d=-1,v=0;v<n.size()-1;v++){if(this.seg.p0=n.get(v),this.seg.p1=n.get(v+1),this.seg.p0.equals2D(t)||this.seg.p1.equals2D(t)){if(this.allowSnappingToSourceVertices)continue;return-1}var C=this.seg.distance(t);C<this.snapTolerance&&l>C&&(l=C,d=v)}return d},setAllowSnappingToSourceVertices:function(t){this.allowSnappingToSourceVertices=t},interfaces_:function(){return[]},getClass:function(){return Qi}}),Qi.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])},T(R.prototype,{snapTo:function(t,n){var l=this.extractTargetCoordinates(t),d=new H(n,l);return d.transform(this.srcGeom)},snapToSelf:function(t,n){var l=this.extractTargetCoordinates(this.srcGeom),d=new H(t,l,!0),v=d.transform(this.srcGeom),C=v;return n&&qe(C,ts)&&(C=v.buffer(0)),C},computeSnapTolerance:function(t){var n=this.computeMinimumSegmentLength(t),l=n/10;return l},extractTargetCoordinates:function(t){for(var n=new Qr,l=t.getCoordinates(),d=0;d<l.length;d++)n.add(l[d]);return n.toArray(new Array(0).fill(null))},computeMinimumSegmentLength:function(t){for(var n=j.MAX_VALUE,l=0;l<t.length-1;l++){var d=t[l].distance(t[l+1]);n>d&&(n=d)}return n},interfaces_:function(){return[]},getClass:function(){return R}}),R.snap=function(t,n,l){var d=new Array(2).fill(null),v=new R(t);d[0]=v.snapTo(n,l);var C=new R(n);return d[1]=C.snapTo(d[0],l),d},R.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],n=R.computeSizeBasedSnapTolerance(t),l=t.getPrecisionModel();if(l.getType()===_e.FIXED){var d=1/l.getScale()*2/1.415;d>n&&(n=d)}return n}if(arguments.length===2){var v=arguments[0],C=arguments[1];return Math.min(R.computeOverlaySnapTolerance(v),R.computeOverlaySnapTolerance(C))}},R.computeSizeBasedSnapTolerance=function(t){var n=t.getEnvelopeInternal(),l=Math.min(n.getHeight(),n.getWidth()),d=l*R.SNAP_PRECISION_FACTOR;return d},R.snapToSelf=function(t,n,l){var d=new R(t);return d.snapToSelf(n,l)},R.SNAP_PRECISION_FACTOR=1e-9,st(H,br),T(H.prototype,{snapLine:function(t,n){var l=new Qi(t,this.snapTolerance);return l.setAllowSnappingToSourceVertices(this.isSelfSnap),l.snapTo(n)},transformCoordinates:function(t,n){var l=t.toCoordinateArray(),d=this.snapLine(l,this.snapPts);return this.factory.getCoordinateSequenceFactory().create(d)},interfaces_:function(){return[]},getClass:function(){return H}}),T(ft.prototype,{getCommon:function(){return j.longBitsToDouble(this.commonBits)},add:function(t){var n=j.doubleToLongBits(t);if(this.isFirst)return this.commonBits=n,this.commonSignExp=ft.signExpBits(this.commonBits),this.isFirst=!1,null;var l=ft.signExpBits(n);return l!==this.commonSignExp?(this.commonBits=0,null):(this.commonMantissaBitsCount=ft.numCommonMostSigMantissaBits(this.commonBits,n),void(this.commonBits=ft.zeroLowerBits(this.commonBits,64-(12+this.commonMantissaBitsCount))))},toString:function(){if(arguments.length===1){var t=arguments[0],n=j.longBitsToDouble(t),l=Long.toBinaryString(t),d="0000000000000000000000000000000000000000000000000000000000000000"+l,v=d.substring(d.length-64),C=v.substring(0,1)+"  "+v.substring(1,12)+"(exp) "+v.substring(12)+" [ "+n+" ]";return C}},interfaces_:function(){return[]},getClass:function(){return ft}}),ft.getBit=function(t,n){var l=1<<n;return(t&l)!==0?1:0},ft.signExpBits=function(t){return t>>52},ft.zeroLowerBits=function(t,n){var l=(1<<n)-1,d=~l,v=t&d;return v},ft.numCommonMostSigMantissaBits=function(t,n){for(var l=0,d=52;d>=0;d--){if(ft.getBit(t,d)!==ft.getBit(n,d))return l;l++}return 52},T(Ht.prototype,{addCommonBits:function(t){var n=new pe(this.commonCoord);t.apply(n),t.geometryChanged()},removeCommonBits:function(t){if(this.commonCoord.x===0&&this.commonCoord.y===0)return t;var n=new it(this.commonCoord);n.x=-n.x,n.y=-n.y;var l=new pe(n);return t.apply(l),t.geometryChanged(),t},getCommonCoordinate:function(){return this.commonCoord},add:function(t){t.apply(this.ccFilter),this.commonCoord=this.ccFilter.getCommonCoordinate()},interfaces_:function(){return[]},getClass:function(){return Ht}}),T(Ce.prototype,{filter:function(t){this.commonBitsX.add(t.x),this.commonBitsY.add(t.y)},getCommonCoordinate:function(){return new it(this.commonBitsX.getCommon(),this.commonBitsY.getCommon())},interfaces_:function(){return[On]},getClass:function(){return Ce}}),T(pe.prototype,{filter:function(t,n){var l=t.getOrdinate(n,0)+this.trans.x,d=t.getOrdinate(n,1)+this.trans.y;t.setOrdinate(n,0,l),t.setOrdinate(n,1,d)},isDone:function(){return!1},isGeometryChanged:function(){return!0},interfaces_:function(){return[Xr]},getClass:function(){return pe}}),Ht.CommonCoordinateFilter=Ce,Ht.Translater=pe,T(be.prototype,{next:function(){if(this.atStart)return this.atStart=!1,be.isAtomic(this.parent)&&this.index++,this.parent;if(this.subcollectionIterator!==null){if(this.subcollectionIterator.hasNext())return this.subcollectionIterator.next();this.subcollectionIterator=null}if(this.index>=this.max)throw new It;var t=this.parent.getGeometryN(this.index++);return t instanceof ri?(this.subcollectionIterator=new be(t),this.subcollectionIterator.next()):t},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){if(this.atStart)return!0;if(this.subcollectionIterator!==null){if(this.subcollectionIterator.hasNext())return!0;this.subcollectionIterator=null}return!(this.index>=this.max)},interfaces_:function(){return[le]},getClass:function(){return be}}),be.isAtomic=function(t){return!(t instanceof ri)},T(en.prototype,{locateInternal:function(){if(arguments[0]instanceof it&&arguments[1]instanceof Pi){var t=arguments[0],n=arguments[1];if(n.isEmpty())return rt.EXTERIOR;var l=n.getExteriorRing(),d=this.locateInPolygonRing(t,l);if(d===rt.EXTERIOR)return rt.EXTERIOR;if(d===rt.BOUNDARY)return rt.BOUNDARY;for(var v=0;v<n.getNumInteriorRing();v++){var C=n.getInteriorRingN(v),z=this.locateInPolygonRing(t,C);if(z===rt.INTERIOR)return rt.EXTERIOR;if(z===rt.BOUNDARY)return rt.BOUNDARY}return rt.INTERIOR}if(arguments[0]instanceof it&&arguments[1]instanceof oi){var W=arguments[0],gt=arguments[1];if(!gt.getEnvelopeInternal().intersects(W))return rt.EXTERIOR;var Bt=gt.getCoordinates();return gt.isClosed()||!W.equals(Bt[0])&&!W.equals(Bt[Bt.length-1])?re.isOnLine(W,Bt)?rt.INTERIOR:rt.EXTERIOR:rt.BOUNDARY}if(arguments[0]instanceof it&&arguments[1]instanceof rr){var Se=arguments[0],Ae=arguments[1],rn=Ae.getCoordinate();return rn.equals2D(Se)?rt.INTERIOR:rt.EXTERIOR}},locateInPolygonRing:function(t,n){return n.getEnvelopeInternal().intersects(t)?re.locatePointInRing(t,n.getCoordinates()):rt.EXTERIOR},intersects:function(t,n){return this.locate(t,n)!==rt.EXTERIOR},updateLocationInfo:function(t){t===rt.INTERIOR&&(this.isIn=!0),t===rt.BOUNDARY&&this.numBoundaries++},computeLocation:function(t,n){if(n instanceof rr&&this.updateLocationInfo(this.locateInternal(t,n)),n instanceof oi)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof Pi)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof Ki)for(var l=n,d=0;d<l.getNumGeometries();d++){var v=l.getGeometryN(d);this.updateLocationInfo(this.locateInternal(t,v))}else if(n instanceof Ct)for(var C=n,d=0;d<C.getNumGeometries();d++){var z=C.getGeometryN(d);this.updateLocationInfo(this.locateInternal(t,z))}else if(n instanceof ri)for(var W=new be(n);W.hasNext();){var gt=W.next();gt!==n&&this.computeLocation(t,gt)}},locate:function(t,n){return n.isEmpty()?rt.EXTERIOR:n instanceof oi?this.locateInternal(t,n):n instanceof Pi?this.locateInternal(t,n):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,n),this.boundaryRule.isInBoundary(this.numBoundaries)?rt.BOUNDARY:this.numBoundaries>0||this.isIn?rt.INTERIOR:rt.EXTERIOR)},interfaces_:function(){return[]},getClass:function(){return en}}),T(nn.prototype,{interfaces_:function(){return[]},getClass:function(){return nn}}),nn.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new q;var l=Math.abs(t),d=Math.abs(n);return t>=0?n>=0?l>=d?0:1:l>=d?7:6:n>=0?l>=d?3:2:l>=d?4:5}if(arguments[0]instanceof it&&arguments[1]instanceof it){var v=arguments[0],C=arguments[1],z=C.x-v.x,W=C.y-v.y;if(z===0&&W===0)throw new q;return nn.octant(z,W)}},T(wn.prototype,{getCoordinates:function(){},size:function(){},getCoordinate:function(t){},isClosed:function(){},setData:function(t){},getData:function(){},interfaces_:function(){return[]},getClass:function(){return wn}}),T(we.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:nn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},getData:function(){return this.data},toString:function(){return Ns.toLineString(new ue(this.pts))},interfaces_:function(){return[wn]},getClass:function(){return we}}),T(Qe.prototype,{getBounds:function(){},interfaces_:function(){return[]},getClass:function(){return Qe}}),T(Tn.prototype,{getItem:function(){return this.item},getBounds:function(){return this.bounds},interfaces_:function(){return[Qe,tt]},getClass:function(){return Tn}}),T(Yn.prototype,{poll:function(){if(this.isEmpty())return null;var t=this.items.get(1);return this.items.set(1,this.items.get(this._size)),this._size-=1,this.reorder(1),t},size:function(){return this._size},reorder:function(t){for(var n=null,l=this.items.get(t);2*t<=this._size&&(n=2*t,n!==this._size&&this.items.get(n+1).compareTo(this.items.get(n))<0&&n++,this.items.get(n).compareTo(l)<0);t=n)this.items.set(t,this.items.get(n));this.items.set(t,l)},clear:function(){this._size=0,this.items.clear()},isEmpty:function(){return this._size===0},add:function(t){this.items.add(null),this._size+=1;var n=this._size;for(this.items.set(0,t);t.compareTo(this.items.get(Math.trunc(n/2)))<0;n/=2)this.items.set(n,this.items.get(Math.trunc(n/2)));this.items.set(n,t)},interfaces_:function(){return[]},getClass:function(){return Yn}}),T(Pn.prototype,{visitItem:function(t){},interfaces_:function(){return[]},getClass:function(){return Pn}}),T(Ni.prototype,{insert:function(t,n){},remove:function(t,n){},query:function(){},interfaces_:function(){return[]},getClass:function(){return Ni}}),T(ke.prototype,{getLevel:function(){return this.level},size:function(){return this.childBoundables.size()},getChildBoundables:function(){return this.childBoundables},addChildBoundable:function(t){yt.isTrue(this.bounds===null),this.childBoundables.add(t)},isEmpty:function(){return this.childBoundables.isEmpty()},getBounds:function(){return this.bounds===null&&(this.bounds=this.computeBounds()),this.bounds},interfaces_:function(){return[Qe,tt]},getClass:function(){return ke}}),ke.serialVersionUID=6493722185909574e3;var tn={reverseOrder:function(){return{compare:function(t,n){return n.compareTo(t)}}},min:function(t){return tn.sort(t),t.get(0)},sort:function(t,n){var l=t.toArray();n?hs.sort(l,n):hs.sort(l);for(var d=t.iterator(),v=0,C=l.length;C>v;v++)d.next(),d.set(l[v])},singletonList:function(t){var n=new _t;return n.add(t),n}};T(_n.prototype,{expandToQueue:function(t,n){var l=_n.isComposite(this.boundable1),d=_n.isComposite(this.boundable2);if(l&&d)return _n.area(this.boundable1)>_n.area(this.boundable2)?(this.expand(this.boundable1,this.boundable2,t,n),null):(this.expand(this.boundable2,this.boundable1,t,n),null);if(l)return this.expand(this.boundable1,this.boundable2,t,n),null;if(d)return this.expand(this.boundable2,this.boundable1,t,n),null;throw new q},isLeaves:function(){return!(_n.isComposite(this.boundable1)||_n.isComposite(this.boundable2))},compareTo:function(t){var n=t;return this._distance<n._distance?-1:this._distance>n._distance?1:0},expand:function(t,n,l,d){for(var v=t.getChildBoundables(),C=v.iterator();C.hasNext();){var z=C.next(),W=new _n(z,n,this.itemDistance);W.getDistance()<d&&l.add(W)}},getBoundable:function(t){return t===0?this.boundable1:this.boundable2},getDistance:function(){return this._distance},distance:function(){return this.isLeaves()?this.itemDistance.distance(this.boundable1,this.boundable2):this.boundable1.getBounds().distance(this.boundable2.getBounds())},interfaces_:function(){return[J]},getClass:function(){return _n}}),_n.area=function(t){return t.getBounds().getArea()},_n.isComposite=function(t){return t instanceof ke},T(kn.prototype,{getNodeCapacity:function(){return this.nodeCapacity},lastNode:function(t){return t.get(t.size()-1)},size:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this.root));if(arguments.length===1){for(var n=arguments[0],l=0,d=n.getChildBoundables().iterator();d.hasNext();){var v=d.next();v instanceof ke?l+=this.size(v):v instanceof Tn&&(l+=1)}return l}},removeItem:function(t,n){for(var l=null,d=t.getChildBoundables().iterator();d.hasNext();){var v=d.next();v instanceof Tn&&v.getItem()===n&&(l=v)}return l!==null?(t.getChildBoundables().remove(l),!0):!1},itemsTree:function(){if(arguments.length===0){this.build();var t=this.itemsTree(this.root);return t===null?new _t:t}if(arguments.length===1){for(var n=arguments[0],l=new _t,d=n.getChildBoundables().iterator();d.hasNext();){var v=d.next();if(v instanceof ke){var C=this.itemsTree(v);C!==null&&l.add(C)}else v instanceof Tn?l.add(v.getItem()):yt.shouldNeverReachHere()}return l.size()<=0?null:l}},insert:function(t,n){yt.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.add(new Tn(t,n))},boundablesAtLevel:function(){if(arguments.length===1){var t=arguments[0],n=new _t;return this.boundablesAtLevel(t,this.root,n),n}if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];if(yt.isTrue(l>-2),d.getLevel()===l)return v.add(d),null;for(var C=d.getChildBoundables().iterator();C.hasNext();){var z=C.next();z instanceof ke?this.boundablesAtLevel(l,z,v):(yt.isTrue(z instanceof Tn),l===-1&&v.add(z))}return null}},query:function(){if(arguments.length===1){var t=arguments[0];this.build();var n=new _t;return this.isEmpty()||this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query(t,this.root,n),n}if(arguments.length===2){var l=arguments[0],d=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this.root.getBounds(),l)&&this.query(l,this.root,d)}else if(arguments.length===3){if(qe(arguments[2],Pn)&&arguments[0]instanceof Object&&arguments[1]instanceof ke)for(var v=arguments[0],C=arguments[1],z=arguments[2],W=C.getChildBoundables(),gt=0;gt<W.size();gt++){var Bt=W.get(gt);this.getIntersectsOp().intersects(Bt.getBounds(),v)&&(Bt instanceof ke?this.query(v,Bt,z):Bt instanceof Tn?z.visitItem(Bt.getItem()):yt.shouldNeverReachHere())}else if(qe(arguments[2],pt)&&arguments[0]instanceof Object&&arguments[1]instanceof ke)for(var Se=arguments[0],Ae=arguments[1],rn=arguments[2],W=Ae.getChildBoundables(),gt=0;gt<W.size();gt++){var Bt=W.get(gt);this.getIntersectsOp().intersects(Bt.getBounds(),Se)&&(Bt instanceof ke?this.query(Se,Bt,rn):Bt instanceof Tn?rn.add(Bt.getItem()):yt.shouldNeverReachHere())}}},build:function(){return this.built?null:(this.root=this.itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.itemBoundables=null,void(this.built=!0))},getRoot:function(){return this.build(),this.root},remove:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.build(),this.getIntersectsOp().intersects(this.root.getBounds(),t)?this.remove(t,this.root,n):!1}if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2],C=this.removeItem(d,v);if(C)return!0;for(var z=null,W=d.getChildBoundables().iterator();W.hasNext();){var gt=W.next();if(this.getIntersectsOp().intersects(gt.getBounds(),l)&&gt instanceof ke&&(C=this.remove(l,gt,v))){z=gt;break}}return z!==null&&z.getChildBoundables().isEmpty()&&d.getChildBoundables().remove(z),C}},createHigherLevels:function(t,n){yt.isTrue(!t.isEmpty());var l=this.createParentBoundables(t,n+1);return l.size()===1?l.get(0):this.createHigherLevels(l,n+1)},depth:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this.root));if(arguments.length===1){for(var t=arguments[0],n=0,l=t.getChildBoundables().iterator();l.hasNext();){var d=l.next();if(d instanceof ke){var v=this.depth(d);v>n&&(n=v)}}return n+1}},createParentBoundables:function(t,n){yt.isTrue(!t.isEmpty());var l=new _t;l.add(this.createNode(n));var d=new _t(t);tn.sort(d,this.getComparator());for(var v=d.iterator();v.hasNext();){var C=v.next();this.lastNode(l).getChildBoundables().size()===this.getNodeCapacity()&&l.add(this.createNode(n)),this.lastNode(l).addChildBoundable(C)}return l},isEmpty:function(){return this.built?this.root.isEmpty():this.itemBoundables.isEmpty()},interfaces_:function(){return[tt]},getClass:function(){return kn}}),kn.compareDoubles=function(t,n){return t>n?1:n>t?-1:0},kn.IntersectsOp=Xi,kn.serialVersionUID=-3886435814360241e3,kn.DEFAULT_NODE_CAPACITY=10,T(Wi.prototype,{distance:function(t,n){},interfaces_:function(){return[]},getClass:function(){return Wi}}),st(xn,kn),T(xn.prototype,{createParentBoundablesFromVerticalSlices:function(t,n){yt.isTrue(t.length>0);for(var l=new _t,d=0;d<t.length;d++)l.addAll(this.createParentBoundablesFromVerticalSlice(t[d],n));return l},createNode:function(t){return new gr(t)},size:function(){return arguments.length===0?kn.prototype.size.call(this):kn.prototype.size.apply(this,arguments)},insert:function(){if(arguments.length!==2)return kn.prototype.insert.apply(this,arguments);var t=arguments[0],n=arguments[1];return t.isNull()?null:void kn.prototype.insert.call(this,t,n)},getIntersectsOp:function(){return xn.intersectsOp},verticalSlices:function(t,n){for(var l=Math.trunc(Math.ceil(t.size()/n)),d=new Array(n).fill(null),v=t.iterator(),C=0;n>C;C++){d[C]=new _t;for(var z=0;v.hasNext()&&l>z;){var W=v.next();d[C].add(W),z++}}return d},query:function(){if(arguments.length===1){var t=arguments[0];return kn.prototype.query.call(this,t)}if(arguments.length===2){var n=arguments[0],l=arguments[1];kn.prototype.query.call(this,n,l)}else if(arguments.length===3){if(qe(arguments[2],Pn)&&arguments[0]instanceof Object&&arguments[1]instanceof ke){var d=arguments[0],v=arguments[1],C=arguments[2];kn.prototype.query.call(this,d,v,C)}else if(qe(arguments[2],pt)&&arguments[0]instanceof Object&&arguments[1]instanceof ke){var z=arguments[0],W=arguments[1],gt=arguments[2];kn.prototype.query.call(this,z,W,gt)}}},getComparator:function(){return xn.yComparator},createParentBoundablesFromVerticalSlice:function(t,n){return kn.prototype.createParentBoundables.call(this,t,n)},remove:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return kn.prototype.remove.call(this,t,n)}return kn.prototype.remove.apply(this,arguments)},depth:function(){return arguments.length===0?kn.prototype.depth.call(this):kn.prototype.depth.apply(this,arguments)},createParentBoundables:function(t,n){yt.isTrue(!t.isEmpty());var l=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),d=new _t(t);tn.sort(d,xn.xComparator);var v=this.verticalSlices(d,Math.trunc(Math.ceil(Math.sqrt(l))));return this.createParentBoundablesFromVerticalSlices(v,n)},nearestNeighbour:function(){if(arguments.length===1){if(qe(arguments[0],Wi)){var t=arguments[0],n=new _n(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(n)}if(arguments[0]instanceof _n){var l=arguments[0];return this.nearestNeighbour(l,j.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof xn&&qe(arguments[1],Wi)){var d=arguments[0],v=arguments[1],n=new _n(this.getRoot(),d.getRoot(),v);return this.nearestNeighbour(n)}if(arguments[0]instanceof _n&&typeof arguments[1]=="number"){var C=arguments[0],z=arguments[1],W=z,gt=null,Bt=new Yn;for(Bt.add(C);!Bt.isEmpty()&&W>0;){var Se=Bt.poll(),Ae=Se.getDistance();if(Ae>=W)break;Se.isLeaves()?(W=Ae,gt=Se):Se.expandToQueue(Bt,W)}return[gt.getBoundable(0).getItem(),gt.getBoundable(1).getItem()]}}else if(arguments.length===3){var rn=arguments[0],Nn=arguments[1],ei=arguments[2],ci=new Tn(rn,Nn),n=new _n(this.getRoot(),ci,ei);return this.nearestNeighbour(n)[0]}},interfaces_:function(){return[Ni,tt]},getClass:function(){return xn}}),xn.centreX=function(t){return xn.avg(t.getMinX(),t.getMaxX())},xn.avg=function(t,n){return(t+n)/2},xn.centreY=function(t){return xn.avg(t.getMinY(),t.getMaxY())},st(gr,ke),T(gr.prototype,{computeBounds:function(){for(var t=null,n=this.getChildBoundables().iterator();n.hasNext();){var l=n.next();t===null?t=new Xt(l.getBounds()):t.expandToInclude(l.getBounds())}return t},interfaces_:function(){return[]},getClass:function(){return gr}}),xn.STRtreeNode=gr,xn.serialVersionUID=0x39920f7d5f261e0,xn.xComparator={interfaces_:function(){return[X]},compare:function(t,n){return kn.compareDoubles(xn.centreX(t.getBounds()),xn.centreX(n.getBounds()))}},xn.yComparator={interfaces_:function(){return[X]},compare:function(t,n){return kn.compareDoubles(xn.centreY(t.getBounds()),xn.centreY(n.getBounds()))}},xn.intersectsOp={interfaces_:function(){return[IntersectsOp]},intersects:function(t,n){return t.intersects(n)}},xn.DEFAULT_NODE_CAPACITY=10,T(ur.prototype,{interfaces_:function(){return[]},getClass:function(){return ur}}),ur.relativeSign=function(t,n){return n>t?-1:t>n?1:0},ur.compare=function(t,n,l){if(n.equals2D(l))return 0;var d=ur.relativeSign(n.x,l.x),v=ur.relativeSign(n.y,l.y);switch(t){case 0:return ur.compareValue(d,v);case 1:return ur.compareValue(v,d);case 2:return ur.compareValue(v,-d);case 3:return ur.compareValue(-d,v);case 4:return ur.compareValue(-d,-v);case 5:return ur.compareValue(-v,-d);case 6:return ur.compareValue(-v,d);case 7:return ur.compareValue(d,-v)}return yt.shouldNeverReachHere("invalid octant value"),0},ur.compareValue=function(t,n){return 0>t?-1:t>0?1:0>n?-1:n>0?1:0},T(qi.prototype,{getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},compareTo:function(t){var n=t;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:ur.compare(this.segmentOctant,this.coord,n.coord)},isEndPoint:function(t){return this.segmentIndex!==0||this._isInterior?this.segmentIndex===t:!0},isInterior:function(){return this._isInterior},interfaces_:function(){return[J]},getClass:function(){return qi}}),T(Yr.prototype,{getSplitCoordinates:function(){var t=new Jt;this.addEndpoints();for(var n=this.iterator(),l=n.next();n.hasNext();){var d=n.next();this.addEdgeCoordinates(l,d,t),l=d}return t.toCoordinateArray()},addCollapsedNodes:function(){var t=new _t;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var n=t.iterator();n.hasNext();){var l=n.next().intValue();this.add(this.edge.getCoordinate(l),l)}},print:function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var l=n.next();l.print(t)}},findCollapsesFromExistingVertices:function(t){for(var n=0;n<this.edge.size()-2;n++){var l=this.edge.getCoordinate(n),d=(this.edge.getCoordinate(n+1),this.edge.getCoordinate(n+2));l.equals2D(d)&&t.add(new ct(n+1))}},addEdgeCoordinates:function(t,n,l){n.segmentIndex-t.segmentIndex+2;var d=this.edge.getCoordinate(n.segmentIndex),v=n.isInterior()||!n.coord.equals2D(d);l.add(new it(t.coord),!1);for(var C=t.segmentIndex+1;C<=n.segmentIndex;C++)l.add(this.edge.getCoordinate(C));v&&l.add(new it(n.coord))},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var n=this.iterator(),l=n.next();n.hasNext();){var d=n.next(),v=this.createSplitEdge(l,d);t.add(v),l=d}},findCollapseIndex:function(t,n,l){if(!t.coord.equals2D(n.coord))return!1;var d=n.segmentIndex-t.segmentIndex;return n.isInterior()||d--,d===1?(l[0]=t.segmentIndex+1,!0):!1},findCollapsesFromInsertedNodes:function(t){for(var n=new Array(1).fill(null),l=this.iterator(),d=l.next();l.hasNext();){var v=l.next(),C=this.findCollapseIndex(d,v,n);C&&t.add(new ct(n[0])),d=v}},getEdge:function(){return this.edge},addEndpoints:function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},createSplitEdge:function(t,n){var l=n.segmentIndex-t.segmentIndex+2,d=this.edge.getCoordinate(n.segmentIndex),v=n.isInterior()||!n.coord.equals2D(d);v||l--;var C=new Array(l).fill(null),z=0;C[z++]=new it(t.coord);for(var W=t.segmentIndex+1;W<=n.segmentIndex;W++)C[z++]=this.edge.getCoordinate(W);return v&&(C[z]=new it(n.coord)),new Co(C,this.edge.getData())},add:function(t,n){var l=new qi(this.edge,t,n,this.edge.getSegmentOctant(n)),d=this.nodeMap.get(l);return d!==null?(yt.isTrue(d.coord.equals2D(t),"Found equal nodes with different coordinates"),d):(this.nodeMap.put(l,l),l)},checkSplitEdgesCorrectness:function(t){var n=this.edge.getCoordinates(),l=t.get(0),d=l.getCoordinate(0);if(!d.equals2D(n[0]))throw new ht("bad split edge start point at "+d);var v=t.get(t.size()-1),C=v.getCoordinates(),z=C[C.length-1];if(!z.equals2D(n[n.length-1]))throw new ht("bad split edge end point at "+z)},interfaces_:function(){return[]},getClass:function(){return Yr}}),T(ss.prototype,{next:function(){return this.currNode===null?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):this.nextNode===null?null:this.nextNode.segmentIndex===this.currNode.segmentIndex?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):(this.nextNode.segmentIndex>this.currNode.segmentIndex,null)},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){return this.nextNode!==null},readNextNode:function(){this.nodeIt.hasNext()?this.nextNode=this.nodeIt.next():this.nextNode=null},interfaces_:function(){return[le]},getClass:function(){return ss}}),T(Da.prototype,{addIntersection:function(t,n){},interfaces_:function(){return[wn]},getClass:function(){return Da}}),T(Co.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},safeOctant:function(t,n){return t.equals2D(n)?0:nn.octant(t,n)},getData:function(){return this.data},addIntersection:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.addIntersectionNode(t,n)}else if(arguments.length===4){var l=arguments[0],d=arguments[1],v=arguments[3],C=new it(l.getIntersection(v));this.addIntersection(C,d)}},toString:function(){return Ns.toLineString(new ue(this.pts))},getNodeList:function(){return this.nodeList},addIntersectionNode:function(t,n){var l=n,d=l+1;if(d<this.pts.length){var v=this.pts[d];t.equals2D(v)&&(l=d)}var C=this.nodeList.add(t,l);return C},addIntersections:function(t,n,l){for(var d=0;d<t.getIntersectionNum();d++)this.addIntersection(t,n,l,d)},interfaces_:function(){return[Da]},getClass:function(){return Co}}),Co.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],n=new _t;return Co.getNodedSubstrings(t,n),n}if(arguments.length===2)for(var l=arguments[0],d=arguments[1],v=l.iterator();v.hasNext();){var C=v.next();C.getNodeList().addSplitEdges(d)}},T(no.prototype,{overlap:function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3];t.getLineSegment(n,this.overlapSeg1),l.getLineSegment(d,this.overlapSeg2),this.overlap(this.overlapSeg1,this.overlapSeg2)}}},interfaces_:function(){return[]},getClass:function(){return no}}),T(fs.prototype,{getLineSegment:function(t,n){n.p0=this.pts[t],n.p1=this.pts[t+1]},computeSelect:function(t,n,l,d){var v=this.pts[n],C=this.pts[l];if(d.tempEnv1.init(v,C),l-n===1)return d.select(this,n),null;if(!t.intersects(d.tempEnv1))return null;var z=Math.trunc((n+l)/2);z>n&&this.computeSelect(t,n,z,d),l>z&&this.computeSelect(t,z,l,d)},getCoordinates:function(){for(var t=new Array(this.end-this.start+1).fill(null),n=0,l=this.start;l<=this.end;l++)t[n++]=this.pts[l];return t},computeOverlaps:function(t,n){this.computeOverlapsInternal(this.start,this.end,t,t.start,t.end,n)},setId:function(t){this.id=t},select:function(t,n){this.computeSelect(t,this.start,this.end,n)},getEnvelope:function(){if(this.env===null){var t=this.pts[this.start],n=this.pts[this.end];this.env=new Xt(t,n)}return this.env},getEndIndex:function(){return this.end},getStartIndex:function(){return this.start},getContext:function(){return this.context},getId:function(){return this.id},computeOverlapsInternal:function(t,n,l,d,v,C){var z=this.pts[t],W=this.pts[n],gt=l.pts[d],Bt=l.pts[v];if(n-t===1&&v-d===1)return C.overlap(this,t,l,d),null;if(C.tempEnv1.init(z,W),C.tempEnv2.init(gt,Bt),!C.tempEnv1.intersects(C.tempEnv2))return null;var Se=Math.trunc((t+n)/2),Ae=Math.trunc((d+v)/2);Se>t&&(Ae>d&&this.computeOverlapsInternal(t,Se,l,d,Ae,C),v>Ae&&this.computeOverlapsInternal(t,Se,l,Ae,v,C)),n>Se&&(Ae>d&&this.computeOverlapsInternal(Se,n,l,d,Ae,C),v>Ae&&this.computeOverlapsInternal(Se,n,l,Ae,v,C))},interfaces_:function(){return[]},getClass:function(){return fs}}),T(Ci.prototype,{interfaces_:function(){return[]},getClass:function(){return Ci}}),Ci.isNorthern=function(t){return t===Ci.NE||t===Ci.NW},Ci.isOpposite=function(t,n){if(t===n)return!1;var l=(t-n+4)%4;return l===2},Ci.commonHalfPlane=function(t,n){if(t===n)return t;var l=(t-n+4)%4;if(l===2)return-1;var d=n>t?t:n,v=t>n?t:n;return d===0&&v===3?3:d},Ci.isInHalfPlane=function(t,n){return n===Ci.SE?t===Ci.SE||t===Ci.SW:t===n||t===n+1},Ci.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new q;return t>=0?n>=0?Ci.NE:Ci.SE:n>=0?Ci.NW:Ci.SW}if(arguments[0]instanceof it&&arguments[1]instanceof it){var l=arguments[0],d=arguments[1];if(d.x===l.x&&d.y===l.y)throw new q;return d.x>=l.x?d.y>=l.y?Ci.NE:Ci.SE:d.y>=l.y?Ci.NW:Ci.SW}},Ci.NE=0,Ci.NW=1,Ci.SW=2,Ci.SE=3,T(ho.prototype,{interfaces_:function(){return[]},getClass:function(){return ho}}),ho.getChainStartIndices=function(t){var n=0,l=new _t;l.add(new ct(n));do{var d=ho.findChainEnd(t,n);l.add(new ct(d)),n=d}while(n<t.length-1);var v=ho.toIntArray(l);return v},ho.findChainEnd=function(t,n){for(var l=n;l<t.length-1&&t[l].equals2D(t[l+1]);)l++;if(l>=t.length-1)return t.length-1;for(var d=Ci.quadrant(t[l],t[l+1]),v=n+1;v<t.length;){if(!t[v-1].equals2D(t[v])){var C=Ci.quadrant(t[v-1],t[v]);if(C!==d)break}v++}return v-1},ho.getChains=function(){if(arguments.length===1){var t=arguments[0];return ho.getChains(t,null)}if(arguments.length===2){for(var n=arguments[0],l=arguments[1],d=new _t,v=ho.getChainStartIndices(n),C=0;C<v.length-1;C++){var z=new fs(n,v[C],v[C+1],l);d.add(z)}return d}},ho.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),l=0;l<n.length;l++)n[l]=t.get(l).intValue();return n},T(fo.prototype,{computeNodes:function(t){},getNodedSubstrings:function(){},interfaces_:function(){return[]},getClass:function(){return fo}}),T(io.prototype,{setSegmentIntersector:function(t){this.segInt=t},interfaces_:function(){return[fo]},getClass:function(){return io}}),st(jo,io),T(jo.prototype,{getMonotoneChains:function(){return this.monoChains},getNodedSubstrings:function(){return Co.getNodedSubstrings(this.nodedSegStrings)},getIndex:function(){return this.index},add:function(t){for(var n=ho.getChains(t.getCoordinates(),t),l=n.iterator();l.hasNext();){var d=l.next();d.setId(this.idCounter++),this.index.insert(d.getEnvelope(),d),this.monoChains.add(d)}},computeNodes:function(t){this.nodedSegStrings=t;for(var n=t.iterator();n.hasNext();)this.add(n.next());this.intersectChains()},intersectChains:function(){for(var t=new Io(this.segInt),n=this.monoChains.iterator();n.hasNext();)for(var l=n.next(),d=this.index.query(l.getEnvelope()),v=d.iterator();v.hasNext();){var C=v.next();if(C.getId()>l.getId()&&(l.computeOverlaps(C,t),this.nOverlaps++),this.segInt.isDone())return null}},interfaces_:function(){return[]},getClass:function(){return jo}}),st(Io,no),T(Io.prototype,{overlap:function(){if(arguments.length!==4)return no.prototype.overlap.apply(this,arguments);var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3],v=t.getContext(),C=l.getContext();this.si.processIntersections(v,n,C,d)},interfaces_:function(){return[]},getClass:function(){return Io}}),jo.SegmentOverlapAction=Io,st(Cs,ht),T(Cs.prototype,{getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Cs}}),Cs.msgWithCoord=function(t,n){return n!==null?t+" [ "+n+" ]":t},T(ro.prototype,{processIntersections:function(t,n,l,d){},isDone:function(){},interfaces_:function(){return[]},getClass:function(){return ro}}),T(Os.prototype,{getInteriorIntersection:function(){return this.interiorIntersection},setCheckEndSegmentsOnly:function(t){this.isCheckEndSegmentsOnly=t},getIntersectionSegments:function(){return this.intSegments},count:function(){return this.intersectionCount},getIntersections:function(){return this.intersections},setFindAllIntersections:function(t){this.findAllIntersections=t},setKeepIntersections:function(t){this.keepIntersections=t},processIntersections:function(t,n,l,d){if(!this.findAllIntersections&&this.hasIntersection()||t===l&&n===d)return null;if(this.isCheckEndSegmentsOnly){var v=this.isEndSegment(t,n)||this.isEndSegment(l,d);if(!v)return null}var C=t.getCoordinates()[n],z=t.getCoordinates()[n+1],W=l.getCoordinates()[d],gt=l.getCoordinates()[d+1];this.li.computeIntersection(C,z,W,gt),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=new Array(4).fill(null),this.intSegments[0]=C,this.intSegments[1]=z,this.intSegments[2]=W,this.intSegments[3]=gt,this.interiorIntersection=this.li.getIntersection(0),this.keepIntersections&&this.intersections.add(this.interiorIntersection),this.intersectionCount++)},isEndSegment:function(t,n){return n===0?!0:n>=t.size()-2},hasIntersection:function(){return this.interiorIntersection!==null},isDone:function(){return this.findAllIntersections?!1:this.interiorIntersection!==null},interfaces_:function(){return[ro]},getClass:function(){return Os}}),Os.createAllIntersectionsFinder=function(t){var n=new Os(t);return n.setFindAllIntersections(!0),n},Os.createAnyIntersectionFinder=function(t){return new Os(t)},Os.createIntersectionCounter=function(t){var n=new Os(t);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n},T(Pu.prototype,{execute:function(){return this.segInt!==null?null:void this.checkInteriorIntersections()},getIntersections:function(){return this.segInt.getIntersections()},isValid:function(){return this.execute(),this._isValid},setFindAllIntersections:function(t){this.findAllIntersections=t},checkInteriorIntersections:function(){this._isValid=!0,this.segInt=new Os(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new jo;return t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection()?(this._isValid=!1,null):void 0},checkValid:function(){if(this.execute(),!this._isValid)throw new Cs(this.getErrorMessage(),this.segInt.getInteriorIntersection())},getErrorMessage:function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+Ns.toLineString(t[0],t[1])+" and "+Ns.toLineString(t[2],t[3])},interfaces_:function(){return[]},getClass:function(){return Pu}}),Pu.computeIntersections=function(t){var n=new Pu(t);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()},T(Qa.prototype,{checkValid:function(){this.nv.checkValid()},interfaces_:function(){return[]},getClass:function(){return Qa}}),Qa.toSegmentStrings=function(t){for(var n=new _t,l=t.iterator();l.hasNext();){var d=l.next();n.add(new we(d.getCoordinates(),d))}return n},Qa.checkValid=function(t){var n=new Qa(t);n.checkValid()},T(xl.prototype,{map:function(t){for(var n=new _t,l=0;l<t.getNumGeometries();l++){var d=this.mapOp.map(t.getGeometryN(l));d.isEmpty()||n.add(d)}return t.getFactory().createGeometryCollection(Rn.toGeometryArray(n))},interfaces_:function(){return[]},getClass:function(){return xl}}),xl.map=function(t,n){var l=new xl(n);return l.map(t)},T(Ke.prototype,{interfaces_:function(){return[]},getClass:function(){return Ke}}),Ke.opposite=function(t){return t===Ke.LEFT?Ke.RIGHT:t===Ke.RIGHT?Ke.LEFT:t},Ke.ON=0,Ke.LEFT=1,Ke.RIGHT=2,T(Hs.prototype,{setAllLocations:function(t){for(var n=0;n<this.location.length;n++)this.location[n]=t},isNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==rt.NONE)return!1;return!0},setAllLocationsIfNull:function(t){for(var n=0;n<this.location.length;n++)this.location[n]===rt.NONE&&(this.location[n]=t)},isLine:function(){return this.location.length===1},merge:function(t){if(t.location.length>this.location.length){var n=new Array(3).fill(null);n[Ke.ON]=this.location[Ke.ON],n[Ke.LEFT]=rt.NONE,n[Ke.RIGHT]=rt.NONE,this.location=n}for(var l=0;l<this.location.length;l++)this.location[l]===rt.NONE&&l<t.location.length&&(this.location[l]=t.location[l])},getLocations:function(){return this.location},flip:function(){if(this.location.length<=1)return null;var t=this.location[Ke.LEFT];this.location[Ke.LEFT]=this.location[Ke.RIGHT],this.location[Ke.RIGHT]=t},toString:function(){var t=new Xn;return this.location.length>1&&t.append(rt.toLocationSymbol(this.location[Ke.LEFT])),t.append(rt.toLocationSymbol(this.location[Ke.ON])),this.location.length>1&&t.append(rt.toLocationSymbol(this.location[Ke.RIGHT])),t.toString()},setLocations:function(t,n,l){this.location[Ke.ON]=t,this.location[Ke.LEFT]=n,this.location[Ke.RIGHT]=l},get:function(t){return t<this.location.length?this.location[t]:rt.NONE},isArea:function(){return this.location.length>1},isAnyNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===rt.NONE)return!0;return!1},setLocation:function(){if(arguments.length===1){var t=arguments[0];this.setLocation(Ke.ON,t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.location[n]=l}},init:function(t){this.location=new Array(t).fill(null),this.setAllLocations(rt.NONE)},isEqualOnSide:function(t,n){return this.location[n]===t.location[n]},allPositionsEqual:function(t){for(var n=0;n<this.location.length;n++)if(this.location[n]!==t)return!1;return!0},interfaces_:function(){return[]},getClass:function(){return Hs}}),T(wr.prototype,{getGeometryCount:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},setAllLocations:function(t,n){this.elt[t].setAllLocations(n)},isNull:function(t){return this.elt[t].isNull()},setAllLocationsIfNull:function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1];this.elt[n].setAllLocationsIfNull(l)}},isLine:function(t){return this.elt[t].isLine()},merge:function(t){for(var n=0;2>n;n++)this.elt[n]===null&&t.elt[n]!==null?this.elt[n]=new Hs(t.elt[n]):this.elt[n].merge(t.elt[n])},flip:function(){this.elt[0].flip(),this.elt[1].flip()},getLocation:function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(Ke.ON)}if(arguments.length===2){var n=arguments[0],l=arguments[1];return this.elt[n].get(l)}},toString:function(){var t=new Xn;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},isArea:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}},isAnyNull:function(t){return this.elt[t].isAnyNull()},setLocation:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setLocation(Ke.ON,n)}else if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];this.elt[l].setLocation(d,v)}},isEqualOnSide:function(t,n){return this.elt[0].isEqualOnSide(t.elt[0],n)&&this.elt[1].isEqualOnSide(t.elt[1],n)},allPositionsEqual:function(t,n){return this.elt[t].allPositionsEqual(n)},toLine:function(t){this.elt[t].isArea()&&(this.elt[t]=new Hs(this.elt[t].location[0]))},interfaces_:function(){return[]},getClass:function(){return wr}}),wr.toLineLabel=function(t){for(var n=new wr(rt.NONE),l=0;2>l;l++)n.setLocation(l,t.getLocation(l));return n},T(tl.prototype,{computeRing:function(){if(this.ring!==null)return null;for(var t=new Array(this.pts.size()).fill(null),n=0;n<this.pts.size();n++)t[n]=this.pts.get(n);this.ring=this.geometryFactory.createLinearRing(t),this._isHole=re.isCCW(this.ring.getCoordinates())},isIsolated:function(){return this.label.getGeometryCount()===1},computePoints:function(t){this.startDe=t;var n=t,l=!0;do{if(n===null)throw new Cs("Found null DirectedEdge");if(n.getEdgeRing()===this)throw new Cs("Directed Edge visited twice during ring-building at "+n.getCoordinate());this.edges.add(n);var d=n.getLabel();yt.isTrue(d.isArea()),this.mergeLabel(d),this.addPoints(n.getEdge(),n.isForward(),l),l=!1,this.setEdgeRing(n,this),n=this.getNext(n)}while(n!==this.startDe)},getLinearRing:function(){return this.ring},getCoordinate:function(t){return this.pts.get(t)},computeMaxNodeDegree:function(){this.maxNodeDegree=0;var t=this.startDe;do{var n=t.getNode(),l=n.getEdges().getOutgoingDegree(this);l>this.maxNodeDegree&&(this.maxNodeDegree=l),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},addPoints:function(t,n,l){var d=t.getCoordinates();if(n){var v=1;l&&(v=0);for(var C=v;C<d.length;C++)this.pts.add(d[C])}else{var v=d.length-2;l&&(v=d.length-1);for(var C=v;C>=0;C--)this.pts.add(d[C])}},isHole:function(){return this._isHole},setInResult:function(){var t=this.startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this.startDe)},containsPoint:function(t){var n=this.getLinearRing(),l=n.getEnvelopeInternal();if(!l.contains(t)||!re.isPointInRing(t,n.getCoordinates()))return!1;for(var d=this.holes.iterator();d.hasNext();){var v=d.next();if(v.containsPoint(t))return!1}return!0},addHole:function(t){this.holes.add(t)},isShell:function(){return this.shell===null},getLabel:function(){return this.label},getEdges:function(){return this.edges},getMaxNodeDegree:function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},getShell:function(){return this.shell},mergeLabel:function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var n=arguments[0],l=arguments[1],d=n.getLocation(l,Ke.RIGHT);if(d===rt.NONE)return null;if(this.label.getLocation(l)===rt.NONE)return this.label.setLocation(l,d),null}},setShell:function(t){this.shell=t,t!==null&&t.addHole(this)},toPolygon:function(t){for(var n=new Array(this.holes.size()).fill(null),l=0;l<this.holes.size();l++)n[l]=this.holes.get(l).getLinearRing();var d=t.createPolygon(this.getLinearRing(),n);return d},interfaces_:function(){return[]},getClass:function(){return tl}}),st(Xo,tl),T(Xo.prototype,{setEdgeRing:function(t,n){t.setMinEdgeRing(n)},getNext:function(t){return t.getNextMin()},interfaces_:function(){return[]},getClass:function(){return Xo}}),st(du,tl),T(du.prototype,{buildMinimalRings:function(){var t=new _t,n=this.startDe;do{if(n.getMinEdgeRing()===null){var l=new Xo(n,this.geometryFactory);t.add(l)}n=n.getNext()}while(n!==this.startDe);return t},setEdgeRing:function(t,n){t.setEdgeRing(n)},linkDirectedEdgesForMinimalEdgeRings:function(){var t=this.startDe;do{var n=t.getNode();n.getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this.startDe)},getNext:function(t){return t.getNext()},interfaces_:function(){return[]},getClass:function(){return du}}),T(Na.prototype,{setVisited:function(t){this._isVisited=t},setInResult:function(t){this._isInResult=t},isCovered:function(){return this._isCovered},isCoveredSet:function(){return this._isCoveredSet},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setCovered:function(t){this._isCovered=t,this._isCoveredSet=!0},updateIM:function(t){yt.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},isInResult:function(){return this._isInResult},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return Na}}),st(ia,Na),T(ia.prototype,{isIncidentEdgeInResult:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){var n=t.next();if(n.getEdge().isInResult())return!0}return!1},isIsolated:function(){return this.label.getGeometryCount()===1},getCoordinate:function(){return this.coord},print:function(t){t.println("node "+this.coord+" lbl: "+this.label)},computeIM:function(t){},computeMergedLocation:function(t,n){var l=rt.NONE;if(l=this.label.getLocation(n),!t.isNull(n)){var d=t.getLocation(n);l!==rt.BOUNDARY&&(l=d)}return l},setLabel:function(){if(arguments.length!==2)return Na.prototype.setLabel.apply(this,arguments);var t=arguments[0],n=arguments[1];this.label===null?this.label=new wr(t,n):this.label.setLocation(t,n)},getEdges:function(){return this.edges},mergeLabel:function(){if(arguments[0]instanceof ia){var t=arguments[0];this.mergeLabel(t.label)}else if(arguments[0]instanceof wr)for(var n=arguments[0],l=0;2>l;l++){var d=this.computeMergedLocation(n,l),v=this.label.getLocation(l);v===rt.NONE&&this.label.setLocation(l,d)}},add:function(t){this.edges.insert(t),t.setNode(this)},setLabelBoundary:function(t){if(this.label===null)return null;var n=rt.NONE;this.label!==null&&(n=this.label.getLocation(t));var l=null;switch(n){case rt.BOUNDARY:l=rt.INTERIOR;break;case rt.INTERIOR:l=rt.BOUNDARY;break;default:l=rt.BOUNDARY}this.label.setLocation(t,l)},interfaces_:function(){return[]},getClass:function(){return ia}}),T(Xl.prototype,{find:function(t){return this.nodeMap.get(t)},addNode:function(){if(arguments[0]instanceof it){var t=arguments[0],n=this.nodeMap.get(t);return n===null&&(n=this.nodeFact.createNode(t),this.nodeMap.put(t,n)),n}if(arguments[0]instanceof ia){var l=arguments[0],n=this.nodeMap.get(l.getCoordinate());return n===null?(this.nodeMap.put(l.getCoordinate(),l),l):(n.mergeLabel(l),n)}},print:function(t){for(var n=this.iterator();n.hasNext();){var l=n.next();l.print(t)}},iterator:function(){return this.nodeMap.values().iterator()},values:function(){return this.nodeMap.values()},getBoundaryNodes:function(t){for(var n=new _t,l=this.iterator();l.hasNext();){var d=l.next();d.getLabel().getLocation(t)===rt.BOUNDARY&&n.add(d)}return n},add:function(t){var n=t.getCoordinate(),l=this.addNode(n);l.add(t)},interfaces_:function(){return[]},getClass:function(){return Xl}}),T(zs.prototype,{compareDirection:function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:re.computeOrientation(t.p0,t.p1,this.p1)},getDy:function(){return this.dy},getCoordinate:function(){return this.p0},setNode:function(t){this.node=t},print:function(t){var n=Math.atan2(this.dy,this.dx),l=this.getClass().getName(),d=l.lastIndexOf("."),v=l.substring(d+1);t.print("  "+v+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+n+"   "+this.label)},compareTo:function(t){var n=t;return this.compareDirection(n)},getDirectedCoordinate:function(){return this.p1},getDx:function(){return this.dx},getLabel:function(){return this.label},getEdge:function(){return this.edge},getQuadrant:function(){return this.quadrant},getNode:function(){return this.node},toString:function(){var t=Math.atan2(this.dy,this.dx),n=this.getClass().getName(),l=n.lastIndexOf("."),d=n.substring(l+1);return"  "+d+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+t+"   "+this.label},computeLabel:function(t){},init:function(t,n){this.p0=t,this.p1=n,this.dx=n.x-t.x,this.dy=n.y-t.y,this.quadrant=Ci.quadrant(this.dx,this.dy),yt.isTrue(!(this.dx===0&&this.dy===0),"EdgeEnd with identical endpoints found")},interfaces_:function(){return[J]},getClass:function(){return zs}}),st(Oi,zs),T(Oi.prototype,{getNextMin:function(){return this.nextMin},getDepth:function(t){return this.depth[t]},setVisited:function(t){this._isVisited=t},computeDirectedLabel:function(){this.label=new wr(this.edge.getLabel()),this._isForward||this.label.flip()},getNext:function(){return this.next},setDepth:function(t,n){if(this.depth[t]!==-999&&this.depth[t]!==n)throw new Cs("assigned depths do not match",this.getCoordinate());this.depth[t]=n},isInteriorAreaEdge:function(){for(var n=!0,l=0;2>l;l++)this.label.isArea(l)&&this.label.getLocation(l,Ke.LEFT)===rt.INTERIOR&&this.label.getLocation(l,Ke.RIGHT)===rt.INTERIOR||(n=!1);return n},setNextMin:function(t){this.nextMin=t},print:function(t){zs.prototype.print.call(this,t),t.print(" "+this.depth[Ke.LEFT]+"/"+this.depth[Ke.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},setMinEdgeRing:function(t){this.minEdgeRing=t},isLineEdge:function(){var t=this.label.isLine(0)||this.label.isLine(1),n=!this.label.isArea(0)||this.label.allPositionsEqual(0,rt.EXTERIOR),l=!this.label.isArea(1)||this.label.allPositionsEqual(1,rt.EXTERIOR);return t&&n&&l},setEdgeRing:function(t){this.edgeRing=t},getMinEdgeRing:function(){return this.minEdgeRing},getDepthDelta:function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},setInResult:function(t){this._isInResult=t},getSym:function(){return this.sym},isForward:function(){return this._isForward},getEdge:function(){return this.edge},printEdge:function(t){this.print(t),t.print(" "),this._isForward?this.edge.print(t):this.edge.printReverse(t)},setSym:function(t){this.sym=t},setVisitedEdge:function(t){this.setVisited(t),this.sym.setVisited(t)},setEdgeDepths:function(t,n){var l=this.getEdge().getDepthDelta();this._isForward||(l=-l);var d=1;t===Ke.LEFT&&(d=-1);var v=Ke.opposite(t),C=l*d,z=n+C;this.setDepth(t,n),this.setDepth(v,z)},getEdgeRing:function(){return this.edgeRing},isInResult:function(){return this._isInResult},setNext:function(t){this.next=t},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return Oi}}),Oi.depthFactor=function(t,n){return t===rt.EXTERIOR&&n===rt.INTERIOR?1:t===rt.INTERIOR&&n===rt.EXTERIOR?-1:0},T(Mo.prototype,{createNode:function(t){return new ia(t,null)},interfaces_:function(){return[]},getClass:function(){return Mo}}),T(Ps.prototype,{printEdges:function(t){t.println("Edges:");for(var n=0;n<this.edges.size();n++){t.println("edge "+n+":");var l=this.edges.get(n);l.print(t),l.eiList.print(t)}},find:function(t){return this.nodes.find(t)},addNode:function(){if(arguments[0]instanceof ia){var t=arguments[0];return this.nodes.addNode(t)}if(arguments[0]instanceof it){var n=arguments[0];return this.nodes.addNode(n)}},getNodeIterator:function(){return this.nodes.iterator()},linkResultDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkResultDirectedEdges()}},debugPrintln:function(t){mt.out.println(t)},isBoundaryNode:function(t,n){var l=this.nodes.find(n);if(l===null)return!1;var d=l.getLabel();return d!==null&&d.getLocation(t)===rt.BOUNDARY},linkAllDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkAllDirectedEdges()}},matchInSameDirection:function(t,n,l,d){return t.equals(l)?re.computeOrientation(t,n,d)===re.COLLINEAR&&Ci.quadrant(t,n)===Ci.quadrant(l,d):!1},getEdgeEnds:function(){return this.edgeEndList},debugPrint:function(t){mt.out.print(t)},getEdgeIterator:function(){return this.edges.iterator()},findEdgeInSameDirection:function(t,n){for(var l=0;l<this.edges.size();l++){var d=this.edges.get(l),v=d.getCoordinates();if(this.matchInSameDirection(t,n,v[0],v[1])||this.matchInSameDirection(t,n,v[v.length-1],v[v.length-2]))return d}return null},insertEdge:function(t){this.edges.add(t)},findEdgeEnd:function(t){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var l=n.next();if(l.getEdge()===t)return l}return null},addEdges:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();this.edges.add(l);var d=new Oi(l,!0),v=new Oi(l,!1);d.setSym(v),v.setSym(d),this.add(d),this.add(v)}},add:function(t){this.nodes.add(t),this.edgeEndList.add(t)},getNodes:function(){return this.nodes.values()},findEdge:function(t,n){for(var l=0;l<this.edges.size();l++){var d=this.edges.get(l),v=d.getCoordinates();if(t.equals(v[0])&&n.equals(v[1]))return d}return null},interfaces_:function(){return[]},getClass:function(){return Ps}}),Ps.linkResultDirectedEdges=function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();l.getEdges().linkResultDirectedEdges()}},T(Ao.prototype,{sortShellsAndHoles:function(t,n,l){for(var d=t.iterator();d.hasNext();){var v=d.next();v.isHole()?l.add(v):n.add(v)}},computePolygons:function(t){for(var n=new _t,l=t.iterator();l.hasNext();){var d=l.next(),v=d.toPolygon(this.geometryFactory);n.add(v)}return n},placeFreeHoles:function(t,n){for(var l=n.iterator();l.hasNext();){var d=l.next();if(d.getShell()===null){var v=this.findEdgeRingContaining(d,t);if(v===null)throw new Cs("unable to assign hole to a shell",d.getCoordinate(0));d.setShell(v)}}},buildMinimalEdgeRings:function(t,n,l){for(var d=new _t,v=t.iterator();v.hasNext();){var C=v.next();if(C.getMaxNodeDegree()>2){C.linkDirectedEdgesForMinimalEdgeRings();var z=C.buildMinimalRings(),W=this.findShell(z);W!==null?(this.placePolygonHoles(W,z),n.add(W)):l.addAll(z)}else d.add(C)}return d},containsPoint:function(t){for(var n=this.shellList.iterator();n.hasNext();){var l=n.next();if(l.containsPoint(t))return!0}return!1},buildMaximalEdgeRings:function(t){for(var n=new _t,l=t.iterator();l.hasNext();){var d=l.next();if(d.isInResult()&&d.getLabel().isArea()&&d.getEdgeRing()===null){var v=new du(d,this.geometryFactory);n.add(v),v.setInResult()}}return n},placePolygonHoles:function(t,n){for(var l=n.iterator();l.hasNext();){var d=l.next();d.isHole()&&d.setShell(t)}},getPolygons:function(){var t=this.computePolygons(this.shellList);return t},findEdgeRingContaining:function(t,n){for(var l=t.getLinearRing(),d=l.getEnvelopeInternal(),v=l.getCoordinateN(0),C=null,z=null,W=n.iterator();W.hasNext();){var gt=W.next(),Bt=gt.getLinearRing(),Se=Bt.getEnvelopeInternal();C!==null&&(z=C.getLinearRing().getEnvelopeInternal());var Ae=!1;Se.contains(d)&&re.isPointInRing(v,Bt.getCoordinates())&&(Ae=!0),Ae&&(C===null||z.contains(Se))&&(C=gt)}return C},findShell:function(t){for(var n=0,l=null,d=t.iterator();d.hasNext();){var v=d.next();v.isHole()||(l=v,n++)}return yt.isTrue(1>=n,"found two shells in MinimalEdgeRing list"),l},add:function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var n=arguments[0],l=arguments[1];Ps.linkResultDirectedEdges(l);var d=this.buildMaximalEdgeRings(n),v=new _t,C=this.buildMinimalEdgeRings(d,this.shellList,v);this.sortShellsAndHoles(C,this.shellList,v),this.placeFreeHoles(this.shellList,v)}},interfaces_:function(){return[]},getClass:function(){return Ao}}),T(va.prototype,{collectLines:function(t){for(var n=this.op.getGraph().getEdgeEnds().iterator();n.hasNext();){var l=n.next();this.collectLineEdge(l,t,this.lineEdgesList),this.collectBoundaryTouchEdge(l,t,this.lineEdgesList)}},labelIsolatedLine:function(t,n){var l=this.ptLocator.locate(t.getCoordinate(),this.op.getArgGeometry(n));t.getLabel().setLocation(n,l)},build:function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},collectLineEdge:function(t,n,l){var d=t.getLabel(),v=t.getEdge();t.isLineEdge()&&(t.isVisited()||!mn.isResultOfOp(d,n)||v.isCovered()||(l.add(v),t.setVisitedEdge(!0)))},findCoveredLineEdges:function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();){var n=t.next();n.getEdges().findCoveredLineEdges()}for(var l=this.op.getGraph().getEdgeEnds().iterator();l.hasNext();){var d=l.next(),v=d.getEdge();if(d.isLineEdge()&&!v.isCoveredSet()){var C=this.op.isCoveredByA(d.getCoordinate());v.setCovered(C)}}},labelIsolatedLines:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next(),d=l.getLabel();l.isIsolated()&&(d.isNull(0)?this.labelIsolatedLine(l,0):this.labelIsolatedLine(l,1))}},buildLines:function(t){for(var n=this.lineEdgesList.iterator();n.hasNext();){var l=n.next(),d=(l.getLabel(),this.geometryFactory.createLineString(l.getCoordinates()));this.resultLineList.add(d),l.setInResult(!0)}},collectBoundaryTouchEdge:function(t,n,l){var d=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(yt.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(mn.isResultOfOp(d,n)&&n===mn.INTERSECTION&&(l.add(t.getEdge()),t.setVisitedEdge(!0))))},interfaces_:function(){return[]},getClass:function(){return va}}),T(Zl.prototype,{filterCoveredNodeToPoint:function(t){var n=t.getCoordinate();if(!this.op.isCoveredByLA(n)){var l=this.geometryFactory.createPoint(n);this.resultPointList.add(l)}},extractNonCoveredResultNodes:function(t){for(var n=this.op.getGraph().getNodes().iterator();n.hasNext();){var l=n.next();if(!(l.isInResult()||l.isIncidentEdgeInResult()||l.getEdges().getDegree()!==0&&t!==mn.INTERSECTION)){var d=l.getLabel();mn.isResultOfOp(d,t)&&this.filterCoveredNodeToPoint(l)}}},build:function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},interfaces_:function(){return[]},getClass:function(){return Zl}}),T(Zo.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return Zo}}),T(po.prototype,{locate:function(t){return po.locate(t,this.geom)},interfaces_:function(){return[Zo]},getClass:function(){return po}}),po.isPointInRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?re.isPointInRing(t,n.getCoordinates()):!1},po.containsPointInPolygon=function(t,n){if(n.isEmpty())return!1;var l=n.getExteriorRing();if(!po.isPointInRing(t,l))return!1;for(var d=0;d<n.getNumInteriorRing();d++){var v=n.getInteriorRingN(d);if(po.isPointInRing(t,v))return!1}return!0},po.containsPoint=function(t,n){if(n instanceof Pi)return po.containsPointInPolygon(t,n);if(n instanceof ri)for(var l=new be(n);l.hasNext();){var d=l.next();if(d!==n&&po.containsPoint(t,d))return!0}return!1},po.locate=function(t,n){return n.isEmpty()?rt.EXTERIOR:po.containsPoint(t,n)?rt.INTERIOR:rt.EXTERIOR},T(ra.prototype,{getNextCW:function(t){this.getEdges();var n=this.edgeList.indexOf(t),l=n-1;return n===0&&(l=this.edgeList.size()-1),this.edgeList.get(l)},propagateSideLabels:function(t){for(var n=rt.NONE,l=this.iterator();l.hasNext();){var d=l.next(),v=d.getLabel();v.isArea(t)&&v.getLocation(t,Ke.LEFT)!==rt.NONE&&(n=v.getLocation(t,Ke.LEFT))}if(n===rt.NONE)return null;for(var C=n,l=this.iterator();l.hasNext();){var d=l.next(),v=d.getLabel();if(v.getLocation(t,Ke.ON)===rt.NONE&&v.setLocation(t,Ke.ON,C),v.isArea(t)){var z=v.getLocation(t,Ke.LEFT),W=v.getLocation(t,Ke.RIGHT);if(W!==rt.NONE){if(W!==C)throw new Cs("side location conflict",d.getCoordinate());z===rt.NONE&&yt.shouldNeverReachHere("found single null side (at "+d.getCoordinate()+")"),C=z}else yt.isTrue(v.getLocation(t,Ke.LEFT)===rt.NONE,"found single null side"),v.setLocation(t,Ke.RIGHT,C),v.setLocation(t,Ke.LEFT,C)}}},getCoordinate:function(){var t=this.iterator();if(!t.hasNext())return null;var n=t.next();return n.getCoordinate()},print:function(t){mt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var l=n.next();l.print(t)}},isAreaLabelsConsistent:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},checkAreaLabelsConsistent:function(t){var n=this.getEdges();if(n.size()<=0)return!0;var l=n.size()-1,d=n.get(l).getLabel(),v=d.getLocation(t,Ke.LEFT);yt.isTrue(v!==rt.NONE,"Found unlabelled area edge");for(var C=v,z=this.iterator();z.hasNext();){var W=z.next(),gt=W.getLabel();yt.isTrue(gt.isArea(t),"Found non-area edge");var Bt=gt.getLocation(t,Ke.LEFT),Se=gt.getLocation(t,Ke.RIGHT);if(Bt===Se||Se!==C)return!1;C=Bt}return!0},findIndex:function(t){this.iterator();for(var n=0;n<this.edgeList.size();n++){var l=this.edgeList.get(n);if(l===t)return n}return-1},iterator:function(){return this.getEdges().iterator()},getEdges:function(){return this.edgeList===null&&(this.edgeList=new _t(this.edgeMap.values())),this.edgeList},getLocation:function(t,n,l){return this.ptInAreaLocation[t]===rt.NONE&&(this.ptInAreaLocation[t]=po.locate(n,l[t].getGeometry())),this.ptInAreaLocation[t]},toString:function(){var t=new Xn;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var n=this.iterator();n.hasNext();){var l=n.next();t.append(l),t.append(`
`)}return t.toString()},computeEdgeEndLabels:function(t){for(var n=this.iterator();n.hasNext();){var l=n.next();l.computeLabel(t)}},computeLabelling:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var n=[!1,!1],l=this.iterator();l.hasNext();)for(var d=l.next(),v=d.getLabel(),C=0;2>C;C++)v.isLine(C)&&v.getLocation(C)===rt.BOUNDARY&&(n[C]=!0);for(var l=this.iterator();l.hasNext();)for(var d=l.next(),v=d.getLabel(),C=0;2>C;C++)if(v.isAnyNull(C)){var z=rt.NONE;if(n[C])z=rt.EXTERIOR;else{var W=d.getCoordinate();z=this.getLocation(C,W,t)}v.setAllLocationsIfNull(C,z)}},getDegree:function(){return this.edgeMap.size()},insertEdgeEnd:function(t,n){this.edgeMap.put(t,n),this.edgeList=null},interfaces_:function(){return[]},getClass:function(){return ra}}),st(xa,ra),T(xa.prototype,{linkResultDirectedEdges:function(){this.getResultAreaEdges();for(var t=null,n=null,l=this.SCANNING_FOR_INCOMING,d=0;d<this.resultAreaEdgeList.size();d++){var v=this.resultAreaEdgeList.get(d),C=v.getSym();if(v.getLabel().isArea())switch(t===null&&v.isInResult()&&(t=v),l){case this.SCANNING_FOR_INCOMING:if(!C.isInResult())continue;n=C,l=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!v.isInResult())continue;n.setNext(v),l=this.SCANNING_FOR_INCOMING}}if(l===this.LINKING_TO_OUTGOING){if(t===null)throw new Cs("no outgoing dirEdge found",this.getCoordinate());yt.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),n.setNext(t)}},insert:function(t){var n=t;this.insertEdgeEnd(n,n)},getRightmostEdge:function(){var t=this.getEdges(),n=t.size();if(1>n)return null;var l=t.get(0);if(n===1)return l;var d=t.get(n-1),v=l.getQuadrant(),C=d.getQuadrant();return Ci.isNorthern(v)&&Ci.isNorthern(C)?l:!Ci.isNorthern(v)&&!Ci.isNorthern(C)?d:l.getDy()!==0?l:d.getDy()!==0?d:(yt.shouldNeverReachHere("found two horizontal edges incident on node"),null)},print:function(t){mt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var l=n.next();t.print("out "),l.print(t),t.println(),t.print("in "),l.getSym().print(t),t.println()}},getResultAreaEdges:function(){if(this.resultAreaEdgeList!==null)return this.resultAreaEdgeList;this.resultAreaEdgeList=new _t;for(var t=this.iterator();t.hasNext();){var n=t.next();(n.isInResult()||n.getSym().isInResult())&&this.resultAreaEdgeList.add(n)}return this.resultAreaEdgeList},updateLabelling:function(t){for(var n=this.iterator();n.hasNext();){var l=n.next(),d=l.getLabel();d.setAllLocationsIfNull(0,t.getLocation(0)),d.setAllLocationsIfNull(1,t.getLocation(1))}},linkAllDirectedEdges:function(){this.getEdges();for(var t=null,n=null,l=this.edgeList.size()-1;l>=0;l--){var d=this.edgeList.get(l),v=d.getSym();n===null&&(n=v),t!==null&&v.setNext(t),t=d}n.setNext(t)},computeDepths:function(){if(arguments.length===1){var t=arguments[0],n=this.findIndex(t),l=(t.getLabel(),t.getDepth(Ke.LEFT)),d=t.getDepth(Ke.RIGHT),v=this.computeDepths(n+1,this.edgeList.size(),l),C=this.computeDepths(0,n,v);if(C!==d)throw new Cs("depth mismatch at "+t.getCoordinate())}else if(arguments.length===3){for(var z=arguments[0],W=arguments[1],gt=arguments[2],Bt=gt,Se=z;W>Se;Se++){var Ae=this.edgeList.get(Se);Ae.getLabel(),Ae.setEdgeDepths(Ke.RIGHT,Bt),Bt=Ae.getDepth(Ke.LEFT)}return Bt}},mergeSymLabels:function(){for(var t=this.iterator();t.hasNext();){var n=t.next(),l=n.getLabel();l.merge(n.getSym().getLabel())}},linkMinimalDirectedEdges:function(t){for(var n=null,l=null,d=this.SCANNING_FOR_INCOMING,v=this.resultAreaEdgeList.size()-1;v>=0;v--){var C=this.resultAreaEdgeList.get(v),z=C.getSym();switch(n===null&&C.getEdgeRing()===t&&(n=C),d){case this.SCANNING_FOR_INCOMING:if(z.getEdgeRing()!==t)continue;l=z,d=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(C.getEdgeRing()!==t)continue;l.setNextMin(C),d=this.SCANNING_FOR_INCOMING}}d===this.LINKING_TO_OUTGOING&&(yt.isTrue(n!==null,"found null for first outgoing dirEdge"),yt.isTrue(n.getEdgeRing()===t,"unable to link last incoming dirEdge"),l.setNextMin(n))},getOutgoingDegree:function(){if(arguments.length===0){for(var t=0,n=this.iterator();n.hasNext();){var l=n.next();l.isInResult()&&t++}return t}if(arguments.length===1){for(var d=arguments[0],t=0,n=this.iterator();n.hasNext();){var l=n.next();l.getEdgeRing()===d&&t++}return t}},getLabel:function(){return this.label},findCoveredLineEdges:function(){for(var t=rt.NONE,n=this.iterator();n.hasNext();){var l=n.next(),d=l.getSym();if(!l.isLineEdge()){if(l.isInResult()){t=rt.INTERIOR;break}if(d.isInResult()){t=rt.EXTERIOR;break}}}if(t===rt.NONE)return null;for(var v=t,n=this.iterator();n.hasNext();){var l=n.next(),d=l.getSym();l.isLineEdge()?l.getEdge().setCovered(v===rt.INTERIOR):(l.isInResult()&&(v=rt.EXTERIOR),d.isInResult()&&(v=rt.INTERIOR))}},computeLabelling:function(t){ra.prototype.computeLabelling.call(this,t),this.label=new wr(rt.NONE);for(var n=this.iterator();n.hasNext();)for(var l=n.next(),d=l.getEdge(),v=d.getLabel(),C=0;2>C;C++){var z=v.getLocation(C);z!==rt.INTERIOR&&z!==rt.BOUNDARY||this.label.setLocation(C,rt.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return xa}}),st(Ho,Mo),T(Ho.prototype,{createNode:function(t){return new ia(t,new xa)},interfaces_:function(){return[]},getClass:function(){return Ho}}),T(bl.prototype,{computeIntersections:function(t,n){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,n)},interfaces_:function(){return[]},getClass:function(){return bl}}),T(Ii.prototype,{isDelete:function(){return this.eventType===Ii.DELETE},setDeleteEventIndex:function(t){this.deleteEventIndex=t},getObject:function(){return this.obj},compareTo:function(t){var n=t;return this.xValue<n.xValue?-1:this.xValue>n.xValue?1:this.eventType<n.eventType?-1:this.eventType>n.eventType?1:0},getInsertEvent:function(){return this.insertEvent},isInsert:function(){return this.eventType===Ii.INSERT},isSameLabel:function(t){return this.label===null?!1:this.label===t.label},getDeleteEventIndex:function(){return this.deleteEventIndex},interfaces_:function(){return[J]},getClass:function(){return Ii}}),Ii.INSERT=1,Ii.DELETE=2,T(wl.prototype,{interfaces_:function(){return[]},getClass:function(){return wl}}),T(Oa.prototype,{isTrivialIntersection:function(t,n,l,d){if(t===l&&this.li.getIntersectionNum()===1){if(Oa.isAdjacentSegments(n,d))return!0;if(t.isClosed()){var v=t.getNumPoints()-1;if(n===0&&d===v||d===0&&n===v)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},setIsDoneIfProperInt:function(t){this.isDoneWhenProperInt=t},hasProperInteriorIntersection:function(){return this.hasProperInterior},isBoundaryPointInternal:function(t,n){for(var l=n.iterator();l.hasNext();){var d=l.next(),v=d.getCoordinate();if(t.isIntersection(v))return!0}return!1},hasProperIntersection:function(){return this.hasProper},hasIntersection:function(){return this._hasIntersection},isDone:function(){return this._isDone},isBoundaryPoint:function(t,n){return n===null?!1:this.isBoundaryPointInternal(t,n[0])?!0:!!this.isBoundaryPointInternal(t,n[1])},setBoundaryNodes:function(t,n){this.bdyNodes=new Array(2).fill(null),this.bdyNodes[0]=t,this.bdyNodes[1]=n},addIntersections:function(t,n,l,d){if(t===l&&n===d)return null;this.numTests++;var v=t.getCoordinates()[n],C=t.getCoordinates()[n+1],z=l.getCoordinates()[d],W=l.getCoordinates()[d+1];this.li.computeIntersection(v,C,z,W),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),l.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,n,l,d)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,n,0),l.addIntersections(this.li,d,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).copy(),this.hasProper=!0,this.isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))},interfaces_:function(){return[]},getClass:function(){return Oa}}),Oa.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1},st(Hl,wl),T(Hl.prototype,{prepareEvents:function(){tn.sort(this.events);for(var t=0;t<this.events.size();t++){var n=this.events.get(t);n.isDelete()&&n.getInsertEvent().setDeleteEventIndex(t)}},computeIntersections:function(){if(arguments.length===1){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var n=0;n<this.events.size();n++){var l=this.events.get(n);if(l.isInsert()&&this.processOverlaps(n,l.getDeleteEventIndex(),l,t),t.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Oa&&qe(arguments[0],pt)&&qe(arguments[1],pt)){var d=arguments[0],v=arguments[1],C=arguments[2];this.addEdges(d,d),this.addEdges(v,v),this.computeIntersections(C)}else if(typeof arguments[2]=="boolean"&&qe(arguments[0],pt)&&arguments[1]instanceof Oa){var z=arguments[0],W=arguments[1],gt=arguments[2];gt?this.addEdges(z,null):this.addEdges(z),this.computeIntersections(W)}}},addEdge:function(t,n){for(var l=t.getMonotoneChainEdge(),d=l.getStartIndexes(),v=0;v<d.length-1;v++){var C=new bl(l,v),z=new Ii(n,l.getMinX(v),C);this.events.add(z),this.events.add(new Ii(l.getMaxX(v),z))}},processOverlaps:function(t,n,l,d){for(var v=l.getObject(),C=t;n>C;C++){var z=this.events.get(C);if(z.isInsert()){var W=z.getObject();l.isSameLabel(z)||(v.computeIntersections(W,d),this.nOverlaps++)}}},addEdges:function(){if(arguments.length===1)for(var t=arguments[0],n=t.iterator();n.hasNext();){var l=n.next();this.addEdge(l,l)}else if(arguments.length===2)for(var d=arguments[0],v=arguments[1],n=d.iterator();n.hasNext();){var l=n.next();this.addEdge(l,v)}},interfaces_:function(){return[]},getClass:function(){return Hl}}),T(Lo.prototype,{getMin:function(){return this.min},intersects:function(t,n){return!(this.min>n||this.max<t)},getMax:function(){return this.max},toString:function(){return Ns.toLineString(new it(this.min,0),new it(this.max,0))},interfaces_:function(){return[]},getClass:function(){return Lo}}),T(za.prototype,{compare:function(t,n){var l=t,d=n,v=(l.min+l.max)/2,C=(d.min+d.max)/2;return C>v?-1:v>C?1:0},interfaces_:function(){return[X]},getClass:function(){return za}}),Lo.NodeComparator=za,st(Bu,Lo),T(Bu.prototype,{query:function(t,n,l){return this.intersects(t,n)?void l.visitItem(this.item):null},interfaces_:function(){return[]},getClass:function(){return Bu}}),st(sa,Lo),T(sa.prototype,{buildExtent:function(t,n){this.min=Math.min(t.min,n.min),this.max=Math.max(t.max,n.max)},query:function(t,n,l){return this.intersects(t,n)?(this.node1!==null&&this.node1.query(t,n,l),void(this.node2!==null&&this.node2.query(t,n,l))):null},interfaces_:function(){return[]},getClass:function(){return sa}}),T(Ju.prototype,{buildTree:function(){tn.sort(this.leaves,new IntervalRTreeNode.NodeComparator);for(var t=this.leaves,n=null,l=new _t;;){if(this.buildLevel(t,l),l.size()===1)return l.get(0);n=t,t=l,l=n}},insert:function(t,n,l){if(this.root!==null)throw new IllegalStateException("Index cannot be added to once it has been queried");this.leaves.add(new Bu(t,n,l))},query:function(t,n,l){this.init(),this.root.query(t,n,l)},buildRoot:function(){return this.root!==null?null:void(this.root=this.buildTree())},printNode:function(t){mt.out.println(Ns.toLineString(new it(t.min,this.level),new it(t.max,this.level)))},init:function(){return this.root!==null?null:void this.buildRoot()},buildLevel:function(t,n){this.level++,n.clear();for(var l=0;l<t.size();l+=2){var d=t.get(l),v=l+1<t.size()?t.get(l):null;if(v===null)n.add(d);else{var C=new sa(t.get(l),t.get(l+1));n.add(C)}}},interfaces_:function(){return[]},getClass:function(){return Ju}}),T(Nr.prototype,{filter:function(t){if(this.isForcedToLineString&&t instanceof Yi){var n=t.getFactory().createLineString(t.getCoordinateSequence());return this.lines.add(n),null}t instanceof oi&&this.lines.add(t)},setForceToLineString:function(t){this.isForcedToLineString=t},interfaces_:function(){return[Be]},getClass:function(){return Nr}}),Nr.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(Nr.getLines(t))}if(arguments.length===2){var n=arguments[0],l=arguments[1];return n.getFactory().buildGeometry(Nr.getLines(n,l))}},Nr.getLines=function(){if(arguments.length===1){var t=arguments[0];return Nr.getLines(t,!1)}if(arguments.length===2){if(qe(arguments[0],Ft)&&qe(arguments[1],Ft)){for(var n=arguments[0],l=arguments[1],d=n.iterator();d.hasNext();){var v=d.next();Nr.getLines(v,l)}return l}if(arguments[0]instanceof de&&typeof arguments[1]=="boolean"){var C=arguments[0],z=arguments[1],W=new _t;return C.apply(new Nr(W,z)),W}if(arguments[0]instanceof de&&qe(arguments[1],Ft)){var gt=arguments[0],Bt=arguments[1];return gt instanceof oi?Bt.add(gt):gt.apply(new Nr(Bt)),Bt}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&qe(arguments[0],Ft)&&qe(arguments[1],Ft)){for(var Se=arguments[0],Ae=arguments[1],rn=arguments[2],d=Se.iterator();d.hasNext();){var v=d.next();Nr.getLines(v,Ae,rn)}return Ae}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof de&&qe(arguments[1],Ft)){var Nn=arguments[0],ei=arguments[1],ci=arguments[2];return Nn.apply(new Nr(ei,ci)),ei}}},T(El.prototype,{visitItem:function(t){this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Pn]},getClass:function(){return El}}),T(ba.prototype,{locate:function(t){var n=new kr(t),l=new el(n);return this.index.query(t.y,t.y,l),n.getLocation()},interfaces_:function(){return[Zo]},getClass:function(){return ba}}),T(el.prototype,{visitItem:function(t){var n=t;this.counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))},interfaces_:function(){return[Pn]},getClass:function(){return el}}),T(Yl.prototype,{init:function(t){for(var n=Nr.getLines(t),l=n.iterator();l.hasNext();){var d=l.next(),v=d.getCoordinates();this.addLine(v)}},addLine:function(t){for(var n=1;n<t.length;n++){var l=new gn(t[n-1],t[n]),d=Math.min(l.p0.y,l.p1.y),v=Math.max(l.p0.y,l.p1.y);this.index.insert(d,v,l)}},query:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],l=new El;return this.index.query(t,n,l),l.getItems()}if(arguments.length===3){var d=arguments[0],v=arguments[1],C=arguments[2];this.index.query(d,v,C)}},interfaces_:function(){return[]},getClass:function(){return Yl}}),ba.SegmentVisitor=el,ba.IntervalIndexedGeometry=Yl,T(Ku.prototype,{getSegmentIndex:function(){return this.segmentIndex},getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},compareTo:function(t){var n=t;return this.compare(n.segmentIndex,n.dist)},isEndPoint:function(t){return this.segmentIndex===0&&this.dist===0?!0:this.segmentIndex===t},toString:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},getDistance:function(){return this.dist},compare:function(t,n){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<n?-1:this.dist>n?1:0},interfaces_:function(){return[J]},getClass:function(){return Ku}}),T(Qu.prototype,{print:function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var l=n.next();l.print(t)}},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints();for(var n=this.iterator(),l=n.next();n.hasNext();){var d=n.next(),v=this.createSplitEdge(l,d);t.add(v),l=d}},addEndpoints:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},createSplitEdge:function(t,n){var l=n.segmentIndex-t.segmentIndex+2,d=this.edge.pts[n.segmentIndex],v=n.dist>0||!n.coord.equals2D(d);v||l--;var C=new Array(l).fill(null),z=0;C[z++]=new it(t.coord);for(var W=t.segmentIndex+1;W<=n.segmentIndex;W++)C[z++]=this.edge.pts[W];return v&&(C[z]=n.coord),new go(C,new wr(this.edge.label))},add:function(t,n,l){var d=new Ku(t,n,l),v=this.nodeMap.get(d);return v!==null?v:(this.nodeMap.put(d,d),d)},isIntersection:function(t){for(var n=this.iterator();n.hasNext();){var l=n.next();if(l.coord.equals(t))return!0}return!1},interfaces_:function(){return[]},getClass:function(){return Qu}}),T(Pa.prototype,{getChainStartIndices:function(t){var n=0,l=new _t;l.add(new ct(n));do{var d=this.findChainEnd(t,n);l.add(new ct(d)),n=d}while(n<t.length-1);var v=Pa.toIntArray(l);return v},findChainEnd:function(t,n){for(var l=Ci.quadrant(t[n],t[n+1]),d=n+1;d<t.length;){var v=Ci.quadrant(t[d-1],t[d]);if(v!==l)break;d++}return d-1},interfaces_:function(){return[]},getClass:function(){return Pa}}),Pa.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),l=0;l<n.length;l++)n[l]=t.get(l).intValue();return n},T(Ro.prototype,{getCoordinates:function(){return this.pts},getMaxX:function(t){var n=this.pts[this.startIndex[t]].x,l=this.pts[this.startIndex[t+1]].x;return n>l?n:l},getMinX:function(t){var n=this.pts[this.startIndex[t]].x,l=this.pts[this.startIndex[t+1]].x;return l>n?n:l},computeIntersectsForChain:function(){if(arguments.length===4){var t=arguments[0],n=arguments[1],l=arguments[2],d=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],n,n.startIndex[l],n.startIndex[l+1],d)}else if(arguments.length===6){var v=arguments[0],C=arguments[1],z=arguments[2],W=arguments[3],gt=arguments[4],Bt=arguments[5],Se=this.pts[v],Ae=this.pts[C],rn=z.pts[W],Nn=z.pts[gt];if(C-v===1&&gt-W===1)return Bt.addIntersections(this.e,v,z.e,W),null;if(this.env1.init(Se,Ae),this.env2.init(rn,Nn),!this.env1.intersects(this.env2))return null;var ei=Math.trunc((v+C)/2),ci=Math.trunc((W+gt)/2);ei>v&&(ci>W&&this.computeIntersectsForChain(v,ei,z,W,ci,Bt),gt>ci&&this.computeIntersectsForChain(v,ei,z,ci,gt,Bt)),C>ei&&(ci>W&&this.computeIntersectsForChain(ei,C,z,W,ci,Bt),gt>ci&&this.computeIntersectsForChain(ei,C,z,ci,gt,Bt))}},getStartIndexes:function(){return this.startIndex},computeIntersects:function(t,n){for(var l=0;l<this.startIndex.length-1;l++)for(var d=0;d<t.startIndex.length-1;d++)this.computeIntersectsForChain(l,t,d,n)},interfaces_:function(){return[]},getClass:function(){return Ro}}),T(Ys.prototype,{getDepth:function(t,n){return this.depth[t][n]},setDepth:function(t,n,l){this.depth[t][n]=l},isNull:function(){if(arguments.length===0){for(var t=0;2>t;t++)for(var n=0;3>n;n++)if(this.depth[t][n]!==Ys.NULL_VALUE)return!1;return!0}if(arguments.length===1){var l=arguments[0];return this.depth[l][1]===Ys.NULL_VALUE}if(arguments.length===2){var d=arguments[0],v=arguments[1];return this.depth[d][v]===Ys.NULL_VALUE}},normalize:function(){for(var t=0;2>t;t++)if(!this.isNull(t)){var n=this.depth[t][1];this.depth[t][2]<n&&(n=this.depth[t][2]),0>n&&(n=0);for(var l=1;3>l;l++){var d=0;this.depth[t][l]>n&&(d=1),this.depth[t][l]=d}}},getDelta:function(t){return this.depth[t][Ke.RIGHT]-this.depth[t][Ke.LEFT]},getLocation:function(t,n){return this.depth[t][n]<=0?rt.EXTERIOR:rt.INTERIOR},toString:function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]},add:function(){if(arguments.length===1)for(var t=arguments[0],n=0;2>n;n++)for(var l=1;3>l;l++){var d=t.getLocation(n,l);d!==rt.EXTERIOR&&d!==rt.INTERIOR||(this.isNull(n,l)?this.depth[n][l]=Ys.depthAtLocation(d):this.depth[n][l]+=Ys.depthAtLocation(d))}else if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2];z===rt.INTERIOR&&this.depth[v][C]++}},interfaces_:function(){return[]},getClass:function(){return Ys}}),Ys.depthAtLocation=function(t){return t===rt.EXTERIOR?0:t===rt.INTERIOR?1:Ys.NULL_VALUE},Ys.NULL_VALUE=-1,st(go,Na),T(go.prototype,{getDepth:function(){return this.depth},getCollapsedEdge:function(){var t=new Array(2).fill(null);t[0]=this.pts[0],t[1]=this.pts[1];var n=new go(t,wr.toLineLabel(this.label));return n},isIsolated:function(){return this._isIsolated},getCoordinates:function(){return this.pts},setIsolated:function(t){this._isIsolated=t},setName:function(t){this.name=t},equals:function(t){if(!(t instanceof go))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var l=!0,d=!0,v=this.pts.length,C=0;C<this.pts.length;C++)if(this.pts[C].equals2D(n.pts[C])||(l=!1),this.pts[C].equals2D(n.pts[--v])||(d=!1),!l&&!d)return!1;return!0},getCoordinate:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var t=arguments[0];return this.pts[t]}},print:function(t){t.print("edge "+this.name+": "),t.print("LINESTRING (");for(var n=0;n<this.pts.length;n++)n>0&&t.print(","),t.print(this.pts[n].x+" "+this.pts[n].y);t.print(")  "+this.label+" "+this.depthDelta)},computeIM:function(t){go.updateIM(this.label,t)},isCollapsed:function(){return this.label.isArea()?this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2]):!1},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getMaximumSegmentIndex:function(){return this.pts.length-1},getDepthDelta:function(){return this.depthDelta},getNumPoints:function(){return this.pts.length},printReverse:function(t){t.print("edge "+this.name+": ");for(var n=this.pts.length-1;n>=0;n--)t.print(this.pts[n]+" ");t.println("")},getMonotoneChainEdge:function(){return this.mce===null&&(this.mce=new Ro(this)),this.mce},getEnvelope:function(){if(this.env===null){this.env=new Xt;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(this.pts[t])}return this.env},addIntersection:function(t,n,l,d){var v=new it(t.getIntersection(d)),C=n,z=t.getEdgeDistance(l,d),W=C+1;if(W<this.pts.length){var gt=this.pts[W];v.equals2D(gt)&&(C=W,z=0)}this.eiList.add(v,C,z)},toString:function(){var t=new Xn;t.append("edge "+this.name+": "),t.append("LINESTRING (");for(var n=0;n<this.pts.length;n++)n>0&&t.append(","),t.append(this.pts[n].x+" "+this.pts[n].y);return t.append(")  "+this.label+" "+this.depthDelta),t.toString()},isPointwiseEqual:function(t){if(this.pts.length!==t.pts.length)return!1;for(var n=0;n<this.pts.length;n++)if(!this.pts[n].equals2D(t.pts[n]))return!1;return!0},setDepthDelta:function(t){this.depthDelta=t},getEdgeIntersectionList:function(){return this.eiList},addIntersections:function(t,n,l){for(var d=0;d<t.getIntersectionNum();d++)this.addIntersection(t,n,l,d)},interfaces_:function(){return[]},getClass:function(){return go}}),go.updateIM=function(){if(arguments.length!==2)return Na.prototype.updateIM.apply(this,arguments);var t=arguments[0],n=arguments[1];n.setAtLeastIfValid(t.getLocation(0,Ke.ON),t.getLocation(1,Ke.ON),1),t.isArea()&&(n.setAtLeastIfValid(t.getLocation(0,Ke.LEFT),t.getLocation(1,Ke.LEFT),2),n.setAtLeastIfValid(t.getLocation(0,Ke.RIGHT),t.getLocation(1,Ke.RIGHT),2))},st(oe,Ps),T(oe.prototype,{insertBoundaryPoint:function(t,n){var l=this.nodes.addNode(n),d=l.getLabel(),v=1,C=rt.NONE;C=d.getLocation(t,Ke.ON),C===rt.BOUNDARY&&v++;var z=oe.determineBoundary(this.boundaryNodeRule,v);d.setLocation(t,z)},computeSelfNodes:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.computeSelfNodes(t,n,!1)}if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2],C=new Oa(l,!0,!1);C.setIsDoneIfProperInt(v);var z=this.createEdgeSetIntersector(),W=this.parentGeom instanceof Yi||this.parentGeom instanceof Pi||this.parentGeom instanceof Ct,gt=d||!W;return z.computeIntersections(this.edges,C,gt),this.addSelfIntersectionNodes(this.argIndex),C}},computeSplitEdges:function(t){for(var n=this.edges.iterator();n.hasNext();){var l=n.next();l.eiList.addSplitEdges(t)}},computeEdgeIntersections:function(t,n,l){var d=new Oa(n,l,!0);d.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes());var v=this.createEdgeSetIntersector();return v.computeIntersections(this.edges,t.edges,d),d},getGeometry:function(){return this.parentGeom},getBoundaryNodeRule:function(){return this.boundaryNodeRule},hasTooFewPoints:function(){return this._hasTooFewPoints},addPoint:function(){if(arguments[0]instanceof rr){var t=arguments[0],n=t.getCoordinate();this.insertPoint(this.argIndex,n,rt.INTERIOR)}else if(arguments[0]instanceof it){var l=arguments[0];this.insertPoint(this.argIndex,l,rt.INTERIOR)}},addPolygon:function(t){this.addPolygonRing(t.getExteriorRing(),rt.EXTERIOR,rt.INTERIOR);for(var n=0;n<t.getNumInteriorRing();n++){var l=t.getInteriorRingN(n);this.addPolygonRing(l,rt.INTERIOR,rt.EXTERIOR)}},addEdge:function(t){this.insertEdge(t);var n=t.getCoordinates();this.insertPoint(this.argIndex,n[0],rt.BOUNDARY),this.insertPoint(this.argIndex,n[n.length-1],rt.BOUNDARY)},addLineString:function(t){var n=Bn.removeRepeatedPoints(t.getCoordinates());if(n.length<2)return this._hasTooFewPoints=!0,this.invalidPoint=n[0],null;var l=new go(n,new wr(this.argIndex,rt.INTERIOR));this.lineEdgeMap.put(t,l),this.insertEdge(l),yt.isTrue(n.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,n[0]),this.insertBoundaryPoint(this.argIndex,n[n.length-1])},getInvalidPoint:function(){return this.invalidPoint},getBoundaryPoints:function(){for(var t=this.getBoundaryNodes(),n=new Array(t.size()).fill(null),l=0,d=t.iterator();d.hasNext();){var v=d.next();n[l++]=v.getCoordinate().copy()}return n},getBoundaryNodes:function(){return this.boundaryNodes===null&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},addSelfIntersectionNode:function(t,n,l){return this.isBoundaryNode(t,n)?null:void(l===rt.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(t,n):this.insertPoint(t,n,l))},addPolygonRing:function(t,n,l){if(t.isEmpty())return null;var d=Bn.removeRepeatedPoints(t.getCoordinates());if(d.length<4)return this._hasTooFewPoints=!0,this.invalidPoint=d[0],null;var v=n,C=l;re.isCCW(d)&&(v=l,C=n);var z=new go(d,new wr(this.argIndex,rt.BOUNDARY,v,C));this.lineEdgeMap.put(t,z),this.insertEdge(z),this.insertPoint(this.argIndex,d[0],rt.BOUNDARY)},insertPoint:function(t,n,l){var d=this.nodes.addNode(n),v=d.getLabel();v===null?d.label=new wr(t,l):v.setLocation(t,l)},createEdgeSetIntersector:function(){return new Hl},addSelfIntersectionNodes:function(t){for(var n=this.edges.iterator();n.hasNext();)for(var l=n.next(),d=l.getLabel().getLocation(t),v=l.eiList.iterator();v.hasNext();){var C=v.next();this.addSelfIntersectionNode(t,C.coord,d)}},add:function(){if(arguments.length!==1)return Ps.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof Ct&&(this.useBoundaryDeterminationRule=!1),t instanceof Pi)this.addPolygon(t);else if(t instanceof oi)this.addLineString(t);else if(t instanceof rr)this.addPoint(t);else if(t instanceof Zr)this.addCollection(t);else if(t instanceof Ki)this.addCollection(t);else if(t instanceof Ct)this.addCollection(t);else{if(!(t instanceof ri))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},addCollection:function(t){for(var n=0;n<t.getNumGeometries();n++){var l=t.getGeometryN(n);this.add(l)}},locate:function(t){return qe(this.parentGeom,ts)&&this.parentGeom.getNumGeometries()>50?(this.areaPtLocator===null&&(this.areaPtLocator=new ba(this.parentGeom)),this.areaPtLocator.locate(t)):this.ptLocator.locate(t,this.parentGeom)},findEdge:function(){if(arguments.length===1){var t=arguments[0];return this.lineEdgeMap.get(t)}return Ps.prototype.findEdge.apply(this,arguments)},interfaces_:function(){return[]},getClass:function(){return oe}}),oe.determineBoundary=function(t,n){return t.isInBoundary(n)?rt.BOUNDARY:rt.INTERIOR},T(De.prototype,{getArgGeometry:function(t){return this.arg[t].getGeometry()},setComputationPrecision:function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},interfaces_:function(){return[]},getClass:function(){return De}}),T(vn.prototype,{compareTo:function(t){var n=t,l=vn.compareOriented(this.pts,this._orientation,n.pts,n._orientation);return l},interfaces_:function(){return[J]},getClass:function(){return vn}}),vn.orientation=function(t){return Bn.increasingDirection(t)===1},vn.compareOriented=function(t,n,l,d){for(var v=n?1:-1,C=d?1:-1,z=n?t.length:-1,W=d?l.length:-1,gt=n?0:t.length-1,Bt=d?0:l.length-1;;){var Se=t[gt].compareTo(l[Bt]);if(Se!==0)return Se;gt+=v,Bt+=C;var Ae=gt===z,rn=Bt===W;if(Ae&&!rn)return-1;if(!Ae&&rn)return 1;if(Ae&&rn)return 0}},T(Wn.prototype,{print:function(t){t.print("MULTILINESTRING ( ");for(var n=0;n<this.edges.size();n++){var l=this.edges.get(n);n>0&&t.print(","),t.print("(");for(var d=l.getCoordinates(),v=0;v<d.length;v++)v>0&&t.print(","),t.print(d[v].x+" "+d[v].y);t.println(")")}t.print(")  ")},addAll:function(t){for(var n=t.iterator();n.hasNext();)this.add(n.next())},findEdgeIndex:function(t){for(var n=0;n<this.edges.size();n++)if(this.edges.get(n).equals(t))return n;return-1},iterator:function(){return this.edges.iterator()},getEdges:function(){return this.edges},get:function(t){return this.edges.get(t)},findEqualEdge:function(t){var n=new vn(t.getCoordinates()),l=this.ocaMap.get(n);return l},add:function(t){this.edges.add(t);var n=new vn(t.getCoordinates());this.ocaMap.put(n,t)},interfaces_:function(){return[]},getClass:function(){return Wn}}),st(mn,De),T(mn.prototype,{insertUniqueEdge:function(t){var n=this.edgeList.findEqualEdge(t);if(n!==null){var l=n.getLabel(),d=t.getLabel();n.isPointwiseEqual(t)||(d=new wr(t.getLabel()),d.flip());var v=n.getDepth();v.isNull()&&v.add(l),v.add(d),l.merge(d)}else this.edgeList.add(t)},getGraph:function(){return this.graph},cancelDuplicateResultEdges:function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var n=t.next(),l=n.getSym();n.isInResult()&&l.isInResult()&&(n.setInResult(!1),l.setInResult(!1))}},isCoveredByLA:function(t){return this.isCovered(t,this.resultLineList)?!0:!!this.isCovered(t,this.resultPolyList)},computeGeometry:function(t,n,l,d){var v=new _t;return v.addAll(t),v.addAll(n),v.addAll(l),v.isEmpty()?mn.createEmptyResult(d,this.arg[0].getGeometry(),this.arg[1].getGeometry(),this.geomFact):this.geomFact.buildGeometry(v)},mergeSymLabels:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var n=t.next();n.getEdges().mergeSymLabels()}},isCovered:function(t,n){for(var l=n.iterator();l.hasNext();){var d=l.next(),v=this.ptLocator.locate(t,d);if(v!==rt.EXTERIOR)return!0}return!1},replaceCollapsedEdges:function(){for(var t=new _t,n=this.edgeList.iterator();n.hasNext();){var l=n.next();l.isCollapsed()&&(n.remove(),t.add(l.getCollapsedEdge()))}this.edgeList.addAll(t)},updateNodeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var n=t.next(),l=n.getEdges().getLabel();n.getLabel().merge(l)}},getResultGeometry:function(t){return this.computeOverlay(t),this.resultGeom},insertUniqueEdges:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();this.insertUniqueEdge(l)}},computeOverlay:function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var n=new _t;this.arg[0].computeSplitEdges(n),this.arg[1].computeSplitEdges(n),this.insertUniqueEdges(n),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Qa.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var l=new Ao(this.geomFact);l.add(this.graph),this.resultPolyList=l.getPolygons();var d=new va(this,this.geomFact,this.ptLocator);this.resultLineList=d.build(t);var v=new Zl(this,this.geomFact,this.ptLocator);this.resultPointList=v.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},labelIncompleteNode:function(t,n){var l=this.ptLocator.locate(t.getCoordinate(),this.arg[n].getGeometry());t.getLabel().setLocation(n,l)},copyPoints:function(t){for(var n=this.arg[t].getNodeIterator();n.hasNext();){var l=n.next(),d=this.graph.addNode(l.getCoordinate());d.setLabel(t,l.getLabel().getLocation(t))}},findResultAreaEdges:function(t){for(var n=this.graph.getEdgeEnds().iterator();n.hasNext();){var l=n.next(),d=l.getLabel();d.isArea()&&!l.isInteriorAreaEdge()&&mn.isResultOfOp(d.getLocation(0,Ke.RIGHT),d.getLocation(1,Ke.RIGHT),t)&&l.setInResult(!0)}},computeLabelsFromDepths:function(){for(var t=this.edgeList.iterator();t.hasNext();){var n=t.next(),l=n.getLabel(),d=n.getDepth();if(!d.isNull()){d.normalize();for(var v=0;2>v;v++)l.isNull(v)||!l.isArea()||d.isNull(v)||(d.getDelta(v)===0?l.toLine(v):(yt.isTrue(!d.isNull(v,Ke.LEFT),"depth of LEFT side has not been initialized"),l.setLocation(v,Ke.LEFT,d.getLocation(v,Ke.LEFT)),yt.isTrue(!d.isNull(v,Ke.RIGHT),"depth of RIGHT side has not been initialized"),l.setLocation(v,Ke.RIGHT,d.getLocation(v,Ke.RIGHT))))}}},computeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var n=t.next();n.getEdges().computeLabelling(this.arg)}this.mergeSymLabels(),this.updateNodeLabelling()},labelIncompleteNodes:function(){for(var t=0,n=this.graph.getNodes().iterator();n.hasNext();){var l=n.next(),d=l.getLabel();l.isIsolated()&&(t++,d.isNull(0)?this.labelIncompleteNode(l,0):this.labelIncompleteNode(l,1)),l.getEdges().updateLabelling(d)}},isCoveredByA:function(t){return!!this.isCovered(t,this.resultPolyList)},interfaces_:function(){return[]},getClass:function(){return mn}}),mn.overlayOp=function(t,n,l){var d=new mn(t,n),v=d.getResultGeometry(l);return v},mn.intersection=function(t,n){if(t.isEmpty()||n.isEmpty())return mn.createEmptyResult(mn.INTERSECTION,t,n,t.getFactory());if(t.isGeometryCollection()){var l=n;return xl.map(t,{interfaces_:function(){return[MapOp]},map:function(d){return d.intersection(l)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),wi.overlayOp(t,n,mn.INTERSECTION)},mn.symDifference=function(t,n){if(t.isEmpty()||n.isEmpty()){if(t.isEmpty()&&n.isEmpty())return mn.createEmptyResult(mn.SYMDIFFERENCE,t,n,t.getFactory());if(t.isEmpty())return n.copy();if(n.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),wi.overlayOp(t,n,mn.SYMDIFFERENCE)},mn.resultDimension=function(t,n,l){var d=n.getDimension(),v=l.getDimension(),C=-1;switch(t){case mn.INTERSECTION:C=Math.min(d,v);break;case mn.UNION:C=Math.max(d,v);break;case mn.DIFFERENCE:C=d;break;case mn.SYMDIFFERENCE:C=Math.max(d,v)}return C},mn.createEmptyResult=function(t,n,l,d){var v=null;switch(mn.resultDimension(t,n,l)){case-1:v=d.createGeometryCollection(new Array(0).fill(null));break;case 0:v=d.createPoint();break;case 1:v=d.createLineString();break;case 2:v=d.createPolygon()}return v},mn.difference=function(t,n){return t.isEmpty()?mn.createEmptyResult(mn.DIFFERENCE,t,n,t.getFactory()):n.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),wi.overlayOp(t,n,mn.DIFFERENCE))},mn.isResultOfOp=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],l=t.getLocation(0),d=t.getLocation(1);return mn.isResultOfOp(l,d,n)}if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2];switch(v===rt.BOUNDARY&&(v=rt.INTERIOR),C===rt.BOUNDARY&&(C=rt.INTERIOR),z){case mn.INTERSECTION:return v===rt.INTERIOR&&C===rt.INTERIOR;case mn.UNION:return v===rt.INTERIOR||C===rt.INTERIOR;case mn.DIFFERENCE:return v===rt.INTERIOR&&C!==rt.INTERIOR;case mn.SYMDIFFERENCE:return v===rt.INTERIOR&&C!==rt.INTERIOR||v!==rt.INTERIOR&&C===rt.INTERIOR}return!1}},mn.INTERSECTION=1,mn.UNION=2,mn.DIFFERENCE=3,mn.SYMDIFFERENCE=4,T(hi.prototype,{selfSnap:function(t){var n=new R(t),l=n.snapTo(t,this.snapTolerance);return l},removeCommonBits:function(t){this.cbr=new Ht,this.cbr.add(t[0]),this.cbr.add(t[1]);var n=new Array(2).fill(null);return n[0]=this.cbr.removeCommonBits(t[0].copy()),n[1]=this.cbr.removeCommonBits(t[1].copy()),n},prepareResult:function(t){return this.cbr.addCommonBits(t),t},getResultGeometry:function(t){var n=this.snap(this.geom),l=mn.overlayOp(n[0],n[1],t);return this.prepareResult(l)},checkValid:function(t){t.isValid()||mt.out.println("Snapped geometry is invalid")},computeSnapTolerance:function(){this.snapTolerance=R.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},snap:function(t){var n=this.removeCommonBits(t),l=R.snap(n[0],n[1],this.snapTolerance);return l},interfaces_:function(){return[]},getClass:function(){return hi}}),hi.overlayOp=function(t,n,l){var d=new hi(t,n);return d.getResultGeometry(l)},hi.union=function(t,n){return hi.overlayOp(t,n,mn.UNION)},hi.intersection=function(t,n){return hi.overlayOp(t,n,mn.INTERSECTION)},hi.symDifference=function(t,n){return hi.overlayOp(t,n,mn.SYMDIFFERENCE)},hi.difference=function(t,n){return hi.overlayOp(t,n,mn.DIFFERENCE)},T(wi.prototype,{getResultGeometry:function(t){var n=null,l=!1,d=null;try{n=mn.overlayOp(this.geom[0],this.geom[1],t);var v=!0;v&&(l=!0)}catch(C){if(!(C instanceof ht))throw C;d=C}finally{}if(!l)try{n=hi.overlayOp(this.geom[0],this.geom[1],t)}catch(C){throw C instanceof ht?d:C}finally{}return n},interfaces_:function(){return[]},getClass:function(){return wi}}),wi.overlayOp=function(t,n,l){var d=new wi(t,n);return d.getResultGeometry(l)},wi.union=function(t,n){return wi.overlayOp(t,n,mn.UNION)},wi.intersection=function(t,n){return wi.overlayOp(t,n,mn.INTERSECTION)},wi.symDifference=function(t,n){return wi.overlayOp(t,n,mn.SYMDIFFERENCE)},wi.difference=function(t,n){return wi.overlayOp(t,n,mn.DIFFERENCE)},T(sr.prototype,{addPolygon:function(t){if(t.isEmpty())return null;var n=null,l=0,d=this.horizontalBisector(t);if(d.getLength()===0)l=0,n=d.getCoordinate();else{var v=wi.overlayOp(d,t,mn.INTERSECTION),C=this.widestGeometry(v);l=C.getEnvelopeInternal().getWidth(),n=sr.centre(C.getEnvelopeInternal())}(this.interiorPoint===null||l>this.maxWidth)&&(this.interiorPoint=n,this.maxWidth=l)},getInteriorPoint:function(){return this.interiorPoint},widestGeometry:function(){if(arguments[0]instanceof ri){var n=arguments[0];if(n.isEmpty())return n;for(var l=n.getGeometryN(0),d=1;d<n.getNumGeometries();d++)n.getGeometryN(d).getEnvelopeInternal().getWidth()>l.getEnvelopeInternal().getWidth()&&(l=n.getGeometryN(d));return l}if(arguments[0]instanceof de){var v=arguments[0];return v instanceof ri?this.widestGeometry(v):v}},horizontalBisector:function(t){var n=t.getEnvelopeInternal(),l=Ws.getBisectorY(t);return this.factory.createLineString([new it(n.getMinX(),l),new it(n.getMaxX(),l)])},add:function(t){if(t instanceof Pi)this.addPolygon(t);else if(t instanceof ri)for(var n=t,l=0;l<n.getNumGeometries();l++)this.add(n.getGeometryN(l))},interfaces_:function(){return[]},getClass:function(){return sr}}),sr.centre=function(t){return new it(sr.avg(t.getMinX(),t.getMaxX()),sr.avg(t.getMinY(),t.getMaxY()))},sr.avg=function(t,n){return(t+n)/2},T(Ws.prototype,{updateInterval:function(t){t<=this.centreY?t>this.loY&&(this.loY=t):t>this.centreY&&t<this.hiY&&(this.hiY=t)},getBisectorY:function(){this.process(this.poly.getExteriorRing());for(var t=0;t<this.poly.getNumInteriorRing();t++)this.process(this.poly.getInteriorRingN(t));var n=sr.avg(this.hiY,this.loY);return n},process:function(t){for(var n=t.getCoordinateSequence(),l=0;l<n.size();l++){var d=n.getY(l);this.updateInterval(d)}},interfaces_:function(){return[]},getClass:function(){return Ws}}),Ws.getBisectorY=function(t){var n=new Ws(t);return n.getBisectorY()},sr.SafeBisectorFinder=Ws,T(ds.prototype,{addEndpoints:function(){if(arguments[0]instanceof de){var t=arguments[0];if(t instanceof oi)this.addEndpoints(t.getCoordinates());else if(t instanceof ri)for(var n=t,l=0;l<n.getNumGeometries();l++)this.addEndpoints(n.getGeometryN(l))}else if(arguments[0]instanceof Array){var d=arguments[0];this.add(d[0]),this.add(d[d.length-1])}},getInteriorPoint:function(){return this.interiorPoint},addInterior:function(){if(arguments[0]instanceof de){var t=arguments[0];if(t instanceof oi)this.addInterior(t.getCoordinates());else if(t instanceof ri)for(var n=t,l=0;l<n.getNumGeometries();l++)this.addInterior(n.getGeometryN(l))}else if(arguments[0]instanceof Array)for(var d=arguments[0],l=1;l<d.length-1;l++)this.add(d[l])},add:function(t){var n=t.distance(this.centroid);n<this.minDistance&&(this.interiorPoint=new it(t),this.minDistance=n)},interfaces_:function(){return[]},getClass:function(){return ds}}),T(Gr.prototype,{getInteriorPoint:function(){return this.interiorPoint},add:function(){if(arguments[0]instanceof de){var t=arguments[0];if(t instanceof rr)this.add(t.getCoordinate());else if(t instanceof ri)for(var n=t,l=0;l<n.getNumGeometries();l++)this.add(n.getGeometryN(l))}else if(arguments[0]instanceof it){var d=arguments[0],v=d.distance(this.centroid);v<this.minDistance&&(this.interiorPoint=new it(d),this.minDistance=v)}},interfaces_:function(){return[]},getClass:function(){return Gr}}),T(Jn.prototype,{interfaces_:function(){return[]},getClass:function(){return Jn}}),Jn.toDegrees=function(t){return 180*t/Math.PI},Jn.normalize=function(t){for(;t>Math.PI;)t-=Jn.PI_TIMES_2;for(;t<=-Math.PI;)t+=Jn.PI_TIMES_2;return t},Jn.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}if(arguments.length===2){var n=arguments[0],l=arguments[1],d=l.x-n.x,v=l.y-n.y;return Math.atan2(v,d)}},Jn.isAcute=function(t,n,l){var d=t.x-n.x,v=t.y-n.y,C=l.x-n.x,z=l.y-n.y,W=d*C+v*z;return W>0},Jn.isObtuse=function(t,n,l){var d=t.x-n.x,v=t.y-n.y,C=l.x-n.x,z=l.y-n.y,W=d*C+v*z;return 0>W},Jn.interiorAngle=function(t,n,l){var d=Jn.angle(n,t),v=Jn.angle(n,l);return Math.abs(v-d)},Jn.normalizePositive=function(t){if(0>t){for(;0>t;)t+=Jn.PI_TIMES_2;t>=Jn.PI_TIMES_2&&(t=0)}else{for(;t>=Jn.PI_TIMES_2;)t-=Jn.PI_TIMES_2;0>t&&(t=0)}return t},Jn.angleBetween=function(t,n,l){var d=Jn.angle(n,t),v=Jn.angle(n,l);return Jn.diff(d,v)},Jn.diff=function(t,n){var l=null;return l=n>t?n-t:t-n,l>Math.PI&&(l=2*Math.PI-l),l},Jn.toRadians=function(t){return t*Math.PI/180},Jn.getTurn=function(t,n){var l=Math.sin(n-t);return l>0?Jn.COUNTERCLOCKWISE:0>l?Jn.CLOCKWISE:Jn.NONE},Jn.angleBetweenOriented=function(t,n,l){var d=Jn.angle(n,t),v=Jn.angle(n,l),C=v-d;return C<=-Math.PI?C+Jn.PI_TIMES_2:C>Math.PI?C-Jn.PI_TIMES_2:C},Jn.PI_TIMES_2=2*Math.PI,Jn.PI_OVER_2=Math.PI/2,Jn.PI_OVER_4=Math.PI/4,Jn.COUNTERCLOCKWISE=re.COUNTERCLOCKWISE,Jn.CLOCKWISE=re.CLOCKWISE,Jn.NONE=re.COLLINEAR,T(zi.prototype,{area:function(){return zi.area(this.p0,this.p1,this.p2)},signedArea:function(){return zi.signedArea(this.p0,this.p1,this.p2)},interpolateZ:function(t){if(t===null)throw new q;return zi.interpolateZ(t,this.p0,this.p1,this.p2)},longestSideLength:function(){return zi.longestSideLength(this.p0,this.p1,this.p2)},isAcute:function(){return zi.isAcute(this.p0,this.p1,this.p2)},circumcentre:function(){return zi.circumcentre(this.p0,this.p1,this.p2)},area3D:function(){return zi.area3D(this.p0,this.p1,this.p2)},centroid:function(){return zi.centroid(this.p0,this.p1,this.p2)},inCentre:function(){return zi.inCentre(this.p0,this.p1,this.p2)},interfaces_:function(){return[]},getClass:function(){return zi}}),zi.area=function(t,n,l){return Math.abs(((l.x-t.x)*(n.y-t.y)-(n.x-t.x)*(l.y-t.y))/2)},zi.signedArea=function(t,n,l){return((l.x-t.x)*(n.y-t.y)-(n.x-t.x)*(l.y-t.y))/2},zi.det=function(t,n,l,d){return t*d-n*l},zi.interpolateZ=function(t,n,l,d){var v=n.x,C=n.y,z=l.x-v,W=d.x-v,gt=l.y-C,Bt=d.y-C,Se=z*Bt-W*gt,Ae=t.x-v,rn=t.y-C,Nn=(Bt*Ae-W*rn)/Se,ei=(-gt*Ae+z*rn)/Se,ci=n.z+Nn*(l.z-n.z)+ei*(d.z-n.z);return ci},zi.longestSideLength=function(t,n,l){var d=t.distance(n),v=n.distance(l),C=l.distance(t),z=d;return v>z&&(z=v),C>z&&(z=C),z},zi.isAcute=function(t,n,l){return Jn.isAcute(t,n,l)&&Jn.isAcute(n,l,t)?!!Jn.isAcute(l,t,n):!1},zi.circumcentre=function(t,n,l){var d=l.x,v=l.y,C=t.x-d,z=t.y-v,W=n.x-d,gt=n.y-v,Bt=2*zi.det(C,z,W,gt),Se=zi.det(z,C*C+z*z,gt,W*W+gt*gt),Ae=zi.det(C,C*C+z*z,W,W*W+gt*gt),rn=d-Se/Bt,Nn=v+Ae/Bt;return new it(rn,Nn)},zi.perpendicularBisector=function(t,n){var l=n.x-t.x,d=n.y-t.y,v=new Zt(t.x+l/2,t.y+d/2,1),C=new Zt(t.x-d+l/2,t.y+l+d/2,1);return new Zt(v,C)},zi.angleBisector=function(t,n,l){var d=n.distance(t),v=n.distance(l),C=d/(d+v),z=l.x-t.x,W=l.y-t.y,gt=new it(t.x+C*z,t.y+C*W);return gt},zi.area3D=function(t,n,l){var d=n.x-t.x,v=n.y-t.y,C=n.z-t.z,z=l.x-t.x,W=l.y-t.y,gt=l.z-t.z,Bt=v*gt-C*W,Se=C*z-d*gt,Ae=d*W-v*z,rn=Bt*Bt+Se*Se+Ae*Ae,Nn=Math.sqrt(rn)/2;return Nn},zi.centroid=function(t,n,l){var d=(t.x+n.x+l.x)/3,v=(t.y+n.y+l.y)/3;return new it(d,v)},zi.inCentre=function(t,n,l){var d=n.distance(l),v=t.distance(l),C=t.distance(n),z=d+v+C,W=(d*t.x+v*n.x+C*l.x)/z,gt=(d*t.y+v*n.y+C*l.y)/z;return new it(W,gt)},T(tr.prototype,{getRadius:function(){return this.compute(),this.radius},getDiameter:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],n=this.extremalPts[1];return this.input.getFactory().createLineString([t,n])},getExtremalPoints:function(){return this.compute(),this.extremalPts},computeCirclePoints:function(){if(this.input.isEmpty())return this.extremalPts=new Array(0).fill(null),null;if(this.input.getNumPoints()===1){var l=this.input.getCoordinates();return this.extremalPts=[new it(l[0])],null}var t=this.input.convexHull(),n=t.getCoordinates(),l=n;if(n[0].equals2D(n[n.length-1])&&(l=new Array(n.length-1).fill(null),Bn.copyDeep(n,0,l,0,n.length-1)),l.length<=2)return this.extremalPts=Bn.copyDeep(l),null;for(var d=tr.lowestPoint(l),v=tr.pointWitMinAngleWithX(l,d),C=0;C<l.length;C++){var z=tr.pointWithMinAngleWithSegment(l,d,v);if(Jn.isObtuse(d,z,v))return this.extremalPts=[new it(d),new it(v)],null;if(Jn.isObtuse(z,d,v))d=z;else{if(!Jn.isObtuse(z,v,d))return this.extremalPts=[new it(d),new it(v),new it(z)],null;v=z}}yt.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")},compute:function(){return this.extremalPts!==null?null:(this.computeCirclePoints(),this.computeCentre(),void(this.centre!==null&&(this.radius=this.centre.distance(this.extremalPts[0]))))},getFarthestPoints:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],n=this.extremalPts[this.extremalPts.length-1];return this.input.getFactory().createLineString([t,n])},getCircle:function(){if(this.compute(),this.centre===null)return this.input.getFactory().createPolygon();var t=this.input.getFactory().createPoint(this.centre);return this.radius===0?t:t.buffer(this.radius)},getCentre:function(){return this.compute(),this.centre},computeCentre:function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new it((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=zi.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2])}},interfaces_:function(){return[]},getClass:function(){return tr}}),tr.pointWitMinAngleWithX=function(t,n){for(var l=j.MAX_VALUE,d=null,v=0;v<t.length;v++){var C=t[v];if(C!==n){var z=C.x-n.x,W=C.y-n.y;0>W&&(W=-W);var gt=Math.sqrt(z*z+W*W),Bt=W/gt;l>Bt&&(l=Bt,d=C)}}return d},tr.lowestPoint=function(t){for(var n=t[0],l=1;l<t.length;l++)t[l].y<n.y&&(n=t[l]);return n},tr.pointWithMinAngleWithSegment=function(t,n,l){for(var d=j.MAX_VALUE,v=null,C=0;C<t.length;C++){var z=t[C];if(z!==n&&z!==l){var W=Jn.angleBetween(n,z,l);d>W&&(d=W,v=z)}}return v},T(cr.prototype,{getWidthCoordinate:function(){return this.computeMinimumDiameter(),this.minWidthPt},getSupportingSegment:function(){return this.computeMinimumDiameter(),this.inputGeom.getFactory().createLineString([this.minBaseSeg.p0,this.minBaseSeg.p1])},getDiameter:function(){if(this.computeMinimumDiameter(),this.minWidthPt===null)return this.inputGeom.getFactory().createLineString(null);var t=this.minBaseSeg.project(this.minWidthPt);return this.inputGeom.getFactory().createLineString([t,this.minWidthPt])},computeWidthConvex:function(t){t instanceof Pi?this.convexHullPts=t.getExteriorRing().getCoordinates():this.convexHullPts=t.getCoordinates(),this.convexHullPts.length===0?(this.minWidth=0,this.minWidthPt=null,this.minBaseSeg=null):this.convexHullPts.length===1?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[0]):this.convexHullPts.length===2||this.convexHullPts.length===3?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[1]):this.computeConvexRingMinDiameter(this.convexHullPts)},computeConvexRingMinDiameter:function(t){this.minWidth=j.MAX_VALUE;for(var n=1,l=new gn,d=0;d<t.length-1;d++)l.p0=t[d],l.p1=t[d+1],n=this.findMaxPerpDistance(t,l,n)},computeMinimumDiameter:function(){if(this.minWidthPt!==null)return null;if(this.isConvex)this.computeWidthConvex(this.inputGeom);else{var t=new Ur(this.inputGeom).getConvexHull();this.computeWidthConvex(t)}},getLength:function(){return this.computeMinimumDiameter(),this.minWidth},findMaxPerpDistance:function(t,n,l){for(var d=n.distancePerpendicular(t[l]),v=d,C=l,z=C;v>=d;)d=v,C=z,z=cr.nextIndex(t,C),v=n.distancePerpendicular(t[z]);return d<this.minWidth&&(this.minPtIndex=C,this.minWidth=d,this.minWidthPt=t[this.minPtIndex],this.minBaseSeg=new gn(n)),C},getMinimumRectangle:function(){if(this.computeMinimumDiameter(),this.minWidth===0)return this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)?this.inputGeom.getFactory().createPoint(this.minBaseSeg.p0):this.minBaseSeg.toGeometry(this.inputGeom.getFactory());for(var t=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x,n=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y,l=j.MAX_VALUE,d=-j.MAX_VALUE,v=j.MAX_VALUE,C=-j.MAX_VALUE,z=0;z<this.convexHullPts.length;z++){var W=cr.computeC(t,n,this.convexHullPts[z]);W>d&&(d=W),l>W&&(l=W);var gt=cr.computeC(-n,t,this.convexHullPts[z]);gt>C&&(C=gt),v>gt&&(v=gt)}var Bt=cr.computeSegmentForLine(-t,-n,C),Se=cr.computeSegmentForLine(-t,-n,v),Ae=cr.computeSegmentForLine(-n,t,d),rn=cr.computeSegmentForLine(-n,t,l),Nn=Ae.lineIntersection(Bt),ei=rn.lineIntersection(Bt),ci=rn.lineIntersection(Se),Mr=Ae.lineIntersection(Se),_s=this.inputGeom.getFactory().createLinearRing([Nn,ei,ci,Mr,Nn]);return this.inputGeom.getFactory().createPolygon(_s,null)},interfaces_:function(){return[]},getClass:function(){return cr}}),cr.nextIndex=function(t,n){return n++,n>=t.length&&(n=0),n},cr.computeC=function(t,n,l){return t*l.y-n*l.x},cr.getMinimumDiameter=function(t){return new cr(t).getDiameter()},cr.getMinimumRectangle=function(t){return new cr(t).getMinimumRectangle()},cr.computeSegmentForLine=function(t,n,l){var d=null,v=null;return Math.abs(n)>Math.abs(t)?(d=new it(0,l/n),v=new it(1,l/n-t/n)):(d=new it(l/t,0),v=new it(l/t-n/t,1)),new gn(d,v)};var ii=Object.freeze({Centroid:Ts,CGAlgorithms:re,ConvexHull:Ur,InteriorPointArea:sr,InteriorPointLine:ds,InteriorPointPoint:Gr,RobustLineIntersector:ji,MinimumBoundingCircle:tr,MinimumDiameter:cr});T(Yo.prototype,{getResultGeometry:function(){return new wa(this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>=t)throw new q;this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return Yo}}),Yo.densifyPoints=function(t,n,l){for(var d=new gn,v=new Jt,C=0;C<t.length-1;C++){d.p0=t[C],d.p1=t[C+1],v.add(d.p0,!1);var z=d.getLength(),W=Math.trunc(z/n)+1;if(W>1)for(var gt=z/W,Bt=1;W>Bt;Bt++){var Se=Bt*gt/z,Ae=d.pointAlong(Se);l.makePrecise(Ae),v.add(Ae,!1)}}return v.add(t[t.length-1],!1),v.toCoordinateArray()},Yo.densify=function(t,n){var l=new Yo(t);return l.setDistanceTolerance(n),l.getResultGeometry()},st(wa,br),T(wa.prototype,{transformMultiPolygon:function(t,n){var l=br.prototype.transformMultiPolygon.call(this,t,n);return this.createValidArea(l)},transformPolygon:function(t,n){var l=br.prototype.transformPolygon.call(this,t,n);return n instanceof Ct?l:this.createValidArea(l)},transformCoordinates:function(t,n){var l=t.toCoordinateArray(),d=Yo.densifyPoints(l,this.distanceTolerance,n.getPrecisionModel());return n instanceof oi&&d.length===1&&(d=new Array(0).fill(null)),this.factory.getCoordinateSequenceFactory().create(d)},createValidArea:function(t){return t.buffer(0)},interfaces_:function(){return[]},getClass:function(){return wa}}),Yo.DensifyTransformer=wa;var di=Object.freeze({Densifier:Yo});T(Gs.prototype,{find:function(t){var n=this;do{if(n===null)return null;if(n.dest().equals2D(t))return n;n=n.oNext()}while(n!==this);return null},dest:function(){return this._sym._orig},oNext:function(){return this._sym._next},insert:function(t){if(this.oNext()===this)return this.insertAfter(t),null;var n=this.compareTo(t),l=this;do{var d=l.oNext(),v=d.compareTo(t);if(v!==n||d===this)return l.insertAfter(t),null;l=d}while(l!==this);yt.shouldNeverReachHere()},insertAfter:function(t){yt.equals(this._orig,t.orig());var n=this.oNext();this._sym.setNext(t),t.sym().setNext(n)},degree:function(){var n=0,l=this;do n++,l=l.oNext();while(l!==this);return n},equals:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(n)}},deltaY:function(){return this._sym._orig.y-this._orig.y},sym:function(){return this._sym},prev:function(){return this._sym.next()._sym},compareAngularDirection:function(t){var n=this.deltaX(),l=this.deltaY(),d=t.deltaX(),v=t.deltaY();if(n===d&&l===v)return 0;var C=Ci.quadrant(n,l),z=Ci.quadrant(d,v);return C>z?1:z>C?-1:re.computeOrientation(t._orig,t.dest(),this.dest())},prevNode:function(){for(var t=this;t.degree()===2;)if(t=t.prev(),t===this)return null;return t},compareTo:function(t){var n=t,l=this.compareAngularDirection(n);return l},next:function(){return this._next},setSym:function(t){this._sym=t},orig:function(){return this._orig},toString:function(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"},setNext:function(t){this._next=t},init:function(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)},deltaX:function(){return this._sym._orig.x-this._orig.x},interfaces_:function(){return[]},getClass:function(){return Gs}}),Gs.init=function(t,n){if(t._sym!==null||n._sym!==null||t._next!==null||n._next!==null)throw new IllegalStateException("Edges are already initialized");return t.init(n),t},Gs.create=function(t,n){var l=new Gs(t),d=new Gs(n);return l.init(d),l},st(ps,Gs),T(ps.prototype,{mark:function(){this._isMarked=!0},setMark:function(t){this._isMarked=t},isMarked:function(){return this._isMarked},interfaces_:function(){return[]},getClass:function(){return ps}}),ps.setMarkBoth=function(t,n){t.setMark(n),t.sym().setMark(n)},ps.isMarked=function(t){return t.isMarked()},ps.setMark=function(t,n){t.setMark(n)},ps.markBoth=function(t){t.mark(),t.sym().mark()},ps.mark=function(t){t.mark()},T(Ba.prototype,{insert:function(t,n,l){var d=this.create(t,n);l!==null?l.insert(d):this.vertexMap.put(t,d);var v=this.vertexMap.get(n);return v!==null?v.insert(d.sym()):this.vertexMap.put(n,d.sym()),d},create:function(t,n){var l=this.createEdge(t),d=this.createEdge(n);return Gs.init(l,d),l},createEdge:function(t){return new Gs(t)},addEdge:function(t,n){if(!Ba.isValidEdge(t,n))return null;var l=this.vertexMap.get(t),d=null;if(l!==null&&(d=l.find(n)),d!==null)return d;var v=this.insert(t,n,l);return v},getVertexEdges:function(){return this.vertexMap.values()},findEdge:function(t,n){var l=this.vertexMap.get(t);return l===null?null:l.find(n)},interfaces_:function(){return[]},getClass:function(){return Ba}}),Ba.isValidEdge=function(t,n){var l=n.compareTo(t);return l!==0},st(Sl,ps),T(Sl.prototype,{setStart:function(){this._isStart=!0},isStart:function(){return this._isStart},interfaces_:function(){return[]},getClass:function(){return Sl}}),st(Tl,Ba),T(Tl.prototype,{createEdge:function(t){return new Sl(t)},interfaces_:function(){return[]},getClass:function(){return Tl}}),T(or.prototype,{addLine:function(t){this.lines.add(this.factory.createLineString(t.toCoordinateArray()))},updateRingStartEdge:function(t){return t.isStart()||(t=t.sym(),t.isStart())?this.ringStartEdge===null?(this.ringStartEdge=t,null):void(t.orig().compareTo(this.ringStartEdge.orig())<0&&(this.ringStartEdge=t)):null},getResult:function(){return this.result===null&&this.computeResult(),this.result},process:function(t){var n=t.prevNode();n===null&&(n=t),this.stackEdges(n),this.buildLines()},buildRing:function(t){var n=new Jt,l=t;for(n.add(l.orig().copy(),!1);l.sym().degree()===2;){var d=l.next();if(d===t)break;n.add(d.orig().copy(),!1),l=d}n.add(l.dest().copy(),!1),this.addLine(n)},buildLine:function(t){var n=new Jt,l=t;for(this.ringStartEdge=null,ps.markBoth(l),n.add(l.orig().copy(),!1);l.sym().degree()===2;){this.updateRingStartEdge(l);var d=l.next();if(d===t)return this.buildRing(this.ringStartEdge),null;n.add(d.orig().copy(),!1),l=d,ps.markBoth(l)}n.add(l.dest().copy(),!1),this.stackEdges(l.sym()),this.addLine(n)},stackEdges:function(t){var n=t;do ps.isMarked(n)||this.nodeEdgeStack.add(n),n=n.oNext();while(n!==t)},computeResult:function(){for(var t=this.graph.getVertexEdges(),n=t.iterator();n.hasNext();){var l=n.next();ps.isMarked(l)||this.process(l)}this.result=this.factory.buildGeometry(this.lines)},buildLines:function(){for(;!this.nodeEdgeStack.empty();){var t=this.nodeEdgeStack.pop();ps.isMarked(t)||this.buildLine(t)}},add:function(){if(arguments[0]instanceof de){var t=arguments[0];t.apply({interfaces_:function(){return[Be]},filter:function(gt){gt instanceof oi&&this.add(gt)}})}else if(qe(arguments[0],Ft))for(var n=arguments[0],l=n.iterator();l.hasNext();){var d=l.next();this.add(d)}else if(arguments[0]instanceof oi){var v=arguments[0];this.factory===null&&(this.factory=v.getFactory());for(var C=v.getCoordinateSequence(),z=!1,l=1;l<C.size();l++){var W=this.graph.addEdge(C.getCoordinate(l-1),C.getCoordinate(l));W!==null&&(z||(W.setStart(),z=!0))}}},interfaces_:function(){return[]},getClass:function(){return or}}),or.dissolve=function(t){var n=new or;return n.add(t),n.getResult()};var Er=Object.freeze({LineDissolver:or});T(Ai.prototype,{hasChildren:function(){for(var t=0;4>t;t++)if(this.subnode[t]!==null)return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var n=0;4>n;n++)this.subnode[n]!==null&&this.subnode[n].addAllItems(t);return t},getNodeCount:function(){for(var t=0,n=0;4>n;n++)this.subnode[n]!==null&&(t+=this.subnode[n].size());return t+1},size:function(){for(var t=0,n=0;4>n;n++)this.subnode[n]!==null&&(t+=this.subnode[n].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,n){if(!this.isSearchMatch(t))return null;n.addAll(this.items);for(var l=0;4>l;l++)this.subnode[l]!==null&&this.subnode[l].addAllItemsFromOverlapping(t,n)},visitItems:function(t,n){for(var l=this.items.iterator();l.hasNext();)n.visitItem(l.next())},hasItems:function(){return!this.items.isEmpty()},remove:function(t,n){if(!this.isSearchMatch(t))return!1;for(var l=!1,d=0;4>d;d++)if(this.subnode[d]!==null&&(l=this.subnode[d].remove(t,n))){this.subnode[d].isPrunable()&&(this.subnode[d]=null);break}return l||(l=this.items.remove(n))},visit:function(t,n){if(!this.isSearchMatch(t))return null;this.visitItems(t,n);for(var l=0;4>l;l++)this.subnode[l]!==null&&this.subnode[l].visit(t,n)},getItems:function(){return this.items},depth:function(){for(var t=0,n=0;4>n;n++)if(this.subnode[n]!==null){var l=this.subnode[n].depth();l>t&&(t=l)}return t+1},isEmpty:function(){var n=!0;this.items.isEmpty()||(n=!1);for(var l=0;4>l;l++)this.subnode[l]!==null&&(this.subnode[l].isEmpty()||(n=!1));return n},add:function(t){this.items.add(t)},interfaces_:function(){return[tt]},getClass:function(){return Ai}}),Ai.getSubnodeIndex=function(t,n,l){var d=-1;return t.getMinX()>=n&&(t.getMinY()>=l&&(d=3),t.getMaxY()<=l&&(d=1)),t.getMaxX()<=n&&(t.getMinY()>=l&&(d=2),t.getMaxY()<=l&&(d=0)),d},oa.exponent=function(t){return nl(64,t)-1023},oa.powerOf2=function(t){return Math.pow(2,t)},T(Do.prototype,{getLevel:function(){return this.level},computeKey:function(){if(arguments.length===1){var t=arguments[0];for(this.level=Do.computeQuadLevel(t),this.env=new Xt,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1],d=oa.powerOf2(n);this.pt.x=Math.floor(l.getMinX()/d)*d,this.pt.y=Math.floor(l.getMinY()/d)*d,this.env.init(this.pt.x,this.pt.x+d,this.pt.y,this.pt.y+d)}},getEnvelope:function(){return this.env},getCentre:function(){return new it((this.env.getMinX()+this.env.getMaxX())/2,(this.env.getMinY()+this.env.getMaxY())/2)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Do}}),Do.computeQuadLevel=function(t){var n=t.getWidth(),l=t.getHeight(),d=n>l?n:l,v=oa.exponent(d)+1;return v},st(Or,Ai),T(Or.prototype,{find:function(t){var n=Ai.getSubnodeIndex(t,this.centrex,this.centrey);if(n===-1)return this;if(this.subnode[n]!==null){var l=this.subnode[n];return l.find(t)}return this},isSearchMatch:function(t){return this.env.intersects(t)},getSubnode:function(t){return this.subnode[t]===null&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getEnvelope:function(){return this.env},getNode:function(t){var n=Ai.getSubnodeIndex(t,this.centrex,this.centrey);if(n!==-1){var l=this.getSubnode(n);return l.getNode(t)}return this},createSubnode:function(t){var n=0,l=0,d=0,v=0;switch(t){case 0:n=this.env.getMinX(),l=this.centrex,d=this.env.getMinY(),v=this.centrey;break;case 1:n=this.centrex,l=this.env.getMaxX(),d=this.env.getMinY(),v=this.centrey;break;case 2:n=this.env.getMinX(),l=this.centrex,d=this.centrey,v=this.env.getMaxY();break;case 3:n=this.centrex,l=this.env.getMaxX(),d=this.centrey,v=this.env.getMaxY()}var C=new Xt(n,l,d,v),z=new Or(C,this.level-1);return z},insertNode:function(t){yt.isTrue(this.env===null||this.env.contains(t.env));var n=Ai.getSubnodeIndex(t.env,this.centrex,this.centrey);if(t.level===this.level-1)this.subnode[n]=t;else{var l=this.createSubnode(n);l.insertNode(t),this.subnode[n]=l}},interfaces_:function(){return[]},getClass:function(){return Or}}),Or.createNode=function(t){var n=new Do(t),l=new Or(n.getEnvelope(),n.getLevel());return l},Or.createExpanded=function(t,n){var l=new Xt(n);t!==null&&l.expandToInclude(t.env);var d=Or.createNode(l);return t!==null&&d.insertNode(t),d},T(Bs.prototype,{interfaces_:function(){return[]},getClass:function(){return Bs}}),Bs.isZeroWidth=function(t,n){var l=n-t;if(l===0)return!0;var d=Math.max(Math.abs(t),Math.abs(n)),v=l/d,C=oa.exponent(v);return C<=Bs.MIN_BINARY_EXPONENT},Bs.MIN_BINARY_EXPONENT=-50,st(mo,Ai),T(mo.prototype,{insert:function(t,n){var l=Ai.getSubnodeIndex(t,mo.origin.x,mo.origin.y);if(l===-1)return this.add(n),null;var d=this.subnode[l];if(d===null||!d.getEnvelope().contains(t)){var v=Or.createExpanded(d,t);this.subnode[l]=v}this.insertContained(this.subnode[l],t,n)},isSearchMatch:function(t){return!0},insertContained:function(t,n,l){yt.isTrue(t.getEnvelope().contains(n));var d=Bs.isZeroWidth(n.getMinX(),n.getMaxX()),v=Bs.isZeroWidth(n.getMinY(),n.getMaxY()),C=null;C=d||v?t.find(n):t.getNode(n),C.add(l)},interfaces_:function(){return[]},getClass:function(){return mo}}),mo.origin=new it(0,0),T(Vs.prototype,{size:function(){return this.root!==null?this.root.size():0},insert:function(t,n){this.collectStats(t);var l=Vs.ensureExtent(t,this.minExtent);this.root.insert(l,n)},query:function(){if(arguments.length===1){var t=arguments[0],n=new El;return this.query(t,n),n.getItems()}if(arguments.length===2){var l=arguments[0],d=arguments[1];this.root.visit(l,d)}},queryAll:function(){var t=new _t;return this.root.addAllItems(t),t},remove:function(t,n){var l=Vs.ensureExtent(t,this.minExtent);return this.root.remove(l,n)},collectStats:function(t){var n=t.getWidth();n<this.minExtent&&n>0&&(this.minExtent=n);var l=t.getHeight();l<this.minExtent&&l>0&&(this.minExtent=l)},depth:function(){return this.root!==null?this.root.depth():0},isEmpty:function(){return this.root===null},interfaces_:function(){return[Ni,tt]},getClass:function(){return Vs}}),Vs.ensureExtent=function(t,n){var l=t.getMinX(),d=t.getMaxX(),v=t.getMinY(),C=t.getMaxY();return l!==d&&v!==C?t:(l===d&&(l-=n/2,d=l+n/2),v===C&&(v-=n/2,C=v+n/2),new Xt(l,d,v,C))},Vs.serialVersionUID=-7461163625812743e3;var pi=Object.freeze({Quadtree:Vs}),ar=Object.freeze({STRtree:xn}),Xs=Object.freeze({quadtree:pi,strtree:ar}),Ko=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];T(Wl.prototype,{read:function(t){var n=void 0;n=typeof t=="string"?JSON.parse(t):t;var l=n.type;if(!ks[l])throw new Error("Unknown GeoJSON type: "+n.type);return Ko.indexOf(l)!==-1?ks[l].apply(this,[n.coordinates]):l==="GeometryCollection"?ks[l].apply(this,[n.geometries]):ks[l].apply(this,[n])},write:function(t){var n=t.getGeometryType();if(!er[n])throw new Error("Geometry is not supported");return er[n].apply(this,[t])}});var ks={Feature:function(t){var n={};for(var l in t)n[l]=t[l];if(t.geometry){var d=t.geometry.type;if(!ks[d])throw new Error("Unknown GeoJSON type: "+t.type);n.geometry=this.read(t.geometry)}return t.bbox&&(n.bbox=ks.bbox.apply(this,[t.bbox])),n},FeatureCollection:function(t){var n={};if(t.features){n.features=[];for(var l=0;l<t.features.length;++l)n.features.push(this.read(t.features[l]))}return t.bbox&&(n.bbox=this.parse.bbox.apply(this,[t.bbox])),n},coordinates:function(n){for(var l=[],d=0;d<n.length;++d){var v=n[d];l.push(new it(v[0],v[1]))}return l},bbox:function(t){return this.geometryFactory.createLinearRing([new it(t[0],t[1]),new it(t[2],t[1]),new it(t[2],t[3]),new it(t[0],t[3]),new it(t[0],t[1])])},Point:function(t){var n=new it(t[0],t[1]);return this.geometryFactory.createPoint(n)},MultiPoint:function(t){for(var n=[],l=0;l<t.length;++l)n.push(ks.Point.apply(this,[t[l]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(t){var n=ks.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(n)},MultiLineString:function(t){for(var n=[],l=0;l<t.length;++l)n.push(ks.LineString.apply(this,[t[l]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(t){for(var n=ks.coordinates.apply(this,[t[0]]),l=this.geometryFactory.createLinearRing(n),d=[],v=1;v<t.length;++v){var C=t[v],z=ks.coordinates.apply(this,[C]),W=this.geometryFactory.createLinearRing(z);d.push(W)}return this.geometryFactory.createPolygon(l,d)},MultiPolygon:function(t){for(var n=[],l=0;l<t.length;++l){var d=t[l];n.push(ks.Polygon.apply(this,[d]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(t){for(var n=[],l=0;l<t.length;++l){var d=t[l];n.push(this.read(d))}return this.geometryFactory.createGeometryCollection(n)}},er={coordinate:function(t){return[t.x,t.y]},Point:function(t){var n=er.coordinate.apply(this,[t.getCoordinate()]);return{type:"Point",coordinates:n}},MultiPoint:function(t){for(var n=[],l=0;l<t.geometries.length;++l){var d=t.geometries[l],v=er.Point.apply(this,[d]);n.push(v.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(t){for(var n=[],l=t.getCoordinates(),d=0;d<l.length;++d){var v=l[d];n.push(er.coordinate.apply(this,[v]))}return{type:"LineString",coordinates:n}},MultiLineString:function(t){for(var n=[],l=0;l<t.geometries.length;++l){var d=t.geometries[l],v=er.LineString.apply(this,[d]);n.push(v.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(t){var n=[],l=er.LineString.apply(this,[t.shell]);n.push(l.coordinates);for(var d=0;d<t.holes.length;++d){var v=t.holes[d],C=er.LineString.apply(this,[v]);n.push(C.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(t){for(var n=[],l=0;l<t.geometries.length;++l){var d=t.geometries[l],v=er.Polygon.apply(this,[d]);n.push(v.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(t){for(var n=[],l=0;l<t.geometries.length;++l){var d=t.geometries[l],v=d.getGeometryType();n.push(er[v].apply(this,[d]))}return{type:"GeometryCollection",geometries:n}}};T(il.prototype,{read:function(t){var n=this.parser.read(t);return this.precisionModel.getType()===_e.FIXED&&this.reducePrecision(n),n},reducePrecision:function(t){var n,l;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(n=0,l=t.points.length;l>n;n++)this.precisionModel.makePrecise(t.points[n]);else if(t.geometries)for(n=0,l=t.geometries.length;l>n;n++)this.reducePrecision(t.geometries[n])}}),T(yo.prototype,{write:function(t){return this.parser.write(t)}}),T($l.prototype,{read:function(t){var n=this.parser.read(t);return this.precisionModel.getType()===_e.FIXED&&this.reducePrecision(n),n},reducePrecision:function(t){if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(var n=0,l=t.points.coordinates.length;l>n;n++)this.precisionModel.makePrecise(t.points.coordinates[n]);else if(t.geometries)for(var d=0,v=t.geometries.length;v>d;d++)this.reducePrecision(t.geometries[d])}}),T(Ea.prototype,{read:function(t){return t instanceof ol.geom.Point?this.convertFromPoint(t):t instanceof ol.geom.LineString?this.convertFromLineString(t):t instanceof ol.geom.LinearRing?this.convertFromLinearRing(t):t instanceof ol.geom.Polygon?this.convertFromPolygon(t):t instanceof ol.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof ol.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof ol.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof ol.geom.GeometryCollection?this.convertFromCollection(t):void 0},convertFromPoint:function(t){var n=t.getCoordinates();return this.geometryFactory.createPoint(new it(n[0],n[1]))},convertFromLineString:function(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(n){return new it(n[0],n[1])}))},convertFromLinearRing:function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(n){return new it(n[0],n[1])}))},convertFromPolygon:function(t){for(var n=t.getLinearRings(),l=null,d=[],v=0;v<n.length;v++){var C=this.convertFromLinearRing(n[v]);v===0?l=C:d.push(C)}return this.geometryFactory.createPolygon(l,d)},convertFromMultiPoint:function(t){var n=t.getPoints().map(function(l){return this.convertFromPoint(l)},this);return this.geometryFactory.createMultiPoint(n)},convertFromMultiLineString:function(t){var n=t.getLineStrings().map(function(l){return this.convertFromLineString(l)},this);return this.geometryFactory.createMultiLineString(n)},convertFromMultiPolygon:function(t){var n=t.getPolygons().map(function(l){return this.convertFromPolygon(l)},this);return this.geometryFactory.createMultiPolygon(n)},convertFromCollection:function(t){var n=t.getGeometries().map(function(l){return this.read(l)},this);return this.geometryFactory.createGeometryCollection(n)},write:function(t){return t.getGeometryType()==="Point"?this.convertToPoint(t.getCoordinate()):t.getGeometryType()==="LineString"?this.convertToLineString(t):t.getGeometryType()==="LinearRing"?this.convertToLinearRing(t):t.getGeometryType()==="Polygon"?this.convertToPolygon(t):t.getGeometryType()==="MultiPoint"?this.convertToMultiPoint(t):t.getGeometryType()==="MultiLineString"?this.convertToMultiLineString(t):t.getGeometryType()==="MultiPolygon"?this.convertToMultiPolygon(t):t.getGeometryType()==="GeometryCollection"?this.convertToCollection(t):void 0},convertToPoint:function(t){return new ol.geom.Point([t.x,t.y])},convertToLineString:function(t){var n=t.points.coordinates.map(rl);return new ol.geom.LineString(n)},convertToLinearRing:function(t){var n=t.points.coordinates.map(rl);return new ol.geom.LinearRing(n)},convertToPolygon:function(t){for(var n=[t.shell.points.coordinates.map(rl)],l=0;l<t.holes.length;l++)n.push(t.holes[l].points.coordinates.map(rl));return new ol.geom.Polygon(n)},convertToMultiPoint:function(t){return new ol.geom.MultiPoint(t.getCoordinates().map(rl))},convertToMultiLineString:function(t){for(var n=[],l=0;l<t.geometries.length;l++)n.push(this.convertToLineString(t.geometries[l]).getCoordinates());return new ol.geom.MultiLineString(n)},convertToMultiPolygon:function(t){for(var n=[],l=0;l<t.geometries.length;l++)n.push(this.convertToPolygon(t.geometries[l]).getCoordinates());return new ol.geom.MultiPolygon(n)},convertToCollection:function(t){for(var n=[],l=0;l<t.geometries.length;l++){var d=t.geometries[l];n.push(this.write(d))}return new ol.geom.GeometryCollection(n)}});var Wr=Object.freeze({GeoJSONReader:il,GeoJSONWriter:yo,OL3Parser:Ea,WKTReader:$l,WKTWriter:Ns});T(Wo.prototype,{rescale:function(){if(qe(arguments[0],Ft))for(var t=arguments[0],n=t.iterator();n.hasNext();){var l=n.next();this.rescale(l.getCoordinates())}else if(arguments[0]instanceof Array){var d=arguments[0];d.length===2&&(new it(d[0]),new it(d[1]));for(var n=0;n<d.length;n++)d[n].x=d[n].x/this.scaleFactor+this.offsetX,d[n].y=d[n].y/this.scaleFactor+this.offsetY;d.length===2&&d[0].equals2D(d[1])&&mt.out.println(d)}},scale:function(){if(qe(arguments[0],Ft)){for(var t=arguments[0],n=new _t,l=t.iterator();l.hasNext();){var d=l.next();n.add(new Co(this.scale(d.getCoordinates()),d.getData()))}return n}if(arguments[0]instanceof Array){for(var v=arguments[0],C=new Array(v.length).fill(null),l=0;l<v.length;l++)C[l]=new it(Math.round((v[l].x-this.offsetX)*this.scaleFactor),Math.round((v[l].y-this.offsetY)*this.scaleFactor),v[l].z);var z=Bn.removeRepeatedPoints(C);return z}},isIntegerPrecision:function(){return this.scaleFactor===1},getNodedSubstrings:function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},computeNodes:function(t){var n=t;this.isScaled&&(n=this.scale(t)),this.noder.computeNodes(n)},interfaces_:function(){return[fo]},getClass:function(){return Wo}});var nr=Object.freeze({MCIndexNoder:jo,ScaledNoder:Wo,SegmentString:wn});T(sl.prototype,{isSimpleMultiPoint:function(t){if(t.isEmpty())return!0;for(var n=new Qr,l=0;l<t.getNumGeometries();l++){var d=t.getGeometryN(l),v=d.getCoordinate();if(n.contains(v))return this.nonSimpleLocation=v,!1;n.add(v)}return!0},isSimplePolygonal:function(t){for(var n=Nr.getLines(t),l=n.iterator();l.hasNext();){var d=l.next();if(!this.isSimpleLinearGeometry(d))return!1}return!0},hasClosedEndpointIntersection:function(t){for(var n=new Ri,l=t.getEdgeIterator();l.hasNext();){var d=l.next(),v=(d.getMaximumSegmentIndex(),d.isClosed()),C=d.getCoordinate(0);this.addEndpoint(n,C,v);var z=d.getCoordinate(d.getNumPoints()-1);this.addEndpoint(n,z,v)}for(var l=n.values().iterator();l.hasNext();){var W=l.next();if(W.isClosed&&W.degree!==2)return this.nonSimpleLocation=W.getCoordinate(),!0}return!1},getNonSimpleLocation:function(){return this.nonSimpleLocation},isSimpleLinearGeometry:function(t){if(t.isEmpty())return!0;var n=new oe(0,t),l=new ji,d=n.computeSelfNodes(l,!0);return d.hasIntersection()?d.hasProperIntersection()?(this.nonSimpleLocation=d.getProperIntersectionPoint(),!1):this.hasNonEndpointIntersection(n)?!1:!this.isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(n):!0},hasNonEndpointIntersection:function(t){for(var n=t.getEdgeIterator();n.hasNext();)for(var l=n.next(),d=l.getMaximumSegmentIndex(),v=l.getEdgeIntersectionList().iterator();v.hasNext();){var C=v.next();if(!C.isEndPoint(d))return this.nonSimpleLocation=C.getCoordinate(),!0}return!1},addEndpoint:function(t,n,l){var d=t.get(n);d===null&&(d=new _o(n),t.put(n,d)),d.addEndpoint(l)},computeSimple:function(t){return this.nonSimpleLocation=null,t.isEmpty()?!0:t instanceof oi?this.isSimpleLinearGeometry(t):t instanceof Ki?this.isSimpleLinearGeometry(t):t instanceof Zr?this.isSimpleMultiPoint(t):qe(t,ts)?this.isSimplePolygonal(t):t instanceof ri?this.isSimpleGeometryCollection(t):!0},isSimple:function(){return this.nonSimpleLocation=null,this.computeSimple(this.inputGeom)},isSimpleGeometryCollection:function(t){for(var n=0;n<t.getNumGeometries();n++){var l=t.getGeometryN(n);if(!this.computeSimple(l))return!1}return!0},interfaces_:function(){return[]},getClass:function(){return sl}}),T(_o.prototype,{addEndpoint:function(t){this.degree++,this.isClosed|=t},getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return _o}}),sl.EndpointInfo=_o,T(In.prototype,{getEndCapStyle:function(){return this.endCapStyle},isSingleSided:function(){return this._isSingleSided},setQuadrantSegments:function(t){this.quadrantSegments=t,this.quadrantSegments===0&&(this.joinStyle=In.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=In.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),0>=t&&(this.quadrantSegments=1),this.joinStyle!==In.JOIN_ROUND&&(this.quadrantSegments=In.DEFAULT_QUADRANT_SEGMENTS)},getJoinStyle:function(){return this.joinStyle},setJoinStyle:function(t){this.joinStyle=t},setSimplifyFactor:function(t){this.simplifyFactor=0>t?0:t},getSimplifyFactor:function(){return this.simplifyFactor},getQuadrantSegments:function(){return this.quadrantSegments},setEndCapStyle:function(t){this.endCapStyle=t},getMitreLimit:function(){return this.mitreLimit},setMitreLimit:function(t){this.mitreLimit=t},setSingleSided:function(t){this._isSingleSided=t},interfaces_:function(){return[]},getClass:function(){return In}}),In.bufferDistanceError=function(t){var n=Math.PI/2/t;return 1-Math.cos(n/2)},In.CAP_ROUND=1,In.CAP_FLAT=2,In.CAP_SQUARE=3,In.JOIN_ROUND=1,In.JOIN_MITRE=2,In.JOIN_BEVEL=3,In.DEFAULT_QUADRANT_SEGMENTS=8,In.DEFAULT_MITRE_LIMIT=5,In.DEFAULT_SIMPLIFY_FACTOR=.01,T(so.prototype,{getCoordinate:function(){return this.minCoord},getRightmostSide:function(t,n){var l=this.getRightmostSideOfSegment(t,n);return 0>l&&(l=this.getRightmostSideOfSegment(t,n-1)),0>l&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),l},findRightmostEdgeAtVertex:function(){var t=this.minDe.getEdge().getCoordinates();yt.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var n=t[this.minIndex-1],l=t[this.minIndex+1],d=re.computeOrientation(this.minCoord,l,n),v=!1;(n.y<this.minCoord.y&&l.y<this.minCoord.y&&d===re.COUNTERCLOCKWISE||n.y>this.minCoord.y&&l.y>this.minCoord.y&&d===re.CLOCKWISE)&&(v=!0),v&&(this.minIndex=this.minIndex-1)},getRightmostSideOfSegment:function(t,n){var l=t.getEdge(),d=l.getCoordinates();if(0>n||n+1>=d.length||d[n].y===d[n+1].y)return-1;var v=Ke.LEFT;return d[n].y<d[n+1].y&&(v=Ke.RIGHT),v},getEdge:function(){return this.orientedDe},checkForRightmostCoordinate:function(t){for(var n=t.getEdge().getCoordinates(),l=0;l<n.length-1;l++)(this.minCoord===null||n[l].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=l,this.minCoord=n[l])},findRightmostEdgeAtNode:function(){var t=this.minDe.getNode(),n=t.getEdges();this.minDe=n.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},findEdge:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();l.isForward()&&this.checkForRightmostCoordinate(l)}yt.isTrue(this.minIndex!==0||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),this.minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe;var d=this.getRightmostSide(this.minDe,this.minIndex);d===Ke.LEFT&&(this.orientedDe=this.minDe.getSym())},interfaces_:function(){return[]},getClass:function(){return so}}),aa.prototype.addLast=function(t){this.array_.push(t)},aa.prototype.removeFirst=function(){return this.array_.shift()},aa.prototype.isEmpty=function(){return this.array_.length===0},T(pu.prototype,{clearVisitedEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var n=t.next();n.setVisited(!1)}},getRightmostCoordinate:function(){return this.rightMostCoord},computeNodeDepth:function(t){for(var n=null,l=t.getEdges().iterator();l.hasNext();){var d=l.next();if(d.isVisited()||d.getSym().isVisited()){n=d;break}}if(n===null)throw new Cs("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(n);for(var l=t.getEdges().iterator();l.hasNext();){var d=l.next();d.setVisited(!0),this.copySymDepths(d)}},computeDepth:function(t){this.clearVisitedEdges();var n=this.finder.getEdge();n.getNode(),n.getLabel(),n.setEdgeDepths(Ke.RIGHT,t),this.copySymDepths(n),this.computeDepths(n)},create:function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},findResultEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var n=t.next();n.getDepth(Ke.RIGHT)>=1&&n.getDepth(Ke.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}},computeDepths:function(t){var n=new mr,l=new aa,d=t.getNode();for(l.addLast(d),n.add(d),t.setVisited(!0);!l.isEmpty();){var v=l.removeFirst();n.add(v),this.computeNodeDepth(v);for(var C=v.getEdges().iterator();C.hasNext();){var z=C.next(),W=z.getSym();if(!W.isVisited()){var gt=W.getNode();n.contains(gt)||(l.addLast(gt),n.add(gt))}}}},compareTo:function(t){var n=t;return this.rightMostCoord.x<n.rightMostCoord.x?-1:this.rightMostCoord.x>n.rightMostCoord.x?1:0},getEnvelope:function(){if(this.env===null){for(var t=new Xt,n=this.dirEdgeList.iterator();n.hasNext();)for(var l=n.next(),d=l.getEdge().getCoordinates(),v=0;v<d.length-1;v++)t.expandToInclude(d[v]);this.env=t}return this.env},addReachable:function(t){var n=new Hn;for(n.add(t);!n.empty();){var l=n.pop();this.add(l,n)}},copySymDepths:function(t){var n=t.getSym();n.setDepth(Ke.LEFT,t.getDepth(Ke.RIGHT)),n.setDepth(Ke.RIGHT,t.getDepth(Ke.LEFT))},add:function(t,n){t.setVisited(!0),this.nodes.add(t);for(var l=t.getEdges().iterator();l.hasNext();){var d=l.next();this.dirEdgeList.add(d);var v=d.getSym(),C=v.getNode();C.isVisited()||n.push(C)}},getNodes:function(){return this.nodes},getDirectedEdges:function(){return this.dirEdgeList},interfaces_:function(){return[J]},getClass:function(){return pu}}),T(es.prototype,{isDeletable:function(t,n,l,d){var v=this.inputLine[t],C=this.inputLine[n],z=this.inputLine[l];return this.isConcave(v,C,z)&&this.isShallow(v,C,z,d)?this.isShallowSampled(v,C,t,l,d):!1},deleteShallowConcavities:function(){for(var t=1,n=(this.inputLine.length-1,this.findNextNonDeletedIndex(t)),l=this.findNextNonDeletedIndex(n),d=!1;l<this.inputLine.length;){var v=!1;this.isDeletable(t,n,l,this.distanceTol)&&(this.isDeleted[n]=es.DELETE,v=!0,d=!0),t=v?l:n,n=this.findNextNonDeletedIndex(t),l=this.findNextNonDeletedIndex(n)}return d},isShallowConcavity:function(t,n,l,d){var v=re.computeOrientation(t,n,l),C=v===this.angleOrientation;if(!C)return!1;var z=re.distancePointLine(n,t,l);return d>z},isShallowSampled:function(t,n,l,d,v){var C=Math.trunc((d-l)/es.NUM_PTS_TO_CHECK);0>=C&&(C=1);for(var z=l;d>z;z+=C)if(!this.isShallow(t,n,this.inputLine[z],v))return!1;return!0},isConcave:function(n,l,d){var v=re.computeOrientation(n,l,d),C=v===this.angleOrientation;return C},simplify:function(t){this.distanceTol=Math.abs(t),0>t&&(this.angleOrientation=re.CLOCKWISE),this.isDeleted=new Array(this.inputLine.length).fill(null);var n=!1;do n=this.deleteShallowConcavities();while(n);return this.collapseLine()},findNextNonDeletedIndex:function(t){for(var n=t+1;n<this.inputLine.length&&this.isDeleted[n]===es.DELETE;)n++;return n},isShallow:function(t,n,l,d){var v=re.distancePointLine(n,t,l);return d>v},collapseLine:function(){for(var t=new Jt,n=0;n<this.inputLine.length;n++)this.isDeleted[n]!==es.DELETE&&t.add(this.inputLine[n]);return t.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return es}}),es.simplify=function(t,n){var l=new es(t);return l.simplify(n)},es.INIT=0,es.DELETE=1,es.KEEP=1,es.NUM_PTS_TO_CHECK=10,T(Fu.prototype,{getCoordinates:function(){var t=this.ptList.toArray(Fu.COORDINATE_ARRAY_TYPE);return t},setPrecisionModel:function(t){this.precisionModel=t},addPt:function(t){var n=new it(t);return this.precisionModel.makePrecise(n),this.isRedundant(n)?null:void this.ptList.add(n)},reverse:function(){},addPts:function(t,n){if(n)for(var l=0;l<t.length;l++)this.addPt(t[l]);else for(var l=t.length-1;l>=0;l--)this.addPt(t[l])},isRedundant:function(t){if(this.ptList.size()<1)return!1;var n=this.ptList.get(this.ptList.size()-1),l=t.distance(n);return l<this.minimimVertexDistance},toString:function(){var t=new Rn,n=t.createLineString(this.getCoordinates());return n.toString()},closeRing:function(){if(this.ptList.size()<1)return null;var t=new it(this.ptList.get(0)),n=this.ptList.get(this.ptList.size()-1);return this.ptList.size()>=2&&this.ptList.get(this.ptList.size()-2),t.equals(n)?null:void this.ptList.add(t)},setMinimumVertexDistance:function(t){this.minimimVertexDistance=t},interfaces_:function(){return[]},getClass:function(){return Fu}}),Fu.COORDINATE_ARRAY_TYPE=new Array(0).fill(null),T($o.prototype,{addNextSegment:function(t,n){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),this.s1.equals(this.s2))return null;var l=re.computeOrientation(this.s0,this.s1,this.s2),d=l===re.CLOCKWISE&&this.side===Ke.LEFT||l===re.COUNTERCLOCKWISE&&this.side===Ke.RIGHT;l===0?this.addCollinear(n):d?this.addOutsideTurn(l,n):this.addInsideTurn(l,n)},addLineEndCap:function(t,n){var l=new gn(t,n),d=new gn;this.computeOffsetSegment(l,Ke.LEFT,this.distance,d);var v=new gn;this.computeOffsetSegment(l,Ke.RIGHT,this.distance,v);var C=n.x-t.x,z=n.y-t.y,W=Math.atan2(z,C);switch(this.bufParams.getEndCapStyle()){case In.CAP_ROUND:this.segList.addPt(d.p1),this.addFilletArc(n,W+Math.PI/2,W-Math.PI/2,re.CLOCKWISE,this.distance),this.segList.addPt(v.p1);break;case In.CAP_FLAT:this.segList.addPt(d.p1),this.segList.addPt(v.p1);break;case In.CAP_SQUARE:var gt=new it;gt.x=Math.abs(this.distance)*Math.cos(W),gt.y=Math.abs(this.distance)*Math.sin(W);var Bt=new it(d.p1.x+gt.x,d.p1.y+gt.y),Se=new it(v.p1.x+gt.x,v.p1.y+gt.y);this.segList.addPt(Bt),this.segList.addPt(Se)}},getCoordinates:function(){var t=this.segList.getCoordinates();return t},addMitreJoin:function(t,n,l,d){var v=!0,C=null;try{C=Zt.intersection(n.p0,n.p1,l.p0,l.p1);var z=0>=d?1:C.distance(t)/Math.abs(d);z>this.bufParams.getMitreLimit()&&(v=!1)}catch(W){if(!(W instanceof Yt))throw W;C=new it(0,0),v=!1}finally{}v?this.segList.addPt(C):this.addLimitedMitreJoin(n,l,d,this.bufParams.getMitreLimit())},addFilletCorner:function(t,n,l,d,v){var C=n.x-t.x,z=n.y-t.y,W=Math.atan2(z,C),gt=l.x-t.x,Bt=l.y-t.y,Se=Math.atan2(Bt,gt);d===re.CLOCKWISE?Se>=W&&(W+=2*Math.PI):W>=Se&&(W-=2*Math.PI),this.segList.addPt(n),this.addFilletArc(t,W,Se,d,v),this.segList.addPt(l)},addOutsideTurn:function(t,n){return this.offset0.p1.distance(this.offset1.p0)<this.distance*$o.OFFSET_SEGMENT_SEPARATION_FACTOR?(this.segList.addPt(this.offset0.p1),null):void(this.bufParams.getJoinStyle()===In.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===In.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(n&&this.segList.addPt(this.offset0.p1),this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0)))},createSquare:function(t){this.segList.addPt(new it(t.x+this.distance,t.y+this.distance)),this.segList.addPt(new it(t.x+this.distance,t.y-this.distance)),this.segList.addPt(new it(t.x-this.distance,t.y-this.distance)),this.segList.addPt(new it(t.x-this.distance,t.y+this.distance)),this.segList.closeRing()},addSegments:function(t,n){this.segList.addPts(t,n)},addFirstSegment:function(){this.segList.addPt(this.offset1.p0)},addLastSegment:function(){this.segList.addPt(this.offset1.p1)},initSideSegments:function(t,n,l){this.s1=t,this.s2=n,this.side=l,this.seg1.setCoordinates(t,n),this.computeOffsetSegment(this.seg1,l,this.distance,this.offset1)},addLimitedMitreJoin:function(t,n,l,d){var v=this.seg0.p1,C=Jn.angle(v,this.seg0.p0),z=(Jn.angle(v,this.seg1.p1),Jn.angleBetweenOriented(this.seg0.p0,v,this.seg1.p1)),W=z/2,gt=Jn.normalize(C+W),Bt=Jn.normalize(gt+Math.PI),Se=d*l,Ae=Se*Math.abs(Math.sin(W)),rn=l-Ae,Nn=v.x+Se*Math.cos(Bt),ei=v.y+Se*Math.sin(Bt),ci=new it(Nn,ei),Mr=new gn(v,ci),_s=Mr.pointAlongOffset(1,rn),ha=Mr.pointAlongOffset(1,-rn);this.side===Ke.LEFT?(this.segList.addPt(_s),this.segList.addPt(ha)):(this.segList.addPt(ha),this.segList.addPt(_s))},computeOffsetSegment:function(t,n,l,d){var v=n===Ke.LEFT?1:-1,C=t.p1.x-t.p0.x,z=t.p1.y-t.p0.y,W=Math.sqrt(C*C+z*z),gt=v*l*C/W,Bt=v*l*z/W;d.p0.x=t.p0.x-Bt,d.p0.y=t.p0.y+gt,d.p1.x=t.p1.x-Bt,d.p1.y=t.p1.y+gt},addFilletArc:function(t,n,l,d,v){var C=d===re.CLOCKWISE?-1:1,z=Math.abs(n-l),W=Math.trunc(z/this.filletAngleQuantum+.5);if(1>W)return null;var gt=null,Bt=null;gt=0,Bt=z/W;for(var Se=gt,Ae=new it;z>Se;){var rn=n+C*Se;Ae.x=t.x+v*Math.cos(rn),Ae.y=t.y+v*Math.sin(rn),this.segList.addPt(Ae),Se+=Bt}},addInsideTurn:function(t,n){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*$o.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var l=new it((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(l);var d=new it((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(d)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},createCircle:function(t){var n=new it(t.x+this.distance,t.y);this.segList.addPt(n),this.addFilletArc(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},addBevelJoin:function(t,n){this.segList.addPt(t.p1),this.segList.addPt(n.p0)},init:function(t){this.distance=t,this.maxCurveSegmentError=t*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new Fu,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(t*$o.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},addCollinear:function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2);var n=this.li.getIntersectionNum();n>=2&&(this.bufParams.getJoinStyle()===In.JOIN_BEVEL||this.bufParams.getJoinStyle()===In.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,re.CLOCKWISE,this.distance))},closeRing:function(){this.segList.closeRing()},hasNarrowConcaveAngle:function(){return this._hasNarrowConcaveAngle},interfaces_:function(){return[]},getClass:function(){return $o}}),$o.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,$o.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,$o.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,$o.MAX_CLOSING_SEG_LEN_FACTOR=80,T(gu.prototype,{getOffsetCurve:function(t,n){if(this.distance=n,n===0)return null;var l=0>n,d=Math.abs(n),v=this.getSegGen(d);t.length<=1?this.computePointCurve(t[0],v):this.computeOffsetCurve(t,l,v);var C=v.getCoordinates();return l&&Bn.reverse(C),C},computeSingleSidedBufferCurve:function(t,n,l){var d=this.simplifyTolerance(this.distance);if(n){l.addSegments(t,!0);var v=es.simplify(t,-d),C=v.length-1;l.initSideSegments(v[C],v[C-1],Ke.LEFT),l.addFirstSegment();for(var z=C-2;z>=0;z--)l.addNextSegment(v[z],!0)}else{l.addSegments(t,!1);var W=es.simplify(t,d),gt=W.length-1;l.initSideSegments(W[0],W[1],Ke.LEFT),l.addFirstSegment();for(var z=2;gt>=z;z++)l.addNextSegment(W[z],!0)}l.addLastSegment(),l.closeRing()},computeRingBufferCurve:function(t,n,l){var d=this.simplifyTolerance(this.distance);n===Ke.RIGHT&&(d=-d);var v=es.simplify(t,d),C=v.length-1;l.initSideSegments(v[C-1],v[0],n);for(var z=1;C>=z;z++){var W=z!==1;l.addNextSegment(v[z],W)}l.closeRing()},computeLineBufferCurve:function(t,n){var l=this.simplifyTolerance(this.distance),d=es.simplify(t,l),v=d.length-1;n.initSideSegments(d[0],d[1],Ke.LEFT);for(var C=2;v>=C;C++)n.addNextSegment(d[C],!0);n.addLastSegment(),n.addLineEndCap(d[v-1],d[v]);var z=es.simplify(t,-l),W=z.length-1;n.initSideSegments(z[W],z[W-1],Ke.LEFT);for(var C=W-2;C>=0;C--)n.addNextSegment(z[C],!0);n.addLastSegment(),n.addLineEndCap(z[1],z[0]),n.closeRing()},computePointCurve:function(t,n){switch(this.bufParams.getEndCapStyle()){case In.CAP_ROUND:n.createCircle(t);break;case In.CAP_SQUARE:n.createSquare(t)}},getLineCurve:function(t,n){if(this.distance=n,0>n&&!this.bufParams.isSingleSided()||n===0)return null;var l=Math.abs(n),d=this.getSegGen(l);if(t.length<=1)this.computePointCurve(t[0],d);else if(this.bufParams.isSingleSided()){var v=0>n;this.computeSingleSidedBufferCurve(t,v,d)}else this.computeLineBufferCurve(t,d);var C=d.getCoordinates();return C},getBufferParameters:function(){return this.bufParams},simplifyTolerance:function(t){return t*this.bufParams.getSimplifyFactor()},getRingCurve:function(t,n,l){if(this.distance=l,t.length<=2)return this.getLineCurve(t,l);if(l===0)return gu.copyCoordinates(t);var d=this.getSegGen(l);return this.computeRingBufferCurve(t,n,d),d.getCoordinates()},computeOffsetCurve:function(t,n,l){var d=this.simplifyTolerance(this.distance);if(n){var v=es.simplify(t,-d),C=v.length-1;l.initSideSegments(v[C],v[C-1],Ke.LEFT),l.addFirstSegment();for(var z=C-2;z>=0;z--)l.addNextSegment(v[z],!0)}else{var W=es.simplify(t,d),gt=W.length-1;l.initSideSegments(W[0],W[1],Ke.LEFT),l.addFirstSegment();for(var z=2;gt>=z;z++)l.addNextSegment(W[z],!0)}l.addLastSegment()},getSegGen:function(t){return new $o(this.precisionModel,this.bufParams,t)},interfaces_:function(){return[]},getClass:function(){return gu}}),gu.copyCoordinates=function(t){for(var n=new Array(t.length).fill(null),l=0;l<n.length;l++)n[l]=new it(t[l]);return n},T(al.prototype,{findStabbedSegments:function(){if(arguments.length===1){for(var t=arguments[0],n=new _t,l=this.subgraphs.iterator();l.hasNext();){var d=l.next(),v=d.getEnvelope();t.y<v.getMinY()||t.y>v.getMaxY()||this.findStabbedSegments(t,d.getDirectedEdges(),n)}return n}if(arguments.length===3){if(qe(arguments[2],pt)&&arguments[0]instanceof it&&arguments[1]instanceof Oi)for(var C=arguments[0],z=arguments[1],W=arguments[2],gt=z.getEdge().getCoordinates(),l=0;l<gt.length-1;l++){this.seg.p0=gt[l],this.seg.p1=gt[l+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse();var Bt=Math.max(this.seg.p0.x,this.seg.p1.x);if(!(Bt<C.x||this.seg.isHorizontal()||C.y<this.seg.p0.y||C.y>this.seg.p1.y||re.computeOrientation(this.seg.p0,this.seg.p1,C)===re.RIGHT)){var Se=z.getDepth(Ke.LEFT);this.seg.p0.equals(gt[l])||(Se=z.getDepth(Ke.RIGHT));var Ae=new mu(this.seg,Se);W.add(Ae)}}else if(qe(arguments[2],pt)&&arguments[0]instanceof it&&qe(arguments[1],pt))for(var rn=arguments[0],Nn=arguments[1],ei=arguments[2],l=Nn.iterator();l.hasNext();){var ci=l.next();ci.isForward()&&this.findStabbedSegments(rn,ci,ei)}}},getDepth:function(t){var n=this.findStabbedSegments(t);if(n.size()===0)return 0;var l=tn.min(n);return l.leftDepth},interfaces_:function(){return[]},getClass:function(){return al}}),T(mu.prototype,{compareTo:function(t){var n=t;if(this.upwardSeg.minX()>=n.upwardSeg.maxX())return 1;if(this.upwardSeg.maxX()<=n.upwardSeg.minX())return-1;var l=this.upwardSeg.orientationIndex(n.upwardSeg);return l!==0?l:(l=-1*n.upwardSeg.orientationIndex(this.upwardSeg),l!==0?l:this.upwardSeg.compareTo(n.upwardSeg))},compareX:function(t,n){var l=t.p0.compareTo(n.p0);return l!==0?l:t.p1.compareTo(n.p1)},toString:function(){return this.upwardSeg.toString()},interfaces_:function(){return[J]},getClass:function(){return mu}}),al.DepthSegment=mu,T(Jl.prototype,{addPoint:function(t){if(this.distance<=0)return null;var n=t.getCoordinates(),l=this.curveBuilder.getLineCurve(n,this.distance);this.addCurve(l,rt.EXTERIOR,rt.INTERIOR)},addPolygon:function(t){var n=this.distance,l=Ke.LEFT;this.distance<0&&(n=-this.distance,l=Ke.RIGHT);var d=t.getExteriorRing(),v=Bn.removeRepeatedPoints(d.getCoordinates());if(this.distance<0&&this.isErodedCompletely(d,this.distance)||this.distance<=0&&v.length<3)return null;this.addPolygonRing(v,n,l,rt.EXTERIOR,rt.INTERIOR);for(var C=0;C<t.getNumInteriorRing();C++){var z=t.getInteriorRingN(C),W=Bn.removeRepeatedPoints(z.getCoordinates());this.distance>0&&this.isErodedCompletely(z,-this.distance)||this.addPolygonRing(W,n,Ke.opposite(l),rt.INTERIOR,rt.EXTERIOR)}},isTriangleErodedCompletely:function(t,n){var l=new zi(t[0],t[1],t[2]),d=l.inCentre(),v=re.distancePointLine(d,l.p0,l.p1);return v<Math.abs(n)},addLineString:function(t){if(this.distance<=0&&!this.curveBuilder.getBufferParameters().isSingleSided())return null;var n=Bn.removeRepeatedPoints(t.getCoordinates()),l=this.curveBuilder.getLineCurve(n,this.distance);this.addCurve(l,rt.EXTERIOR,rt.INTERIOR)},addCurve:function(t,n,l){if(t===null||t.length<2)return null;var d=new Co(t,new wr(0,rt.BOUNDARY,n,l));this.curveList.add(d)},getCurves:function(){return this.add(this.inputGeom),this.curveList},addPolygonRing:function(t,n,l,d,v){if(n===0&&t.length<Yi.MINIMUM_VALID_SIZE)return null;var C=d,z=v;t.length>=Yi.MINIMUM_VALID_SIZE&&re.isCCW(t)&&(C=v,z=d,l=Ke.opposite(l));var W=this.curveBuilder.getRingCurve(t,l,n);this.addCurve(W,C,z)},add:function(t){if(t.isEmpty())return null;if(t instanceof Pi)this.addPolygon(t);else if(t instanceof oi)this.addLineString(t);else if(t instanceof rr)this.addPoint(t);else if(t instanceof Zr)this.addCollection(t);else if(t instanceof Ki)this.addCollection(t);else if(t instanceof Ct)this.addCollection(t);else{if(!(t instanceof ri))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},isErodedCompletely:function(t,n){var l=t.getCoordinates();if(l.length<4)return 0>n;if(l.length===4)return this.isTriangleErodedCompletely(l,n);var d=t.getEnvelopeInternal(),v=Math.min(d.getHeight(),d.getWidth());return 0>n&&2*Math.abs(n)>v},addCollection:function(t){for(var n=0;n<t.getNumGeometries();n++){var l=t.getGeometryN(n);this.add(l)}},interfaces_:function(){return[]},getClass:function(){return Jl}}),T(Jo.prototype,{isTrivialIntersection:function(t,n,l,d){if(t===l&&this.li.getIntersectionNum()===1){if(Jo.isAdjacentSegments(n,d))return!0;if(t.isClosed()){var v=t.size()-1;if(n===0&&d===v||d===0&&n===v)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},hasProperInteriorIntersection:function(){return this.hasProperInterior},getLineIntersector:function(){return this.li},hasProperIntersection:function(){return this.hasProper},processIntersections:function(t,n,l,d){if(t===l&&n===d)return null;this.numTests++;var v=t.getCoordinates()[n],C=t.getCoordinates()[n+1],z=l.getCoordinates()[d],W=l.getCoordinates()[d+1];this.li.computeIntersection(v,C,z,W),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,n,l,d)||(this._hasIntersection=!0,t.addIntersections(this.li,n,0),l.addIntersections(this.li,d,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))},hasIntersection:function(){return this._hasIntersection},isDone:function(){return!1},hasInteriorIntersection:function(){return this.hasInterior},interfaces_:function(){return[ro]},getClass:function(){return Jo}}),Jo.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1},T(Cl.prototype,{setWorkingPrecisionModel:function(t){this.workingPrecisionModel=t},insertUniqueEdge:function(t){var n=this.edgeList.findEqualEdge(t);if(n!==null){var l=n.getLabel(),d=t.getLabel();n.isPointwiseEqual(t)||(d=new wr(t.getLabel()),d.flip()),l.merge(d);var v=Cl.depthDelta(d),C=n.getDepthDelta(),z=C+v;n.setDepthDelta(z)}else this.edgeList.add(t),t.setDepthDelta(Cl.depthDelta(t.getLabel()))},buildSubgraphs:function(t,n){for(var l=new _t,d=t.iterator();d.hasNext();){var v=d.next(),C=v.getRightmostCoordinate(),z=new al(l),W=z.getDepth(C);v.computeDepth(W),v.findResultEdges(),l.add(v),n.add(v.getDirectedEdges(),v.getNodes())}},createSubgraphs:function(t){for(var n=new _t,l=t.getNodes().iterator();l.hasNext();){var d=l.next();if(!d.isVisited()){var v=new pu;v.create(d),n.add(v)}}return tn.sort(n,tn.reverseOrder()),n},createEmptyResultGeometry:function(){var t=this.geomFact.createPolygon();return t},getNoder:function(t){if(this.workingNoder!==null)return this.workingNoder;var n=new jo,l=new ji;return l.setPrecisionModel(t),n.setSegmentIntersector(new Jo(l)),n},buffer:function(t,n){var l=this.workingPrecisionModel;l===null&&(l=t.getPrecisionModel()),this.geomFact=t.getFactory();var d=new gu(l,this.bufParams),v=new Jl(t,n,d),C=v.getCurves();if(C.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(C,l),this.graph=new Ps(new Ho),this.graph.addEdges(this.edgeList.getEdges());var z=this.createSubgraphs(this.graph),W=new Ao(this.geomFact);this.buildSubgraphs(z,W);var gt=W.getPolygons();if(gt.size()<=0)return this.createEmptyResultGeometry();var Bt=this.geomFact.buildGeometry(gt);return Bt},computeNodedEdges:function(t,n){var l=this.getNoder(n);l.computeNodes(t);for(var d=l.getNodedSubstrings(),v=d.iterator();v.hasNext();){var C=v.next(),z=C.getCoordinates();if(z.length!==2||!z[0].equals2D(z[1])){var W=C.getData(),gt=new go(C.getCoordinates(),new wr(W));this.insertUniqueEdge(gt)}}},setNoder:function(t){this.workingNoder=t},interfaces_:function(){return[]},getClass:function(){return Cl}}),Cl.depthDelta=function(t){var n=t.getLocation(0,Ke.LEFT),l=t.getLocation(0,Ke.RIGHT);return n===rt.INTERIOR&&l===rt.EXTERIOR?1:n===rt.EXTERIOR&&l===rt.INTERIOR?-1:0},Cl.convertSegStrings=function(t){for(var n=new Rn,l=new _t;t.hasNext();){var d=t.next(),v=n.createLineString(d.getCoordinates());l.add(v)}return n.buildGeometry(l)},T($s.prototype,{checkEndPtVertexIntersections:function(){if(arguments.length===0)for(var t=this.segStrings.iterator();t.hasNext();){var n=t.next(),l=n.getCoordinates();this.checkEndPtVertexIntersections(l[0],this.segStrings),this.checkEndPtVertexIntersections(l[l.length-1],this.segStrings)}else if(arguments.length===2){for(var d=arguments[0],v=arguments[1],t=v.iterator();t.hasNext();)for(var n=t.next(),l=n.getCoordinates(),C=1;C<l.length-1;C++)if(l[C].equals(d))throw new ht("found endpt/interior pt intersection at index "+C+" :pt "+d)}},checkInteriorIntersections:function(){if(arguments.length===0)for(var t=this.segStrings.iterator();t.hasNext();)for(var n=t.next(),l=this.segStrings.iterator();l.hasNext();){var d=l.next();this.checkInteriorIntersections(n,d)}else if(arguments.length===2)for(var v=arguments[0],C=arguments[1],z=v.getCoordinates(),W=C.getCoordinates(),gt=0;gt<z.length-1;gt++)for(var Bt=0;Bt<W.length-1;Bt++)this.checkInteriorIntersections(v,gt,C,Bt);else if(arguments.length===4){var Se=arguments[0],Ae=arguments[1],rn=arguments[2],Nn=arguments[3];if(Se===rn&&Ae===Nn)return null;var ei=Se.getCoordinates()[Ae],ci=Se.getCoordinates()[Ae+1],Mr=rn.getCoordinates()[Nn],_s=rn.getCoordinates()[Nn+1];if(this.li.computeIntersection(ei,ci,Mr,_s),this.li.hasIntersection()&&(this.li.isProper()||this.hasInteriorIntersection(this.li,ei,ci)||this.hasInteriorIntersection(this.li,Mr,_s)))throw new ht("found non-noded intersection at "+ei+"-"+ci+" and "+Mr+"-"+_s)}},checkValid:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},checkCollapses:function(){if(arguments.length===0)for(var t=this.segStrings.iterator();t.hasNext();){var n=t.next();this.checkCollapses(n)}else if(arguments.length===1)for(var l=arguments[0],d=l.getCoordinates(),t=0;t<d.length-2;t++)this.checkCollapse(d[t],d[t+1],d[t+2])},hasInteriorIntersection:function(t,n,l){for(var d=0;d<t.getIntersectionNum();d++){var v=t.getIntersection(d);if(!v.equals(n)&&!v.equals(l))return!0}return!1},checkCollapse:function(t,n,l){if(t.equals(l))throw new ht("found non-noded collapse at "+$s.fact.createLineString([t,n,l]))},interfaces_:function(){return[]},getClass:function(){return $s}}),$s.fact=new Rn,T(ll.prototype,{intersectsScaled:function(t,n){var l=Math.min(t.x,n.x),d=Math.max(t.x,n.x),v=Math.min(t.y,n.y),C=Math.max(t.y,n.y),z=this.maxx<l||this.minx>d||this.maxy<v||this.miny>C;if(z)return!1;var W=this.intersectsToleranceSquare(t,n);return yt.isTrue(!(z&&W),"Found bad envelope test"),W},initCorners:function(t){var n=.5;this.minx=t.x-n,this.maxx=t.x+n,this.miny=t.y-n,this.maxy=t.y+n,this.corner[0]=new it(this.maxx,this.maxy),this.corner[1]=new it(this.minx,this.maxy),this.corner[2]=new it(this.minx,this.miny),this.corner[3]=new it(this.maxx,this.miny)},intersects:function(t,n){return this.scaleFactor===1?this.intersectsScaled(t,n):(this.copyScaled(t,this.p0Scaled),this.copyScaled(n,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},scale:function(t){return Math.round(t*this.scaleFactor)},getCoordinate:function(){return this.originalPt},copyScaled:function(t,n){n.x=this.scale(t.x),n.y=this.scale(t.y)},getSafeEnvelope:function(){if(this.safeEnv===null){var t=ll.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new Xt(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},intersectsPixelClosure:function(t,n){return this.li.computeIntersection(t,n,this.corner[0],this.corner[1]),this.li.hasIntersection()?!0:(this.li.computeIntersection(t,n,this.corner[1],this.corner[2]),this.li.hasIntersection()?!0:(this.li.computeIntersection(t,n,this.corner[2],this.corner[3]),this.li.hasIntersection()?!0:(this.li.computeIntersection(t,n,this.corner[3],this.corner[0]),!!this.li.hasIntersection())))},intersectsToleranceSquare:function(t,n){var l=!1,d=!1;return this.li.computeIntersection(t,n,this.corner[0],this.corner[1]),this.li.isProper()?!0:(this.li.computeIntersection(t,n,this.corner[1],this.corner[2]),this.li.isProper()?!0:(this.li.hasIntersection()&&(l=!0),this.li.computeIntersection(t,n,this.corner[2],this.corner[3]),this.li.isProper()?!0:(this.li.hasIntersection()&&(d=!0),this.li.computeIntersection(t,n,this.corner[3],this.corner[0]),this.li.isProper()||l&&d||t.equals(this.pt)?!0:!!n.equals(this.pt))))},addSnappedNode:function(t,n){var l=t.getCoordinate(n),d=t.getCoordinate(n+1);return this.intersects(l,d)?(t.addIntersection(this.getCoordinate(),n),!0):!1},interfaces_:function(){return[]},getClass:function(){return ll}}),ll.SAFE_ENV_EXPANSION_FACTOR=.75,T(gs.prototype,{select:function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],n=arguments[1];t.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}},interfaces_:function(){return[]},getClass:function(){return gs}}),T(yu.prototype,{snap:function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}if(arguments.length===3){var n=arguments[0],l=arguments[1],d=arguments[2],v=n.getSafeEnvelope(),C=new bn(n,l,d);return this.index.query(v,{interfaces_:function(){return[Pn]},visitItem:function(z){var W=z;W.select(v,C)}}),C.isNodeAdded()}},interfaces_:function(){return[]},getClass:function(){return yu}}),st(bn,gs),T(bn.prototype,{isNodeAdded:function(){return this._isNodeAdded},select:function(){if(arguments.length!==2)return gs.prototype.select.apply(this,arguments);var t=arguments[0],n=arguments[1],l=t.getContext();return this.parentEdge!==null&&l===this.parentEdge&&n===this.hotPixelVertexIndex?null:void(this._isNodeAdded=this.hotPixel.addSnappedNode(l,n))},interfaces_:function(){return[]},getClass:function(){return bn}}),yu.HotPixelSnapAction=bn,T(qs.prototype,{processIntersections:function(t,n,l,d){if(t===l&&n===d)return null;var v=t.getCoordinates()[n],C=t.getCoordinates()[n+1],z=l.getCoordinates()[d],W=l.getCoordinates()[d+1];if(this.li.computeIntersection(v,C,z,W),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var gt=0;gt<this.li.getIntersectionNum();gt++)this.interiorIntersections.add(this.li.getIntersection(gt));t.addIntersections(this.li,n,0),l.addIntersections(this.li,d,1)}},isDone:function(){return!1},getInteriorIntersections:function(){return this.interiorIntersections},interfaces_:function(){return[ro]},getClass:function(){return qs}}),T(tc.prototype,{checkCorrectness:function(t){var n=Co.getNodedSubstrings(t),l=new $s(n);try{l.checkValid()}catch(d){if(!(d instanceof ie))throw d;d.printStackTrace()}finally{}},getNodedSubstrings:function(){return Co.getNodedSubstrings(this.nodedSegStrings)},snapRound:function(t,n){var l=this.findInteriorIntersections(t,n);this.computeIntersectionSnaps(l),this.computeVertexSnaps(t)},findInteriorIntersections:function(t,n){var l=new qs(n);return this.noder.setSegmentIntersector(l),this.noder.computeNodes(t),l.getInteriorIntersections()},computeVertexSnaps:function(){if(qe(arguments[0],Ft))for(var t=arguments[0],n=t.iterator();n.hasNext();){var l=n.next();this.computeVertexSnaps(l)}else if(arguments[0]instanceof Co)for(var d=arguments[0],v=d.getCoordinates(),C=0;C<v.length;C++){var z=new ll(v[C],this.scaleFactor,this.li),W=this.pointSnapper.snap(z,d,C);W&&d.addIntersection(v[C],C)}},computeNodes:function(t){this.nodedSegStrings=t,this.noder=new jo,this.pointSnapper=new yu(this.noder.getIndex()),this.snapRound(t,this.li)},computeIntersectionSnaps:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next(),d=new ll(l,this.scaleFactor,this.li);this.pointSnapper.snap(d)}},interfaces_:function(){return[fo]},getClass:function(){return tc}}),T(js.prototype,{bufferFixedPrecision:function(t){var n=new Wo(new tc(new _e(1)),t.getScale()),l=new Cl(this.bufParams);l.setWorkingPrecisionModel(t),l.setNoder(n),this.resultGeometry=l.buffer(this.argGeom,this.distance)},bufferReducedPrecision:function(){if(arguments.length===0){for(var t=js.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(v){if(!(v instanceof Cs))throw v;this.saveException=v}finally{}if(this.resultGeometry!==null)return null}throw this.saveException}if(arguments.length===1){var n=arguments[0],l=js.precisionScaleFactor(this.argGeom,this.distance,n),d=new _e(l);this.bufferFixedPrecision(d)}},computeGeometry:function(){if(this.bufferOriginalPrecision(),this.resultGeometry!==null)return null;var t=this.argGeom.getFactory().getPrecisionModel();t.getType()===_e.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},setQuadrantSegments:function(t){this.bufParams.setQuadrantSegments(t)},bufferOriginalPrecision:function(){try{var t=new Cl(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(n){if(!(n instanceof ht))throw n;this.saveException=n}finally{}},getResultGeometry:function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},setEndCapStyle:function(t){this.bufParams.setEndCapStyle(t)},interfaces_:function(){return[]},getClass:function(){return js}}),js.bufferOp=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],l=new js(t),d=l.getResultGeometry(n);return d}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof de&&typeof arguments[1]=="number"){var v=arguments[0],C=arguments[1],z=arguments[2],W=new js(v);W.setQuadrantSegments(z);var d=W.getResultGeometry(C);return d}if(arguments[2]instanceof In&&arguments[0]instanceof de&&typeof arguments[1]=="number"){var gt=arguments[0],Bt=arguments[1],Se=arguments[2],W=new js(gt,Se),d=W.getResultGeometry(Bt);return d}}else if(arguments.length===4){var Ae=arguments[0],rn=arguments[1],Nn=arguments[2],ei=arguments[3],W=new js(Ae);W.setQuadrantSegments(Nn),W.setEndCapStyle(ei);var d=W.getResultGeometry(rn);return d}},js.precisionScaleFactor=function(t,n,l){var d=t.getEnvelopeInternal(),v=Sn.max(Math.abs(d.getMaxX()),Math.abs(d.getMaxY()),Math.abs(d.getMinX()),Math.abs(d.getMinY())),C=n>0?n:0,z=v+2*C,W=Math.trunc(Math.log(z)/Math.log(10)+1),gt=l-W,Bt=Math.pow(10,gt);return Bt},js.CAP_ROUND=In.CAP_ROUND,js.CAP_BUTT=In.CAP_FLAT,js.CAP_FLAT=In.CAP_FLAT,js.CAP_SQUARE=In.CAP_SQUARE,js.MAX_PRECISION_DIGITS=12;var Is=Object.freeze({BufferOp:js,BufferParameters:In});T(Il.prototype,{filter:function(t){t instanceof Pi&&this.comps.add(t)},interfaces_:function(){return[yr]},getClass:function(){return Il}}),Il.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return Il.getPolygons(t,new _t)}if(arguments.length===2){var n=arguments[0],l=arguments[1];return n instanceof Pi?l.add(n):n instanceof ri&&n.apply(new Il(l)),l}},T(ms.prototype,{isInsideArea:function(){return this.segIndex===ms.INSIDE_AREA},getCoordinate:function(){return this.pt},getGeometryComponent:function(){return this.component},getSegmentIndex:function(){return this.segIndex},interfaces_:function(){return[]},getClass:function(){return ms}}),ms.INSIDE_AREA=-1,T(oo.prototype,{filter:function(t){t instanceof rr&&this.pts.add(t)},interfaces_:function(){return[yr]},getClass:function(){return oo}}),oo.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof rr?tn.singletonList(t):oo.getPoints(t,new _t)}if(arguments.length===2){var n=arguments[0],l=arguments[1];return n instanceof rr?l.add(n):n instanceof ri&&n.apply(new oo(l)),l}},T(Fa.prototype,{filter:function(t){(t instanceof rr||t instanceof oi||t instanceof Pi)&&this.locations.add(new ms(t,0,t.getCoordinate()))},interfaces_:function(){return[yr]},getClass:function(){return Fa}}),Fa.getLocations=function(t){var n=new _t;return t.apply(new Fa(n)),n},T(ao.prototype,{computeContainmentDistance:function(){if(arguments.length===0){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this.minDistance<=this.terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(arguments.length===2){var n=arguments[0],l=arguments[1],d=1-n,v=Il.getPolygons(this.geom[n]);if(v.size()>0){var C=Fa.getLocations(this.geom[d]);if(this.computeContainmentDistance(C,v,l),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[d]=l[0],this.minDistanceLocation[n]=l[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&qe(arguments[0],pt)&&qe(arguments[1],pt)){for(var z=arguments[0],W=arguments[1],gt=arguments[2],Bt=0;Bt<z.size();Bt++)for(var Se=z.get(Bt),Ae=0;Ae<W.size();Ae++)if(this.computeContainmentDistance(Se,W.get(Ae),gt),this.minDistance<=this.terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof ms&&arguments[1]instanceof Pi){var rn=arguments[0],Nn=arguments[1],ei=arguments[2],ci=rn.getCoordinate();if(rt.EXTERIOR!==this.ptLocator.locate(ci,Nn))return this.minDistance=0,ei[0]=rn,ei[1]=new ms(Nn,ci),null}}},computeMinDistanceLinesPoints:function(t,n,l){for(var d=0;d<t.size();d++)for(var v=t.get(d),C=0;C<n.size();C++){var z=n.get(C);if(this.computeMinDistance(v,z,l),this.minDistance<=this.terminateDistance)return null}},computeFacetDistance:function(){var t=new Array(2).fill(null),n=Nr.getLines(this.geom[0]),l=Nr.getLines(this.geom[1]),d=oo.getPoints(this.geom[0]),v=oo.getPoints(this.geom[1]);return this.computeMinDistanceLines(n,l,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,v,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(l,d,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(d,v,t),void this.updateMinDistance(t,!1))))},nearestLocations:function(){return this.computeMinDistance(),this.minDistanceLocation},updateMinDistance:function(t,n){return t[0]===null?null:void(n?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1]))},nearestPoints:function(){this.computeMinDistance();var t=[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()];return t},computeMinDistance:function(){if(arguments.length===0){if(this.minDistanceLocation!==null||(this.minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this.minDistance<=this.terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof oi&&arguments[1]instanceof rr){var t=arguments[0],n=arguments[1],l=arguments[2];if(t.getEnvelopeInternal().distance(n.getEnvelopeInternal())>this.minDistance)return null;for(var d=t.getCoordinates(),v=n.getCoordinate(),C=0;C<d.length-1;C++){var z=re.distancePointLine(v,d[C],d[C+1]);if(z<this.minDistance){this.minDistance=z;var W=new gn(d[C],d[C+1]),gt=W.closestPoint(v);l[0]=new ms(t,C,gt),l[1]=new ms(n,0,v)}if(this.minDistance<=this.terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof oi&&arguments[1]instanceof oi){var Bt=arguments[0],Se=arguments[1],Ae=arguments[2];if(Bt.getEnvelopeInternal().distance(Se.getEnvelopeInternal())>this.minDistance)return null;for(var d=Bt.getCoordinates(),rn=Se.getCoordinates(),C=0;C<d.length-1;C++)for(var Nn=0;Nn<rn.length-1;Nn++){var z=re.distanceLineLine(d[C],d[C+1],rn[Nn],rn[Nn+1]);if(z<this.minDistance){this.minDistance=z;var ei=new gn(d[C],d[C+1]),ci=new gn(rn[Nn],rn[Nn+1]),Mr=ei.closestPoints(ci);Ae[0]=new ms(Bt,C,Mr[0]),Ae[1]=new ms(Se,Nn,Mr[1])}if(this.minDistance<=this.terminateDistance)return null}}}},computeMinDistancePoints:function(t,n,l){for(var d=0;d<t.size();d++)for(var v=t.get(d),C=0;C<n.size();C++){var z=n.get(C),W=v.getCoordinate().distance(z.getCoordinate());if(W<this.minDistance&&(this.minDistance=W,l[0]=new ms(v,0,v.getCoordinate()),l[1]=new ms(z,0,z.getCoordinate())),this.minDistance<=this.terminateDistance)return null}},distance:function(){if(this.geom[0]===null||this.geom[1]===null)throw new q;return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},computeMinDistanceLines:function(t,n,l){for(var d=0;d<t.size();d++)for(var v=t.get(d),C=0;C<n.size();C++){var z=n.get(C);if(this.computeMinDistance(v,z,l),this.minDistance<=this.terminateDistance)return null}},interfaces_:function(){return[]},getClass:function(){return ao}}),ao.distance=function(t,n){var l=new ao(t,n);return l.distance()},ao.isWithinDistance=function(t,n,l){var d=new ao(t,n,l);return d.distance()<=l},ao.nearestPoints=function(t,n){var l=new ao(t,n);return l.nearestPoints()};var Ir=Object.freeze({DistanceOp:ao});T(_u.prototype,{getCoordinates:function(){if(this.coordinates===null){for(var t=0,n=0,l=new Jt,d=this.directedEdges.iterator();d.hasNext();){var v=d.next();v.getEdgeDirection()?t++:n++,l.add(v.getEdge().getLine().getCoordinates(),!1,v.getEdgeDirection())}this.coordinates=l.toCoordinateArray(),n>t&&Bn.reverse(this.coordinates)}return this.coordinates},toLineString:function(){return this.factory.createLineString(this.getCoordinates())},add:function(t){this.directedEdges.add(t)},interfaces_:function(){return[]},getClass:function(){return _u}}),T(vo.prototype,{setVisited:function(t){this._isVisited=t},isMarked:function(){return this._isMarked},setData:function(t){this.data=t},getData:function(){return this.data},setMarked:function(t){this._isMarked=t},getContext:function(){return this.data},isVisited:function(){return this._isVisited},setContext:function(t){this.data=t},interfaces_:function(){return[]},getClass:function(){return vo}}),vo.getComponentWithVisitedState=function(t,n){for(;t.hasNext();){var l=t.next();if(l.isVisited()===n)return l}return null},vo.setVisited=function(t,n){for(;t.hasNext();){var l=t.next();l.setVisited(n)}},vo.setMarked=function(t,n){for(;t.hasNext();){var l=t.next();l.setMarked(n)}},st(zr,vo),T(zr.prototype,{isRemoved:function(){return this.parentEdge===null},compareDirection:function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:re.computeOrientation(t.p0,t.p1,this.p1)},getCoordinate:function(){return this.from.getCoordinate()},print:function(t){var n=this.getClass().getName(),l=n.lastIndexOf("."),d=n.substring(l+1);t.print("  "+d+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+this.angle)},getDirectionPt:function(){return this.p1},getAngle:function(){return this.angle},compareTo:function(t){var n=t;return this.compareDirection(n)},getFromNode:function(){return this.from},getSym:function(){return this.sym},setEdge:function(t){this.parentEdge=t},remove:function(){this.sym=null,this.parentEdge=null},getEdge:function(){return this.parentEdge},getQuadrant:function(){return this.quadrant},setSym:function(t){this.sym=t},getToNode:function(){return this.to},getEdgeDirection:function(){return this.edgeDirection},interfaces_:function(){return[J]},getClass:function(){return zr}}),zr.toEdges=function(t){for(var n=new _t,l=t.iterator();l.hasNext();)n.add(l.next().parentEdge);return n},st(ys,zr),T(ys.prototype,{getNext:function(){return this.getToNode().getDegree()!==2?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(yt.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))},interfaces_:function(){return[]},getClass:function(){return ys}}),st(Cr,vo),T(Cr.prototype,{isRemoved:function(){return this.dirEdge===null},setDirectedEdges:function(t,n){this.dirEdge=[t,n],t.setEdge(this),n.setEdge(this),t.setSym(n),n.setSym(t),t.getFromNode().addOutEdge(t),n.getFromNode().addOutEdge(n)},getDirEdge:function(){if(Number.isInteger(arguments[0])){var t=arguments[0];return this.dirEdge[t]}if(arguments[0]instanceof Js){var n=arguments[0];return this.dirEdge[0].getFromNode()===n?this.dirEdge[0]:this.dirEdge[1].getFromNode()===n?this.dirEdge[1]:null}},remove:function(){this.dirEdge=null},getOppositeNode:function(t){return this.dirEdge[0].getFromNode()===t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()===t?this.dirEdge[1].getToNode():null},interfaces_:function(){return[]},getClass:function(){return Cr}}),T(la.prototype,{getNextEdge:function(t){var n=this.getIndex(t);return this.outEdges.get(this.getIndex(n+1))},getCoordinate:function(){var t=this.iterator();if(!t.hasNext())return null;var n=t.next();return n.getCoordinate()},iterator:function(){return this.sortEdges(),this.outEdges.iterator()},sortEdges:function(){this.sorted||(tn.sort(this.outEdges),this.sorted=!0)},remove:function(t){this.outEdges.remove(t)},getEdges:function(){return this.sortEdges(),this.outEdges},getNextCWEdge:function(t){var n=this.getIndex(t);return this.outEdges.get(this.getIndex(n-1))},getIndex:function(){if(arguments[0]instanceof Cr){var t=arguments[0];this.sortEdges();for(var n=0;n<this.outEdges.size();n++){var l=this.outEdges.get(n);if(l.getEdge()===t)return n}return-1}if(arguments[0]instanceof zr){var d=arguments[0];this.sortEdges();for(var n=0;n<this.outEdges.size();n++){var l=this.outEdges.get(n);if(l===d)return n}return-1}if(Number.isInteger(arguments[0])){var v=arguments[0],C=v%this.outEdges.size();return 0>C&&(C+=this.outEdges.size()),C}},add:function(t){this.outEdges.add(t),this.sorted=!1},getDegree:function(){return this.outEdges.size()},interfaces_:function(){return[]},getClass:function(){return la}}),st(Js,vo),T(Js.prototype,{isRemoved:function(){return this.pt===null},addOutEdge:function(t){this.deStar.add(t)},getCoordinate:function(){return this.pt},getOutEdges:function(){return this.deStar},remove:function(){if(arguments.length===0)this.pt=null;else if(arguments.length===1){var t=arguments[0];this.deStar.remove(t)}},getIndex:function(t){return this.deStar.getIndex(t)},getDegree:function(){return this.deStar.getDegree()},interfaces_:function(){return[]},getClass:function(){return Js}}),Js.getEdgesBetween=function(t,n){var l=zr.toEdges(t.getOutEdges().getEdges()),d=new mr(l),v=zr.toEdges(n.getOutEdges().getEdges());return d.retainAll(v),d},st(ua,Cr),T(ua.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return ua}}),T(hc.prototype,{find:function(t){return this.nodeMap.get(t)},iterator:function(){return this.nodeMap.values().iterator()},remove:function(t){return this.nodeMap.remove(t)},values:function(){return this.nodeMap.values()},add:function(t){return this.nodeMap.put(t.getCoordinate(),t),t},interfaces_:function(){return[]},getClass:function(){return hc}}),T(vu.prototype,{findNodesOfDegree:function(t){for(var n=new _t,l=this.nodeIterator();l.hasNext();){var d=l.next();d.getDegree()===t&&n.add(d)}return n},dirEdgeIterator:function(){return this.dirEdges.iterator()},edgeIterator:function(){return this.edges.iterator()},remove:function(){if(arguments[0]instanceof Cr){var t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),t.remove()}else if(arguments[0]instanceof zr){var n=arguments[0],l=n.getSym();l!==null&&l.setSym(null),n.getFromNode().remove(n),n.remove(),this.dirEdges.remove(n)}else if(arguments[0]instanceof Js){for(var d=arguments[0],v=d.getOutEdges().getEdges(),C=v.iterator();C.hasNext();){var z=C.next(),l=z.getSym();l!==null&&this.remove(l),this.dirEdges.remove(z);var W=z.getEdge();W!==null&&this.edges.remove(W)}this.nodeMap.remove(d.getCoordinate()),d.remove()}},findNode:function(t){return this.nodeMap.find(t)},getEdges:function(){return this.edges},nodeIterator:function(){return this.nodeMap.iterator()},contains:function(){if(arguments[0]instanceof Cr){var t=arguments[0];return this.edges.contains(t)}if(arguments[0]instanceof zr){var n=arguments[0];return this.dirEdges.contains(n)}},add:function(){if(arguments[0]instanceof Js){var t=arguments[0];this.nodeMap.add(t)}else if(arguments[0]instanceof Cr){var n=arguments[0];this.edges.add(n),this.add(n.getDirEdge(0)),this.add(n.getDirEdge(1))}else if(arguments[0]instanceof zr){var l=arguments[0];this.dirEdges.add(l)}},getNodes:function(){return this.nodeMap.values()},interfaces_:function(){return[]},getClass:function(){return vu}}),st(xu,vu),T(xu.prototype,{addEdge:function(t){if(t.isEmpty())return null;var n=Bn.removeRepeatedPoints(t.getCoordinates());if(n.length<=1)return null;var l=n[0],d=n[n.length-1],v=this.getNode(l),C=this.getNode(d),z=new ys(v,C,n[1],!0),W=new ys(C,v,n[n.length-2],!1),gt=new ua(t);gt.setDirectedEdges(z,W),this.add(gt)},getNode:function(t){var n=this.findNode(t);return n===null&&(n=new Js(t),this.add(n)),n},interfaces_:function(){return[]},getClass:function(){return xu}}),T(ec.prototype,{buildEdgeStringsForUnprocessedNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var n=t.next();n.isMarked()||(yt.isTrue(n.getDegree()===2),this.buildEdgeStringsStartingAt(n),n.setMarked(!0))}},buildEdgeStringsForNonDegree2Nodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var n=t.next();n.getDegree()!==2&&(this.buildEdgeStringsStartingAt(n),n.setMarked(!0))}},buildEdgeStringsForObviousStartNodes:function(){this.buildEdgeStringsForNonDegree2Nodes()},getMergedLineStrings:function(){return this.merge(),this.mergedLineStrings},buildEdgeStringsStartingAt:function(t){for(var n=t.getOutEdges().iterator();n.hasNext();){var l=n.next();l.getEdge().isMarked()||this.edgeStrings.add(this.buildEdgeStringStartingWith(l))}},merge:function(){if(this.mergedLineStrings!==null)return null;vo.setMarked(this.graph.nodeIterator(),!1),vo.setMarked(this.graph.edgeIterator(),!1),this.edgeStrings=new _t,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this.mergedLineStrings=new _t;for(var t=this.edgeStrings.iterator();t.hasNext();){var n=t.next();this.mergedLineStrings.add(n.toLineString())}},buildEdgeStringStartingWith:function(t){var n=new _u(this.factory),l=t;do n.add(l),l.getEdge().setMarked(!0),l=l.getNext();while(l!==null&&l!==t);return n},add:function(){if(arguments[0]instanceof de){var t=arguments[0];t.apply({interfaces_:function(){return[Be]},filter:function(C){C instanceof oi&&this.add(C)}})}else if(qe(arguments[0],Ft)){var n=arguments[0];this.mergedLineStrings=null;for(var l=n.iterator();l.hasNext();){var d=l.next();this.add(d)}}else if(arguments[0]instanceof oi){var v=arguments[0];this.factory===null&&(this.factory=v.getFactory()),this.graph.addEdge(v)}},buildEdgeStringsForIsolatedLoops:function(){this.buildEdgeStringsForUnprocessedNodes()},interfaces_:function(){return[]},getClass:function(){return ec}});var xi=Object.freeze({LineMerger:ec}),Po=Object.freeze({OverlayOp:mn});st(os,zr),T(os.prototype,{getNext:function(){return this.next},isInRing:function(){return this.edgeRing!==null},setRing:function(t){this.edgeRing=t},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setNext:function(t){this.next=t},getRing:function(){return this.edgeRing},interfaces_:function(){return[]},getClass:function(){return os}}),st(Pr,Cr),T(Pr.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return Pr}}),T(Mi.prototype,{isIncluded:function(){return this._isIncluded},getCoordinates:function(){if(this.ringPts===null){for(var t=new Jt,n=this.deList.iterator();n.hasNext();){var l=n.next(),d=l.getEdge();Mi.addEdge(d.getLine().getCoordinates(),l.getEdgeDirection(),t)}this.ringPts=t.toCoordinateArray()}return this.ringPts},isIncludedSet:function(){return this._isIncludedSet},isValid:function(){return this.getCoordinates(),this.ringPts.length<=3?!1:(this.getRing(),this.ring.isValid())},build:function(t){var n=t;do this.add(n),n.setRing(this),n=n.getNext(),yt.isTrue(n!==null,"found null DE in ring"),yt.isTrue(n===t||!n.isInRing(),"found DE already in ring");while(n!==t)},isOuterHole:function(){return this._isHole?!this.hasShell():!1},getPolygon:function(){var t=null;if(this.holes!==null){t=new Array(this.holes.size()).fill(null);for(var n=0;n<this.holes.size();n++)t[n]=this.holes.get(n)}var l=this.factory.createPolygon(this.ring,t);return l},isHole:function(){return this._isHole},isProcessed:function(){return this._isProcessed},addHole:function(){if(arguments[0]instanceof Yi){var t=arguments[0];this.holes===null&&(this.holes=new _t),this.holes.add(t)}else if(arguments[0]instanceof Mi){var n=arguments[0];n.setShell(this);var l=n.getRing();this.holes===null&&(this.holes=new _t),this.holes.add(l)}},setIncluded:function(t){this._isIncluded=t,this._isIncludedSet=!0},getOuterHole:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var n=this.deList.get(t),l=n.getSym().getRing();if(l.isOuterHole())return l}return null},computeHole:function(){var t=this.getRing();this._isHole=re.isCCW(t.getCoordinates())},hasShell:function(){return this.shell!==null},isOuterShell:function(){return this.getOuterHole()!==null},getLineString:function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},toString:function(){return Ns.toLineString(new ue(this.getCoordinates()))},getShell:function(){return this.isHole()?this.shell:this},add:function(t){this.deList.add(t)},getRing:function(){if(this.ring!==null)return this.ring;this.getCoordinates(),this.ringPts.length<3&&mt.out.println(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){if(!(t instanceof ie))throw t;mt.out.println(this.ringPts)}finally{}return this.ring},updateIncluded:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var n=this.deList.get(t),l=n.getSym().getRing().getShell();if(l!==null&&l.isIncludedSet())return this.setIncluded(!l.isIncluded()),null}},setShell:function(t){this.shell=t},setProcessed:function(t){this._isProcessed=t},interfaces_:function(){return[]},getClass:function(){return Mi}}),Mi.findDirEdgesInRing=function(t){var n=t,l=new _t;do l.add(n),n=n.getNext(),yt.isTrue(n!==null,"found null DE in ring"),yt.isTrue(n===t||!n.isInRing(),"found DE already in ring");while(n!==t);return l},Mi.addEdge=function(t,n,l){if(n)for(var d=0;d<t.length;d++)l.add(t[d],!1);else for(var d=t.length-1;d>=0;d--)l.add(t[d],!1)},Mi.findEdgeRingContaining=function(t,n){for(var l=t.getRing(),d=l.getEnvelopeInternal(),v=l.getCoordinateN(0),C=null,z=null,W=n.iterator();W.hasNext();){var gt=W.next(),Bt=gt.getRing(),Se=Bt.getEnvelopeInternal();if(!Se.equals(d)&&Se.contains(d)){v=Bn.ptNotInList(l.getCoordinates(),Bt.getCoordinates());var Ae=!1;re.isPointInRing(v,Bt.getCoordinates())&&(Ae=!0),Ae&&(C===null||z.contains(Se))&&(C=gt,z=C.getRing().getEnvelopeInternal())}}return C},T(ka.prototype,{compare:function(t,n){var l=t,d=n;return l.getRing().getEnvelope().compareTo(d.getRing().getEnvelope())},interfaces_:function(){return[X]},getClass:function(){return ka}}),Mi.EnvelopeComparator=ka,st(hr,vu),T(hr.prototype,{findEdgeRing:function(t){var n=new Mi(this.factory);return n.build(t),n},computeDepthParity:function(){if(arguments.length===0)for(;;){var t=null;if(t===null)return null;this.computeDepthParity(t)}},computeNextCWEdges:function(){for(var t=this.nodeIterator();t.hasNext();){var n=t.next();hr.computeNextCWEdges(n)}},addEdge:function(t){if(t.isEmpty())return null;var n=Bn.removeRepeatedPoints(t.getCoordinates());if(n.length<2)return null;var l=n[0],d=n[n.length-1],v=this.getNode(l),C=this.getNode(d),z=new os(v,C,n[1],!0),W=new os(C,v,n[n.length-2],!1),gt=new Pr(t);gt.setDirectedEdges(z,W),this.add(gt)},deleteCutEdges:function(){this.computeNextCWEdges(),hr.findLabeledEdgeRings(this.dirEdges);for(var t=new _t,n=this.dirEdges.iterator();n.hasNext();){var l=n.next();if(!l.isMarked()){var d=l.getSym();if(l.getLabel()===d.getLabel()){l.setMarked(!0),d.setMarked(!0);var v=l.getEdge();t.add(v.getLine())}}}return t},getEdgeRings:function(){this.computeNextCWEdges(),hr.label(this.dirEdges,-1);var t=hr.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var n=new _t,l=this.dirEdges.iterator();l.hasNext();){var d=l.next();if(!d.isMarked()&&!d.isInRing()){var v=this.findEdgeRing(d);n.add(v)}}return n},getNode:function(t){var n=this.findNode(t);return n===null&&(n=new Js(t),this.add(n)),n},convertMaximalToMinimalEdgeRings:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next(),d=l.getLabel(),v=hr.findIntersectionNodes(l,d);if(v!==null)for(var C=v.iterator();C.hasNext();){var z=C.next();hr.computeNextCCWEdges(z,d)}}},deleteDangles:function(){for(var t=this.findNodesOfDegree(1),n=new mr,l=new Hn,d=t.iterator();d.hasNext();)l.push(d.next());for(;!l.isEmpty();){var v=l.pop();hr.deleteAllEdges(v);for(var C=v.getOutEdges().getEdges(),d=C.iterator();d.hasNext();){var z=d.next();z.setMarked(!0);var W=z.getSym();W!==null&&W.setMarked(!0);var gt=z.getEdge();n.add(gt.getLine());var Bt=z.getToNode();hr.getDegreeNonDeleted(Bt)===1&&l.push(Bt)}}return n},interfaces_:function(){return[]},getClass:function(){return hr}}),hr.findLabeledEdgeRings=function(t){for(var n=new _t,l=1,d=t.iterator();d.hasNext();){var v=d.next();if(!(v.isMarked()||v.getLabel()>=0)){n.add(v);var C=Mi.findDirEdgesInRing(v);hr.label(C,l),l++}}return n},hr.getDegreeNonDeleted=function(t){for(var n=t.getOutEdges().getEdges(),l=0,d=n.iterator();d.hasNext();){var v=d.next();v.isMarked()||l++}return l},hr.deleteAllEdges=function(t){for(var n=t.getOutEdges().getEdges(),l=n.iterator();l.hasNext();){var d=l.next();d.setMarked(!0);var v=d.getSym();v!==null&&v.setMarked(!0)}},hr.label=function(t,n){for(var l=t.iterator();l.hasNext();){var d=l.next();d.setLabel(n)}},hr.computeNextCWEdges=function(t){for(var n=t.getOutEdges(),l=null,d=null,v=n.getEdges().iterator();v.hasNext();){var C=v.next();if(!C.isMarked()){if(l===null&&(l=C),d!==null){var z=d.getSym();z.setNext(C)}d=C}}if(d!==null){var z=d.getSym();z.setNext(l)}},hr.computeNextCCWEdges=function(t,n){for(var l=t.getOutEdges(),d=null,v=null,C=l.getEdges(),z=C.size()-1;z>=0;z--){var W=C.get(z),gt=W.getSym(),Bt=null;W.getLabel()===n&&(Bt=W);var Se=null;gt.getLabel()===n&&(Se=gt),Bt===null&&Se===null||(Se!==null&&(v=Se),Bt!==null&&(v!==null&&(v.setNext(Bt),v=null),d===null&&(d=Bt)))}v!==null&&(yt.isTrue(d!==null),v.setNext(d))},hr.getDegree=function(t,n){for(var l=t.getOutEdges().getEdges(),d=0,v=l.iterator();v.hasNext();){var C=v.next();C.getLabel()===n&&d++}return d},hr.findIntersectionNodes=function(t,n){var l=t,d=null;do{var v=l.getFromNode();hr.getDegree(v,n)>1&&(d===null&&(d=new _t),d.add(v)),l=l.getNext(),yt.isTrue(l!==null,"found null DE in ring"),yt.isTrue(l===t||!l.isInRing(),"found DE already in ring")}while(l!==t);return d},T(lo.prototype,{getGeometry:function(){return this.geomFactory===null&&(this.geomFactory=new Rn),this.polygonize(),this.extractOnlyPolygonal?this.geomFactory.buildGeometry(this.polyList):this.geomFactory.createGeometryCollection(Rn.toGeometryArray(this.polyList))},getInvalidRingLines:function(){return this.polygonize(),this.invalidRingLines},findValidRings:function(t,n,l){for(var d=t.iterator();d.hasNext();){var v=d.next();v.isValid()?n.add(v):l.add(v.getLineString())}},polygonize:function(){if(this.polyList!==null||(this.polyList=new _t,this.graph===null))return null;this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var t=this.graph.getEdgeRings(),n=new _t;this.invalidRingLines=new _t,this.isCheckingRingsValid?this.findValidRings(t,n,this.invalidRingLines):n=t,this.findShellsAndHoles(n),lo.assignHolesToShells(this.holeList,this.shellList),tn.sort(this.shellList,new Mi.EnvelopeComparator);var l=!0;this.extractOnlyPolygonal&&(lo.findDisjointShells(this.shellList),l=!1),this.polyList=lo.extractPolygons(this.shellList,l)},getDangles:function(){return this.polygonize(),this.dangles},getCutEdges:function(){return this.polygonize(),this.cutEdges},getPolygons:function(){return this.polygonize(),this.polyList},add:function(){if(qe(arguments[0],Ft))for(var t=arguments[0],n=t.iterator();n.hasNext();){var l=n.next();this.add(l)}else if(arguments[0]instanceof oi){var d=arguments[0];this.geomFactory=d.getFactory(),this.graph===null&&(this.graph=new hr(this.geomFactory)),this.graph.addEdge(d)}else if(arguments[0]instanceof de){var v=arguments[0];v.apply(this.lineStringAdder)}},setCheckRingsValid:function(t){this.isCheckingRingsValid=t},findShellsAndHoles:function(t){this.holeList=new _t,this.shellList=new _t;for(var n=t.iterator();n.hasNext();){var l=n.next();l.computeHole(),l.isHole()?this.holeList.add(l):this.shellList.add(l)}},interfaces_:function(){return[]},getClass:function(){return lo}}),lo.findOuterShells=function(t){for(var n=t.iterator();n.hasNext();){var l=n.next(),d=l.getOuterHole();d===null||d.isProcessed()||(l.setIncluded(!0),d.setProcessed(!0))}},lo.extractPolygons=function(t,n){for(var l=new _t,d=t.iterator();d.hasNext();){var v=d.next();(n||v.isIncluded())&&l.add(v.getPolygon())}return l},lo.assignHolesToShells=function(t,n){for(var l=t.iterator();l.hasNext();){var d=l.next();lo.assignHoleToShell(d,n)}},lo.assignHoleToShell=function(t,n){var l=Mi.findEdgeRingContaining(t,n);l!==null&&l.addHole(t)},lo.findDisjointShells=function(t){lo.findOuterShells(t);var n=null;do{n=!1;for(var l=t.iterator();l.hasNext();){var d=l.next();d.isIncludedSet()||(d.updateIncluded(),d.isIncludedSet()||(n=!0))}}while(n)},T(No.prototype,{filter:function(t){t instanceof oi&&this.p.add(t)},interfaces_:function(){return[Be]},getClass:function(){return No}}),lo.LineStringAdder=No;var Ol=Object.freeze({Polygonizer:lo});T(fc.prototype,{createEdgeEndForNext:function(t,n,l,d){var v=l.segmentIndex+1;if(v>=t.getNumPoints()&&d===null)return null;var C=t.getCoordinate(v);d!==null&&d.segmentIndex===l.segmentIndex&&(C=d.coord);var z=new zs(t,l.coord,C,new wr(t.getLabel()));n.add(z)},createEdgeEndForPrev:function(t,n,l,d){var v=l.segmentIndex;if(l.dist===0){if(v===0)return null;v--}var C=t.getCoordinate(v);d!==null&&d.segmentIndex>=v&&(C=d.coord);var z=new wr(t.getLabel());z.flip();var W=new zs(t,l.coord,C,z);n.add(W)},computeEdgeEnds:function(){if(arguments.length===1){for(var t=arguments[0],n=new _t,l=t;l.hasNext();){var d=l.next();this.computeEdgeEnds(d,n)}return n}if(arguments.length===2){var v=arguments[0],C=arguments[1],z=v.getEdgeIntersectionList();z.addEndpoints();var W=z.iterator(),gt=null,Bt=null;if(!W.hasNext())return null;var Se=W.next();do gt=Bt,Bt=Se,Se=null,W.hasNext()&&(Se=W.next()),Bt!==null&&(this.createEdgeEndForPrev(v,C,Bt,gt),this.createEdgeEndForNext(v,C,Bt,Se));while(Bt!==null)}},interfaces_:function(){return[]},getClass:function(){return fc}}),st(bu,zs),T(bu.prototype,{insert:function(t){this.edgeEnds.add(t)},print:function(t){t.println("EdgeEndBundle--> Label: "+this.label);for(var n=this.iterator();n.hasNext();){var l=n.next();l.print(t),t.println()}},iterator:function(){return this.edgeEnds.iterator()},getEdgeEnds:function(){return this.edgeEnds},computeLabelOn:function(t,n){for(var l=0,d=!1,v=this.iterator();v.hasNext();){var C=v.next(),z=C.getLabel().getLocation(t);z===rt.BOUNDARY&&l++,z===rt.INTERIOR&&(d=!0)}var z=rt.NONE;d&&(z=rt.INTERIOR),l>0&&(z=oe.determineBoundary(n,l)),this.label.setLocation(t,z)},computeLabelSide:function(t,n){for(var l=this.iterator();l.hasNext();){var d=l.next();if(d.getLabel().isArea()){var v=d.getLabel().getLocation(t,n);if(v===rt.INTERIOR)return this.label.setLocation(t,n,rt.INTERIOR),null;v===rt.EXTERIOR&&this.label.setLocation(t,n,rt.EXTERIOR)}}},getLabel:function(){return this.label},computeLabelSides:function(t){this.computeLabelSide(t,Ke.LEFT),this.computeLabelSide(t,Ke.RIGHT)},updateIM:function(t){go.updateIM(this.label,t)},computeLabel:function(t){for(var n=!1,l=this.iterator();l.hasNext();){var d=l.next();d.getLabel().isArea()&&(n=!0)}n?this.label=new wr(rt.NONE,rt.NONE,rt.NONE):this.label=new wr(rt.NONE);for(var v=0;2>v;v++)this.computeLabelOn(v,t),n&&this.computeLabelSides(v)},interfaces_:function(){return[]},getClass:function(){return bu}}),st(Ua,ra),T(Ua.prototype,{updateIM:function(t){for(var n=this.iterator();n.hasNext();){var l=n.next();l.updateIM(t)}},insert:function(t){var n=this.edgeMap.get(t);n===null?(n=new bu(t),this.insertEdgeEnd(t,n)):n.insert(t)},interfaces_:function(){return[]},getClass:function(){return Ua}}),st(ul,ia),T(ul.prototype,{updateIMFromEdges:function(t){this.edges.updateIM(t)},computeIM:function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},interfaces_:function(){return[]},getClass:function(){return ul}}),st(ku,Mo),T(ku.prototype,{createNode:function(t){return new ul(t,new Ua)},interfaces_:function(){return[]},getClass:function(){return ku}}),T(Kl.prototype,{insertEdgeEnds:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();this.nodes.add(l)}},computeProperIntersectionIM:function(t,n){var l=this.arg[0].getGeometry().getDimension(),d=this.arg[1].getGeometry().getDimension(),v=t.hasProperIntersection(),C=t.hasProperInteriorIntersection();l===2&&d===2?v&&n.setAtLeast("212101212"):l===2&&d===1?(v&&n.setAtLeast("FFF0FFFF2"),C&&n.setAtLeast("1FFFFF1FF")):l===1&&d===2?(v&&n.setAtLeast("F0FFFFFF2"),C&&n.setAtLeast("1F1FFFFFF")):l===1&&d===1&&C&&n.setAtLeast("0FFFFFFFF")},labelIsolatedEdges:function(t,n){for(var l=this.arg[t].getEdgeIterator();l.hasNext();){var d=l.next();d.isIsolated()&&(this.labelIsolatedEdge(d,n,this.arg[n].getGeometry()),this.isolatedEdges.add(d))}},labelIsolatedEdge:function(t,n,l){if(l.getDimension()>0){var d=this.ptLocator.locate(t.getCoordinate(),l);t.getLabel().setAllLocations(n,d)}else t.getLabel().setAllLocations(n,rt.EXTERIOR)},computeIM:function(){var t=new zn;if(t.set(rt.EXTERIOR,rt.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var n=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(n,t);var l=new fc,d=l.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(d);var v=l.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(v),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t},labelNodeEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().computeLabelling(this.arg)}},copyNodesAndLabels:function(t){for(var n=this.arg[t].getNodeIterator();n.hasNext();){var l=n.next(),d=this.nodes.addNode(l.getCoordinate());d.setLabel(t,l.getLabel().getLocation(t))}},labelIntersectionNodes:function(t){for(var n=this.arg[t].getEdgeIterator();n.hasNext();)for(var l=n.next(),d=l.getLabel().getLocation(t),v=l.getEdgeIntersectionList().iterator();v.hasNext();){var C=v.next(),z=this.nodes.find(C.coord);z.getLabel().isNull(t)&&(d===rt.BOUNDARY?z.setLabelBoundary(t):z.setLabel(t,rt.INTERIOR))}},labelIsolatedNode:function(t,n){var l=this.ptLocator.locate(t.getCoordinate(),this.arg[n].getGeometry());t.getLabel().setAllLocations(n,l)},computeIntersectionNodes:function(t){for(var n=this.arg[t].getEdgeIterator();n.hasNext();)for(var l=n.next(),d=l.getLabel().getLocation(t),v=l.getEdgeIntersectionList().iterator();v.hasNext();){var C=v.next(),z=this.nodes.addNode(C.coord);d===rt.BOUNDARY?z.setLabelBoundary(t):z.getLabel().isNull(t)&&z.setLabel(t,rt.INTERIOR)}},labelIsolatedNodes:function(){for(var t=this.nodes.iterator();t.hasNext();){var n=t.next(),l=n.getLabel();yt.isTrue(l.getGeometryCount()>0,"node with empty label found"),n.isIsolated()&&(l.isNull(0)?this.labelIsolatedNode(n,0):this.labelIsolatedNode(n,1))}},updateIM:function(t){for(var n=this.isolatedEdges.iterator();n.hasNext();){var l=n.next();l.updateIM(t)}for(var d=this.nodes.iterator();d.hasNext();){var v=d.next();v.updateIM(t),v.updateIMFromEdges(t)}},computeDisjointIM:function(t){var n=this.arg[0].getGeometry();n.isEmpty()||(t.set(rt.INTERIOR,rt.EXTERIOR,n.getDimension()),t.set(rt.BOUNDARY,rt.EXTERIOR,n.getBoundaryDimension()));var l=this.arg[1].getGeometry();l.isEmpty()||(t.set(rt.EXTERIOR,rt.INTERIOR,l.getDimension()),t.set(rt.EXTERIOR,rt.BOUNDARY,l.getBoundaryDimension()))},interfaces_:function(){return[]},getClass:function(){return Kl}}),T(Fs.prototype,{isContainedInBoundary:function(t){if(t instanceof Pi)return!1;if(t instanceof rr)return this.isPointContainedInBoundary(t);if(t instanceof oi)return this.isLineStringContainedInBoundary(t);for(var n=0;n<t.getNumGeometries();n++){var l=t.getGeometryN(n);if(!this.isContainedInBoundary(l))return!1}return!0},isLineSegmentContainedInBoundary:function(t,n){if(t.equals(n))return this.isPointContainedInBoundary(t);if(t.x===n.x){if(t.x===this.rectEnv.getMinX()||t.x===this.rectEnv.getMaxX())return!0}else if(t.y===n.y&&(t.y===this.rectEnv.getMinY()||t.y===this.rectEnv.getMaxY()))return!0;return!1},isLineStringContainedInBoundary:function(t){for(var n=t.getCoordinateSequence(),l=new it,d=new it,v=0;v<n.size()-1;v++)if(n.getCoordinate(v,l),n.getCoordinate(v+1,d),!this.isLineSegmentContainedInBoundary(l,d))return!1;return!0},isPointContainedInBoundary:function(){if(arguments[0]instanceof rr){var t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof it){var n=arguments[0];return n.x===this.rectEnv.getMinX()||n.x===this.rectEnv.getMaxX()||n.y===this.rectEnv.getMinY()||n.y===this.rectEnv.getMaxY()}},contains:function(t){return this.rectEnv.contains(t.getEnvelopeInternal())?!this.isContainedInBoundary(t):!1},interfaces_:function(){return[]},getClass:function(){return Fs}}),Fs.contains=function(t,n){var l=new Fs(t);return l.contains(n)},T(Ml.prototype,{intersects:function(t,n){var l=new Xt(t,n);if(!this.rectEnv.intersects(l))return!1;if(this.rectEnv.intersects(t)||this.rectEnv.intersects(n))return!0;if(t.compareTo(n)>0){var d=t;t=n,n=d}var v=!1;return n.y>t.y&&(v=!0),v?this.li.computeIntersection(t,n,this.diagDown0,this.diagDown1):this.li.computeIntersection(t,n,this.diagUp0,this.diagUp1),!!this.li.hasIntersection()},interfaces_:function(){return[]},getClass:function(){return Ml}}),T(Oo.prototype,{applyTo:function(t){for(var n=0;n<t.getNumGeometries()&&!this._isDone;n++){var l=t.getGeometryN(n);if(l instanceof ri)this.applyTo(l);else if(this.visit(l),this.isDone())return this._isDone=!0,null}},interfaces_:function(){return[]},getClass:function(){return Oo}}),T(Ga.prototype,{intersects:function(t){if(!this.rectEnv.intersects(t.getEnvelopeInternal()))return!1;var n=new cl(this.rectEnv);if(n.applyTo(t),n.intersects())return!0;var l=new Sa(this.rectangle);if(l.applyTo(t),l.containsPoint())return!0;var d=new Uu(this.rectangle);return d.applyTo(t),!!d.intersects()},interfaces_:function(){return[]},getClass:function(){return Ga}}),Ga.intersects=function(t,n){var l=new Ga(t);return l.intersects(n)},st(cl,Oo),T(cl.prototype,{isDone:function(){return this._intersects===!0},visit:function(t){var n=t.getEnvelopeInternal();return this.rectEnv.intersects(n)?this.rectEnv.contains(n)?(this._intersects=!0,null):n.getMinX()>=this.rectEnv.getMinX()&&n.getMaxX()<=this.rectEnv.getMaxX()?(this._intersects=!0,null):n.getMinY()>=this.rectEnv.getMinY()&&n.getMaxY()<=this.rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null},intersects:function(){return this._intersects},interfaces_:function(){return[]},getClass:function(){return cl}}),st(Sa,Oo),T(Sa.prototype,{isDone:function(){return this._containsPoint===!0},visit:function(t){if(!(t instanceof Pi))return null;var n=t.getEnvelopeInternal();if(!this.rectEnv.intersects(n))return null;for(var l=new it,d=0;4>d;d++)if(this.rectSeq.getCoordinate(d,l),n.contains(l)&&po.containsPointInPolygon(l,t))return this._containsPoint=!0,null},containsPoint:function(){return this._containsPoint},interfaces_:function(){return[]},getClass:function(){return Sa}}),st(Uu,Oo),T(Uu.prototype,{intersects:function(){return this.hasIntersection},isDone:function(){return this.hasIntersection===!0},visit:function(t){var n=t.getEnvelopeInternal();if(!this.rectEnv.intersects(n))return null;var l=Nr.getLines(t);this.checkIntersectionWithLineStrings(l)},checkIntersectionWithLineStrings:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();if(this.checkIntersectionWithSegments(l),this.hasIntersection)return null}},checkIntersectionWithSegments:function(t){for(var n=t.getCoordinateSequence(),l=1;l<n.size();l++)if(n.getCoordinate(l-1,this.p0),n.getCoordinate(l,this.p1),this.rectIntersector.intersects(this.p0,this.p1))return this.hasIntersection=!0,null},interfaces_:function(){return[]},getClass:function(){return Uu}}),st(Ei,De),T(Ei.prototype,{getIntersectionMatrix:function(){return this._relate.computeIM()},interfaces_:function(){return[]},getClass:function(){return Ei}}),Ei.covers=function(t,n){return t.getEnvelopeInternal().covers(n.getEnvelopeInternal())?t.isRectangle()?!0:Ei.relate(t,n).isCovers():!1},Ei.intersects=function(t,n){return t.getEnvelopeInternal().intersects(n.getEnvelopeInternal())?t.isRectangle()?Ga.intersects(t,n):n.isRectangle()?Ga.intersects(n,t):Ei.relate(t,n).isIntersects():!1},Ei.touches=function(t,n){return t.getEnvelopeInternal().intersects(n.getEnvelopeInternal())?Ei.relate(t,n).isTouches(t.getDimension(),n.getDimension()):!1},Ei.within=function(t,n){return n.contains(t)},Ei.coveredBy=function(t,n){return Ei.covers(n,t)},Ei.relate=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],l=new Ei(t,n),d=l.getIntersectionMatrix();return d}if(arguments.length===3){if(typeof arguments[2]=="string"&&arguments[0]instanceof de&&arguments[1]instanceof de){var v=arguments[0],C=arguments[1],z=arguments[2];return Ei.relateWithCheck(v,C).matches(z)}if(qe(arguments[2],An)&&arguments[0]instanceof de&&arguments[1]instanceof de){var W=arguments[0],gt=arguments[1],Bt=arguments[2],l=new Ei(W,gt,Bt),d=l.getIntersectionMatrix();return d}}},Ei.overlaps=function(t,n){return t.getEnvelopeInternal().intersects(n.getEnvelopeInternal())?Ei.relate(t,n).isOverlaps(t.getDimension(),n.getDimension()):!1},Ei.disjoint=function(t,n){return!t.intersects(n)},Ei.relateWithCheck=function(t,n){return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),Ei.relate(t,n)},Ei.crosses=function(t,n){return t.getEnvelopeInternal().intersects(n.getEnvelopeInternal())?Ei.relate(t,n).isCrosses(t.getDimension(),n.getDimension()):!1},Ei.contains=function(t,n){return t.getEnvelopeInternal().contains(n.getEnvelopeInternal())?t.isRectangle()?Fs.contains(t,n):Ei.relate(t,n).isContains():!1};var Ia=Object.freeze({RelateOp:Ei});T(ns.prototype,{extractElements:function(t,n){if(t===null)return null;for(var l=0;l<t.getNumGeometries();l++){var d=t.getGeometryN(l);this.skipEmpty&&d.isEmpty()||n.add(d)}},combine:function(){for(var t=new _t,n=this.inputGeoms.iterator();n.hasNext();){var l=n.next();this.extractElements(l,t)}return t.size()===0?this.geomFactory!==null?this.geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(t)},interfaces_:function(){return[]},getClass:function(){return ns}}),ns.combine=function(){if(arguments.length===1){var t=arguments[0],n=new ns(t);return n.combine()}if(arguments.length===2){var l=arguments[0],d=arguments[1],n=new ns(ns.createList(l,d));return n.combine()}if(arguments.length===3){var v=arguments[0],C=arguments[1],z=arguments[2],n=new ns(ns.createList(v,C,z));return n.combine()}},ns.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},ns.createList=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],l=new _t;return l.add(t),l.add(n),l}if(arguments.length===3){var d=arguments[0],v=arguments[1],C=arguments[2],l=new _t;return l.add(d),l.add(v),l.add(C),l}},T(Ta.prototype,{union:function(){for(var t=new en,n=new Qr,l=0;l<this.pointGeom.getNumGeometries();l++){var d=this.pointGeom.getGeometryN(l),v=d.getCoordinate(),C=t.locate(v,this.otherGeom);C===rt.EXTERIOR&&n.add(v)}if(n.size()===0)return this.otherGeom;var z=null,W=Bn.toCoordinateArray(n);return z=W.length===1?this.geomFact.createPoint(W[0]):this.geomFact.createMultiPointFromCoords(W),ns.combine(z,this.otherGeom)},interfaces_:function(){return[]},getClass:function(){return Ta}}),Ta.union=function(t,n){var l=new Ta(t,n);return l.union()},T(dn.prototype,{filter:function(t){this.sortIndex!==-1&&t.getSortIndex()!==this.sortIndex||this.comps.add(t)},interfaces_:function(){return[yr]},getClass:function(){return dn}}),dn.extract=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return dn.extract(t,n,new _t)}if(arguments.length===3){var l=arguments[0],d=arguments[1],v=arguments[2];return l.getSortIndex()===d?v.add(l):l instanceof ri&&l.apply(new dn(d,v)),v}},T(zo.prototype,{reduceToGeometries:function(t){for(var n=new _t,l=t.iterator();l.hasNext();){var d=l.next(),v=null;qe(d,pt)?v=this.unionTree(d):d instanceof de&&(v=d),n.add(v)}return n},extractByEnvelope:function(t,n,l){for(var d=new _t,v=0;v<n.getNumGeometries();v++){var C=n.getGeometryN(v);C.getEnvelopeInternal().intersects(t)?d.add(C):l.add(C)}return this.geomFactory.buildGeometry(d)},unionOptimized:function(t,n){var l=t.getEnvelopeInternal(),d=n.getEnvelopeInternal();if(!l.intersects(d)){var v=ns.combine(t,n);return v}if(t.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(t,n);var C=l.intersection(d);return this.unionUsingEnvelopeIntersection(t,n,C)},union:function(){if(this.inputPolys===null)throw new IllegalStateException("union() method cannot be called twice");if(this.inputPolys.isEmpty())return null;this.geomFactory=this.inputPolys.iterator().next().getFactory();for(var t=new xn(zo.STRTREE_NODE_CAPACITY),n=this.inputPolys.iterator();n.hasNext();){var l=n.next();t.insert(l.getEnvelopeInternal(),l)}this.inputPolys=null;var d=t.itemsTree(),v=this.unionTree(d);return v},binaryUnion:function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(arguments.length===3){var n=arguments[0],l=arguments[1],d=arguments[2];if(1>=d-l){var C=zo.getGeometry(n,l);return this.unionSafe(C,null)}if(d-l===2)return this.unionSafe(zo.getGeometry(n,l),zo.getGeometry(n,l+1));var v=Math.trunc((d+l)/2),C=this.binaryUnion(n,l,v),z=this.binaryUnion(n,v,d);return this.unionSafe(C,z)}},repeatedUnion:function(t){for(var n=null,l=t.iterator();l.hasNext();){var d=l.next();n=n===null?d.copy():n.union(d)}return n},unionSafe:function(t,n){return t===null&&n===null?null:t===null?n.copy():n===null?t.copy():this.unionOptimized(t,n)},unionActual:function(t,n){return zo.restrictToPolygons(t.union(n))},unionTree:function(t){var n=this.reduceToGeometries(t),l=this.binaryUnion(n);return l},unionUsingEnvelopeIntersection:function(t,n,l){var d=new _t,v=this.extractByEnvelope(l,t,d),C=this.extractByEnvelope(l,n,d),z=this.unionActual(v,C);d.add(z);var W=ns.combine(d);return W},bufferUnion:function(){if(arguments.length===1){var t=arguments[0],n=t.get(0).getFactory(),l=n.buildGeometry(t),d=l.buffer(0);return d}if(arguments.length===2){var v=arguments[0],C=arguments[1],n=v.getFactory(),l=n.createGeometryCollection([v,C]),d=l.buffer(0);return d}},interfaces_:function(){return[]},getClass:function(){return zo}}),zo.restrictToPolygons=function(t){if(qe(t,ts))return t;var n=Il.getPolygons(t);return n.size()===1?n.get(0):t.getFactory().createMultiPolygon(Rn.toPolygonArray(n))},zo.getGeometry=function(t,n){return n>=t.size()?null:t.get(n)},zo.union=function(t){var n=new zo(t);return n.union()},zo.STRTREE_NODE_CAPACITY=4,T(Ql.prototype,{unionNoOpt:function(t){var n=this.geomFact.createPoint();return wi.overlayOp(t,n,mn.UNION)},unionWithNull:function(t,n){return t===null&&n===null?null:n===null?t:t===null?n:t.union(n)},extract:function(){if(qe(arguments[0],Ft))for(var t=arguments[0],n=t.iterator();n.hasNext();){var l=n.next();this.extract(l)}else if(arguments[0]instanceof de){var d=arguments[0];this.geomFact===null&&(this.geomFact=d.getFactory()),dn.extract(d,de.SORTINDEX_POLYGON,this.polygons),dn.extract(d,de.SORTINDEX_LINESTRING,this.lines),dn.extract(d,de.SORTINDEX_POINT,this.points)}},union:function(){if(this.geomFact===null)return null;var n=null;if(this.points.size()>0){var l=this.geomFact.buildGeometry(this.points);n=this.unionNoOpt(l)}var d=null;if(this.lines.size()>0){var v=this.geomFact.buildGeometry(this.lines);d=this.unionNoOpt(v)}var C=null;this.polygons.size()>0&&(C=zo.union(this.polygons));var z=this.unionWithNull(d,C),W=null;return W=n===null?z:z===null?n:Ta.union(n,z),W===null?this.geomFact.createGeometryCollection():W},interfaces_:function(){return[]},getClass:function(){return Ql}}),Ql.union=function(){if(arguments.length===1){if(qe(arguments[0],Ft)){var t=arguments[0],n=new Ql(t);return n.union()}if(arguments[0]instanceof de){var l=arguments[0],n=new Ql(l);return n.union()}}else if(arguments.length===2){var d=arguments[0],v=arguments[1],n=new Ql(d,v);return n.union()}};var Bo=Object.freeze({UnaryUnionOp:Ql});T(wu.prototype,{visitInteriorRing:function(t,n){var l=t.getCoordinates(),d=l[0],v=wu.findDifferentPoint(l,d),C=n.findEdgeInSameDirection(d,v),z=n.findEdgeEnd(C),W=null;z.getLabel().getLocation(0,Ke.RIGHT)===rt.INTERIOR?W=z:z.getSym().getLabel().getLocation(0,Ke.RIGHT)===rt.INTERIOR&&(W=z.getSym()),yt.isTrue(W!==null,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(W)},visitShellInteriors:function(t,n){if(t instanceof Pi){var l=t;this.visitInteriorRing(l.getExteriorRing(),n)}if(t instanceof Ct)for(var d=t,v=0;v<d.getNumGeometries();v++){var l=d.getGeometryN(v);this.visitInteriorRing(l.getExteriorRing(),n)}},getCoordinate:function(){return this.disconnectedRingcoord},setInteriorEdgesInResult:function(t){for(var n=t.getEdgeEnds().iterator();n.hasNext();){var l=n.next();l.getLabel().getLocation(0,Ke.RIGHT)===rt.INTERIOR&&l.setInResult(!0)}},visitLinkedDirectedEdges:function(t){var n=t,l=t;do yt.isTrue(l!==null,"found null Directed Edge"),l.setVisited(!0),l=l.getNext();while(l!==n)},buildEdgeRings:function(t){for(var n=new _t,l=t.iterator();l.hasNext();){var d=l.next();if(d.isInResult()&&d.getEdgeRing()===null){var v=new du(d,this.geometryFactory);v.linkDirectedEdgesForMinimalEdgeRings();var C=v.buildMinimalRings();n.addAll(C)}}return n},hasUnvisitedShellEdge:function(t){for(var n=0;n<t.size();n++){var l=t.get(n);if(!l.isHole()){var d=l.getEdges(),v=d.get(0);if(v.getLabel().getLocation(0,Ke.RIGHT)===rt.INTERIOR){for(var C=0;C<d.size();C++)if(v=d.get(C),!v.isVisited())return this.disconnectedRingcoord=v.getCoordinate(),!0}}}return!1},isInteriorsConnected:function(){var t=new _t;this.geomGraph.computeSplitEdges(t);var n=new Ps(new Ho);n.addEdges(t),this.setInteriorEdgesInResult(n),n.linkResultDirectedEdges();var l=this.buildEdgeRings(n.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),n),!this.hasUnvisitedShellEdge(l)},interfaces_:function(){return[]},getClass:function(){return wu}}),wu.findDifferentPoint=function(t,n){for(var l=0;l<t.length;l++)if(!t[l].equals(n))return t[l];return null},T(xo.prototype,{hasChildren:function(){for(var t=0;2>t;t++)if(this.subnode[t]!==null)return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var n=0;2>n;n++)this.subnode[n]!==null&&this.subnode[n].addAllItems(t);return t},size:function(){for(var t=0,n=0;2>n;n++)this.subnode[n]!==null&&(t+=this.subnode[n].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,n){return t===null||this.isSearchMatch(t)?(n.addAll(this.items),this.subnode[0]!==null&&this.subnode[0].addAllItemsFromOverlapping(t,n),void(this.subnode[1]!==null&&this.subnode[1].addAllItemsFromOverlapping(t,n))):null},hasItems:function(){return!this.items.isEmpty()},remove:function(t,n){if(!this.isSearchMatch(t))return!1;for(var l=!1,d=0;2>d;d++)if(this.subnode[d]!==null&&(l=this.subnode[d].remove(t,n))){this.subnode[d].isPrunable()&&(this.subnode[d]=null);break}return l||(l=this.items.remove(n))},getItems:function(){return this.items},depth:function(){for(var t=0,n=0;2>n;n++)if(this.subnode[n]!==null){var l=this.subnode[n].depth();l>t&&(t=l)}return t+1},nodeSize:function(){for(var t=0,n=0;2>n;n++)this.subnode[n]!==null&&(t+=this.subnode[n].nodeSize());return t+1},add:function(t){this.items.add(t)},interfaces_:function(){return[]},getClass:function(){return xo}}),xo.getSubnodeIndex=function(t,n){var l=-1;return t.min>=n&&(l=1),t.max<=n&&(l=0),l},T(Al.prototype,{expandToInclude:function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},getWidth:function(){return this.max-this.min},overlaps:function(){if(arguments.length===1){var t=arguments[0];return this.overlaps(t.min,t.max)}if(arguments.length===2){var n=arguments[0],l=arguments[1];return!(this.min>l||this.max<n)}},getMin:function(){return this.min},toString:function(){return"["+this.min+", "+this.max+"]"},contains:function(){if(arguments.length===1){if(arguments[0]instanceof Al){var t=arguments[0];return this.contains(t.min,t.max)}if(typeof arguments[0]=="number"){var n=arguments[0];return n>=this.min&&n<=this.max}}else if(arguments.length===2){var l=arguments[0],d=arguments[1];return l>=this.min&&d<=this.max}},init:function(t,n){this.min=t,this.max=n,t>n&&(this.min=n,this.max=t)},getMax:function(){return this.max},interfaces_:function(){return[]},getClass:function(){return Al}}),T(as.prototype,{getInterval:function(){return this.interval},getLevel:function(){return this.level},computeKey:function(t){for(this.level=as.computeLevel(t),this.interval=new Al,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},computeInterval:function(t,n){var l=oa.powerOf2(t);this.pt=Math.floor(n.getMin()/l)*l,this.interval.init(this.pt,this.pt+l)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return as}}),as.computeLevel=function(t){var n=t.getWidth(),l=oa.exponent(n)+1;return l},st(ca,xo),T(ca.prototype,{getInterval:function(){return this.interval},find:function(t){var n=xo.getSubnodeIndex(t,this.centre);if(n===-1)return this;if(this.subnode[n]!==null){var l=this.subnode[n];return l.find(t)}return this},insert:function(t){yt.isTrue(this.interval===null||this.interval.contains(t.interval));var n=xo.getSubnodeIndex(t.interval,this.centre);if(t.level===this.level-1)this.subnode[n]=t;else{var l=this.createSubnode(n);l.insert(t),this.subnode[n]=l}},isSearchMatch:function(t){return t.overlaps(this.interval)},getSubnode:function(t){return this.subnode[t]===null&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getNode:function(t){var n=xo.getSubnodeIndex(t,this.centre);if(n!==-1){var l=this.getSubnode(n);return l.getNode(t)}return this},createSubnode:function(t){var n=0,l=0;switch(t){case 0:n=this.interval.getMin(),l=this.centre;break;case 1:n=this.centre,l=this.interval.getMax()}var d=new Al(n,l),v=new ca(d,this.level-1);return v},interfaces_:function(){return[]},getClass:function(){return ca}}),ca.createNode=function(t){var n=new as(t),l=new ca(n.getInterval(),n.getLevel());return l},ca.createExpanded=function(t,n){var l=new Al(n);t!==null&&l.expandToInclude(t.interval);var d=ca.createNode(l);return t!==null&&d.insert(t),d},st(Ll,xo),T(Ll.prototype,{insert:function(t,n){var l=xo.getSubnodeIndex(t,Ll.origin);if(l===-1)return this.add(n),null;var d=this.subnode[l];if(d===null||!d.getInterval().contains(t)){var v=ca.createExpanded(d,t);this.subnode[l]=v}this.insertContained(this.subnode[l],t,n)},isSearchMatch:function(t){return!0},insertContained:function(t,n,l){yt.isTrue(t.getInterval().contains(n));var d=Bs.isZeroWidth(n.getMin(),n.getMax()),v=null;v=d?t.find(n):t.getNode(n),v.add(l)},interfaces_:function(){return[]},getClass:function(){return Ll}}),Ll.origin=0,T(hl.prototype,{size:function(){return this.root!==null?this.root.size():0},insert:function(t,n){this.collectStats(t);var l=hl.ensureExtent(t,this.minExtent);this.root.insert(l,n)},query:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];return this.query(new Al(t,t))}if(arguments[0]instanceof Al){var n=arguments[0],l=new _t;return this.query(n,l),l}}else if(arguments.length===2){var d=arguments[0],v=arguments[1];this.root.addAllItemsFromOverlapping(d,v)}},iterator:function(){var t=new _t;return this.root.addAllItems(t),t.iterator()},remove:function(t,n){var l=hl.ensureExtent(t,this.minExtent);return this.root.remove(l,n)},collectStats:function(t){var n=t.getWidth();n<this.minExtent&&n>0&&(this.minExtent=n)},depth:function(){return this.root!==null?this.root.depth():0},nodeSize:function(){return this.root!==null?this.root.nodeSize():0},interfaces_:function(){return[]},getClass:function(){return hl}}),hl.ensureExtent=function(t,n){var l=t.getMin(),d=t.getMax();return l!==d?t:(l===d&&(l-=n/2,d=l+n/2),new Al(l,d))},T(dc.prototype,{isInside:function(t){},interfaces_:function(){return[]},getClass:function(){return dc}}),T(Rl.prototype,{testLineSegment:function(t,n){var l=null,d=null,v=null,C=null,z=null,W=n.p0,gt=n.p1;d=W.x-t.x,v=W.y-t.y,C=gt.x-t.x,z=gt.y-t.y,(v>0&&0>=z||z>0&&0>=v)&&(l=ea.signOfDet2x2(d,v,C,z)/(z-v),l>0&&this.crossings++)},buildIndex:function(){this.tree=new hl;for(var t=Bn.removeRepeatedPoints(this.ring.getCoordinates()),n=ho.getChains(t),l=0;l<n.size();l++){var d=n.get(l),v=d.getEnvelope();this.interval.min=v.getMinY(),this.interval.max=v.getMaxY(),this.tree.insert(this.interval,d)}},testMonotoneChain:function(t,n,l){l.select(t,n)},isInside:function(t){this.crossings=0;var n=new Xt(j.NEGATIVE_INFINITY,j.POSITIVE_INFINITY,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var l=this.tree.query(this.interval),d=new Ca(this,t),v=l.iterator();v.hasNext();){var C=v.next();this.testMonotoneChain(n,d,C)}return this.crossings%2===1},interfaces_:function(){return[dc]},getClass:function(){return Rl}}),st(Ca,gs),T(Ca.prototype,{select:function(){if(arguments.length!==1)return gs.prototype.select.apply(this,arguments);var t=arguments[0];this.mcp.testLineSegment(this.p,t)},interfaces_:function(){return[]},getClass:function(){return Ca}}),Rl.MCSelecter=Ca,T(pc.prototype,{insertEdgeEnds:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();this.nodes.add(l)}},getNodeIterator:function(){return this.nodes.iterator()},copyNodesAndLabels:function(t,n){for(var l=t.getNodeIterator();l.hasNext();){var d=l.next(),v=this.nodes.addNode(d.getCoordinate());v.setLabel(n,d.getLabel().getLocation(n))}},build:function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var n=new fc,l=n.computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(l)},computeIntersectionNodes:function(t,n){for(var l=t.getEdgeIterator();l.hasNext();)for(var d=l.next(),v=d.getLabel().getLocation(n),C=d.getEdgeIntersectionList().iterator();C.hasNext();){var z=C.next(),W=this.nodes.addNode(z.coord);v===rt.BOUNDARY?W.setLabelBoundary(n):W.getLabel().isNull(n)&&W.setLabel(n,rt.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return pc}}),T(Gu.prototype,{isNodeEdgeAreaLabelsConsistent:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var n=t.next();if(!n.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=n.getCoordinate().copy(),!1}return!0},getInvalidPoint:function(){return this.invalidPoint},hasDuplicateRings:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var n=t.next(),l=n.getEdges().iterator();l.hasNext();){var d=l.next();if(d.getEdgeEnds().size()>1)return this.invalidPoint=d.getEdge().getCoordinate(0),!0}return!1},isNodeConsistentArea:function(){var t=this.geomGraph.computeSelfNodes(this.li,!0,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},interfaces_:function(){return[]},getClass:function(){return Gu}}),T(gc.prototype,{buildIndex:function(){this.index=new xn;for(var t=0;t<this.rings.size();t++){var n=this.rings.get(t),l=n.getEnvelopeInternal();this.index.insert(l,n)}},getNestedPoint:function(){return this.nestedPt},isNonNested:function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var n=this.rings.get(t),l=n.getCoordinates(),d=this.index.query(n.getEnvelopeInternal()),v=0;v<d.size();v++){var C=d.get(v),z=C.getCoordinates();if(n!==C&&n.getEnvelopeInternal().intersects(C.getEnvelopeInternal())){var W=Ks.findPtNotNode(l,C,this.graph);if(W!==null){var gt=re.isPointInRing(W,z);if(gt)return this.nestedPt=W,!1}}}return!0},add:function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},interfaces_:function(){return[]},getClass:function(){return gc}}),T(Bi.prototype,{getErrorType:function(){return this.errorType},getMessage:function(){return Bi.errMsg[this.errorType]},getCoordinate:function(){return this.pt},toString:function(){var t="";return this.pt!==null&&(t=" at or near point "+this.pt),this.getMessage()+t},interfaces_:function(){return[]},getClass:function(){return Bi}}),Bi.ERROR=0,Bi.REPEATED_POINT=1,Bi.HOLE_OUTSIDE_SHELL=2,Bi.NESTED_HOLES=3,Bi.DISCONNECTED_INTERIOR=4,Bi.SELF_INTERSECTION=5,Bi.RING_SELF_INTERSECTION=6,Bi.NESTED_SHELLS=7,Bi.DUPLICATE_RINGS=8,Bi.TOO_FEW_POINTS=9,Bi.INVALID_COORDINATE=10,Bi.RING_NOT_CLOSED=11,Bi.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],T(Ks.prototype,{checkInvalidCoordinates:function(){if(arguments[0]instanceof Array){for(var t=arguments[0],n=0;n<t.length;n++)if(!Ks.isValid(t[n]))return this.validErr=new Bi(Bi.INVALID_COORDINATE,t[n]),null}else if(arguments[0]instanceof Pi){var l=arguments[0];if(this.checkInvalidCoordinates(l.getExteriorRing().getCoordinates()),this.validErr!==null)return null;for(var n=0;n<l.getNumInteriorRing();n++)if(this.checkInvalidCoordinates(l.getInteriorRingN(n).getCoordinates()),this.validErr!==null)return null}},checkHolesNotNested:function(t,n){for(var l=new gc(n),d=0;d<t.getNumInteriorRing();d++){var v=t.getInteriorRingN(d);l.add(v)}var C=l.isNonNested();C||(this.validErr=new Bi(Bi.NESTED_HOLES,l.getNestedPoint()))},checkConsistentArea:function(t){var n=new Gu(t),l=n.isNodeConsistentArea();return l?void(n.hasDuplicateRings()&&(this.validErr=new Bi(Bi.DUPLICATE_RINGS,n.getInvalidPoint()))):(this.validErr=new Bi(Bi.SELF_INTERSECTION,n.getInvalidPoint()),null)},isValid:function(){return this.checkValid(this.parentGeometry),this.validErr===null},checkShellInsideHole:function(t,n,l){var d=t.getCoordinates(),v=n.getCoordinates(),C=Ks.findPtNotNode(d,n,l);if(C!==null){var z=re.isPointInRing(C,v);if(!z)return C}var W=Ks.findPtNotNode(v,t,l);if(W!==null){var gt=re.isPointInRing(W,d);return gt?W:null}return yt.shouldNeverReachHere("points in shell and hole appear to be equal"),null},checkNoSelfIntersectingRings:function(t){for(var n=t.getEdgeIterator();n.hasNext();){var l=n.next();if(this.checkNoSelfIntersectingRing(l.getEdgeIntersectionList()),this.validErr!==null)return null}},checkConnectedInteriors:function(t){var n=new wu(t);n.isInteriorsConnected()||(this.validErr=new Bi(Bi.DISCONNECTED_INTERIOR,n.getCoordinate()))},checkNoSelfIntersectingRing:function(t){for(var n=new Qr,l=!0,d=t.iterator();d.hasNext();){var v=d.next();if(l)l=!1;else{if(n.contains(v.coord))return this.validErr=new Bi(Bi.RING_SELF_INTERSECTION,v.coord),null;n.add(v.coord)}}},checkHolesInShell:function(t,n){for(var l=t.getExteriorRing(),d=new Rl(l),v=0;v<t.getNumInteriorRing();v++){var C=t.getInteriorRingN(v),z=Ks.findPtNotNode(C.getCoordinates(),l,n);if(z===null)return null;var W=!d.isInside(z);if(W)return this.validErr=new Bi(Bi.HOLE_OUTSIDE_SHELL,z),null}},checkTooFewPoints:function(t){return t.hasTooFewPoints()?(this.validErr=new Bi(Bi.TOO_FEW_POINTS,t.getInvalidPoint()),null):void 0},getValidationError:function(){return this.checkValid(this.parentGeometry),this.validErr},checkValid:function(){if(arguments[0]instanceof rr){var t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof Zr){var n=arguments[0];this.checkInvalidCoordinates(n.getCoordinates())}else if(arguments[0]instanceof Yi){var l=arguments[0];if(this.checkInvalidCoordinates(l.getCoordinates()),this.validErr!==null||(this.checkClosedRing(l),this.validErr!==null))return null;var d=new oe(0,l);if(this.checkTooFewPoints(d),this.validErr!==null)return null;var v=new ji;d.computeSelfNodes(v,!0,!0),this.checkNoSelfIntersectingRings(d)}else if(arguments[0]instanceof oi){var C=arguments[0];if(this.checkInvalidCoordinates(C.getCoordinates()),this.validErr!==null)return null;var d=new oe(0,C);this.checkTooFewPoints(d)}else if(arguments[0]instanceof Pi){var z=arguments[0];if(this.checkInvalidCoordinates(z),this.validErr!==null||(this.checkClosedRings(z),this.validErr!==null))return null;var d=new oe(0,z);if(this.checkTooFewPoints(d),this.validErr!==null||(this.checkConsistentArea(d),this.validErr!==null)||!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(d),this.validErr!==null)||(this.checkHolesInShell(z,d),this.validErr!==null)||(this.checkHolesNotNested(z,d),this.validErr!==null))return null;this.checkConnectedInteriors(d)}else if(arguments[0]instanceof Ct){for(var W=arguments[0],gt=0;gt<W.getNumGeometries();gt++){var Bt=W.getGeometryN(gt);if(this.checkInvalidCoordinates(Bt),this.validErr!==null||(this.checkClosedRings(Bt),this.validErr!==null))return null}var d=new oe(0,W);if(this.checkTooFewPoints(d),this.validErr!==null||(this.checkConsistentArea(d),this.validErr!==null)||!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(d),this.validErr!==null))return null;for(var gt=0;gt<W.getNumGeometries();gt++){var Bt=W.getGeometryN(gt);if(this.checkHolesInShell(Bt,d),this.validErr!==null)return null}for(var gt=0;gt<W.getNumGeometries();gt++){var Bt=W.getGeometryN(gt);if(this.checkHolesNotNested(Bt,d),this.validErr!==null)return null}if(this.checkShellsNotNested(W,d),this.validErr!==null)return null;this.checkConnectedInteriors(d)}else if(arguments[0]instanceof ri)for(var Se=arguments[0],gt=0;gt<Se.getNumGeometries();gt++){var Ae=Se.getGeometryN(gt);if(this.checkValid(Ae),this.validErr!==null)return null}else if(arguments[0]instanceof de){var rn=arguments[0];if(this.validErr=null,rn.isEmpty())return null;if(rn instanceof rr)this.checkValid(rn);else if(rn instanceof Zr)this.checkValid(rn);else if(rn instanceof Yi)this.checkValid(rn);else if(rn instanceof oi)this.checkValid(rn);else if(rn instanceof Pi)this.checkValid(rn);else if(rn instanceof Ct)this.checkValid(rn);else{if(!(rn instanceof ri))throw new UnsupportedOperationException(rn.getClass().getName());this.checkValid(rn)}}},setSelfTouchingRingFormingHoleValid:function(t){this.isSelfTouchingRingFormingHoleValid=t},checkShellNotNested:function(t,n,l){var d=t.getCoordinates(),v=n.getExteriorRing(),C=v.getCoordinates(),z=Ks.findPtNotNode(d,v,l);if(z===null)return null;var W=re.isPointInRing(z,C);if(!W)return null;if(n.getNumInteriorRing()<=0)return this.validErr=new Bi(Bi.NESTED_SHELLS,z),null;for(var gt=null,Bt=0;Bt<n.getNumInteriorRing();Bt++){var Se=n.getInteriorRingN(Bt);if(gt=this.checkShellInsideHole(t,Se,l),gt===null)return null}this.validErr=new Bi(Bi.NESTED_SHELLS,gt)},checkClosedRings:function(t){if(this.checkClosedRing(t.getExteriorRing()),this.validErr!==null)return null;for(var n=0;n<t.getNumInteriorRing();n++)if(this.checkClosedRing(t.getInteriorRingN(n)),this.validErr!==null)return null},checkClosedRing:function(t){if(!t.isClosed()){var n=null;t.getNumPoints()>=1&&(n=t.getCoordinateN(0)),this.validErr=new Bi(Bi.RING_NOT_CLOSED,n)}},checkShellsNotNested:function(t,n){for(var l=0;l<t.getNumGeometries();l++)for(var d=t.getGeometryN(l),v=d.getExteriorRing(),C=0;C<t.getNumGeometries();C++)if(l!==C){var z=t.getGeometryN(C);if(this.checkShellNotNested(v,z,n),this.validErr!==null)return null}},interfaces_:function(){return[]},getClass:function(){return Ks}}),Ks.findPtNotNode=function(t,n,l){for(var d=l.findEdge(n),v=d.getEdgeIntersectionList(),C=0;C<t.length;C++){var z=t[C];if(!v.isIntersection(z))return z}return null},Ks.isValid=function(){if(arguments[0]instanceof de){var t=arguments[0],n=new Ks(t);return n.isValid()}if(arguments[0]instanceof it){var l=arguments[0];return j.isNaN(l.x)||j.isInfinite(l.x)||j.isNaN(l.y)?!1:!j.isInfinite(l.y)}};var Ma=Object.freeze({IsValidOp:Ks}),zl=Object.freeze({BoundaryOp:Tr,IsSimpleOp:sl,buffer:Is,distance:Ir,linemerge:xi,overlay:Po,polygonize:Ol,relate:Ia,union:Bo,valid:Ma});st(nc,et.CoordinateOperation),T(nc.prototype,{editCoordinates:function(t,n){if(t.length===0)return null;for(var l=new Array(t.length).fill(null),d=0;d<t.length;d++){var v=new it(t[d]);this.targetPM.makePrecise(v),l[d]=v}var C=new Jt(l,!1),z=C.toCoordinateArray(),W=0;n instanceof oi&&(W=2),n instanceof Yi&&(W=4);var gt=l;return this.removeCollapsed&&(gt=null),z.length<W?gt:z},interfaces_:function(){return[]},getClass:function(){return nc}}),T(fl.prototype,{fixPolygonalTopology:function(t){var n=t;this.changePrecisionModel||(n=this.changePM(t,this.targetPM));var l=n.buffer(0),d=l;return this.changePrecisionModel||(d=t.getFactory().createGeometry(l)),d},reducePointwise:function(t){var n=null;if(this.changePrecisionModel){var l=this.createFactory(t.getFactory(),this.targetPM);n=new et(l)}else n=new et;var d=this.removeCollapsed;t.getDimension()>=2&&(d=!0);var v=n.edit(t,new nc(this.targetPM,d));return v},changePM:function(t,n){var l=this.createEditor(t.getFactory(),n);return l.edit(t,new et.NoOpGeometryOperation)},setRemoveCollapsedComponents:function(t){this.removeCollapsed=t},createFactory:function(t,n){var l=new Rn(n,t.getSRID(),t.getCoordinateSequenceFactory());return l},setChangePrecisionModel:function(t){this.changePrecisionModel=t},reduce:function(t){var n=this.reducePointwise(t);return this.isPointwise?n:qe(n,ts)?n.isValid()?n:this.fixPolygonalTopology(n):n},setPointwise:function(t){this.isPointwise=t},createEditor:function(t,n){if(t.getPrecisionModel()===n)return new et;var l=this.createFactory(t,n),d=new et(l);return d},interfaces_:function(){return[]},getClass:function(){return fl}}),fl.reduce=function(t,n){var l=new fl(n);return l.reduce(t)},fl.reducePointwise=function(t,n){var l=new fl(n);return l.setPointwise(!0),l.reduce(t)};var uo=Object.freeze({GeometryPrecisionReducer:fl});T(ic.prototype,{simplifySection:function(t,n){if(t+1===n)return null;this.seg.p0=this.pts[t],this.seg.p1=this.pts[n];for(var l=-1,d=t,v=t+1;n>v;v++){var C=this.seg.distance(this.pts[v]);C>l&&(l=C,d=v)}if(l<=this.distanceTolerance)for(var v=t+1;n>v;v++)this.usePt[v]=!1;else this.simplifySection(t,d),this.simplifySection(d,n)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(){this.usePt=new Array(this.pts.length).fill(null);for(var t=0;t<this.pts.length;t++)this.usePt[t]=!0;this.simplifySection(0,this.pts.length-1);for(var n=new Jt,t=0;t<this.pts.length;t++)this.usePt[t]&&n.add(new it(this.pts[t]));return n.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return ic}}),ic.simplify=function(t,n){var l=new ic(t);return l.setDistanceTolerance(n),l.simplify()},T(dl.prototype,{setEnsureValid:function(t){this.isEnsureValidTopology=t},getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():new Eu(this.isEnsureValidTopology,this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>t)throw new q;this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return dl}}),dl.simplify=function(t,n){var l=new dl(t);return l.setDistanceTolerance(n),l.getResultGeometry()},st(Eu,br),T(Eu.prototype,{transformPolygon:function(t,n){if(t.isEmpty())return null;var l=br.prototype.transformPolygon.call(this,t,n);return n instanceof Ct?l:this.createValidArea(l)},createValidArea:function(t){return this.isEnsureValidTopology?t.buffer(0):t},transformCoordinates:function(t,n){var l=t.toCoordinateArray(),d=null;return d=l.length===0?new Array(0).fill(null):ic.simplify(l,this.distanceTolerance),this.factory.getCoordinateSequenceFactory().create(d)},transformMultiPolygon:function(t,n){var l=br.prototype.transformMultiPolygon.call(this,t,n);return this.createValidArea(l)},transformLinearRing:function(t,n){var l=n instanceof Pi,d=br.prototype.transformLinearRing.call(this,t,n);return!l||d instanceof Yi?d:null},interfaces_:function(){return[]},getClass:function(){return Eu}}),dl.DPTransformer=Eu,st(Dl,gn),T(Dl.prototype,{getIndex:function(){return this.index},getParent:function(){return this.parent},interfaces_:function(){return[]},getClass:function(){return Dl}}),T(Va.prototype,{addToResult:function(t){this.resultSegs.add(t)},asLineString:function(){return this.parentLine.getFactory().createLineString(Va.extractCoordinates(this.resultSegs))},getResultSize:function(){var t=this.resultSegs.size();return t===0?0:t+1},getParent:function(){return this.parentLine},getSegment:function(t){return this.segs[t]},getParentCoordinates:function(){return this.parentLine.getCoordinates()},getMinimumSize:function(){return this.minimumSize},asLinearRing:function(){return this.parentLine.getFactory().createLinearRing(Va.extractCoordinates(this.resultSegs))},getSegments:function(){return this.segs},init:function(){var t=this.parentLine.getCoordinates();this.segs=new Array(t.length-1).fill(null);for(var n=0;n<t.length-1;n++){var l=new Dl(t[n],t[n+1],this.parentLine,n);this.segs[n]=l}},getResultCoordinates:function(){return Va.extractCoordinates(this.resultSegs)},interfaces_:function(){return[]},getClass:function(){return Va}}),Va.extractCoordinates=function(t){for(var n=new Array(t.size()+1).fill(null),l=null,d=0;d<t.size();d++)l=t.get(d),n[d]=l.p0;return n[n.length-1]=l.p1,n},T(Vu.prototype,{remove:function(t){this.index.remove(new Xt(t.p0,t.p1),t)},add:function(){if(arguments[0]instanceof Va)for(var t=arguments[0],n=t.getSegments(),l=0;l<n.length;l++){var d=n[l];this.add(d)}else if(arguments[0]instanceof gn){var v=arguments[0];this.index.insert(new Xt(v.p0,v.p1),v)}},query:function(t){var n=new Xt(t.p0,t.p1),l=new Pc(t);this.index.query(n,l);var d=l.getItems();return d},interfaces_:function(){return[]},getClass:function(){return Vu}}),T(Pc.prototype,{visitItem:function(t){var n=t;Xt.intersects(n.p0,n.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Pn]},getClass:function(){return Pc}}),T(qa.prototype,{flatten:function(t,n){var l=this.linePts[t],d=this.linePts[n],v=new gn(l,d);return this.remove(this.line,t,n),this.outputIndex.add(v),v},hasBadIntersection:function(t,n,l){return this.hasBadOutputIntersection(l)?!0:!!this.hasBadInputIntersection(t,n,l)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplifySection:function(t,n,l){l+=1;var d=new Array(2).fill(null);if(t+1===n){var v=this.line.getSegment(t);return this.line.addToResult(v),null}var C=!0;if(this.line.getResultSize()<this.line.getMinimumSize()){var z=l+1;z<this.line.getMinimumSize()&&(C=!1)}var W=new Array(1).fill(null),gt=this.findFurthestPoint(this.linePts,t,n,W);W[0]>this.distanceTolerance&&(C=!1);var Bt=new gn;if(Bt.p0=this.linePts[t],Bt.p1=this.linePts[n],d[0]=t,d[1]=n,this.hasBadIntersection(this.line,d,Bt)&&(C=!1),C){var v=this.flatten(t,n);return this.line.addToResult(v),null}this.simplifySection(t,gt,l),this.simplifySection(gt,n,l)},hasBadOutputIntersection:function(t){for(var n=this.outputIndex.query(t),l=n.iterator();l.hasNext();){var d=l.next();if(this.hasInteriorIntersection(d,t))return!0}return!1},findFurthestPoint:function(t,n,l,d){var v=new gn;v.p0=t[n],v.p1=t[l];for(var C=-1,z=n,W=n+1;l>W;W++){var gt=t[W],Bt=v.distance(gt);Bt>C&&(C=Bt,z=W)}return d[0]=C,z},simplify:function(t){this.line=t,this.linePts=t.getParentCoordinates(),this.simplifySection(0,this.linePts.length-1,0)},remove:function(t,n,l){for(var d=n;l>d;d++){var v=t.getSegment(d);this.inputIndex.remove(v)}},hasInteriorIntersection:function(t,n){return this.li.computeIntersection(t.p0,t.p1,n.p0,n.p1),this.li.isInteriorIntersection()},hasBadInputIntersection:function(t,n,l){for(var d=this.inputIndex.query(l),v=d.iterator();v.hasNext();){var C=v.next();if(this.hasInteriorIntersection(C,l)){if(qa.isInLineSection(t,n,C))continue;return!0}}return!1},interfaces_:function(){return[]},getClass:function(){return qa}}),qa.isInLineSection=function(t,n,l){if(l.getParent()!==t.getParent())return!1;var d=l.getIndex();return d>=n[0]&&d<n[1]},T(tu.prototype,{setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(t){for(var n=t.iterator();n.hasNext();)this.inputIndex.add(n.next());for(var n=t.iterator();n.hasNext();){var l=new qa(this.inputIndex,this.outputIndex);l.setDistanceTolerance(this.distanceTolerance),l.simplify(n.next())}},interfaces_:function(){return[]},getClass:function(){return tu}}),T(Nl.prototype,{getResultGeometry:function(){if(this.inputGeom.isEmpty())return this.inputGeom.copy();this.linestringMap=new Ss,this.inputGeom.apply(new m(this)),this.lineSimplifier.simplify(this.linestringMap.values());var t=new eu(this.linestringMap).transform(this.inputGeom);return t},setDistanceTolerance:function(t){if(0>t)throw new q;this.lineSimplifier.setDistanceTolerance(t)},interfaces_:function(){return[]},getClass:function(){return Nl}}),Nl.simplify=function(t,n){var l=new Nl(t);return l.setDistanceTolerance(n),l.getResultGeometry()},st(eu,br),T(eu.prototype,{transformCoordinates:function(t,n){if(t.size()===0)return null;if(n instanceof oi){var l=this.linestringMap.get(n);return this.createCoordinateSequence(l.getResultCoordinates())}return br.prototype.transformCoordinates.call(this,t,n)},interfaces_:function(){return[]},getClass:function(){return eu}}),T(m.prototype,{filter:function(t){if(t instanceof oi){var n=t;if(n.isEmpty())return null;var l=n.isClosed()?4:2,d=new Va(n,l);this.tps.linestringMap.put(n,d)}},interfaces_:function(){return[Be]},getClass:function(){return m}}),Nl.LineStringTransformer=eu,Nl.LineStringMapBuilderFilter=m;var pl=Object.freeze({DouglasPeuckerSimplifier:dl,TopologyPreservingSimplifier:Nl});T(o.prototype,{splitAt:function(){if(arguments.length===1){var t=arguments[0],n=this.minimumLen/this.segLen;if(t.distance(this.seg.p0)<this.minimumLen)return this.splitPt=this.seg.pointAlong(n),null;if(t.distance(this.seg.p1)<this.minimumLen)return this.splitPt=o.pointAlongReverse(this.seg,n),null;this.splitPt=t}else if(arguments.length===2){var l=arguments[0],d=arguments[1],v=this.getConstrainedLength(l),C=v/this.segLen;d.equals2D(this.seg.p0)?this.splitPt=this.seg.pointAlong(C):this.splitPt=o.pointAlongReverse(this.seg,C)}},setMinimumLength:function(t){this.minimumLen=t},getConstrainedLength:function(t){return t<this.minimumLen?this.minimumLen:t},getSplitPoint:function(){return this.splitPt},interfaces_:function(){return[]},getClass:function(){return o}}),o.pointAlongReverse=function(t,n){var l=new it;return l.x=t.p1.x-n*(t.p1.x-t.p0.x),l.y=t.p1.y-n*(t.p1.y-t.p0.y),l},T(f.prototype,{findSplitPoint:function(t,n){},interfaces_:function(){return[]},getClass:function(){return f}}),T(_.prototype,{findSplitPoint:function(t,n){var l=t.getLineSegment(),d=l.getLength(),v=d/2,C=new o(l),z=_.projectedSplitPoint(t,n),W=2*z.distance(n)*.8,gt=W;return gt>v&&(gt=v),C.setMinimumLength(gt),C.splitAt(z),C.getSplitPoint()},interfaces_:function(){return[f]},getClass:function(){return _}}),_.projectedSplitPoint=function(t,n){var l=t.getLineSegment(),d=l.project(n);return d},T(w.prototype,{interfaces_:function(){return[]},getClass:function(){return w}}),w.triArea=function(t,n,l){return(n.x-t.x)*(l.y-t.y)-(n.y-t.y)*(l.x-t.x)},w.isInCircleDDNormalized=function(t,n,l,d){var v=ut.valueOf(t.x).selfSubtract(d.x),C=ut.valueOf(t.y).selfSubtract(d.y),z=ut.valueOf(n.x).selfSubtract(d.x),W=ut.valueOf(n.y).selfSubtract(d.y),gt=ut.valueOf(l.x).selfSubtract(d.x),Bt=ut.valueOf(l.y).selfSubtract(d.y),Se=v.multiply(W).selfSubtract(z.multiply(C)),Ae=z.multiply(Bt).selfSubtract(gt.multiply(W)),rn=gt.multiply(C).selfSubtract(v.multiply(Bt)),Nn=v.multiply(v).selfAdd(C.multiply(C)),ei=z.multiply(z).selfAdd(W.multiply(W)),ci=gt.multiply(gt).selfAdd(Bt.multiply(Bt)),Mr=Nn.selfMultiply(Ae).selfAdd(ei.selfMultiply(rn)).selfAdd(ci.selfMultiply(Se)),_s=Mr.doubleValue()>0;return _s},w.checkRobustInCircle=function(t,n,l,d){var v=w.isInCircleNonRobust(t,n,l,d),C=w.isInCircleDDSlow(t,n,l,d),z=w.isInCircleCC(t,n,l,d),W=zi.circumcentre(t,n,l);mt.out.println("p radius diff a = "+Math.abs(d.distance(W)-t.distance(W))/t.distance(W)),v===C&&v===z||(mt.out.println("inCircle robustness failure (double result = "+v+", DD result = "+C+", CC result = "+z+")"),mt.out.println(Ns.toLineString(new ue([t,n,l,d]))),mt.out.println("Circumcentre = "+Ns.toPoint(W)+" radius = "+t.distance(W)),mt.out.println("p radius diff a = "+Math.abs(d.distance(W)/t.distance(W)-1)),mt.out.println("p radius diff b = "+Math.abs(d.distance(W)/n.distance(W)-1)),mt.out.println("p radius diff c = "+Math.abs(d.distance(W)/l.distance(W)-1)),mt.out.println())},w.isInCircleDDFast=function(t,n,l,d){var v=ut.sqr(t.x).selfAdd(ut.sqr(t.y)).selfMultiply(w.triAreaDDFast(n,l,d)),C=ut.sqr(n.x).selfAdd(ut.sqr(n.y)).selfMultiply(w.triAreaDDFast(t,l,d)),z=ut.sqr(l.x).selfAdd(ut.sqr(l.y)).selfMultiply(w.triAreaDDFast(t,n,d)),W=ut.sqr(d.x).selfAdd(ut.sqr(d.y)).selfMultiply(w.triAreaDDFast(t,n,l)),gt=v.selfSubtract(C).selfAdd(z).selfSubtract(W),Bt=gt.doubleValue()>0;return Bt},w.isInCircleCC=function(t,n,l,d){var v=zi.circumcentre(t,n,l),C=t.distance(v),z=d.distance(v)-C;return 0>=z},w.isInCircleNormalized=function(t,n,l,d){var v=t.x-d.x,C=t.y-d.y,z=n.x-d.x,W=n.y-d.y,gt=l.x-d.x,Bt=l.y-d.y,Se=v*W-z*C,Ae=z*Bt-gt*W,rn=gt*C-v*Bt,Nn=v*v+C*C,ei=z*z+W*W,ci=gt*gt+Bt*Bt,Mr=Nn*Ae+ei*rn+ci*Se;return Mr>0},w.isInCircleDDSlow=function(t,n,l,d){var v=ut.valueOf(d.x),C=ut.valueOf(d.y),z=ut.valueOf(t.x),W=ut.valueOf(t.y),gt=ut.valueOf(n.x),Bt=ut.valueOf(n.y),Se=ut.valueOf(l.x),Ae=ut.valueOf(l.y),rn=z.multiply(z).add(W.multiply(W)).multiply(w.triAreaDDSlow(gt,Bt,Se,Ae,v,C)),Nn=gt.multiply(gt).add(Bt.multiply(Bt)).multiply(w.triAreaDDSlow(z,W,Se,Ae,v,C)),ei=Se.multiply(Se).add(Ae.multiply(Ae)).multiply(w.triAreaDDSlow(z,W,gt,Bt,v,C)),ci=v.multiply(v).add(C.multiply(C)).multiply(w.triAreaDDSlow(z,W,gt,Bt,Se,Ae)),Mr=rn.subtract(Nn).add(ei).subtract(ci),_s=Mr.doubleValue()>0;return _s},w.isInCircleNonRobust=function(t,n,l,d){var v=(t.x*t.x+t.y*t.y)*w.triArea(n,l,d)-(n.x*n.x+n.y*n.y)*w.triArea(t,l,d)+(l.x*l.x+l.y*l.y)*w.triArea(t,n,d)-(d.x*d.x+d.y*d.y)*w.triArea(t,n,l)>0;return v},w.isInCircleRobust=function(t,n,l,d){return w.isInCircleNormalized(t,n,l,d)},w.triAreaDDSlow=function(t,n,l,d,v,C){return l.subtract(t).multiply(C.subtract(n)).subtract(d.subtract(n).multiply(v.subtract(t)))},w.triAreaDDFast=function(t,n,l){var d=ut.valueOf(n.x).selfSubtract(t.x).selfMultiply(ut.valueOf(l.y).selfSubtract(t.y)),v=ut.valueOf(n.y).selfSubtract(t.y).selfMultiply(ut.valueOf(l.x).selfSubtract(t.x));return d.selfSubtract(v)},T(S.prototype,{circleCenter:function(t,n){var l=new S(this.getX(),this.getY()),d=this.bisector(l,t),v=this.bisector(t,n),C=new Zt(d,v),z=null;try{z=new S(C.getX(),C.getY())}catch(W){if(!(W instanceof Yt))throw W;mt.err.println("a: "+l+"  b: "+t+"  c: "+n),mt.err.println(W)}finally{}return z},dot:function(t){return this.p.x*t.getX()+this.p.y*t.getY()},magn:function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},getZ:function(){return this.p.z},bisector:function(t,n){var l=n.getX()-t.getX(),d=n.getY()-t.getY(),v=new Zt(t.getX()+l/2,t.getY()+d/2,1),C=new Zt(t.getX()-d+l/2,t.getY()+l+d/2,1);return new Zt(v,C)},equals:function(){if(arguments.length===1){var t=arguments[0];return this.p.x===t.getX()&&this.p.y===t.getY()}if(arguments.length===2){var n=arguments[0],l=arguments[1];return this.p.distance(n.getCoordinate())<l}},getCoordinate:function(){return this.p},isInCircle:function(t,n,l){return w.isInCircleRobust(t.p,n.p,l.p,this.p)},interpolateZValue:function(t,n,l){var d=t.getX(),v=t.getY(),C=n.getX()-d,z=l.getX()-d,W=n.getY()-v,gt=l.getY()-v,Bt=C*gt-z*W,Se=this.getX()-d,Ae=this.getY()-v,rn=(gt*Se-z*Ae)/Bt,Nn=(-W*Se+C*Ae)/Bt,ei=t.getZ()+rn*(n.getZ()-t.getZ())+Nn*(l.getZ()-t.getZ());return ei},midPoint:function(t){var n=(this.p.x+t.getX())/2,l=(this.p.y+t.getY())/2,d=(this.p.z+t.getZ())/2;return new S(n,l,d)},rightOf:function(t){return this.isCCW(t.dest(),t.orig())},isCCW:function(t,n){return(t.p.x-this.p.x)*(n.p.y-this.p.y)-(t.p.y-this.p.y)*(n.p.x-this.p.x)>0},getX:function(){return this.p.x},crossProduct:function(t){return this.p.x*t.getY()-this.p.y*t.getX()},setZ:function(t){this.p.z=t},times:function(t){return new S(t*this.p.x,t*this.p.y)},cross:function(){return new S(this.p.y,-this.p.x)},leftOf:function(t){return this.isCCW(t.orig(),t.dest())},toString:function(){return"POINT ("+this.p.x+" "+this.p.y+")"},sub:function(t){return new S(this.p.x-t.getX(),this.p.y-t.getY())},getY:function(){return this.p.y},classify:function(t,n){var l=this,d=n.sub(t),v=l.sub(t),C=d.crossProduct(v);return C>0?S.LEFT:0>C?S.RIGHT:d.getX()*v.getX()<0||d.getY()*v.getY()<0?S.BEHIND:d.magn()<v.magn()?S.BEYOND:t.equals(l)?S.ORIGIN:n.equals(l)?S.DESTINATION:S.BETWEEN},sum:function(t){return new S(this.p.x+t.getX(),this.p.y+t.getY())},distance:function(t,n){return Math.sqrt(Math.pow(n.getX()-t.getX(),2)+Math.pow(n.getY()-t.getY(),2))},circumRadiusRatio:function(t,n){var l=this.circleCenter(t,n),d=this.distance(l,t),v=this.distance(this,t),C=this.distance(t,n);return v>C&&(v=C),C=this.distance(n,this),v>C&&(v=C),d/v},interfaces_:function(){return[]},getClass:function(){return S}}),S.interpolateZ=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],l=arguments[2],d=n.distance(l),v=t.distance(n),C=l.z-n.z,z=n.z+C*(v/d);return z}if(arguments.length===4){var W=arguments[0],gt=arguments[1],Bt=arguments[2],Se=arguments[3],Ae=gt.x,rn=gt.y,Nn=Bt.x-Ae,ei=Se.x-Ae,ci=Bt.y-rn,Mr=Se.y-rn,_s=Nn*Mr-ei*ci,ha=W.x-Ae,mc=W.y-rn,nu=(Mr*ha-ei*mc)/_s,yc=(-ci*ha+Nn*mc)/_s,Wc=gt.z+nu*(Bt.z-gt.z)+yc*(Se.z-gt.z);return Wc}},S.LEFT=0,S.RIGHT=1,S.BEYOND=2,S.BEHIND=3,S.BETWEEN=4,S.ORIGIN=5,S.DESTINATION=6,st(L,S),T(L.prototype,{getConstraint:function(){return this.constraint},setOnConstraint:function(t){this._isOnConstraint=t},merge:function(t){t._isOnConstraint&&(this._isOnConstraint=!0,this.constraint=t.constraint)},isOnConstraint:function(){return this._isOnConstraint},setConstraint:function(t){this._isOnConstraint=!0,this.constraint=t},interfaces_:function(){return[]},getClass:function(){return L}}),T(N.prototype,{equalsNonOriented:function(t){return this.equalsOriented(t)?!0:!!this.equalsOriented(t.sym())},toLineSegment:function(){return new gn(this.vertex.getCoordinate(),this.dest().getCoordinate())},dest:function(){return this.sym().orig()},oNext:function(){return this.next},equalsOriented:function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},dNext:function(){return this.sym().oNext().sym()},lPrev:function(){return this.next.sym()},rPrev:function(){return this.sym().oNext()},rot:function(){return this._rot},oPrev:function(){return this._rot.next._rot},sym:function(){return this._rot._rot},setOrig:function(t){this.vertex=t},lNext:function(){return this.invRot().oNext().rot()},getLength:function(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())},invRot:function(){return this._rot.sym()},setDest:function(t){this.sym().setOrig(t)},setData:function(t){this.data=t},getData:function(){return this.data},delete:function(){this._rot=null},orig:function(){return this.vertex},rNext:function(){return this._rot.next.invRot()},toString:function(){var t=this.vertex.getCoordinate(),n=this.dest().getCoordinate();return Ns.toLineString(t,n)},isLive:function(){return this._rot!==null},getPrimary:function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},dPrev:function(){return this.invRot().oNext().invRot()},setNext:function(t){this.next=t},interfaces_:function(){return[]},getClass:function(){return N}}),N.makeEdge=function(t,n){var l=new N,d=new N,v=new N,C=new N;l._rot=d,d._rot=v,v._rot=C,C._rot=l,l.setNext(l),d.setNext(C),v.setNext(v),C.setNext(d);var z=l;return z.setOrig(t),z.setDest(n),z},N.swap=function(t){var n=t.oPrev(),l=t.sym().oPrev();N.splice(t,n),N.splice(t.sym(),l),N.splice(t,n.lNext()),N.splice(t.sym(),l.lNext()),t.setOrig(n.dest()),t.setDest(l.dest())},N.splice=function(t,n){var l=t.oNext().rot(),d=n.oNext().rot(),v=n.oNext(),C=t.oNext(),z=d.oNext(),W=l.oNext();t.setNext(v),n.setNext(C),l.setNext(z),d.setNext(W)},N.connect=function(t,n){var l=N.makeEdge(t.dest(),n.orig());return N.splice(l,t.lNext()),N.splice(l.sym(),n),l},T(P.prototype,{insertSite:function(t){var n=this.subdiv.locate(t);if(this.subdiv.isVertexOfEdge(n,t))return n;this.subdiv.isOnEdge(n,t.getCoordinate())&&(n=n.oPrev(),this.subdiv.delete(n.oNext()));var l=this.subdiv.makeEdge(n.orig(),t);N.splice(l,n);var d=l;do l=this.subdiv.connect(n,l.sym()),n=l.oPrev();while(n.lNext()!==d);for(;;){var v=n.oPrev();if(v.dest().rightOf(n)&&t.isInCircle(n.orig(),v.dest(),n.dest()))N.swap(n),n=n.oPrev();else{if(n.oNext()===d)return l;n=n.oNext().lPrev()}}},insertSites:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();this.insertSite(l)}},interfaces_:function(){return[]},getClass:function(){return P}}),T(Z.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return Z}}),T(Y.prototype,{init:function(){this.lastEdge=this.findEdge()},locate:function(t){this.lastEdge.isLive()||this.init();var n=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=n,n},findEdge:function(){var t=this.subdiv.getEdges();return t.iterator().next()},interfaces_:function(){return[Z]},getClass:function(){return Y}}),st(nt,ht),T(nt.prototype,{getSegment:function(){return this.seg},interfaces_:function(){return[]},getClass:function(){return nt}}),nt.msgWithSpatial=function(t,n){return n!==null?t+" [ "+n+" ]":t},T(dt.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return dt}}),T(Et.prototype,{getTriangleVertices:function(t){var n=new St;return this.visitTriangles(n,t),n.getTriangleVertices()},isFrameVertex:function(t){return t.equals(this.frameVertex[0])||t.equals(this.frameVertex[1])?!0:!!t.equals(this.frameVertex[2])},isVertexOfEdge:function(t,n){return!(!n.equals(t.orig(),this.tolerance)&&!n.equals(t.dest(),this.tolerance))},connect:function(t,n){var l=N.connect(t,n);return this.quadEdges.add(l),l},getVoronoiCellPolygon:function(t,n){var l=new _t,d=t;do{var v=t.rot().orig().getCoordinate();l.add(v),t=t.oPrev()}while(t!==d);var C=new Jt;C.addAll(l,!1),C.closeRing(),C.size()<4&&(mt.out.println(C),C.add(C.get(C.size()-1),!0));var z=C.toCoordinateArray(),W=n.createPolygon(n.createLinearRing(z),null),gt=d.orig();return W.setUserData(gt.getCoordinate()),W},setLocator:function(t){this.locator=t},initSubdiv:function(){var t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),n=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);N.splice(t.sym(),n);var l=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);return N.splice(n.sym(),l),N.splice(l.sym(),t),t},isFrameBorderEdge:function(t){var n=new Array(3).fill(null);Et.getTriangleEdges(t,n);var l=new Array(3).fill(null);Et.getTriangleEdges(t.sym(),l);var d=t.lNext().dest();if(this.isFrameVertex(d))return!0;var v=t.sym().lNext().dest();return!!this.isFrameVertex(v)},makeEdge:function(t,n){var l=N.makeEdge(t,n);return this.quadEdges.add(l),l},visitTriangles:function(t,n){this.visitedKey++;var l=new Hn;l.push(this.startingEdge);for(var d=new mr;!l.empty();){var v=l.pop();if(!d.contains(v)){var C=this.fetchTriangleToVisit(v,l,n,d);C!==null&&t.visit(C)}}},isFrameEdge:function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},isOnEdge:function(t,n){this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate());var l=this.seg.distance(n);return l<this.edgeCoincidenceTolerance},getEnvelope:function(){return new Xt(this.frameEnv)},createFrame:function(t){var n=t.getWidth(),l=t.getHeight(),d=0;d=n>l?10*n:10*l,this.frameVertex[0]=new S((t.getMaxX()+t.getMinX())/2,t.getMaxY()+d),this.frameVertex[1]=new S(t.getMinX()-d,t.getMinY()-d),this.frameVertex[2]=new S(t.getMaxX()+d,t.getMinY()-d),this.frameEnv=new Xt(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},getTriangleCoordinates:function(t){var n=new vt;return this.visitTriangles(n,t),n.getTriangles()},getVertices:function(t){for(var n=new mr,l=this.quadEdges.iterator();l.hasNext();){var d=l.next(),v=d.orig();!t&&this.isFrameVertex(v)||n.add(v);var C=d.dest();!t&&this.isFrameVertex(C)||n.add(C)}return n},fetchTriangleToVisit:function(t,n,l,d){var v=t,C=0,z=!1;do{this.triEdges[C]=v,this.isFrameEdge(v)&&(z=!0);var W=v.sym();d.contains(W)||n.push(W),d.add(v),C++,v=v.lNext()}while(v!==t);return z&&!l?null:this.triEdges},getEdges:function(){if(arguments.length===0)return this.quadEdges;if(arguments.length===1){for(var t=arguments[0],n=this.getPrimaryEdges(!1),l=new Array(n.size()).fill(null),d=0,v=n.iterator();v.hasNext();){var C=v.next();l[d++]=t.createLineString([C.orig().getCoordinate(),C.dest().getCoordinate()])}return t.createMultiLineString(l)}},getVertexUniqueEdges:function(t){for(var n=new _t,l=new mr,d=this.quadEdges.iterator();d.hasNext();){var v=d.next(),C=v.orig();l.contains(C)||(l.add(C),!t&&this.isFrameVertex(C)||n.add(v));var z=v.sym(),W=z.orig();l.contains(W)||(l.add(W),!t&&this.isFrameVertex(W)||n.add(z))}return n},getTriangleEdges:function(t){var n=new Mt;return this.visitTriangles(n,t),n.getTriangleEdges()},getPrimaryEdges:function(t){this.visitedKey++;var n=new _t,l=new Hn;l.push(this.startingEdge);for(var d=new mr;!l.empty();){var v=l.pop();if(!d.contains(v)){var C=v.getPrimary();!t&&this.isFrameEdge(C)||n.add(C),l.push(v.oNext()),l.push(v.sym().oNext()),d.add(v),d.add(v.sym())}}return n},delete:function(t){N.splice(t,t.oPrev()),N.splice(t.sym(),t.sym().oPrev());var n=t.sym(),l=t.rot(),d=t.rot().sym();this.quadEdges.remove(t),this.quadEdges.remove(n),this.quadEdges.remove(l),this.quadEdges.remove(d),t.delete(),n.delete(),l.delete(),d.delete()},locateFromEdge:function(t,n){for(var l=0,d=this.quadEdges.size(),v=n;;){if(l++,l>d)throw new nt(v.toLineSegment());if(t.equals(v.orig())||t.equals(v.dest()))break;if(t.rightOf(v))v=v.sym();else if(t.rightOf(v.oNext())){if(t.rightOf(v.dPrev()))break;v=v.dPrev()}else v=v.oNext()}return v},getTolerance:function(){return this.tolerance},getVoronoiCellPolygons:function(t){this.visitTriangles(new xt,!0);for(var n=new _t,l=this.getVertexUniqueEdges(!1),d=l.iterator();d.hasNext();){var v=d.next();n.add(this.getVoronoiCellPolygon(v,t))}return n},getVoronoiDiagram:function(t){var n=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(Rn.toGeometryArray(n))},getTriangles:function(t){for(var n=this.getTriangleCoordinates(!1),l=new Array(n.size()).fill(null),d=0,v=n.iterator();v.hasNext();){var C=v.next();l[d++]=t.createPolygon(t.createLinearRing(C),null)}return t.createGeometryCollection(l)},insertSite:function(t){var n=this.locate(t);if(t.equals(n.orig(),this.tolerance)||t.equals(n.dest(),this.tolerance))return n;var l=this.makeEdge(n.orig(),t);N.splice(l,n);var d=l;do l=this.connect(n,l.sym()),n=l.oPrev();while(n.lNext()!==d);return d},locate:function(){if(arguments.length===1){if(arguments[0]instanceof S){var t=arguments[0];return this.locator.locate(t)}if(arguments[0]instanceof it){var n=arguments[0];return this.locator.locate(new S(n))}}else if(arguments.length===2){var l=arguments[0],d=arguments[1],v=this.locator.locate(new S(l));if(v===null)return null;var C=v;v.dest().getCoordinate().equals2D(l)&&(C=v.sym());var z=C;do{if(z.dest().getCoordinate().equals2D(d))return z;z=z.oNext()}while(z!==C);return null}},interfaces_:function(){return[]},getClass:function(){return Et}}),Et.getTriangleEdges=function(t,n){if(n[0]=t,n[1]=n[0].lNext(),n[2]=n[1].lNext(),n[2].lNext()!==n[0])throw new q},T(xt.prototype,{visit:function(t){for(var n=t[0].orig().getCoordinate(),l=t[1].orig().getCoordinate(),d=t[2].orig().getCoordinate(),v=zi.circumcentre(n,l,d),C=new S(v),z=0;3>z;z++)t[z].rot().setOrig(C)},interfaces_:function(){return[dt]},getClass:function(){return xt}}),T(Mt.prototype,{getTriangleEdges:function(){return this.triList},visit:function(t){this.triList.add(t.clone())},interfaces_:function(){return[dt]},getClass:function(){return Mt}}),T(St.prototype,{visit:function(t){this.triList.add([t[0].orig(),t[1].orig(),t[2].orig()])},getTriangleVertices:function(){return this.triList},interfaces_:function(){return[dt]},getClass:function(){return St}}),T(vt.prototype,{checkTriangleSize:function(t){t.length>=2?Ns.toLineString(t[0],t[1]):t.length>=1&&Ns.toPoint(t[0])},visit:function(t){this.coordList.clear();for(var n=0;3>n;n++){var l=t[n].orig();this.coordList.add(l.getCoordinate())}if(this.coordList.size()>0){this.coordList.closeRing();var d=this.coordList.toCoordinateArray();if(d.length!==4)return null;this.triCoords.add(d)}},getTriangles:function(){return this.triCoords},interfaces_:function(){return[dt]},getClass:function(){return vt}}),Et.TriangleCircumcentreVisitor=xt,Et.TriangleEdgesListVisitor=Mt,Et.TriangleVertexListVisitor=St,Et.TriangleCoordinatesVisitor=vt,Et.EDGE_COINCIDENCE_TOL_FACTOR=1e3,T(Rt.prototype,{getLineSegment:function(){return this.ls},getEndZ:function(){var t=this.ls.getCoordinate(1);return t.z},getStartZ:function(){var t=this.ls.getCoordinate(0);return t.z},intersection:function(t){return this.ls.intersection(t.getLineSegment())},getStart:function(){return this.ls.getCoordinate(0)},getEnd:function(){return this.ls.getCoordinate(1)},getEndY:function(){var t=this.ls.getCoordinate(1);return t.y},getStartX:function(){var t=this.ls.getCoordinate(0);return t.x},equalsTopo:function(t){return this.ls.equalsTopo(t.getLineSegment())},getStartY:function(){var t=this.ls.getCoordinate(0);return t.y},setData:function(t){this.data=t},getData:function(){return this.data},getEndX:function(){var t=this.ls.getCoordinate(1);return t.x},toString:function(){return this.ls.toString()},interfaces_:function(){return[]},getClass:function(){return Rt}}),T(Tt.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return Tt}}),T(Ut.prototype,{isRepeated:function(){return this.count>1},getRight:function(){return this.right},getCoordinate:function(){return this.p},setLeft:function(t){this.left=t},getX:function(){return this.p.x},getData:function(){return this.data},getCount:function(){return this.count},getLeft:function(){return this.left},getY:function(){return this.p.y},increment:function(){this.count=this.count+1},setRight:function(t){this.right=t},interfaces_:function(){return[]},getClass:function(){return Ut}}),T(Gt.prototype,{insert:function(){if(arguments.length===1){var t=arguments[0];return this.insert(t,null)}if(arguments.length===2){var n=arguments[0],l=arguments[1];if(this.root===null)return this.root=new Ut(n,l),this.root;if(this.tolerance>0){var d=this.findBestMatchNode(n);if(d!==null)return d.increment(),d}return this.insertExact(n,l)}},query:function(){var t=arguments,n=this;if(arguments.length===1){var l=arguments[0],d=new _t;return this.query(l,d),d}if(arguments.length===2){if(arguments[0]instanceof Xt&&qe(arguments[1],pt))(function(){var z=t[0],W=t[1];n.queryNode(n.root,z,!0,{interfaces_:function(){return[Tt]},visit:function(gt){W.add(gt)}})})();else if(arguments[0]instanceof Xt&&qe(arguments[1],Tt)){var v=arguments[0],C=arguments[1];this.queryNode(this.root,v,!0,C)}}},queryNode:function(t,n,l,d){if(t===null)return null;var v=null,C=null,z=null;l?(v=n.getMinX(),C=n.getMaxX(),z=t.getX()):(v=n.getMinY(),C=n.getMaxY(),z=t.getY());var W=z>v,gt=C>=z;W&&this.queryNode(t.getLeft(),n,!l,d),n.contains(t.getCoordinate())&&d.visit(t),gt&&this.queryNode(t.getRight(),n,!l,d)},findBestMatchNode:function(t){var n=new Nt(t,this.tolerance);return this.query(n.queryEnvelope(),n),n.getNode()},isEmpty:function(){return this.root===null},insertExact:function(t,n){for(var l=this.root,d=this.root,v=!0,C=!0;l!==null;){if(l!==null){var z=t.distance(l.getCoordinate())<=this.tolerance;if(z)return l.increment(),l}C=v?t.x<l.getX():t.y<l.getY(),d=l,l=C?l.getLeft():l.getRight(),v=!v}this.numberOfNodes=this.numberOfNodes+1;var W=new Ut(t,n);return C?d.setLeft(W):d.setRight(W),W},interfaces_:function(){return[]},getClass:function(){return Gt}}),Gt.toCoordinates=function(){if(arguments.length===1){var t=arguments[0];return Gt.toCoordinates(t,!1)}if(arguments.length===2){for(var n=arguments[0],l=arguments[1],d=new Jt,v=n.iterator();v.hasNext();)for(var C=v.next(),z=l?C.getCount():1,W=0;z>W;W++)d.add(C.getCoordinate(),!0);return d.toCoordinateArray()}},T(Nt.prototype,{visit:function(t){var n=this.p.distance(t.getCoordinate()),l=n<=this.tolerance;if(!l)return null;var d=!1;(this.matchNode===null||n<this.matchDist||this.matchNode!==null&&n===this.matchDist&&t.getCoordinate().compareTo(this.matchNode.getCoordinate())<1)&&(d=!0),d&&(this.matchNode=t,this.matchDist=n)},queryEnvelope:function(){var t=new Xt(this.p);return t.expandBy(this.tolerance),t},getNode:function(){return this.matchNode},interfaces_:function(){return[Tt]},getClass:function(){return Nt}}),Gt.BestMatchVisitor=Nt,T(jt.prototype,{getInitialVertices:function(){return this.initialVertices},getKDT:function(){return this.kdt},enforceConstraints:function(){this.addConstraintVertices();var t=0,n=0;do n=this.enforceGabriel(this.segments),t++;while(n>0&&t<jt.MAX_SPLIT_ITER)},insertSites:function(t){for(var n=t.iterator();n.hasNext();){var l=n.next();this.insertSite(l)}},getVertexFactory:function(){return this.vertexFactory},getPointArray:function(){for(var t=new Array(this.initialVertices.size()+this.segVertices.size()).fill(null),n=0,l=this.initialVertices.iterator();l.hasNext();){var d=l.next();t[n++]=d.getCoordinate()}for(var v=this.segVertices.iterator();v.hasNext();){var d=v.next();t[n++]=d.getCoordinate()}return t},setConstraints:function(t,n){this.segments=t,this.segVertices=n},computeConvexHull:function(){var t=new Rn,n=this.getPointArray(),l=new Ur(n,t);this.convexHull=l.getConvexHull()},addConstraintVertices:function(){this.computeConvexHull(),this.insertSites(this.segVertices)},findNonGabrielPoint:function(t){var n=t.getStart(),l=t.getEnd(),d=new it((n.x+l.x)/2,(n.y+l.y)/2),v=n.distance(d),C=new Xt(d);C.expandBy(v);for(var z=this.kdt.query(C),W=null,gt=j.MAX_VALUE,Bt=z.iterator();Bt.hasNext();){var Se=Bt.next(),Ae=Se.getCoordinate();if(!Ae.equals2D(n)&&!Ae.equals2D(l)){var rn=d.distance(Ae);if(v>rn){var Nn=rn;(W===null||gt>Nn)&&(W=Ae,gt=Nn)}}}return W},getConstraintSegments:function(){return this.segments},setSplitPointFinder:function(t){this.splitFinder=t},getConvexHull:function(){return this.convexHull},getTolerance:function(){return this.tolerance},enforceGabriel:function(t){for(var n=new _t,l=0,d=new _t,v=t.iterator();v.hasNext();){var C=v.next(),z=this.findNonGabrielPoint(C);if(z!==null){this.splitPt=this.splitFinder.findSplitPoint(C,z);var W=this.createVertex(this.splitPt,C),gt=(this.insertSite(W),new Rt(C.getStartX(),C.getStartY(),C.getStartZ(),W.getX(),W.getY(),W.getZ(),C.getData())),Bt=new Rt(W.getX(),W.getY(),W.getZ(),C.getEndX(),C.getEndY(),C.getEndZ(),C.getData());n.add(gt),n.add(Bt),d.add(C),l+=1}}return t.removeAll(d),t.addAll(n),l},createVertex:function(){if(arguments.length===1){var t=arguments[0],n=null;return n=this.vertexFactory!==null?this.vertexFactory.createVertex(t,null):new L(t)}if(arguments.length===2){var l=arguments[0],d=arguments[1],n=null;return n=this.vertexFactory!==null?this.vertexFactory.createVertex(l,d):new L(l),n.setOnConstraint(!0),n}},getSubdivision:function(){return this.subdiv},computeBoundingBox:function(){var t=jt.computeVertexEnvelope(this.initialVertices),n=jt.computeVertexEnvelope(this.segVertices),l=new Xt(t);l.expandToInclude(n);var d=.2*l.getWidth(),v=.2*l.getHeight(),C=Math.max(d,v);this.computeAreaEnv=new Xt(l),this.computeAreaEnv.expandBy(C)},setVertexFactory:function(t){this.vertexFactory=t},formInitialDelaunay:function(){this.computeBoundingBox(),this.subdiv=new Et(this.computeAreaEnv,this.tolerance),this.subdiv.setLocator(new Y(this.subdiv)),this.incDel=new P(this.subdiv),this.insertSites(this.initialVertices)},insertSite:function(){if(arguments[0]instanceof L){var t=arguments[0],n=this.kdt.insert(t.getCoordinate(),t);if(n.isRepeated()){var l=n.getData();return l.merge(t),l}return this.incDel.insertSite(t),t}if(arguments[0]instanceof it){var d=arguments[0];this.insertSite(this.createVertex(d))}},interfaces_:function(){return[]},getClass:function(){return jt}}),jt.computeVertexEnvelope=function(t){for(var n=new Xt,l=t.iterator();l.hasNext();){var d=l.next();n.expandToInclude(d.getCoordinate())}return n},jt.MAX_SPLIT_ITER=99,T(fe.prototype,{create:function(){if(this.subdiv!==null)return null;var t=fe.envelope(this.siteCoords),n=fe.toVertices(this.siteCoords);this.subdiv=new Et(t,this.tolerance);var l=new P(this.subdiv);l.insertSites(n)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof de){var t=arguments[0];this.siteCoords=fe.extractUniqueCoordinates(t)}else if(qe(arguments[0],Ft)){var n=arguments[0];this.siteCoords=fe.unique(Bn.toCoordinateArray(n))}},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},interfaces_:function(){return[]},getClass:function(){return fe}}),fe.extractUniqueCoordinates=function(t){if(t===null)return new Jt;var n=t.getCoordinates();return fe.unique(n)},fe.envelope=function(t){for(var n=new Xt,l=t.iterator();l.hasNext();){var d=l.next();n.expandToInclude(d)}return n},fe.unique=function(t){var n=Bn.copyDeep(t);hs.sort(n);var l=new Jt(n,!1);return l},fe.toVertices=function(t){for(var n=new _t,l=t.iterator();l.hasNext();){var d=l.next();n.add(new S(d))}return n},T(Ee.prototype,{createSiteVertices:function(t){for(var n=new _t,l=t.iterator();l.hasNext();){var d=l.next();this.constraintVertexMap.containsKey(d)||n.add(new L(d))}return n},create:function(){if(this.subdiv!==null)return null;var t=fe.envelope(this.siteCoords),n=new _t;this.constraintLines!==null&&(t.expandToInclude(this.constraintLines.getEnvelopeInternal()),this.createVertices(this.constraintLines),n=Ee.createConstraintSegments(this.constraintLines));var l=this.createSiteVertices(this.siteCoords),d=new jt(l,this.tolerance);d.setConstraints(n,new _t(this.constraintVertexMap.values())),d.formInitialDelaunay(),d.enforceConstraints(),this.subdiv=d.getSubdivision()},setTolerance:function(t){this.tolerance=t},setConstraints:function(t){this.constraintLines=t},setSites:function(t){this.siteCoords=fe.extractUniqueCoordinates(t)},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},createVertices:function(t){for(var n=t.getCoordinates(),l=0;l<n.length;l++){var d=new L(n[l]);this.constraintVertexMap.put(n[l],d)}},interfaces_:function(){return[]},getClass:function(){return Ee}}),Ee.createConstraintSegments=function(){if(arguments.length===1){for(var t=arguments[0],n=Nr.getLines(t),l=new _t,d=n.iterator();d.hasNext();){var v=d.next();Ee.createConstraintSegments(v,l)}return l}if(arguments.length===2)for(var C=arguments[0],z=arguments[1],W=C.getCoordinates(),d=1;d<W.length;d++)z.add(new Rt(W[d-1],W[d]))},T(xe.prototype,{create:function(){if(this.subdiv!==null)return null;var t=fe.envelope(this.siteCoords);this.diagramEnv=t;var n=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(n),this.clipEnv!==null&&this.diagramEnv.expandToInclude(this.clipEnv);var l=fe.toVertices(this.siteCoords);this.subdiv=new Et(t,this.tolerance);var d=new P(this.subdiv);d.insertSites(l)},getDiagram:function(t){this.create();var n=this.subdiv.getVoronoiDiagram(t);return xe.clipGeometryCollection(n,this.diagramEnv)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof de){var t=arguments[0];this.siteCoords=fe.extractUniqueCoordinates(t)}else if(qe(arguments[0],Ft)){var n=arguments[0];this.siteCoords=fe.unique(Bn.toCoordinateArray(n))}},setClipEnvelope:function(t){this.clipEnv=t},getSubdivision:function(){return this.create(),this.subdiv},interfaces_:function(){return[]},getClass:function(){return xe}}),xe.clipGeometryCollection=function(t,n){for(var l=t.getFactory().toGeometry(n),d=new _t,v=0;v<t.getNumGeometries();v++){var C=t.getGeometryN(v),z=null;n.contains(C.getEnvelopeInternal())?z=C:n.intersects(C.getEnvelopeInternal())&&(z=l.intersection(C),z.setUserData(C.getUserData())),z===null||z.isEmpty()||d.add(z)}return t.getFactory().createGeometryCollection(Rn.toGeometryArray(d))};var Su=Object.freeze({ConformingDelaunayTriangulationBuilder:Ee,DelaunayTriangulationBuilder:fe,VoronoiDiagramBuilder:xe});T(We.prototype,{interfaces_:function(){return[]},getClass:function(){return We}}),We.union=function(t,n){if(t.isEmpty()||n.isEmpty()){if(t.isEmpty()&&n.isEmpty())return mn.createEmptyResult(mn.UNION,t,n,t.getFactory());if(t.isEmpty())return n.copy();if(n.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),wi.overlayOp(t,n,mn.UNION)},T(de.prototype,{equalsTopo:function(t){return this.getEnvelopeInternal().equals(t.getEnvelopeInternal())?Ei.relate(this,t).isEquals(this.getDimension(),t.getDimension()):!1},union:function(){if(arguments.length===0)return Ql.union(this);if(arguments.length===1){var t=arguments[0];return We.union(this,t)}},isValid:function(){return Ks.isValid(this)},intersection:function(t){if(this.isEmpty()||t.isEmpty())return mn.createEmptyResult(mn.INTERSECTION,this,t,this.factory);if(this.isGeometryCollection()){var n=t;return xl.map(this,{interfaces_:function(){return[MapOp]},map:function(l){return l.intersection(n)}})}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),wi.overlayOp(this,t,mn.INTERSECTION)},covers:function(t){return Ei.covers(this,t)},coveredBy:function(t){return Ei.coveredBy(this,t)},touches:function(t){return Ei.touches(this,t)},intersects:function(t){return Ei.intersects(this,t)},within:function(t){return Ei.within(this,t)},overlaps:function(t){return Ei.overlaps(this,t)},disjoint:function(t){return Ei.disjoint(this,t)},crosses:function(t){return Ei.crosses(this,t)},buffer:function(){if(arguments.length===1){var t=arguments[0];return js.bufferOp(this,t)}if(arguments.length===2){var n=arguments[0],l=arguments[1];return js.bufferOp(this,n,l)}if(arguments.length===3){var d=arguments[0],v=arguments[1],C=arguments[2];return js.bufferOp(this,d,v,C)}},convexHull:function(){return new Ur(this).getConvexHull()},relate:function(){for(var t=arguments.length,n=Array(t),l=0;t>l;l++)n[l]=arguments[l];return Ei.relate.apply(Ei,[this].concat(n))},getCentroid:function(){if(this.isEmpty())return this.factory.createPoint();var t=Ts.getCentroid(this);return this.createPointFromInternalCoord(t,this)},getInteriorPoint:function(){if(this.isEmpty())return this.factory.createPoint();var t=null,n=this.getDimension();if(n===0){var l=new Gr(this);t=l.getInteriorPoint()}else if(n===1){var l=new ds(this);t=l.getInteriorPoint()}else{var l=new sr(this);t=l.getInteriorPoint()}return this.createPointFromInternalCoord(t,this)},symDifference:function(t){if(this.isEmpty()||t.isEmpty()){if(this.isEmpty()&&t.isEmpty())return mn.createEmptyResult(mn.SYMDIFFERENCE,this,t,this.factory);if(this.isEmpty())return t.copy();if(t.isEmpty())return this.copy()}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),wi.overlayOp(this,t,mn.SYMDIFFERENCE)},createPointFromInternalCoord:function(t,n){return n.getPrecisionModel().makePrecise(t),n.getFactory().createPoint(t)},toText:function(){var t=new Ns;return t.write(this)},toString:function(){this.toText()},contains:function(t){return Ei.contains(this,t)},difference:function(t){return this.isEmpty()?mn.createEmptyResult(mn.DIFFERENCE,this,t,this.factory):t.isEmpty()?this.copy():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),wi.overlayOp(this,t,mn.DIFFERENCE))},isSimple:function(){var t=new sl(this);return t.isSimple()},isWithinDistance:function(t,n){var l=this.getEnvelopeInternal().distance(t.getEnvelopeInternal());return l>n?!1:ao.isWithinDistance(this,t,n)},distance:function(t){return ao.distance(this,t)},isEquivalentClass:function(t){return this.getClass()===t.getClass()}});var gl="1.1.2 (248dab8)";F.version=gl,F.algorithm=ii,F.densify=di,F.dissolve=Er,F.geom=Un,F.index=Xs,F.io=Wr,F.noding=nr,F.operation=zl,F.precision=uo,F.simplify=pl,F.triangulate=Su})})(xg,xg.exports)),xg.exports}var r_,R0;function Kx(){if(R0)return r_;R0=1;var B=Fm();return r_=function(V,F){var T=new B.io.GeoJSONReader,G=T.read(JSON.stringify(V.geometry)),q=T.read(JSON.stringify(F.geometry)),j=G.union(q),J=new B.io.GeoJSONWriter;return j=J.write(j),{type:"Feature",geometry:j,properties:V.properties}},r_}var s_,D0;function ww(){if(D0)return s_;D0=1;var B=ev(),V=Kx(),F=cc();function T(q,j,J){if(typeof j!="number")throw new Error("maxEdge parameter is required");if(typeof J!="string")throw new Error("units parameter is required");var h=B(q),X=h.features.filter(tt);h.features=X;function tt(ht){var st=ht.geometry.coordinates[0][0],At=ht.geometry.coordinates[0][1],yt=ht.geometry.coordinates[0][2],it=F(st,At,J),ae=F(At,yt,J),le=F(st,yt,J);return it<=j&&ae<=j&&le<=j}return G(h)}function G(q){for(var j=JSON.parse(JSON.stringify(q.features[0])),J=q.features,h=0,X=J.length;h<X;h++){var tt=J[h];tt.geometry&&(j=V(j,tt))}return j}return s_=T,s_}var o_,N0;function Ew(){if(N0)return o_;N0=1;var B=Fm();return o_=function(V,F){var T=JSON.parse(JSON.stringify(V)),G=JSON.parse(JSON.stringify(F));T.type!=="Feature"&&(T={type:"Feature",properties:{},geometry:T}),G.type!=="Feature"&&(G={type:"Feature",properties:{},geometry:G});var q=new B.io.GeoJSONReader,j=q.read(JSON.stringify(T.geometry)),J=q.read(JSON.stringify(G.geometry)),h=j.difference(J);if(!h.isEmpty()){var X=new B.io.GeoJSONWriter,tt=X.write(h);return T.geometry=h,{type:"Feature",properties:T.properties,geometry:tt}}},o_}var a_,O0;function Sw(){if(O0)return a_;O0=1;var B=ap();return a_=function(F,T,G,q){return F.features.forEach(function(j){var J=T.features.filter(function(h){return B(h,j)}).map(function(h){return h.properties[G]});j.properties||(j.properties={}),j.properties[q]=J}),F},a_}var l_,z0;function Tw(){if(z0)return l_;z0=1;var B=lp().coordEach;return l_=function(F){return F=JSON.parse(JSON.stringify(F)),B(F,function(T){T.reverse()}),F},l_}var u_={exports:{}},P0;function Cw(){return P0||(P0=1,(function(B){(function(){function V(J,h){var X=J.x-h.x,tt=J.y-h.y;return X*X+tt*tt}function F(J,h,X){var tt=h.x,ht=h.y,st=X.x-tt,At=X.y-ht;if(st!==0||At!==0){var yt=((J.x-tt)*st+(J.y-ht)*At)/(st*st+At*At);yt>1?(tt=X.x,ht=X.y):yt>0&&(tt+=st*yt,ht+=At*yt)}return st=J.x-tt,At=J.y-ht,st*st+At*At}function T(J,h){for(var X=J[0],tt=[X],ht,st=1,At=J.length;st<At;st++)ht=J[st],V(ht,X)>h&&(tt.push(ht),X=ht);return X!==ht&&tt.push(ht),tt}function G(J,h,X,tt,ht){for(var st=tt,At,yt=h+1;yt<X;yt++){var it=F(J[yt],J[h],J[X]);it>st&&(At=yt,st=it)}st>tt&&(At-h>1&&G(J,h,At,tt,ht),ht.push(J[At]),X-At>1&&G(J,At,X,tt,ht))}function q(J,h){var X=J.length-1,tt=[J[0]];return G(J,0,X,h,tt),tt.push(J[X]),tt}function j(J,h,X){if(J.length<=2)return J;var tt=h!==void 0?h*h:1;return J=X?J:T(J,tt),J=q(J,tt),J}B.exports=j,B.exports.default=j})()})(u_)),u_.exports}var c_,B0;function Iw(){if(B0)return c_;B0=1;var B=Cw(),V=["LineString","MultiLineString","Polygon","MultiPolygon"];c_=function(J,h,X){return J.type==="Feature"?G(F(J,h,X),J.properties):J.type==="FeatureCollection"?{type:"FeatureCollection",features:J.features.map(function(tt){var ht=F(tt,h,X);return V.indexOf(ht.type)>-1?G(ht,tt.properties):ht})}:J.type==="GeometryCollection"?{type:"GeometryCollection",geometries:J.geometries.map(function(tt){return V.indexOf(tt.type)>-1?F({type:"Feature",geometry:tt},h,X):tt})}:J};function F(J,h,X){return J.geometry.type==="LineString"?{type:"LineString",coordinates:q(J.geometry.coordinates,h,X)}:J.geometry.type==="MultiLineString"?{type:"MultiLineString",coordinates:J.geometry.coordinates.map(function(tt){return q(tt,h,X)})}:J.geometry.type==="Polygon"?{type:"Polygon",coordinates:j(J.geometry.coordinates,h,X)}:J.geometry.type==="MultiPolygon"?{type:"MultiPolygon",coordinates:J.geometry.coordinates.map(function(tt){return j(tt,h,X)})}:J}function T(J){return J.length<3?!1:!(J.length===3&&J[2][0]===J[0][0]&&J[2][1]===J[0][1])}function G(J,h){return{type:"Feature",geometry:J,properties:h}}function q(J,h,X){return B(J.map(function(tt){return{x:tt[0],y:tt[1]}}),h,X).map(function(tt){return[tt.x,tt.y]})}function j(J,h,X){return J.map(function(tt){var ht=tt.map(function(At){return{x:At[0],y:At[1]}});if(ht.length<4)throw new Error("Invalid polygon");for(var st=B(ht,h,X).map(function(At){return[At.x,At.y]});!T(st);)h-=h*.01,st=B(ht,h,X).map(function(At){return[At.x,At.y]});return(st[st.length-1][0]!==st[0][0]||st[st.length-1][1]!==st[0][1])&&st.push(st[0]),st})}return c_}var h_,F0;function Mw(){if(F0)return h_;F0=1;var B=function(V){this.points=V.points||[],this.duration=V.duration||1e4,this.sharpness=V.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=V.stepLength||60,this.length=this.points.length,this.delay=0;for(var F=0;F<this.length;F++)this.points[F].z=this.points[F].z||0;for(var F=0;F<this.length-1;F++){var T=this.points[F],G=this.points[F+1];this.centers.push({x:(T.x+G.x)/2,y:(T.y+G.y)/2,z:(T.z+G.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var F=0;F<this.centers.length-1;F++){var T=this.centers[F],G=this.centers[F+1],q=this.points[F+1].x-(this.centers[F].x+this.centers[F+1].x)/2,j=this.points[F+1].y-(this.centers[F].y+this.centers[F+1].y)/2,J=this.points[F+1].z-(this.centers[F].y+this.centers[F+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[F+1].x+this.sharpness*(this.centers[F].x+q),y:(1-this.sharpness)*this.points[F+1].y+this.sharpness*(this.centers[F].y+j),z:(1-this.sharpness)*this.points[F+1].z+this.sharpness*(this.centers[F].z+J)},{x:(1-this.sharpness)*this.points[F+1].x+this.sharpness*(this.centers[F+1].x+q),y:(1-this.sharpness)*this.points[F+1].y+this.sharpness*(this.centers[F+1].y+j),z:(1-this.sharpness)*this.points[F+1].z+this.sharpness*(this.centers[F+1].z+J)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};return B.prototype.cacheSteps=function(V){var F=[],T=this.pos(0);F.push(0);for(var G=0;G<this.duration;G+=10){var q=this.pos(G),j=Math.sqrt((q.x-T.x)*(q.x-T.x)+(q.y-T.y)*(q.y-T.y)+(q.z-T.z)*(q.z-T.z));j>V&&(F.push(G),T=q)}return F},B.prototype.vector=function(V){var F=this.pos(V+10),T=this.pos(V-10);return{angle:180*Math.atan2(F.y-T.y,F.x-T.x)/3.14,speed:Math.sqrt((T.x-F.x)*(T.x-F.x)+(T.y-F.y)*(T.y-F.y)+(T.z-F.z)*(T.z-F.z))}},B.prototype.pos=function(V){function F(J,h,X,tt,ht){var st=function(it){var ae=it*it,le=ae*it;return[le,3*ae*(1-it),3*it*(1-it)*(1-it),(1-it)*(1-it)*(1-it)]},At=st(J),yt={x:ht.x*At[0]+tt.x*At[1]+X.x*At[2]+h.x*At[3],y:ht.y*At[0]+tt.y*At[1]+X.y*At[2]+h.y*At[3],z:ht.z*At[0]+tt.z*At[1]+X.z*At[2]+h.z*At[3]};return yt}var T=V-this.delay;T<0&&(T=0),T>this.duration&&(T=this.duration-1);var G=T/this.duration;if(G>=1)return this.points[this.length-1];var q=Math.floor((this.points.length-1)*G),j=(this.length-1)*G-q;return F(j,this.points[q],this.controls[q][1],this.controls[q+1][0],this.points[q+1])},h_=B,h_}var f_,k0;function Aw(){if(k0)return f_;k0=1;var B=qr().lineString,V=Mw();return f_=function(F,T,G){var q=B([]);q.properties=F.properties;for(var j=new V({points:F.geometry.coordinates.map(function(X){return{x:X[0],y:X[1]}}),duration:T,sharpness:G}),J=0;J<j.duration;J+=10){var h=j.pos(J);Math.floor(J/100)%2===0&&q.geometry.coordinates.push([h.x,h.y])}return q},f_}var d_,U0;function Lw(){if(U0)return d_;U0=1;var B=ap();return d_=function(V,F,T,G){return V=JSON.parse(JSON.stringify(V)),F=JSON.parse(JSON.stringify(F)),V.features.forEach(function(q){q.properties||(q.properties={}),F.features.forEach(function(j){if(q.properties[G]===void 0){var J=B(q,j);J&&(q.properties[G]=j.properties[T])}})}),V},d_}var p_,G0;function Rw(){if(G0)return p_;G0=1;var B=qr().featureCollection;p_=function(F,T){var G=B(V(F.features,T));return G};function V(F,T){for(var G=F.slice(0),q=F.length,j=q-T,J,h;q-- >j;)h=Math.floor((q+1)*Math.random()),J=G[h],G[h]=G[q],G[q]=J;return G.slice(j)}return p_}var g_,V0;function Qx(){if(V0)return g_;V0=1;var B=qr().polygon;return g_=function(V){var F=[V[0],V[1]],T=[V[0],V[3]],G=[V[2],V[3]],q=[V[2],V[1]];return B([[F,q,G,T,F]])},g_}var m_,q0;function Dw(){if(q0)return m_;q0=1;var B=Bm(),V=Qx();return m_=function(F){return V(B(F))},m_}var y_,j0;function km(){if(j0)return y_;j0=1;var B=Pm().getCoord;return y_=function(V,F){var T=Math.PI/180,G=180/Math.PI,q=B(V),j=B(F),J=T*q[0],h=T*j[0],X=T*q[1],tt=T*j[1],ht=Math.sin(h-J)*Math.cos(tt),st=Math.cos(X)*Math.sin(tt)-Math.sin(X)*Math.cos(tt)*Math.cos(h-J),At=G*Math.atan2(ht,st);return At},y_}var __,X0;function Um(){if(X0)return __;X0=1;var B=Pm().getCoord,V=qr(),F=V.point,T=V.distanceToRadians;return __=function(G,q,j,J){var h=Math.PI/180,X=180/Math.PI,tt=B(G),ht=h*tt[0],st=h*tt[1],At=h*j,yt=T(q,J),it=Math.asin(Math.sin(st)*Math.cos(yt)+Math.cos(st)*Math.sin(yt)*Math.cos(At)),ae=ht+Math.atan2(Math.sin(At)*Math.sin(yt)*Math.cos(st),Math.cos(yt)-Math.sin(st)*Math.sin(it));return F([X*ae,X*it])},__}var v_,Z0;function Nw(){if(Z0)return v_;Z0=1;var B=km(),V=Um(),F=cc();return v_=function(T,G){var q=F(T,G,"miles"),j=B(T,G),J=V(T,q/2,j,"miles");return J},v_}var x_,H0;function Ow(){if(H0)return x_;H0=1,x_=V;var B={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function V(F){if(!F||!F.type)return null;var T=B[F.type];if(!T)return null;if(T==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:F}]};if(T==="feature")return{type:"FeatureCollection",features:[F]};if(T==="featurecollection")return F}return x_}var b_,Y0;function zw(){if(Y0)return b_;Y0=1;var B=qr(),V=B.featureCollection,F=Fm(),T=Ow();b_=function(q,j,J){var h=B.distanceToDegrees(j,J),X=T(q),tt=T(V(X.features.map(function(ht){return G(ht,h)})));if(tt.features.length>1)return tt;if(tt.features.length===1)return tt.features[0]};function G(q,j){var J=new F.io.GeoJSONReader,h=J.read(q.geometry),X=h.buffer(j),tt=new F.io.GeoJSONWriter;return X=tt.write(X),{type:"Feature",geometry:X,properties:{}}}return b_}var w_,W0;function t1(){if(W0)return w_;W0=1;var B=Bm(),V=qr().point;return w_=function(F){var T=B(F),G=(T[0]+T[2])/2,q=(T[1]+T[3])/2;return V([G,q])},w_}var E_,$0;function Pw(){if($0)return E_;$0=1;var B=lp().coordEach,V=qr().point;return E_=function(F){var T=0,G=0,q=0;return B(F,function(j){T+=j[0],G+=j[1],q++},!0),V([T/q,G/q])},E_}var S_,J0;function Bw(){if(J0)return S_;J0=1;var B=lp();return S_=function(V){var F={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},T=Object.keys(F).reduce(function(q,j){return q[j.replace("Multi","")]=j,q},{});function G(q,j,J){J?F[j].coordinates=F[j].coordinates.concat(q.geometry.coordinates):F[j].coordinates.push(q.geometry.coordinates),F[j].properties.push(q.properties)}return B.featureEach(V,function(q){q.geometry&&(F[q.geometry.type]?G(q,q.geometry.type,!0):T[q.geometry.type]&&G(q,T[q.geometry.type],!1))}),{type:"FeatureCollection",features:Object.keys(F).filter(function(q){return F[q].coordinates.length}).sort().map(function(q){return{type:"Feature",properties:{collectedProperties:F[q].properties},geometry:{type:q,coordinates:F[q].coordinates}}})}},S_}var T_,K0;function e1(){if(K0)return T_;K0=1;var B=qr().featureCollection,V=lp().coordEach,F=qr().point;return T_=function(T){var G=[];return V(T,function(q){G.push(F(q))}),B(G)},T_}var Im={exports:{}},Q0;function Fw(){if(Q0)return Im.exports;Q0=1,Im.exports=B,Im.exports.default=B;function B(ct,kt,ut){ut=ut||2;var ye=kt&&kt.length,te=ye?kt[0]*ut:ct.length,mt=V(ct,0,te,ut,!0),Zt=[];if(!mt||mt.next===mt.prev)return Zt;var ve,Be,de,On,An,$n,yi;if(ye&&(mt=h(ct,kt,mt,ut)),ct.length>80*ut){ve=de=ct[0],Be=On=ct[1];for(var Gi=ut;Gi<te;Gi+=ut)An=ct[Gi],$n=ct[Gi+1],An<ve&&(ve=An),$n<Be&&(Be=$n),An>de&&(de=An),$n>On&&(On=$n);yi=Math.max(de-ve,On-Be),yi=yi!==0?32767/yi:0}return T(mt,Zt,ut,ve,Be,yi,0),Zt}function V(ct,kt,ut,ye,te){var mt,Zt;if(te===Xn(ct,kt,ut,ye)>0)for(mt=kt;mt<ut;mt+=ye)Zt=rt(mt,ct[mt],ct[mt+1],Zt);else for(mt=ut-ye;mt>=kt;mt-=ye)Zt=rt(mt,ct[mt],ct[mt+1],Zt);return Zt&&pt(Zt,Zt.next)&&(qe(Zt),Zt=Zt.next),Zt}function F(ct,kt){if(!ct)return ct;kt||(kt=ct);var ut=ct,ye;do if(ye=!1,!ut.steiner&&(pt(ut,ut.next)||lt(ut.prev,ut,ut.next)===0)){if(qe(ut),ut=kt=ut.prev,ut===ut.next)break;ye=!0}else ut=ut.next;while(ye||ut!==kt);return kt}function T(ct,kt,ut,ye,te,mt,Zt){if(ct){!Zt&&mt&&At(ct,ye,te,mt);for(var ve=ct,Be,de;ct.prev!==ct.next;){if(Be=ct.prev,de=ct.next,mt?q(ct,ye,te,mt):G(ct)){kt.push(Be.i/ut|0),kt.push(ct.i/ut|0),kt.push(de.i/ut|0),qe(ct),ct=de.next,ve=de.next;continue}if(ct=de,ct===ve){Zt?Zt===1?(ct=j(F(ct),kt,ut),T(ct,kt,ut,ye,te,mt,2)):Zt===2&&J(ct,kt,ut,ye,te,mt):T(F(ct),kt,ut,ye,te,mt,1);break}}}}function G(ct){var kt=ct.prev,ut=ct,ye=ct.next;if(lt(kt,ut,ye)>=0)return!1;for(var te=kt.x,mt=ut.x,Zt=ye.x,ve=kt.y,Be=ut.y,de=ye.y,On=te<mt?te<Zt?te:Zt:mt<Zt?mt:Zt,An=ve<Be?ve<de?ve:de:Be<de?Be:de,$n=te>mt?te>Zt?te:Zt:mt>Zt?mt:Zt,yi=ve>Be?ve>de?ve:de:Be>de?Be:de,Gi=ye.next;Gi!==kt;){if(Gi.x>=On&&Gi.x<=$n&&Gi.y>=An&&Gi.y<=yi&&le(te,ve,mt,Be,Zt,de,Gi.x,Gi.y)&&lt(Gi.prev,Gi,Gi.next)>=0)return!1;Gi=Gi.next}return!0}function q(ct,kt,ut,ye){var te=ct.prev,mt=ct,Zt=ct.next;if(lt(te,mt,Zt)>=0)return!1;for(var ve=te.x,Be=mt.x,de=Zt.x,On=te.y,An=mt.y,$n=Zt.y,yi=ve<Be?ve<de?ve:de:Be<de?Be:de,Gi=On<An?On<$n?On:$n:An<$n?An:$n,jr=ve>Be?ve>de?ve:de:Be>de?Be:de,Bn=On>An?On>$n?On:$n:An>$n?An:$n,lr=it(yi,Gi,kt,ut,ye),Fr=it(jr,Bn,kt,ut,ye),Mn=ct.prevZ,ui=ct.nextZ;Mn&&Mn.z>=lr&&ui&&ui.z<=Fr;){if(Mn.x>=yi&&Mn.x<=jr&&Mn.y>=Gi&&Mn.y<=Bn&&Mn!==te&&Mn!==Zt&&le(ve,On,Be,An,de,$n,Mn.x,Mn.y)&&lt(Mn.prev,Mn,Mn.next)>=0||(Mn=Mn.prevZ,ui.x>=yi&&ui.x<=jr&&ui.y>=Gi&&ui.y<=Bn&&ui!==te&&ui!==Zt&&le(ve,On,Be,An,de,$n,ui.x,ui.y)&&lt(ui.prev,ui,ui.next)>=0))return!1;ui=ui.nextZ}for(;Mn&&Mn.z>=lr;){if(Mn.x>=yi&&Mn.x<=jr&&Mn.y>=Gi&&Mn.y<=Bn&&Mn!==te&&Mn!==Zt&&le(ve,On,Be,An,de,$n,Mn.x,Mn.y)&&lt(Mn.prev,Mn,Mn.next)>=0)return!1;Mn=Mn.prevZ}for(;ui&&ui.z<=Fr;){if(ui.x>=yi&&ui.x<=jr&&ui.y>=Gi&&ui.y<=Bn&&ui!==te&&ui!==Zt&&le(ve,On,Be,An,de,$n,ui.x,ui.y)&&lt(ui.prev,ui,ui.next)>=0)return!1;ui=ui.nextZ}return!0}function j(ct,kt,ut){var ye=ct;do{var te=ye.prev,mt=ye.next.next;!pt(te,mt)&&It(te,ye,ye.next,mt)&&Xt(te,mt)&&Xt(mt,te)&&(kt.push(te.i/ut|0),kt.push(ye.i/ut|0),kt.push(mt.i/ut|0),qe(ye),qe(ye.next),ye=ct=mt),ye=ye.next}while(ye!==ct);return F(ye)}function J(ct,kt,ut,ye,te,mt){var Zt=ct;do{for(var ve=Zt.next.next;ve!==Zt.prev;){if(Zt.i!==ve.i&&Ft(Zt,ve)){var Be=Yt(Zt,ve);Zt=F(Zt,Zt.next),Be=F(Be,Be.next),T(Zt,kt,ut,ye,te,mt,0),T(Be,kt,ut,ye,te,mt,0);return}ve=ve.next}Zt=Zt.next}while(Zt!==ct)}function h(ct,kt,ut,ye){var te=[],mt,Zt,ve,Be,de;for(mt=0,Zt=kt.length;mt<Zt;mt++)ve=kt[mt]*ye,Be=mt<Zt-1?kt[mt+1]*ye:ct.length,de=V(ct,ve,Be,ye,!1),de===de.next&&(de.steiner=!0),te.push(ae(de));for(te.sort(X),mt=0;mt<te.length;mt++)ut=tt(te[mt],ut);return ut}function X(ct,kt){return ct.x-kt.x}function tt(ct,kt){var ut=ht(ct,kt);if(!ut)return kt;var ye=Yt(ut,ct);return F(ye,ye.next),F(ut,ut.next)}function ht(ct,kt){var ut=kt,ye=ct.x,te=ct.y,mt=-1/0,Zt;do{if(te<=ut.y&&te>=ut.next.y&&ut.next.y!==ut.y){var ve=ut.x+(te-ut.y)*(ut.next.x-ut.x)/(ut.next.y-ut.y);if(ve<=ye&&ve>mt&&(mt=ve,Zt=ut.x<ut.next.x?ut:ut.next,ve===ye))return Zt}ut=ut.next}while(ut!==kt);if(!Zt)return null;var Be=Zt,de=Zt.x,On=Zt.y,An=1/0,$n;ut=Zt;do ye>=ut.x&&ut.x>=de&&ye!==ut.x&&le(te<On?ye:mt,te,de,On,te<On?mt:ye,te,ut.x,ut.y)&&($n=Math.abs(te-ut.y)/(ye-ut.x),Xt(ut,ct)&&($n<An||$n===An&&(ut.x>Zt.x||ut.x===Zt.x&&st(Zt,ut)))&&(Zt=ut,An=$n)),ut=ut.next;while(ut!==Be);return Zt}function st(ct,kt){return lt(ct.prev,ct,kt.prev)<0&&lt(kt.next,ct,ct.next)<0}function At(ct,kt,ut,ye){var te=ct;do te.z===0&&(te.z=it(te.x,te.y,kt,ut,ye)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==ct);te.prevZ.nextZ=null,te.prevZ=null,yt(te)}function yt(ct){var kt,ut,ye,te,mt,Zt,ve,Be,de=1;do{for(ut=ct,ct=null,mt=null,Zt=0;ut;){for(Zt++,ye=ut,ve=0,kt=0;kt<de&&(ve++,ye=ye.nextZ,!!ye);kt++);for(Be=de;ve>0||Be>0&&ye;)ve!==0&&(Be===0||!ye||ut.z<=ye.z)?(te=ut,ut=ut.nextZ,ve--):(te=ye,ye=ye.nextZ,Be--),mt?mt.nextZ=te:ct=te,te.prevZ=mt,mt=te;ut=ye}mt.nextZ=null,de*=2}while(Zt>1);return ct}function it(ct,kt,ut,ye,te){return ct=(ct-ut)*te|0,kt=(kt-ye)*te|0,ct=(ct|ct<<8)&16711935,ct=(ct|ct<<4)&252645135,ct=(ct|ct<<2)&858993459,ct=(ct|ct<<1)&1431655765,kt=(kt|kt<<8)&16711935,kt=(kt|kt<<4)&252645135,kt=(kt|kt<<2)&858993459,kt=(kt|kt<<1)&1431655765,ct|kt<<1}function ae(ct){var kt=ct,ut=ct;do(kt.x<ut.x||kt.x===ut.x&&kt.y<ut.y)&&(ut=kt),kt=kt.next;while(kt!==ct);return ut}function le(ct,kt,ut,ye,te,mt,Zt,ve){return(te-Zt)*(kt-ve)>=(ct-Zt)*(mt-ve)&&(ct-Zt)*(ye-ve)>=(ut-Zt)*(kt-ve)&&(ut-Zt)*(mt-ve)>=(te-Zt)*(ye-ve)}function Ft(ct,kt){return ct.next.i!==kt.i&&ct.prev.i!==kt.i&&!Jt(ct,kt)&&(Xt(ct,kt)&&Xt(kt,ct)&&ie(ct,kt)&&(lt(ct.prev,ct,kt.prev)||lt(ct,kt.prev,kt))||pt(ct,kt)&&lt(ct.prev,ct,ct.next)>0&&lt(kt.prev,kt,kt.next)>0)}function lt(ct,kt,ut){return(kt.y-ct.y)*(ut.x-kt.x)-(kt.x-ct.x)*(ut.y-kt.y)}function pt(ct,kt){return ct.x===kt.x&&ct.y===kt.y}function It(ct,kt,ut,ye){var te=_t(lt(ct,kt,ut)),mt=_t(lt(ct,kt,ye)),Zt=_t(lt(ut,ye,ct)),ve=_t(lt(ut,ye,kt));return!!(te!==mt&&Zt!==ve||te===0&&Dt(ct,ut,kt)||mt===0&&Dt(ct,ye,kt)||Zt===0&&Dt(ut,ct,ye)||ve===0&&Dt(ut,kt,ye))}function Dt(ct,kt,ut){return kt.x<=Math.max(ct.x,ut.x)&&kt.x>=Math.min(ct.x,ut.x)&&kt.y<=Math.max(ct.y,ut.y)&&kt.y>=Math.min(ct.y,ut.y)}function _t(ct){return ct>0?1:ct<0?-1:0}function Jt(ct,kt){var ut=ct;do{if(ut.i!==ct.i&&ut.next.i!==ct.i&&ut.i!==kt.i&&ut.next.i!==kt.i&&It(ut,ut.next,ct,kt))return!0;ut=ut.next}while(ut!==ct);return!1}function Xt(ct,kt){return lt(ct.prev,ct,ct.next)<0?lt(ct,kt,ct.next)>=0&&lt(ct,ct.prev,kt)>=0:lt(ct,kt,ct.prev)<0||lt(ct,ct.next,kt)<0}function ie(ct,kt){var ut=ct,ye=!1,te=(ct.x+kt.x)/2,mt=(ct.y+kt.y)/2;do ut.y>mt!=ut.next.y>mt&&ut.next.y!==ut.y&&te<(ut.next.x-ut.x)*(mt-ut.y)/(ut.next.y-ut.y)+ut.x&&(ye=!ye),ut=ut.next;while(ut!==ct);return ye}function Yt(ct,kt){var ut=new Sn(ct.i,ct.x,ct.y),ye=new Sn(kt.i,kt.x,kt.y),te=ct.next,mt=kt.prev;return ct.next=kt,kt.prev=ct,ut.next=te,te.prev=ut,ye.next=ut,ut.prev=ye,mt.next=ye,ye.prev=mt,ye}function rt(ct,kt,ut,ye){var te=new Sn(ct,kt,ut);return ye?(te.next=ye.next,te.prev=ye,ye.next.prev=te,ye.next=te):(te.prev=te,te.next=te),te}function qe(ct){ct.next.prev=ct.prev,ct.prev.next=ct.next,ct.prevZ&&(ct.prevZ.nextZ=ct.nextZ),ct.nextZ&&(ct.nextZ.prevZ=ct.prevZ)}function Sn(ct,kt,ut){this.i=ct,this.x=kt,this.y=ut,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}B.deviation=function(ct,kt,ut,ye){var te=kt&&kt.length,mt=te?kt[0]*ut:ct.length,Zt=Math.abs(Xn(ct,0,mt,ut));if(te)for(var ve=0,Be=kt.length;ve<Be;ve++){var de=kt[ve]*ut,On=ve<Be-1?kt[ve+1]*ut:ct.length;Zt-=Math.abs(Xn(ct,de,On,ut))}var An=0;for(ve=0;ve<ye.length;ve+=3){var $n=ye[ve]*ut,yi=ye[ve+1]*ut,Gi=ye[ve+2]*ut;An+=Math.abs((ct[$n]-ct[Gi])*(ct[yi+1]-ct[$n+1])-(ct[$n]-ct[yi])*(ct[Gi+1]-ct[$n+1]))}return Zt===0&&An===0?0:Math.abs((An-Zt)/Zt)};function Xn(ct,kt,ut,ye){for(var te=0,mt=kt,Zt=ut-ye;mt<ut;mt+=ye)te+=(ct[Zt]-ct[mt])*(ct[mt+1]+ct[Zt+1]),Zt=mt;return te}return B.flatten=function(ct){for(var kt=ct[0][0].length,ut={vertices:[],holes:[],dimensions:kt},ye=0,te=0;te<ct.length;te++){for(var mt=0;mt<ct[te].length;mt++)for(var Zt=0;Zt<kt;Zt++)ut.vertices.push(ct[te][mt][Zt]);te>0&&(ye+=ct[te-1].length,ut.holes.push(ye))}return ut},Im.exports}var C_,tx;function kw(){if(tx)return C_;tx=1;var B=qr().polygon,V=Fw();C_=function(G){if(!G.geometry||G.geometry.type!=="Polygon"&&G.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var q={type:"FeatureCollection",features:[]};return G.geometry.type==="Polygon"?q.features=F(G.geometry.coordinates):G.geometry.coordinates.forEach(function(j){q.features=q.features.concat(F(j))}),q};function F(G){var q=T(G),j=2,J=V(q.vertices,q.holes,j),h=[],X=[];J.forEach(function(st,At){var yt=J[At];X.push([q.vertices[yt*j],q.vertices[yt*j+1]])});for(var tt=0;tt<X.length;tt+=3){var ht=X.slice(tt,tt+3);ht.push(X[tt]),h.push(B([ht]))}return h}function T(G){for(var q=G[0][0].length,j={vertices:[],holes:[],dimensions:q},J=0,h=0;h<G.length;h++){for(var X=0;X<G[h].length;X++)for(var tt=0;tt<q;tt++)j.vertices.push(G[h][X][tt]);h>0&&(J+=G[h-1].length,j.holes.push(J))}return j}return C_}var I_,ex;function Uw(){if(ex)return I_;ex=1;var B=Fm();return I_=function(F,T){var G,q;F.type==="Feature"?G=F.geometry:G=F,T.type==="Feature"?q=T.geometry:q=T;var j=new B.io.GeoJSONReader,J=j.read(JSON.stringify(G)),h=j.read(JSON.stringify(q)),X=J.intersection(h);if(!X.isEmpty()){var tt=new B.io.GeoJSONWriter,ht=tt.write(X);return{type:"Feature",properties:{},geometry:ht}}},I_}var M_,nx;function Gw(){if(nx)return M_;nx=1;var B=cc();return M_=function(V,F){for(var T,G=1/0,q=0;q<F.features.length;q++){var j=B(V,F.features[q],"miles");j<G&&(T=F.features[q],G=j)}return T},M_}var np={exports:{}},ix;function Vw(){if(ix)return np.exports;ix=1,np.exports=function(){throw new Error("call .point() or .polygon() instead")};function B(tt){return tt?j(tt):[T(),G()]}np.exports.position=B,np.exports.point=function(tt,ht){var st=[];for(i=0;i<tt;i++)st.push(h(ht?q(B(ht)):q()));return X(st)},np.exports.polygon=function(tt,ht,st,At){typeof ht!="number"&&(ht=10),typeof st!="number"&&(st=10);var yt=[];for(i=0;i<tt;i++){var it=[],ae=Array.apply(null,new Array(ht+1)).map(Math.random);ae.forEach(le),ae.forEach(Ft),it[it.length-1]=it[0],it=it.map(V(B(At))),yt.push(h(J([it])))}function le(lt,pt,It){It[pt]=pt>0?lt+It[pt-1]:lt}function Ft(lt,pt){lt=lt*2*Math.PI/ae[ae.length-1];var It=Math.random();it.push([It*st*Math.sin(lt),It*st*Math.cos(lt)])}return X(yt)};function V(tt){return function(ht,st){return[ht[0]+tt[0],ht[1]+tt[1]]}}function F(){return Math.random()-.5}function T(){return F()*360}function G(){return F()*180}function q(tt){return{type:"Point",coordinates:tt||[T(),G()]}}function j(tt){return[Math.random()*(tt[2]-tt[0])+tt[0],Math.random()*(tt[3]-tt[1])+tt[1]]}function J(tt){return{type:"Polygon",coordinates:tt}}function h(tt){return{type:"Feature",geometry:tt,properties:{}}}function X(tt){return{type:"FeatureCollection",features:tt}}return np.exports}var A_,rx;function qw(){if(rx)return A_;rx=1;var B=Vw();return A_=function(V,F,T){switch(T=T||{},F=F||1,V){case"point":case"points":case void 0:return B.point(F,T.bbox);case"polygon":case"polygons":return B.polygon(F,T.num_vertices,T.max_radial_length,T.bbox);default:throw new Error("Unknown type given: valid options are points and polygons")}},A_}var L_,sx;function jw(){if(sx)return L_;sx=1;var B=qr().point;L_=function(F){var T,G={type:"FeatureCollection",features:[]};return F.type==="Feature"?T=F.geometry:T=F,T.coordinates.forEach(function(q){T.coordinates.forEach(function(j){for(var J=0;J<q.length-1;J++)for(var h=0;h<j.length-1;h++)if(!(q===j&&(Math.abs(J-h)===1||Math.abs(J-h)===q.length-2))){var X=V(q[J][0],q[J][1],q[J+1][0],q[J+1][1],j[h][0],j[h][1],j[h+1][0],j[h+1][1]);X&&G.features.push(B([X[0],X[1]]))}})}),G};function V(F,T,G,q,j,J,h,X){var tt,ht,st,At,yt,it={x:null,y:null,onLine1:!1,onLine2:!1};return tt=(X-J)*(G-F)-(h-j)*(q-T),tt===0?it.x!==null&&it.y!==null?it:!1:(ht=T-J,st=F-j,At=(h-j)*ht-(X-J)*st,yt=(G-F)*ht-(q-T)*st,ht=At/tt,st=yt/tt,it.x=F+ht*(G-F),it.y=T+ht*(q-T),ht>=0&&ht<=1&&(it.onLine1=!0),st>=0&&st<=1&&(it.onLine2=!0),it.onLine1&&it.onLine2?[it.x,it.y]:!1)}return L_}var R_,ox;function Xw(){if(ox)return R_;ox=1;var B=qr().featureCollection,V=t1(),F=cc(),T=ap(),G=e1();function q(J){J.type!=="FeatureCollection"&&(J.type!=="Feature"&&(J={type:"Feature",geometry:J,properties:{}}),J=B([J]));for(var h=V(J),X=!1,tt=0;!X&&tt<J.features.length;){var ht=J.features[tt].geometry,st,At,yt,it,ae,le,Ft,lt=!1;if(ht.type==="Point")h.geometry.coordinates[0]===ht.coordinates[0]&&h.geometry.coordinates[1]===ht.coordinates[1]&&(X=!0);else if(ht.type==="MultiPoint"){var pt=!1;for(Ft=0;!pt&&Ft<ht.coordinates.length;)h.geometry.coordinates[0]===ht.coordinates[Ft][0]&&h.geometry.coordinates[1]===ht.coordinates[Ft][1]&&(X=!0,pt=!0),Ft++}else if(ht.type==="LineString")for(Ft=0;!lt&&Ft<ht.coordinates.length-1;)st=h.geometry.coordinates[0],At=h.geometry.coordinates[1],yt=ht.coordinates[Ft][0],it=ht.coordinates[Ft][1],ae=ht.coordinates[Ft+1][0],le=ht.coordinates[Ft+1][1],j(st,At,yt,it,ae,le)&&(lt=!0,X=!0),Ft++;else if(ht.type==="MultiLineString")for(var It=0;It<ht.coordinates.length;){lt=!1,Ft=0;for(var Dt=ht.coordinates[It];!lt&&Ft<Dt.length-1;)st=h.geometry.coordinates[0],At=h.geometry.coordinates[1],yt=Dt[Ft][0],it=Dt[Ft][1],ae=Dt[Ft+1][0],le=Dt[Ft+1][1],j(st,At,yt,it,ae,le)&&(lt=!0,X=!0),Ft++;It++}else if(ht.type==="Polygon"||ht.type==="MultiPolygon"){var _t={type:"Feature",geometry:ht,properties:{}};T(h,_t)&&(X=!0)}tt++}if(X)return h;var Jt=B([]);for(tt=0;tt<J.features.length;tt++)Jt.features=Jt.features.concat(G(J.features[tt]).features);var Xt,ie=1/0;for(tt=0;tt<Jt.features.length;tt++){var Yt=F(h,Jt.features[tt],"miles");Yt<ie&&(ie=Yt,Xt=Jt.features[tt])}return Xt}function j(J,h,X,tt,ht,st){var At=Math.sqrt((ht-X)*(ht-X)+(st-tt)*(st-tt)),yt=Math.sqrt((J-X)*(J-X)+(h-tt)*(h-tt)),it=Math.sqrt((ht-J)*(ht-J)+(st-h)*(st-h));if(At===yt+it)return!0}return R_=q,R_}var Mm={},vg={},ax;function Zw(){return ax||(ax=1,vg.RADIUS=6378137,vg.FLATTENING=1/298.257223563,vg.POLAR_RADIUS=63567523142e-4),vg}var lx;function Hw(){if(lx)return Mm;lx=1;var B=Zw();Mm.geometry=V,Mm.ring=T;function V(q){var j=0,J;switch(q.type){case"Polygon":return F(q.coordinates);case"MultiPolygon":for(J=0;J<q.coordinates.length;J++)j+=F(q.coordinates[J]);return j;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(J=0;J<q.geometries.length;J++)j+=V(q.geometries[J]);return j}}function F(q){var j=0;if(q&&q.length>0){j+=Math.abs(T(q[0]));for(var J=1;J<q.length;J++)j-=Math.abs(T(q[J]))}return j}function T(q){var j,J,h,X,tt,ht,st=0,At=q.length;if(At>2){for(i=0;i<At;i++)i===At-2?(X=At-2,tt=At-1,ht=0):i===At-1?(X=At-1,tt=0,ht=1):(X=i,tt=i+1,ht=i+2),j=q[X],J=q[tt],h=q[ht],st+=(G(h[0])-G(j[0]))*Math.sin(G(J[1]));st=st*B.RADIUS*B.RADIUS/2}return st}function G(q){return q*Math.PI/180}return Mm}var D_,ux;function Yw(){if(ux)return D_;ux=1;var B=Hw().geometry;function V(F){if(F.type==="FeatureCollection"){for(var T=0,G=0;T<F.features.length;T++)F.features[T].geometry&&(G+=B(F.features[T].geometry));return G}else return F.type==="Feature"?B(F.geometry):B(F)}return D_=V,D_}var N_,cx;function Ww(){if(cx)return N_;cx=1;var B=cc(),V=qr().point,F=km(),T=Um();return N_=function(G,q,j){var J;if(G.type==="Feature")J=G.geometry.coordinates;else if(G.type==="LineString")J=G.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var h=0,X=0;X<J.length&&!(q>=h&&X===J.length-1);X++)if(h>=q){var tt=q-h;if(tt){var ht=F(J[X],J[X-1])-180,st=T(J[X],tt,ht,j);return st}else return V(J[X])}else h+=B(J[X],J[X+1],j);return V(J[J.length-1])},N_}var O_,hx;function $w(){if(hx)return O_;hx=1;var B=cc(),V=qr().point;O_=function T(G,q){if(G.type==="FeatureCollection")return G.features.reduce(function(tt,ht){return tt+T(ht,q)},0);var j=G.type==="Feature"?G.geometry:G,J,h;if(j.type==="LineString")return F(j.coordinates,q);if(j.type==="Polygon"||j.type==="MultiLineString"){for(J=0,h=0;h<j.coordinates.length;h++)J+=F(j.coordinates[h],q);return J}else if(G.type==="MultiPolygon"){for(J=0,h=0;h<j.coordinates.length;h++)for(var X=0;X<j.coordinates[h].length;X++)J+=F(j.coordinates[h][X],q);return J}else throw new Error("input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry (or a FeatureCollection containing only those types)")};function F(T,G){for(var q=0,j=V(T[0]),J=V(T[0]),h,X=1;X<T.length;X++)J.geometry.coordinates=T[X],q+=B(j,J,G),h=j,j=J,J=h;return q}return O_}var z_,fx;function n1(){if(fx)return z_;fx=1;var B=cc(),V=qr().point,F=km(),T=Um();z_=function(j,J){var h;if(j.type==="Feature")h=j.geometry.coordinates;else if(j.type==="LineString")h=j.coordinates;else throw new Error("input must be a LineString Feature or Geometry");return G(J,h)};function G(j,J){for(var h="miles",X=V([1/0,1/0],{dist:1/0}),tt=0;tt<J.length-1;tt++){var ht=V(J[tt]),st=V(J[tt+1]);ht.properties.dist=B(j,ht,h),st.properties.dist=B(j,st,h);var At=Math.max(ht.properties.dist,st.properties.dist),yt=F(ht,st),it=T(j,At,yt+90,h),ae=T(j,At,yt-90,h),le=q(it.geometry.coordinates[0],it.geometry.coordinates[1],ae.geometry.coordinates[0],ae.geometry.coordinates[1],ht.geometry.coordinates[0],ht.geometry.coordinates[1],st.geometry.coordinates[0],st.geometry.coordinates[1]),Ft;le&&(Ft=V(le),Ft.properties.dist=B(j,Ft,h)),ht.properties.dist<X.properties.dist&&(X=ht,X.properties.index=tt),st.properties.dist<X.properties.dist&&(X=st,X.properties.index=tt),Ft&&Ft.properties.dist<X.properties.dist&&(X=Ft,X.properties.index=tt)}return X}function q(j,J,h,X,tt,ht,st,At){var yt,it,ae,le,Ft,lt={x:null,y:null,onLine1:!1,onLine2:!1};return yt=(At-ht)*(h-j)-(st-tt)*(X-J),yt===0?lt.x!==null&&lt.y!==null?lt:!1:(it=J-ht,ae=j-tt,le=(st-tt)*it-(At-ht)*ae,Ft=(h-j)*it-(X-J)*ae,it=le/yt,ae=Ft/yt,lt.x=j+it*(h-j),lt.y=J+it*(X-J),it>0&&it<1&&(lt.onLine1=!0),ae>0&&ae<1&&(lt.onLine2=!0),lt.onLine1&&lt.onLine2?[lt.x,lt.y]:!1)}return z_}var P_,dx;function Jw(){if(dx)return P_;dx=1;var B=qr().lineString,V=n1();return P_=function(T,G,q){var j;if(q.type==="Feature")j=q.geometry.coordinates;else if(q.type==="LineString")j=q.coordinates;else throw new Error("input must be a LineString Feature or Geometry");var J=V(q,T),h=V(q,G),X;J.properties.index<=h.properties.index?X=[J,h]:X=[h,J];for(var tt=B([X[0].geometry.coordinates],{}),ht=X[0].properties.index+1;ht<X[1].properties.index+1;ht++)tt.geometry.coordinates.push(j[ht]);return tt.geometry.coordinates.push(X[1].geometry.coordinates),tt},P_}var B_,px;function Kw(){if(px)return B_;px=1;var B=qr().point,V=qr().featureCollection,F=cc();return B_=function(G,q,j){for(var J=V([]),h=q/F(B([G[0],G[1]]),B([G[2],G[1]]),j),X=h*(G[2]-G[0]),tt=q/F(B([G[0],G[1]]),B([G[0],G[3]]),j),ht=tt*(G[3]-G[1]),st=G[0];st<=G[2];){for(var At=G[1];At<=G[3];)J.features.push(B([st,At])),At+=ht;st+=X}return J},B_}var F_,gx;function Qw(){if(gx)return F_;gx=1;var B=qr().featureCollection,V=qr().point,F=qr().polygon,T=cc();return F_=function(q,j,J){for(var h=B([]),X=j/T(V([q[0],q[1]]),V([q[2],q[1]]),J),tt=X*(q[2]-q[0]),ht=j/T(V([q[0],q[1]]),V([q[0],q[3]]),J),st=ht*(q[3]-q[1]),At=q[0];At<=q[2];){for(var yt=q[1];yt<=q[3];){var it=F([[[At,yt],[At,yt+st],[At+tt,yt+st],[At+tt,yt],[At,yt]]]);h.features.push(it),yt+=st}At+=tt}return h},F_}var k_,mx;function tE(){if(mx)return k_;mx=1;var B=qr().featureCollection,V=qr().polygon,F=cc();return k_=function(T,G,q){for(var j=B([]),J=G/F([T[0],T[1]],[T[2],T[1]],q),h=J*(T[2]-T[0]),X=G/F([T[0],T[1]],[T[0],T[3]],q),tt=X*(T[3]-T[1]),ht=0,st=T[0];st<=T[2];){for(var At=0,yt=T[1];yt<=T[3];)ht%2===0&&At%2===0?j.features.push(V([[[st,yt],[st,yt+tt],[st+h,yt],[st,yt]]]),V([[[st,yt+tt],[st+h,yt+tt],[st+h,yt],[st,yt+tt]]])):ht%2===0&&At%2===1?j.features.push(V([[[st,yt],[st+h,yt+tt],[st+h,yt],[st,yt]]]),V([[[st,yt],[st,yt+tt],[st+h,yt+tt],[st,yt]]])):At%2===0&&ht%2===1?j.features.push(V([[[st,yt],[st,yt+tt],[st+h,yt+tt],[st,yt]]]),V([[[st,yt],[st+h,yt+tt],[st+h,yt],[st,yt]]])):At%2===1&&ht%2===1&&j.features.push(V([[[st,yt],[st,yt+tt],[st+h,yt],[st,yt]]]),V([[[st,yt+tt],[st+h,yt+tt],[st+h,yt],[st,yt+tt]]])),yt+=tt,At++;ht++,st+=h}return j},k_}var U_,yx;function eE(){if(yx)return U_;yx=1;for(var B=qr().point,V=qr().polygon,F=cc(),T=qr().featureCollection,G=[],q=[],j=0;j<6;j++){var J=2*Math.PI/6*j;G.push(Math.cos(J)),q.push(Math.sin(J))}U_=function(ht,st,At,yt){var it=st/F(B([ht[0],ht[1]]),B([ht[2],ht[1]]),At),ae=it*(ht[2]-ht[0]),le=st/F(B([ht[0],ht[1]]),B([ht[0],ht[3]]),At),Ft=le*(ht[3]-ht[1]),lt=ae/2,pt=lt*2,It=Math.sqrt(3)/2*Ft,Dt=ht[2]-ht[0],_t=ht[3]-ht[1],Jt=3/4*pt,Xt=It,ie=Dt/(pt-lt/2),Yt=Math.ceil(ie);Math.round(ie)===Yt&&Yt++;var rt=(Yt*Jt-lt/2-Dt)/2-lt/2,qe=Math.ceil(_t/It),Sn=(_t-qe*It)/2,Xn=qe*It-_t>It/2;Xn&&(Sn-=It/4);for(var ct=T([]),kt=0;kt<Yt;kt++)for(var ut=0;ut<=qe;ut++){var ye=kt%2===1;if(!(ut===0&&ye)&&!(ut===0&&Xn)){var te=kt*Jt+ht[0]-rt,mt=ut*Xt+ht[1]+Sn;ye&&(mt-=It/2),yt?ct.features.push.apply(ct.features,X([te,mt],ae/2,Ft/2)):ct.features.push(h([te,mt],ae/2,Ft/2))}}return ct};function h(tt,ht,st){for(var At=[],yt=0;yt<6;yt++){var it=tt[0]+ht*G[yt],ae=tt[1]+st*q[yt];At.push([it,ae])}return At.push(At[0]),V([At])}function X(tt,ht,st){for(var At=[],yt=0;yt<6;yt++){var it=[];it.push(tt),it.push([tt[0]+ht*G[yt],tt[1]+st*q[yt]]),it.push([tt[0]+ht*G[(yt+1)%6],tt[1]+st*q[(yt+1)%6]]),it.push(tt),At.push(V([it]))}return At}return U_}var _x;function nE(){if(_x)return Oc.exports;_x=1,Oc.exports={isolines:rw(),convex:vw(),within:xw(),concave:ww(),difference:Ew(),collect:Sw(),flip:Tw(),simplify:Iw(),bezier:Aw(),tag:Lw(),sample:Rw(),envelope:Dw(),square:$x(),midpoint:Nw(),buffer:zw(),center:t1(),centroid:Pw(),combine:Bw(),distance:cc(),explode:e1(),bbox:Bm(),tesselate:kw(),bboxPolygon:Qx(),inside:ap(),intersect:Uw(),nearest:Gw(),planepoint:Wx(),random:qw(),tin:ev(),union:Kx(),bearing:km(),destination:Um(),kinks:jw(),pointOnSurface:Xw(),area:Yw(),along:Ww(),lineDistance:$w(),lineSlice:Jw(),pointOnLine:n1(),pointGrid:Kw(),squareGrid:Qw(),triangleGrid:tE(),hexGrid:eE()};var B=qr();return Oc.exports.point=B.point,Oc.exports.polygon=B.polygon,Oc.exports.lineString=B.lineString,Oc.exports.multiPoint=B.multiPoint,Oc.exports.multiPolygon=B.multiPolygon,Oc.exports.multiLineString=B.multiLineString,Oc.exports.feature=B.feature,Oc.exports.featureCollection=B.featureCollection,Oc.exports.geometryCollection=B.geometryCollection,Oc.exports}var X_=nE();const Z_=rp(X_),H_=La.create({baseURL:void 0,headers:{"Content-Type":"application/json"}}),i1=Ls.memo(()=>{const{isLoading:B,userLocation:V}=Ls.useContext(Mx),{setMap:F}=Ls.useContext(W_),T=Ls.useRef(null);return Ls.useLayoutEffect(()=>{if(!B){const G=new Tx.Map({container:T.current,style:"mapbox://styles/mapbox/satellite-v9",center:V,zoom:12});F(G)}},[B]),B?Ui.jsx(dE,{}):Ui.jsx("div",{ref:T,className:"",style:{position:"absolute",top:0,bottom:0,width:"100%"}})});i1.displayName="MapView";const vx=B=>{let V;const F=new Set,T=(X,tt)=>{const ht=typeof X=="function"?X(V):X;if(!Object.is(ht,V)){const st=V;V=tt??(typeof ht!="object"||ht===null)?ht:Object.assign({},V,ht),F.forEach(At=>At(V,st))}},G=()=>V,J={setState:T,getState:G,getInitialState:()=>h,subscribe:X=>(F.add(X),()=>F.delete(X))},h=V=B(T,G,J);return J},iE=(B=>B?vx(B):vx),rE=B=>B;function sE(B,V=rE){const F=Cm.useSyncExternalStore(B.subscribe,Cm.useCallback(()=>V(B.getState()),[B,V]),Cm.useCallback(()=>V(B.getInitialState()),[B,V]));return Cm.useDebugValue(F),F}const xx=B=>{const V=iE(B),F=T=>sE(V,T);return Object.assign(F,V),F},oE=(B=>B?xx(B):xx),aE=B=>JSON.parse(JSON.stringify(B.geometry)).coordinates,lE=B=>Z_.centroid(B),bx=async B=>{const V=lE(B),F=V.geometry.coordinates[0],T=V.geometry.coordinates[1];try{const G=await tw.get(`/${F},${T}.json`);return{...B,properties:{...B.properties,place_name:G.data.features[0].place_name}}}catch(G){return console.error("Error geocoding polygon:",G),B}},G_=B=>{if(B.properties&&B.properties.area)return B;const V=aE(B),F=Z_.polygon(V),T=Z_.area(F);return{...B,properties:{...B.properties,area:T}}},wx=oE((B,V)=>({polygons:{type:"FeatureCollection",features:[]},updatePolygonProperties:(F,T)=>{const G=F.properties||{},q={...F,properties:{...G,name:T||G.name||"Title Placeholder"}};return G_(q)},updatePolygonsArray:async F=>{const T=G_(F),G=await bx(T);B(q=>({polygons:{...q.polygons,features:[...q.polygons.features,G]}}))},loadFirstPolygons:async()=>{try{const{data:F}=await H_.get("/api/polygons"),T=F.data[0][0].json_build_object,G=await Promise.all(T.features.map(async q=>{const j={...q,id:q.properties?.id||q.id},J=await bx(j);return G_(J)}));B({polygons:{type:"FeatureCollection",features:G}})}catch(F){console.error("Error loading polygons:",F)}},deletePolygonFromArray:(F,T)=>{B(G=>({polygons:{...G.polygons,features:G.polygons.features.filter((q,j)=>j!==T)}}))}})),uE=B=>Ls.createElement("svg",{width:15,height:15,viewBox:"0 0 15 15",xmlns:"http://www.w3.org/2000/svg",id:"marker",...B},Ls.createElement("path",{d:"M7.5 1C5.42312 1 3 2.2883 3 5.56759C3 7.79276 6.46156 12.7117 7.5 14C8.42309 12.7117 12 7.90993 12 5.56759C12 2.2883 9.57688 1 7.5 1Z"})),cE=B=>Ls.createElement("svg",{id:"waste-basket",xmlns:"http://www.w3.org/2000/svg",width:15,height:15,viewBox:"0 0 15 15",...B},Ls.createElement("path",{d:`M12.41,5.58l-1.34,8c-0.0433,0.2368-0.2493,0.4091-0.49,0.41H4.42c-0.2407-0.0009-0.4467-0.1732-0.49-0.41l-1.34-8
	C2.5458,5.3074,2.731,5.0506,3.0035,5.0064C3.0288,5.0023,3.0544,5.0002,3.08,5h8.83c0.2761-0.0036,0.5028,0.2174,0.5064,0.4935
	C12.4168,5.5225,12.4146,5.5514,12.41,5.58z M13,3.5C13,3.7761,12.7761,4,12.5,4h-10C2.2239,4,2,3.7761,2,3.5S2.2239,3,2.5,3H5V1.5
	C5,1.2239,5.2239,1,5.5,1h4C9.7761,1,10,1.2239,10,1.5V3h2.5C12.7761,3,13,3.2239,13,3.5z M9,3V2H6v1H9z`})),hE=B=>Ls.createElement("svg",{id:"hospital",xmlns:"http://www.w3.org/2000/svg",width:15,height:15,viewBox:"0 0 15 15",...B},Ls.createElement("path",{id:"rect4194",d:`M7,1C6.4,1,6,1.4,6,2v4H2C1.4,6,1,6.4,1,7v1
	c0,0.6,0.4,1,1,1h4v4c0,0.6,0.4,1,1,1h1c0.6,0,1-0.4,1-1V9h4c0.6,0,1-0.4,1-1V7c0-0.6-0.4-1-1-1H9V2c0-0.6-0.4-1-1-1H7z`})),fE=()=>{const B=Ls.useRef(null),V=Ls.useRef([]),[F,T]=Ls.useState({feature:void 0,polygonId:"",index:0}),{map:G,isMapReady:q,draw:j}=Ls.useContext(W_),{polygons:J,loadFirstPolygons:h,updatePolygonProperties:X,updatePolygonsArray:tt,deletePolygonFromArray:ht}=wx(),st=()=>{let ae=JSON.parse(JSON.stringify(F.feature?.geometry));ae=ae.coordinates;const le=X_.bbox(X_.polygon(ae));G?.fitBounds(le,{padding:50})},At=ae=>{if(B.current){const le=B.current?.children.namedItem(ae);if(le){const Ft=le?.getAttribute("data-key");return Number(Ft)}}return V.current.length},yt=()=>{if(B.current&&V.current.length)try{B.current.scrollTo({behavior:"smooth",top:V.current[0].getBoundingClientRect().height*F.index})}catch{B.current.scrollTo({behavior:"smooth",top:0})}},it=async(ae,le)=>{const Ft=ae.id;await H_.delete(`/api/polygons/${Ft}`),ht(ae,le),j.delete(Ft)};return Ls.useEffect(()=>{F.feature&&(st(),yt())},[F]),Ls.useLayoutEffect(()=>{if(!q||!G||!j)return;const ae=async()=>{try{await h();const lt=wx.getState().polygons;lt.features.length>0&&j.set(lt)}catch(lt){lt instanceof Error?console.log("Add your first Polygon!"):console.log(lt)}},le=()=>{const lt=j.getSelectedIds()[0],pt=j.get(lt),It=At(pt?.id);lt&&T({feature:pt,index:It,polygonId:lt})},Ft=async lt=>{let pt=lt.features[0];pt=X(pt);try{const{data:It}=await H_.post("/api/polygons",pt),Dt=It.data;tt(Dt)}catch(It){console.error("Error creating polygon:",It)}};return G.on("load",ae),G.on("click",le),G.on("draw.create",Ft),()=>{G.off("load",ae),G.off("click",le),G.off("draw.create",Ft)}},[q,G,j,h,X,tt]),Ui.jsx(Ui.Fragment,{children:Ui.jsxs("ul",{ref:B,className:"list-unstyled list-group mh-100 polygons-list-container polygons-list",children:[Ui.jsxs("li",{onClick:()=>j.changeMode("draw_polygon"),className:"list-group-item list-group-item-action d-flex justify-content-left align-items-center sticky-top",children:[Ui.jsx("div",{children:Ui.jsx("div",{style:{borderRadius:"50px",border:"none",outline:"none",backgroundColor:"rgb(0, 131, 59)",display:"flex",justifyContent:"center",alignItems:"center",height:"21px",width:"21px"},children:Ui.jsx(hE,{fill:"#dad8d8"})})}),Ui.jsxs("div",{className:"px-3 d-flex align-items-baseline",style:{gap:"0.5rem"},children:[Ui.jsx("h3",{className:"h5 mb-0",children:"New Field"}),Ui.jsx("p",{className:"mb-0",style:{fontSize:"13px",color:"#979797"},children:"Please draw your polygon first."})]})]}),J?.features.length?J.features.map((ae,le)=>Ui.jsxs("li",{ref:Ft=>{Ft&&(V.current[le]=Ft)},onClick:()=>{T({feature:ae,polygonId:ae.id,index:le})},className:`${F.polygonId===ae.id?"active":""} list-group-item list-group-item-action d-flex justify-content-between align-items-center`,"data-key":le,id:ae.id,children:[Ui.jsx("div",{children:Ui.jsx(uE,{className:"marker-icon",fill:"#9857ff"})}),Ui.jsxs("div",{className:"px-3",style:{flex:1,minWidth:0},children:[Ui.jsx("div",{children:ae.properties?.name}),Ui.jsx("div",{className:"text-truncate",children:ae.properties?.place_name}),Ui.jsxs("div",{className:"font-weight-bold",style:{fontSize:"12px",color:"#575757"},children:["Area:"," ",`${ae.properties?.area.toLocaleString(void 0,{maximumFractionDigits:2})}m`]})]}),Ui.jsx("div",{children:Ui.jsx("button",{onClick:()=>it(ae,le),className:"delete-polygon",children:Ui.jsx(cE,{fill:"#333"})})})]},le)):Ui.jsx("li",{className:"text-center py-5",children:"Add your first Polygon!"})]})})};function dE(){return Ui.jsx("div",{className:"loading-map d-flex justify-content-center align-items-center",children:Ui.jsxs("div",{className:"text-center",children:[Ui.jsx("h3",{children:"Espere por favor"}),Ui.jsx("span",{children:"Localizando..."})]})})}class pE extends Ls.Component{state={hasError:!1};static getDerivedStateFromError(V){return{hasError:!0,error:V}}componentDidCatch(V,F){console.error("ErrorBoundary caught an error:",V,F)}render(){return this.state.hasError?this.props.fallback||Ui.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[Ui.jsx("h2",{children:"Algo sali mal"}),Ui.jsx("p",{children:"Por favor, recarga la pgina."}),this.state.error&&Ui.jsxs("details",{style:{marginTop:"20px"},children:[Ui.jsx("summary",{children:"Detalles del error"}),Ui.jsx("pre",{children:this.state.error.toString()})]})]}):this.props.children}}const gE="/assets/sinecta-D15cCP6s.png",mE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJIAAACJCAMAAADwtJHkAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAFdQTFRFAAAAp3j/m1j/nFb/m1j/m1f/m1j/mlX/mlj/nFf/m1f/m1j/r3D/m1f/m1f/m1f/mlf/upH/upL/uZH/uZH/uZH/uJL/uZD/uo//upH/uZH/uJL/uZH/o2B8aAAAAB10Uk5TACBAUICwwDBgkP+gEODwcNBDYKD/0IXwMODAcLCoIHrsAAAEiUlEQVR4nM2a24KqMAxFAQEVKyNQwNv/f+eICgpN26RA434752FmTZruXGgQ2BRGmziOk3RdxVsryItmt08zXzoIK892f/SG81Ri5hGxZ55OO9OBHfzzZKYwCR6gLMt1RH85E1GWaULk74opOoFEW74QZVkMEe0YgbIcMiZWouzv54iOP0eUbVSiDS9R+mN37aFIIRInXqKDGiSuItIr/LVEAlxSMCcS4JJ7XiLAJUNmIqDecue2OgpwBwnoAJiDBByb4CXKVUsK/niR1EoSBLylBJqUeJP795pboNoy3zeYKGCYtHtpJm4+C8h1O4CIi+io3ShxZXeiXyfFLEA5MI/wIpk3bgxIqWUv6R0phYoaJ9IBsbn1iZTs7Ftbj0jHA44n8NEt5WkSb4A+Tat57p0ncRRZ85WoOe0SJldd5Dzo7rG5QVbiBnRaKUKd3PJ7vx6QYzKZPncsIIcJZWUih5MDx4olRW51gU3n0iLOKOAWf2ERExza4i8uUpigLb5BRVEWlAL3VkhxcEqQwko+VZdkJsqlI2RSIwfV5EjhvcnynfpblfxSeyYi4Y8Of26NHOlCvajoXTy6OQrlRA0RCd3won9gNUVqyX6GdAL0z2unSJJ+7VBMeZrGqLNTzs3h5AiOeUTU3UJFutKRCPak38QYkC4F1Qge2uBt3NYynVWkTnV1I3KFeM+0ManpPVy9e0m6fDE6UJazU0xgJBJViB1Z4Ccig4BkGseqIpS9SPsU5jHcHj4bYMvRNRYmKReAeg2Tw2siS5iC2sokK8rxAS/h+oo7PCmw/JHCnE6v47vhmR6/OR5fv88UEE8YtSoQgbrSOimxidPhBn6WsP1MgzDxsLSGqqXXvr5v+fqvdBo3g2w3T85oW9ZDImV5p34p9nXm79TXfCiiI8maxhQpmaP+z1wkKlPvk0MF6W8iqnHCIcmKhNRXmPeWS/T/1j7NHMlu4i+RcvwzKhyibfSpy6hUCq5IJFlQmDQdC87j9E3KRO38RTRuy4RMpU6kRhiaqJBbJkSdG0SycXVSOOFuLTCoGI6O5ATTSQHxrP4pSpColWX73UIdTd9Bv6UZCpYJ0yPJ3w1lnuAXuojmZCRS9/SUiKKIclVpx/bQhYxEVEklktJh+FyZyGVvQBC2uI205smJuwuRlA7bX6Ru6NI2Eb0RR0mUF0egdZIpLO+uEepEXEKdi6aprkZRvVFRS/jbq9m/DSdkdBpPOEgkUXrkkYh+N2zm5OoKSJjdh18k7xHqZLLvwt3v5shwZk5Vc02ks99r9lGtPTSOLHrqriG6cQFpyy7D1R8EewAnkQTHJlYiMLu5Lv9L0CDnMlYsKMC7iRPz0gJ6SsFTRAYBw4DjpLOUgCmO0SKfUoMk2MrIS0CQWB1JQkEibDpXEXDd0BvqlaR6ErNJQsbNbEnAsfHWNmhzymwA0Ls05iABlYS0xfdCxOySEBGvS4LLQE6XbMEJgLNx07xLZTRu3bqUrU/SPzhhyu6raZfEYd1383LL+8nVN+uXCZ9WealK1JeSwsNw0l6vza2wfSz9B21mESqoZ0T5AAAAAElFTkSuQmCC";function Ex(){if(typeof window>"u")return{width:0,height:0};const{innerWidth:B,innerHeight:V}=window;return{width:B,height:V}}function yE(){const[B,V]=Ls.useState(()=>Ex());return Ls.useEffect(()=>{let F;function T(){clearTimeout(F),F=setTimeout(()=>{V(Ex())},150)}return window.addEventListener("resize",T),()=>{window.removeEventListener("resize",T),clearTimeout(F)}},[]),B}function _E(){const{width:B}=yE(),V=Ls.useMemo(()=>({src:B>=768?gE:mE,style:{maxWidth:B>=768?"160px":"50px",position:"absolute",right:30,bottom:30},alt:"Sinecta Logo"}),[B]);return Ui.jsx("img",{...V})}const vE=Ls.memo(_E),xE=()=>Ui.jsx("div",{className:"container-fluid",children:Ui.jsxs("div",{className:"row flex-column flex-md-row polygons-row",children:[Ui.jsx("aside",{className:"col col-md-4 py-3 polygons-sidebar",style:{maxHeight:"100vh"},children:Ui.jsx(fE,{})}),Ui.jsx("div",{className:"loaded-map col col-md-8 p-0",children:Ui.jsx(i1,{})}),Ui.jsx(vE,{})]})});function bE(){return Ui.jsx(pE,{children:Ui.jsx(G1,{children:Ui.jsx(B1,{children:Ui.jsx(xE,{})})})})}Cx.accessToken=void 0;if(!navigator.geolocation)throw alert("Tu navegador no tiene opcin de Geolocation"),new Error("Tu navegador no tiene opcin de Geolocation");const wE=M1.createRoot(document.getElementById("root"));wE.render(Ui.jsx(bE,{}));
//# sourceMappingURL=index-Bh5YjJEZ.js.map
